<!-- Copyright 2020 Rohit Goswami <rog32@hi.is>
     Licensed under the Apache License, Version 2.0 (the "License");
     you may not use this file except in compliance with the License.
     You may obtain a copy of the License at
     http://www.apache.org/licenses/LICENSE-2.0
     Unless required by applicable law or agreed to in writing, software
     distributed under the License is distributed on an "AS IS" BASIS,
     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     See the License for the specific language governing permissions and
     limitations under the License. -->
<!-- HTML header for doxygen 1.9.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>d-SEAMS: src/seams_output.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script>
MathJax = {
  tex: {
    inlineMath: [['$', '$'], ['\\(', '\\)']]
  },
  svg: {
    fontCache: 'global'
  }
  loader: { load: ["[tex]/unicode", "[tex]/ams"] },
  tex: {
    packages: { "[+]": ["unicode", "ams"] },
    tags: "ams",
  },
};
</script>
<script type="text/javascript" id="MathJax-script" async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js">
</script>
<!-- <link href="doxygen.css" rel="stylesheet" type="text/css" /> -->
<link href="doxyYoda.min.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" >
$(document).ready(function() {
     $(".fragment").wrap("<details class='code-details'></details>");
     $(".code-details").append("<summary>Code</summary>");
 }
)
</script>
</head>
<body>
<div class="grid-contents">
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<nav class="title_area">
<a class="project_logo" href="#">
<img src="dSeamsLogo.png" width="30" height="30" alt="Logo">
</a>
<span class="project_info">d-SEAMS v1.0.0</span>
</nav>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">seams_output.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="seams__output_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">// d-SEAMS - Deferred Structural Elucidation Analysis for Molecular Simulations</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">// Copyright (c) 2018--present d-SEAMS core team</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">// This program is free software: you can redistribute it and/or modify</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">// it under the terms of the MIT License as published by</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">// the Open Source Initiative.</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">// A copy of the MIT License is included in the LICENSE file of this repository.</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">// You should have received a copy of the MIT License along with this program.</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">// If not, see &lt;https://opensource.org/licenses/MIT&gt;.</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160; </div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="seams__input_8hpp.html">seams_input.hpp</a>&gt;</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="seams__output_8hpp.html">seams_output.hpp</a>&gt;</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160; </div>
<div class="line"><a name="l00022"></a><span class="lineno"><a class="line" href="namespacesout.html#a18a4f9b414456914c2b21c664a543cc2">   22</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="namespacesout.html#a18a4f9b414456914c2b21c664a543cc2">sout::writeLAMMPSdata</a>(</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;    <a class="code" href="structmolSys_1_1PointCloud.html">molSys::PointCloud</a>&lt;<a class="code" href="structmolSys_1_1Point.html">molSys::Point&lt;double&gt;</a>, <span class="keywordtype">double</span>&gt; *yCloud,</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;    <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt;<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a>&gt; rings, <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt;<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a>&gt; bonds,</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;    <a class="codeRef" href="http://en.cppreference.com/w/cpp/string/basic_string.html">std::string</a> filename) {</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/io/basic_ofstream.html">std::ofstream</a> outputFile;</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a> atoms;         <span class="comment">// Holds all atom IDs to print</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;  <span class="keywordtype">int</span> ringSize = rings[0].<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/size.html">size</a>(); <span class="comment">// Ring size of each ring in rings</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;  <span class="keywordtype">int</span> iatom;                      <span class="comment">// Index, not atom ID</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;  <span class="keywordtype">bool</span> padAtoms = <span class="keyword">false</span>;          <span class="comment">// Add extra atoms if the atom IDs are skipped</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;  <span class="keywordtype">int</span> prevAtomID = 0;             <span class="comment">// Check for previous atom ID</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;  <span class="keywordtype">int</span> dummyAtoms = 0;             <span class="comment">// Number of dummy atoms to fill</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;  <span class="keywordtype">int</span> dummyID;</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;  <span class="keywordtype">int</span> jatom; <span class="comment">// Array index is 1 less than the ID (index for dummy atom)</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;  <span class="comment">// ----------------</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;  <span class="comment">// Return if there are no rings</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;  <span class="keywordflow">if</span> (rings.size() == 0) {</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;  }</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;  <span class="comment">// ----------------</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;  <span class="comment">// Otherwise create file</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;  <span class="comment">// Create output dir if it doesn&#39;t exist already</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span> *path = <span class="stringliteral">&quot;../output&quot;</span>; <span class="comment">// relative to the build directory</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  fs::path dir(path);</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  <span class="comment">// if (fs::create_directory(dir)) {</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  <span class="comment">//   std::cerr &lt;&lt; &quot;Output directory created\n&quot;;</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  <span class="comment">// }</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  <span class="comment">// ----------------</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;  <span class="comment">// Get all the unique atomIDs of the atoms in the rings of this type</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  <span class="comment">// Put all atom IDs into one 1-D vector</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;  <span class="keywordtype">size_t</span> total_size{0};</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  <span class="comment">// Get the total number of atoms (repeated)</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  total_size = rings.size() * ringSize;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;  <span class="comment">// Reserve this size inside atoms</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;  atoms.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/reserve.html">reserve</a>(total_size);</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  <span class="comment">// Fill up all these atom IDs</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iring = 0; iring &lt; rings.size(); iring++) {</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    <a class="codeRef" href="http://en.cppreference.com/w/cpp/utility/move.html">std::move</a>(rings[iring].begin(), rings[iring].end(),</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;              <a class="codeRef" href="http://en.cppreference.com/w/cpp/iterator/back_inserter.html">std::back_inserter</a>(atoms));</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  } <span class="comment">// end of loop through all rings in the list</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160; </div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;  <span class="comment">// Sort the array according to atom ID, which will be needed to get the</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;  <span class="comment">// unique IDs and to remove duplicates</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  sort(atoms.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/begin.html">begin</a>(), atoms.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/end.html">end</a>());</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;  <span class="comment">// Get the unique atom IDs</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;  <span class="keyword">auto</span> ip = <a class="codeRef" href="http://en.cppreference.com/w/cpp/algorithm/unique.html">std::unique</a>(atoms.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/begin.html">begin</a>(), atoms.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/end.html">end</a>());</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;  <span class="comment">// Resize the vector to remove undefined terms</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  atoms.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/resize.html">resize</a>(<a class="codeRef" href="http://en.cppreference.com/w/cpp/iterator/distance.html">std::distance</a>(atoms.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/begin.html">begin</a>(), ip));</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;  <span class="comment">// If the number of atoms is less than the total nop, add dummy atoms</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;  <span class="keywordflow">if</span> (atoms.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/size.html">size</a>() != yCloud-&gt;nop) {</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    padAtoms = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;  }</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  <span class="comment">// ----------------</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  <span class="comment">// Write output to file inside the output directory</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  outputFile.<a class="codeRef" href="http://en.cppreference.com/w/cpp/io/basic_ofstream/open.html">open</a>(<span class="stringliteral">&quot;../output/&quot;</span> + filename);</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  <span class="comment">// FORMAT:</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  <span class="comment">//  Comment Line</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;  <span class="comment">//  4 atoms</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;  <span class="comment">//  4 bonds</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;  <span class="comment">//  0 angles</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;  <span class="comment">//  0 dihedrals</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;  <span class="comment">//  0 impropers</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;  <span class="comment">//  1 atom types</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  <span class="comment">//  1 bond types</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  <span class="comment">//  0 angle types</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;  <span class="comment">//  0 dihedral types</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;  <span class="comment">//  0 improper types</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;  <span class="comment">//  -1.124000 52.845002  xlo xhi</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  <span class="comment">//  0.000000 54.528999  ylo yhi</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  <span class="comment">//  1.830501 53.087501  zlo zhi</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160; </div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  <span class="comment">//  Masses</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160; </div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;  <span class="comment">//  1 15.999400 # O</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160; </div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  <span class="comment">//  Atoms</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160; </div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  <span class="comment">// 1 1 1 0 20.239  1.298 6.873 # O</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  <span class="comment">// 2 1 1 0 0 5.193 6.873 # O</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  <span class="comment">// 3 1 1 0 2.249 1.298 6.873 # O</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160; </div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  <span class="comment">// -------</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  <span class="comment">// Write the header</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  <span class="comment">// Write comment line</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  outputFile &lt;&lt; <span class="stringliteral">&quot;Written out by D-SEAMS\n&quot;</span>;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  <span class="comment">// Write out the number of atoms</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  outputFile &lt;&lt; atoms[atoms.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/size.html">size</a>() - 1] &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;             &lt;&lt; <span class="stringliteral">&quot;atoms&quot;</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;             &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  <span class="comment">// Number of bonds</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  outputFile &lt;&lt; bonds.size() &lt;&lt; <span class="stringliteral">&quot; bonds&quot;</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;             &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  outputFile &lt;&lt; <span class="stringliteral">&quot;0 angles\n0 dihedrals\n0 impropers\n&quot;</span>;</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  <span class="comment">// If padded atoms are required, two atom types will be required</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  <span class="keywordflow">if</span> (padAtoms) {</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    outputFile &lt;&lt; <span class="stringliteral">&quot;2 atom types\n&quot;</span>;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    outputFile &lt;&lt; <span class="stringliteral">&quot;1 atom types\n&quot;</span>;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;  } <span class="comment">// end of atom types</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  outputFile</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;1 bond types\n0 angle types\n0 dihedral types\n0 improper types\n&quot;</span>;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  <span class="comment">// Box lengths</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  outputFile &lt;&lt; <span class="stringliteral">&quot;0 &quot;</span> &lt;&lt; yCloud-&gt;box[0] &lt;&lt; <span class="stringliteral">&quot; xlo xhi\n&quot;</span>;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;  outputFile &lt;&lt; <span class="stringliteral">&quot;0 &quot;</span> &lt;&lt; yCloud-&gt;box[1] &lt;&lt; <span class="stringliteral">&quot; ylo yhi\n&quot;</span>;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;  outputFile &lt;&lt; <span class="stringliteral">&quot;0 &quot;</span> &lt;&lt; yCloud-&gt;box[2] &lt;&lt; <span class="stringliteral">&quot; zlo zhi\n&quot;</span>;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;  <span class="comment">// Masses</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  outputFile &lt;&lt; <span class="stringliteral">&quot;\nMasses\n\n&quot;</span>;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  outputFile &lt;&lt; <span class="stringliteral">&quot;1 15.999400 # O\n&quot;</span>;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  <span class="keywordflow">if</span> (padAtoms) {</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    outputFile &lt;&lt; <span class="stringliteral">&quot;2 1.0 # dummy\n&quot;</span>;</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;  }</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;  <span class="comment">// Atoms</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;  outputFile &lt;&lt; <span class="stringliteral">&quot;\nAtoms\n\n&quot;</span>;</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;  <span class="comment">// -------</span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;  <span class="comment">// Write out the atom coordinates</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;  <span class="comment">// Loop through atoms</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; atoms.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/size.html">size</a>(); i++) {</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    iatom = atoms[i] - 1; <span class="comment">// The actual index is one less than the ID</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    <span class="comment">// -----------</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    <span class="comment">// Pad out</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    <span class="comment">// Fill in dummy atoms if some have been skipped</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    <span class="keywordflow">if</span> (atoms[i] != prevAtomID + 1) {</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;      dummyAtoms = atoms[i] - prevAtomID - 1;</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;      dummyID = prevAtomID;</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;      <span class="comment">// Loop to write out dummy atoms</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; dummyAtoms; j++) {</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        dummyID++;</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        jatom = dummyID - 1;</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        <span class="comment">// 1 molecule-tag atom-type q x y z</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;        outputFile &lt;&lt; dummyID &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; yCloud-&gt;pts[jatom].molID &lt;&lt; <span class="stringliteral">&quot; 2 0 &quot;</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;                   &lt;&lt; yCloud-&gt;pts[jatom].x &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; yCloud-&gt;pts[jatom].y &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;                   &lt;&lt; yCloud-&gt;pts[jatom].z &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;      } <span class="comment">// end of dummy atom write-out</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    }   <span class="comment">// end of check for dummy atom printing</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    <span class="comment">// -----------</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    <span class="comment">// Write out coordinates</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    <span class="comment">// 1 molecule-tag atom-type q x y z</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    outputFile &lt;&lt; atoms[i] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; yCloud-&gt;pts[iatom].molID &lt;&lt; <span class="stringliteral">&quot; 1 0 &quot;</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;               &lt;&lt; yCloud-&gt;pts[iatom].x &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; yCloud-&gt;pts[iatom].y &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;               &lt;&lt; yCloud-&gt;pts[iatom].z &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    <span class="comment">// update the previous atom ID</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    prevAtomID = atoms[i];</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;  } <span class="comment">// end of loop through all atoms in atomID</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160; </div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;  <span class="comment">// Print the bonds now!</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;  outputFile &lt;&lt; <span class="stringliteral">&quot;\nBonds\n\n&quot;</span>;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;  <span class="comment">// Loop through all bonds</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ibond = 0; ibond &lt; bonds.size(); ibond++) {</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    outputFile &lt;&lt; ibond + 1 &lt;&lt; <span class="stringliteral">&quot; 1 &quot;</span> &lt;&lt; bonds[ibond][0] &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;               &lt;&lt; bonds[ibond][1] &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;  }</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160; </div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;  <span class="comment">// Once the datafile has been printed, exit</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;}</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160; </div>
<div class="line"><a name="l00182"></a><span class="lineno"><a class="line" href="namespacesout.html#aafb7e57984a7fdc5d7563aea08148a42">  182</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="namespacesout.html#aafb7e57984a7fdc5d7563aea08148a42">sout::writeRings</a>(<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt;<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a>&gt; rings,</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;                     <a class="codeRef" href="http://en.cppreference.com/w/cpp/string/basic_string.html">std::string</a> filename) {</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/io/basic_ofstream.html">std::ofstream</a> outputFile;</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;  <span class="comment">// ----------------</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;  <span class="comment">// Create output dir if it doesn&#39;t exist already</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span> *path = <span class="stringliteral">&quot;../output&quot;</span>; <span class="comment">// relative to the build directory</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;  fs::path dir(path);</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;  <span class="comment">// if (fs::create_directory(dir)) {</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;  <span class="comment">//   std::cerr &lt;&lt; &quot;Output directory created\n&quot;;</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;  <span class="comment">// }</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;  <span class="comment">// ----------------</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;  <span class="comment">// Write output to file inside the output directory</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;  outputFile.<a class="codeRef" href="http://en.cppreference.com/w/cpp/io/basic_ofstream/open.html">open</a>(<span class="stringliteral">&quot;../output/&quot;</span> + filename);</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160; </div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;  <span class="comment">// Format:</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;  <span class="comment">// 272    214    906   1361    388      1</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160; </div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iring = 0; iring &lt; rings.size(); iring++) {</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <span class="comment">// Otherwise, write out to the file</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; rings[iring].size(); k++) {</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;      outputFile &lt;&lt; rings[iring][k] &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    } <span class="comment">// end of loop through ring elements</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    outputFile &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;  } <span class="comment">// end of loop through rings</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160; </div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;  outputFile.<a class="codeRef" href="http://en.cppreference.com/w/cpp/io/basic_ofstream/close.html">close</a>();</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160; </div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;  <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;}</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160; </div>
<div class="line"><a name="l00216"></a><span class="lineno"><a class="line" href="namespacesout.html#a749ab343b193903acb8489f113e6b1e8">  216</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="namespacesout.html#a749ab343b193903acb8489f113e6b1e8">sout::writePrisms</a>(</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a> *basal1, <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a> *basal2, <span class="keywordtype">int</span> prismNum,</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    <a class="code" href="structmolSys_1_1PointCloud.html">molSys::PointCloud</a>&lt;<a class="code" href="structmolSys_1_1Point.html">molSys::Point&lt;double&gt;</a>, <span class="keywordtype">double</span>&gt; *yCloud) {</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/io/basic_ofstream.html">std::ofstream</a> outputFile;</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/string/basic_string.html">std::string</a> number = <a class="codeRef" href="http://en.cppreference.com/w/cpp/string/basic_string/to_string.html">std::to_string</a>(prismNum);</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/string/basic_string.html">std::string</a> filename = <span class="stringliteral">&quot;prism&quot;</span> + number + <span class="stringliteral">&quot;.dat&quot;</span>;</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;  <span class="keywordtype">int</span> ringSize =</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;      (*basal1).<a class="codeRef" href="http://en.cppreference.com/w/cpp/string/basic_string/size.html">size</a>(); <span class="comment">// Size of the ring; each ring contains n elements</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;  <span class="keywordtype">int</span> iatomIndex;       <span class="comment">// index of atom coordinate being written out</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160; </div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;  <span class="comment">// ----------------</span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;  <span class="comment">// Create output dir if it doesn&#39;t exist already</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span> *path = <span class="stringliteral">&quot;../output/prisms&quot;</span>; <span class="comment">// relative to the build directory</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;  fs::path dir(path);</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;  <span class="comment">// if (fs::create_directory(dir)) {</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;  <span class="comment">//   std::cerr &lt;&lt; &quot;Output Prism directory created\n&quot;;</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;  <span class="comment">// }</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;  <span class="comment">// ----------------</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;  <span class="comment">// Write output to file inside the output directory</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;  outputFile.<a class="codeRef" href="http://en.cppreference.com/w/cpp/io/basic_ofstream/open.html">open</a>(<span class="stringliteral">&quot;../output/prisms/&quot;</span> + filename);</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160; </div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;  <span class="comment">// Format:</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;  <span class="comment">// x y z coordinates of each node</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160; </div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;  <span class="comment">// For basal 1</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iring = 0; iring &lt; ringSize; iring++) {</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    iatomIndex = (*basal1)[iring]; <span class="comment">// C++ indices are one less</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    <span class="comment">// Write the coordinates out to the file</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    outputFile &lt;&lt; yCloud-&gt;pts[iatomIndex].x &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    outputFile &lt;&lt; yCloud-&gt;pts[iatomIndex].y &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    outputFile &lt;&lt; yCloud-&gt;pts[iatomIndex].z &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160; </div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    outputFile &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;  } <span class="comment">// end of loop through basal1</span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160; </div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;  <span class="comment">// For basal 2</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iring = 0; iring &lt; ringSize; iring++) {</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    iatomIndex = (*basal2)[iring]; <span class="comment">// C++ indices are one less</span></div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    <span class="comment">// Write the coordinates out to the file</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    outputFile &lt;&lt; yCloud-&gt;pts[iatomIndex].x &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    outputFile &lt;&lt; yCloud-&gt;pts[iatomIndex].y &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    outputFile &lt;&lt; yCloud-&gt;pts[iatomIndex].z &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160; </div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    outputFile &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;  } <span class="comment">// end of loop through basal1</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160; </div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;  outputFile.<a class="codeRef" href="http://en.cppreference.com/w/cpp/io/basic_ofstream/close.html">close</a>();</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160; </div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;  <span class="comment">// ---- Print out all the coordinates of a single ring, for prismNum=1 only</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;  <span class="keywordflow">if</span> (prismNum == 1) {</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    outputFile.<a class="codeRef" href="http://en.cppreference.com/w/cpp/io/basic_ofstream/open.html">open</a>(<span class="stringliteral">&quot;../output/prisms/singleRing.dat&quot;</span>);</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    <span class="comment">// For basal 1</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iring = 0; iring &lt; ringSize; iring++) {</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;      iatomIndex = (*basal1)[iring]; <span class="comment">// C++ indices are one less</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;      <span class="comment">// Write the coordinates out to the file</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;      outputFile &lt;&lt; yCloud-&gt;pts[iatomIndex].x &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;      outputFile &lt;&lt; yCloud-&gt;pts[iatomIndex].y &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;      outputFile &lt;&lt; yCloud-&gt;pts[iatomIndex].z &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160; </div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;      outputFile &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    } <span class="comment">// end of loop through basal1</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    outputFile.<a class="codeRef" href="http://en.cppreference.com/w/cpp/io/basic_ofstream/close.html">close</a>();</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;  }</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160; </div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;  <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;}</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160; </div>
<div class="line"><a name="l00287"></a><span class="lineno"><a class="line" href="namespacesout.html#a24a195019ec838ff8db628a31cf9ebb2">  287</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="namespacesout.html#a24a195019ec838ff8db628a31cf9ebb2">sout::writeAllCages</a>(</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    <a class="codeRef" href="http://en.cppreference.com/w/cpp/string/basic_string.html">std::string</a> path, <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;cage::Cage&gt;</a> *cageList,</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt;<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a>&gt; rings, <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt;<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a>&gt; nList,</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    <a class="code" href="structmolSys_1_1PointCloud.html">molSys::PointCloud</a>&lt;<a class="code" href="structmolSys_1_1Point.html">molSys::Point&lt;double&gt;</a>, <span class="keywordtype">double</span>&gt; *yCloud,</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    <span class="keywordtype">int</span> currentFrame) {</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;  <span class="keywordtype">int</span> numDDC;                          <span class="comment">// Number of DDCs</span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;  <span class="keywordtype">int</span> numHC;                           <span class="comment">// Number of HCs</span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;  <span class="keywordtype">int</span> numMC;                           <span class="comment">// Number of MCs</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;  <span class="keywordtype">int</span> totalCages = (*cageList).size(); <span class="comment">// Total number of cages</span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;  <a class="code" href="group__cage.html#ga5787314f51b5927c213db48b81c21d95">cage::cageType</a> type;                 <span class="comment">// Current cage type</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160; </div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;  <span class="comment">// ---------------------------------</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;  <span class="comment">// Error handling!</span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;  <span class="keywordflow">if</span> (totalCages == 0) {</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    <a class="codeRef" href="http://en.cppreference.com/w/cpp/io/basic_ostream.html">std::cerr</a> &lt;&lt; <span class="stringliteral">&quot;There are no cages to print.\n&quot;</span>;</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;  }</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;  <span class="comment">// ---------------------------------</span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;  <span class="comment">// Init</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;  numDDC = 0;</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;  numHC = 0;</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;  numMC = 0;</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160; </div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;  <span class="comment">// Loop through every cage</span></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> icage = 0; icage &lt; totalCages; icage++) {</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    type = (*cageList)[icage].type;</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    <span class="comment">// ------</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    <span class="comment">// Add to the cage type and write out to the appropriate folders</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    <span class="comment">// Hexagonal Cages</span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    <span class="keywordflow">if</span> (type == <a class="code" href="group__cage.html#gga5787314f51b5927c213db48b81c21d95a0ff989d0b3eed06750ff06c8bc95c84d">cage::HexC</a>) {</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;      numHC++;</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;      <a class="code" href="namespacesout.html#ae323bc5bea39c66f2efee0f05600fd32">sout::writeEachCage</a>((*cageList)[icage].rings, numHC, type, rings, yCloud);</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;      <a class="code" href="namespacesout.html#a7390840ba628261c9d817c99369b1207">sout::writeBasalRingsHex</a>((*cageList)[icage].rings, numHC, nList, rings);</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    } <span class="comment">// end of write out of HCs</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    <span class="comment">// Double diamond Cages</span></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (type == <a class="code" href="group__cage.html#gga5787314f51b5927c213db48b81c21d95ac5a9e4f20bab07bef66bb6e15c49682d">cage::DoubleDiaC</a>) {</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;      numDDC++;</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;      <a class="code" href="namespacesout.html#ae323bc5bea39c66f2efee0f05600fd32">sout::writeEachCage</a>((*cageList)[icage].rings, numDDC, type, rings,</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;                          yCloud);</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    } <span class="comment">// end of write out of DDCs</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    <span class="comment">// // Mixed Cages</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    <span class="comment">// else if (type == cage::Mixed) {</span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    <span class="comment">//   numMC++;</span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    <span class="comment">//   sout::writeEachCage((*cageList)[icage].rings, numMC, type, rings,</span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    <span class="comment">//   yCloud);</span></div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    <span class="comment">// }  // end of write out of MCs</span></div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    <span class="comment">// // Error</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;      <a class="codeRef" href="http://en.cppreference.com/w/cpp/io/basic_ostream.html">std::cerr</a> &lt;&lt; <span class="stringliteral">&quot;The cage is of the wrong type\n&quot;</span>;</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    } <span class="comment">// some error</span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    <span class="comment">// ------</span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;  } <span class="comment">// end of loop through all cages</span></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160; </div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;  <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;}</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160; </div>
<div class="line"><a name="l00348"></a><span class="lineno"><a class="line" href="namespacesout.html#ae323bc5bea39c66f2efee0f05600fd32">  348</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="namespacesout.html#ae323bc5bea39c66f2efee0f05600fd32">sout::writeEachCage</a>(</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a> currentCage, <span class="keywordtype">int</span> cageNum, <a class="code" href="group__cage.html#ga5787314f51b5927c213db48b81c21d95">cage::cageType</a> type,</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt;<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a>&gt; rings,</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    <a class="code" href="structmolSys_1_1PointCloud.html">molSys::PointCloud</a>&lt;<a class="code" href="structmolSys_1_1Point.html">molSys::Point&lt;double&gt;</a>, <span class="keywordtype">double</span>&gt; *yCloud) {</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/io/basic_ofstream.html">std::ofstream</a> outputFile;</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/string/basic_string.html">std::string</a> number = <a class="codeRef" href="http://en.cppreference.com/w/cpp/string/basic_string/to_string.html">std::to_string</a>(cageNum);</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/string/basic_string.html">std::string</a> filename = <span class="stringliteral">&quot;cage&quot;</span> + number + <span class="stringliteral">&quot;.dat&quot;</span>;</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;  <span class="keywordtype">int</span> ringSize =</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;      rings[0].<a class="codeRef" href="http://en.cppreference.com/w/cpp/string/basic_string/size.html">size</a>();        <span class="comment">// Size of the ring; each ring contains n elements</span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;  <span class="keywordtype">int</span> iatomIndex;             <span class="comment">// index of atom coordinate being written out</span></div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/string/basic_string.html">std::string</a> actualCageType; <span class="comment">// is icage a DDC, HC or MC?</span></div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;  <span class="keywordtype">char</span> cageChar[100];         <span class="comment">// is icage a DDC, HC or MC?</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;  <span class="keywordtype">int</span> iring;                  <span class="comment">// Ring index of the current ring</span></div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160; </div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;  <span class="keywordflow">if</span> (type == <a class="code" href="group__cage.html#gga5787314f51b5927c213db48b81c21d95a0ff989d0b3eed06750ff06c8bc95c84d">cage::HexC</a>) {</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    strcpy(cageChar, <span class="stringliteral">&quot;../output/cages/hexCages&quot;</span>);</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    actualCageType = <span class="stringliteral">&quot;hexCages&quot;</span>;</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (type == <a class="code" href="group__cage.html#gga5787314f51b5927c213db48b81c21d95ac5a9e4f20bab07bef66bb6e15c49682d">cage::DoubleDiaC</a>) {</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    strcpy(cageChar, <span class="stringliteral">&quot;../output/cages/doubleDiaCages&quot;</span>);</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    actualCageType = <span class="stringliteral">&quot;doubleDiaCages&quot;</span>;</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    <span class="comment">// throw error</span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    <a class="codeRef" href="http://en.cppreference.com/w/cpp/io/basic_ostream.html">std::cerr</a> &lt;&lt; <span class="stringliteral">&quot;The cage is of the wrong type. Exit\n&quot;</span>;</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;  } <span class="comment">//</span></div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160; </div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;  <span class="comment">// ----------------</span></div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;  <span class="comment">// Create output dir if it doesn&#39;t exist already</span></div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span> *path = <span class="stringliteral">&quot;../output/cages&quot;</span>; <span class="comment">// relative to the build directory</span></div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;  fs::path dir(path);</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;  <span class="comment">// if (fs::create_directory(dir)) {</span></div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;  <span class="comment">//   std::cerr &lt;&lt; &quot;Output Cage directory created\n&quot;;</span></div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;  <span class="comment">// }</span></div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;  <span class="comment">// ----------------</span></div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;  <span class="comment">// Subdirectory</span></div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160; </div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;  <span class="keyword">const</span> fs::path path1(cageChar);</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;  <span class="comment">// fs::create_directories(path1);</span></div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160; </div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;  <span class="comment">// Write output to file inside the output directory</span></div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/string/basic_string.html">std::string</a> fileOutNameFull =</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;      <span class="stringliteral">&quot;../output/cages/&quot;</span> + actualCageType + <span class="stringliteral">&quot;/&quot;</span> + filename;</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;  outputFile.<a class="codeRef" href="http://en.cppreference.com/w/cpp/io/basic_ofstream/open.html">open</a>(fileOutNameFull);</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160; </div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;  <span class="comment">// Format:</span></div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;  <span class="comment">// x y z coordinates of each node</span></div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160; </div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;  <span class="comment">// For hexagonal cages:</span></div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;  <span class="keywordflow">if</span> (type == <a class="code" href="group__cage.html#gga5787314f51b5927c213db48b81c21d95a0ff989d0b3eed06750ff06c8bc95c84d">cage::HexC</a>) {</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    <span class="comment">// Print out only basal ring atoms, since they describe the outer structure</span></div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    <span class="comment">// The first two rings are basal rings</span></div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 2; i++) {</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;      iring = currentCage[i]; <span class="comment">// Current iring</span></div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;      <span class="comment">// Get every node of iring</span></div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; ringSize; j++) {</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;        iatomIndex = rings[iring][j] - 1; <span class="comment">// C++ indices are one less</span></div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;        <span class="comment">// Write out the coordinates to the file</span></div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;        outputFile &lt;&lt; yCloud-&gt;pts[iatomIndex].x &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;        outputFile &lt;&lt; yCloud-&gt;pts[iatomIndex].y &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;        outputFile &lt;&lt; yCloud-&gt;pts[iatomIndex].z &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160; </div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;        outputFile &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;      } <span class="comment">// end of loop through iring</span></div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    }   <span class="comment">// end of getting every ring in the current cage</span></div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;  }     <span class="comment">// end of printing basal ring atoms for hexagonal cages</span></div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;  <span class="comment">// For currentCage</span></div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;  <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    <span class="comment">// Loop through all cages (could be duplicates) TODO: remove duplicates</span></div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; currentCage.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/size.html">size</a>(); i++) {</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;      iring = currentCage[i]; <span class="comment">// Current iring</span></div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;      <span class="comment">// Get every node of iring</span></div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; ringSize; j++) {</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;        iatomIndex = rings[iring][j] - 1; <span class="comment">// C++ indices are one less</span></div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;        <span class="comment">// Write out the coordinates to the file</span></div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;        outputFile &lt;&lt; yCloud-&gt;pts[iatomIndex].x &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;        outputFile &lt;&lt; yCloud-&gt;pts[iatomIndex].y &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;        outputFile &lt;&lt; yCloud-&gt;pts[iatomIndex].z &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160; </div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;        outputFile &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;      } <span class="comment">// end of loop through iring</span></div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    }   <span class="comment">// end of getting every ring in the current cage</span></div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;  }     <span class="comment">// end of cage printing (has duplicates)</span></div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160; </div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;  <span class="comment">// Close the output file</span></div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;  outputFile.<a class="codeRef" href="http://en.cppreference.com/w/cpp/io/basic_ofstream/close.html">close</a>();</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160; </div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;  <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;}</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160; </div>
<div class="line"><a name="l00441"></a><span class="lineno"><a class="line" href="namespacesout.html#a7390840ba628261c9d817c99369b1207">  441</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="namespacesout.html#a7390840ba628261c9d817c99369b1207">sout::writeBasalRingsHex</a>(<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a> currentCage, <span class="keywordtype">int</span> cageNum,</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;                             <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt;<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a>&gt; nList,</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;                             <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt;<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a>&gt; rings) {</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/io/basic_ofstream.html">std::ofstream</a> outputFile;</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/string/basic_string.html">std::string</a> number = <a class="codeRef" href="http://en.cppreference.com/w/cpp/string/basic_string/to_string.html">std::to_string</a>(cageNum);</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/string/basic_string.html">std::string</a> filename = <span class="stringliteral">&quot;basalRings&quot;</span> + number + <span class="stringliteral">&quot;.dat&quot;</span>;</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;  <span class="keywordtype">int</span> ringSize =</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;      rings[0].<a class="codeRef" href="http://en.cppreference.com/w/cpp/string/basic_string/size.html">size</a>(); <span class="comment">// Size of the ring; each ring contains n elements</span></div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;  <span class="keywordtype">int</span> iatomIndex; <span class="comment">// index of atom coordinate being written out TODO get rid of</span></div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;                  <span class="comment">// this</span></div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;  <span class="keywordtype">int</span> iring;      <span class="comment">// Ring index of the current ring</span></div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;  <span class="comment">// Variables for the hydrogen-bonded &#39;second&#39; basal ring</span></div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a></div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;      basal2; <span class="comment">// Elements are bonded to each element of basal1 in order</span></div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a> basal1; <span class="comment">// &#39;First&#39; basal ring</span></div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a></div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;      unOrderedBasal2; <span class="comment">// Unordered basal2 ring, the ith element is not</span></div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;                       <span class="comment">// necessarily bonded to the ith element of basal1</span></div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;  <span class="keywordtype">int</span> iatom, jatom;    <span class="comment">// Atom numbers (starting from 1), not C++ indices; saved</span></div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;                       <span class="comment">// inside rings</span></div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;  <span class="keywordtype">int</span> natom;           <span class="comment">// Neighbour list ID for iatom</span></div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;  <span class="keywordtype">int</span> findAtom;        <span class="comment">// Atom number of atomID to find in neighbour list</span></div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;  <span class="keywordtype">bool</span> atomFound; <span class="comment">// bool to check if an atomID has been found in the neighbour</span></div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;                  <span class="comment">// list or not</span></div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;  <span class="comment">// Variables for ordering basal2</span></div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;  <span class="comment">// After finding the nearest neighbours, elements which are not nearest</span></div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;  <span class="comment">// neighbours are assigned a value of zero.</span></div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;  <span class="keywordtype">int</span> needle;      <span class="comment">// First non-zero element of basal2 after getting the nearest</span></div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;                   <span class="comment">// neighbours</span></div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;  <span class="keywordtype">int</span> startNeedle; <span class="comment">// Index of basal2; the first non-zero element of basal2</span></div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;  <span class="keywordtype">int</span> startHayStack; <span class="comment">// Index of unOrderedBasal2, corresponding to the first</span></div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;                     <span class="comment">// non-zero element of basal2</span></div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;  <span class="keywordtype">bool</span> isClock;      <span class="comment">// Original order of unOrderedBasal2</span></div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;  <span class="keywordtype">int</span> nextElement;   <span class="comment">// Next element in unOrderedBasal2 after startHayStack</span></div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160; </div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;  <span class="comment">// ----------------</span></div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;  <span class="comment">// Create output dir if it doesn&#39;t exist already</span></div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span> *path = <span class="stringliteral">&quot;../output/cages&quot;</span>; <span class="comment">// relative to the build directory</span></div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;  fs::path dir(path);</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;  <span class="comment">// if (fs::create_directory(dir)) {</span></div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;  <span class="comment">//   std::cerr &lt;&lt; &quot;Output Cage directory created\n&quot;;</span></div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;  <span class="comment">// }</span></div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;  <span class="comment">// ----------------</span></div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;  <span class="comment">// Subdirectory</span></div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160; </div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;  <span class="keyword">const</span> fs::path path1(<span class="stringliteral">&quot;../output/cages/hexBasalRings&quot;</span>);</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;  <span class="comment">// fs::create_directories(path1);</span></div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160; </div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;  <span class="comment">// Write output to file inside the output directory</span></div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/string/basic_string.html">std::string</a> fileOutNameFull = <span class="stringliteral">&quot;../output/cages/hexBasalRings/&quot;</span> + filename;</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;  outputFile.<a class="codeRef" href="http://en.cppreference.com/w/cpp/io/basic_ofstream/open.html">open</a>(fileOutNameFull);</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160; </div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;  <span class="comment">// Format:</span></div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;  <span class="comment">// Coordinate IDs (starting from 1), ordered according to the input XYZ file</span></div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;  <span class="comment">// The first line is a comment line</span></div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;  outputFile &lt;&lt; <span class="stringliteral">&quot;# Particle IDs in the two basal rings\n&quot;</span>;</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160; </div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;  <span class="comment">// ---------------</span></div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;  <span class="comment">// Find the nearest neighbours of basal1 elements in basal2</span></div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;  basal1 = rings[currentCage[0]];          <span class="comment">// First basal ring</span></div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;  unOrderedBasal2 = rings[currentCage[1]]; <span class="comment">// Unordered second basal ring</span></div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160; </div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; basal1.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/size.html">size</a>(); i++) {</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;    iatom = basal1[i]; <span class="comment">// This is the atom particle ID, not the C++ index</span></div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160; </div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;    <span class="comment">// Search through unOrderedBasal2 for an element in the neighbourlist of</span></div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;    <span class="comment">// iatom</span></div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; unOrderedBasal2.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/size.html">size</a>(); k++) {</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;      findAtom =</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;          unOrderedBasal2[k]; <span class="comment">// Atom ID to find in the neighbour list of iatom</span></div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160; </div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;      atomFound = <span class="keyword">false</span>; <span class="comment">// init</span></div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;      jatom = 0;</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160; </div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;      <span class="comment">// Search through the neighbour list for findAtom</span></div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n = 1; n &lt; nList[iatom - 1].size(); n++) {</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;        natom = nList[iatom - 1][n]; <span class="comment">// Atom ID</span></div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160; </div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;        <span class="keywordflow">if</span> (findAtom == natom) {</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;          atomFound = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;        } <span class="comment">// Check</span></div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;      }   <span class="comment">// Loop through nList</span></div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160; </div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;      <span class="keywordflow">if</span> (atomFound) {</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;        jatom = natom;</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;      } <span class="comment">// atom has been found</span></div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;    }   <span class="comment">// end of loop through all atomIDs in unOrderedBasal2</span></div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;    basal2.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/push_back.html">push_back</a>(jatom);</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;  } <span class="comment">// end of loop through all the atomIDs in basal1</span></div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160; </div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;  <span class="comment">// ---------------------------------------------------</span></div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;  <span class="comment">// Get particles which are not nearest neighbours</span></div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;  <span class="comment">// &#39;Alternately&#39; ordered particles</span></div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160; </div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;  <span class="comment">// ---------------</span></div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;  <span class="comment">// Init</span></div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;  isClock = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160; </div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;  <span class="comment">// ---------------</span></div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;  <span class="comment">// Get the first non-zero index {needle}</span></div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 2; i++) {</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;    <span class="keywordflow">if</span> (basal2[i] != 0) {</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;      needle = basal2[i]; <span class="comment">// Set the needle to the first non-zero element</span></div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;      startNeedle = i;    <span class="comment">// Index of basal2</span></div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;      <span class="keywordflow">break</span>;              <span class="comment">// Break out of the loop</span></div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;    }                     <span class="comment">// end of checking for non-zero index</span></div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;  }                       <span class="comment">// end of getting the first non-zero index</span></div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160; </div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;  <span class="comment">// Find the index matching needle in unOrderedBasal2</span></div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; unOrderedBasal2.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/size.html">size</a>(); i++) {</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;    <span class="keywordflow">if</span> (unOrderedBasal2[i] == needle) {</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;      startHayStack = i; <span class="comment">// Index at which needle has been found</span></div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;    }                    <span class="comment">// end of check for needle</span></div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;  }                      <span class="comment">// end of search for needle in unOrderedBasal2</span></div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160; </div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;  <span class="comment">// ---------------</span></div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;  <span class="comment">// Check for &#39;clockwise&#39; order</span></div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;  <span class="comment">// Check &#39;next&#39; element</span></div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;  nextElement = startHayStack + 2;</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;  <span class="keywordflow">if</span> (nextElement &gt;= ringSize) {</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;    nextElement -= ringSize;</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;  }</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160; </div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;  <span class="comment">// Init (indices of basal2 and unOrderedBasal2 respectively)</span></div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;  iatom = 0;</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;  jatom = 0;</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160; </div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;  <span class="keywordflow">if</span> (basal2[startNeedle + 2] == unOrderedBasal2[nextElement]) {</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;    isClock = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;    <span class="comment">// Fill the three elements in increasing order</span></div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt; ringSize; i += 2) {</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;      iatom = startNeedle + i;</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;      jatom = startHayStack + i;</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;      <span class="comment">// Make sure the indices are not larger than 6</span></div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;      <span class="keywordflow">if</span> (iatom &gt;= ringSize) {</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;        iatom -= ringSize;</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;      }</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;      <span class="keywordflow">if</span> (jatom &gt;= ringSize) {</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;        jatom -= ringSize;</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;      }</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160; </div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;      basal2[iatom] = unOrderedBasal2[jatom];</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;    } <span class="comment">// end of filling next two alternate elements</span></div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;  }   <span class="comment">// check to see if clockwise order is correct</span></div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160; </div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;  <span class="comment">// ---------------</span></div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;  <span class="comment">// Check for &#39;anticlockwise&#39; order</span></div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;  <span class="comment">// Check &#39;next&#39; element</span></div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;  <span class="keywordflow">if</span> (!isClock) {</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;    iatom = 0;</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;    jatom = 0; <span class="comment">// init</span></div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160; </div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;    <span class="comment">// First element</span></div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;    iatom = startNeedle + 2;</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;    jatom = startHayStack - 2;</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;    <span class="keywordflow">if</span> (jatom &lt; 0) {</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;      jatom += ringSize;</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;    }</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160; </div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;    <span class="keywordflow">if</span> (basal2[iatom] == unOrderedBasal2[jatom]) {</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;      <span class="comment">// Fill the three elements in increasing order</span></div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt; ringSize; i += 2) {</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;        iatom = startNeedle + i;</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;        jatom = startHayStack - i;</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;        <span class="comment">// Make sure the indices are not larger than 6</span></div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;        <span class="keywordflow">if</span> (iatom &gt; ringSize) {</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;          iatom -= ringSize;</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;        }</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;        <span class="keywordflow">if</span> (jatom &lt; 0) {</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;          jatom += ringSize;</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;        }</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160; </div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;        basal2[iatom] = unOrderedBasal2[jatom];</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;      } <span class="comment">// end of filling next two alternate elements</span></div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;    }   <span class="comment">// check to see if anticlockwise order is correct</span></div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;      <a class="codeRef" href="http://en.cppreference.com/w/cpp/io/basic_ostream.html">std::cerr</a> &lt;&lt; <span class="stringliteral">&quot;Something is wrong with your HCs.\n&quot;</span>;</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;      <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;    } <span class="comment">// exit with error</span></div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;  }   <span class="comment">// End of check for anticlockwise stuff</span></div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160; </div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;  <span class="comment">// ---------------------------------------------------</span></div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;  <span class="comment">// Print out the ordered rings</span></div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;  <span class="comment">// For hexagonal cages:</span></div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;  <span class="comment">// Only print out basal1 and basal2</span></div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160; </div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;  <span class="comment">// BASAL1</span></div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; basal1.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/size.html">size</a>(); i++) {</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;    outputFile &lt;&lt; basal1[i] &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;  } <span class="comment">// end of loop through basal1</span></div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;  outputFile &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160; </div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;  <span class="comment">// BASAL2</span></div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; basal2.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/size.html">size</a>(); i++) {</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;    outputFile &lt;&lt; basal2[i] &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;  } <span class="comment">// end of loop through basal2</span></div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160; </div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;  <span class="comment">// Close the output file</span></div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;  outputFile.<a class="codeRef" href="http://en.cppreference.com/w/cpp/io/basic_ofstream/close.html">close</a>();</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160; </div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;  <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;}</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160; </div>
<div class="line"><a name="l00650"></a><span class="lineno"><a class="line" href="namespacesout.html#a01b11b3b1d2830a9e2724526ee40712b">  650</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="namespacesout.html#a01b11b3b1d2830a9e2724526ee40712b">sout::writeBasalRingsPrism</a>(</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;    <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a> *basal1, <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a> *basal2, <span class="keywordtype">int</span> prismNum,</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;    <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt;<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a>&gt; nList,</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;    <a class="code" href="structmolSys_1_1PointCloud.html">molSys::PointCloud</a>&lt;<a class="code" href="structmolSys_1_1Point.html">molSys::Point&lt;double&gt;</a>, <span class="keywordtype">double</span>&gt; *yCloud,</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;    <span class="keywordtype">bool</span> isDeformed) {</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/io/basic_ofstream.html">std::ofstream</a> outputFile;</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/string/basic_string.html">std::string</a> number = <a class="codeRef" href="http://en.cppreference.com/w/cpp/string/basic_string/to_string.html">std::to_string</a>(prismNum);</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/string/basic_string.html">std::string</a> filename = <span class="stringliteral">&quot;basalRings&quot;</span> + number + <span class="stringliteral">&quot;.dat&quot;</span>;</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;  <span class="keywordtype">int</span> ringSize =</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;      (*basal1).<a class="codeRef" href="http://en.cppreference.com/w/cpp/string/basic_string/size.html">size</a>(); <span class="comment">// Size of the ring; each ring contains n elements</span></div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;  <span class="keywordtype">int</span> nBonds;           <span class="comment">// Number of bonds between the two deformed prisms</span></div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;  <span class="keywordtype">int</span> l_k, m_k;         <span class="comment">// Atom ID in basal1 and basal2 respectively</span></div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;  <span class="keywordtype">int</span> iatom,</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;      jatom; <span class="comment">// Index not ID of basal1 and basal2 respectively which match</span></div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;  <span class="keywordtype">int</span> currentIatom, currentJatom; <span class="comment">// Index not ID for matchedBasal1 and</span></div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;                                  <span class="comment">// matchedBasal2 respectively</span></div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;  <span class="keywordtype">bool</span> isNeighbour; <span class="comment">// Basal rings should have at least one nearest neighbour</span></div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;  <span class="keywordtype">bool</span> isClock;     <span class="comment">// The order is in the original &#39;direction&#39; of basal2</span></div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;  <span class="keywordtype">bool</span> isAntiClock; <span class="comment">// The order must be reversed</span></div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a> matchedBasal1, matchedBasal2; <span class="comment">// Vectors with revised order</span></div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160; </div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;  <span class="comment">// ----------------</span></div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;  <span class="comment">// Path for deformed prisms</span></div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;  <span class="keywordflow">if</span> (isDeformed) {</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;    <span class="comment">// Create output dir if it doesn&#39;t exist already</span></div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *path = <span class="stringliteral">&quot;../output/deformed&quot;</span>; <span class="comment">// relative to the build directory</span></div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;    fs::path dir(path);</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;    <span class="comment">// if (fs::create_directory(dir)) {</span></div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;    <span class="comment">//   std::cerr &lt;&lt; &quot;Output Cage directory created\n&quot;;</span></div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;    <span class="comment">// }</span></div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;    <span class="comment">// ----------------</span></div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;    <span class="comment">// Subdirectory</span></div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160; </div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;    <span class="keyword">const</span> fs::path path1(<span class="stringliteral">&quot;../output/deformed/basalRings&quot;</span>);</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;    <span class="comment">// fs::create_directories(path1);</span></div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160; </div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;    <span class="comment">// Write output to file inside the output directory</span></div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;    <a class="codeRef" href="http://en.cppreference.com/w/cpp/string/basic_string.html">std::string</a> fileOutNameFull = <span class="stringliteral">&quot;../output/deformed/basalRings/&quot;</span> + filename;</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;    outputFile.<a class="codeRef" href="http://en.cppreference.com/w/cpp/io/basic_ofstream/open.html">open</a>(fileOutNameFull);</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;    <span class="comment">// Create output dir if it doesn&#39;t exist already</span></div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *path = <span class="stringliteral">&quot;../output/perfect&quot;</span>; <span class="comment">// relative to the build directory</span></div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;    fs::path dir(path);</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;    <span class="comment">// if (fs::create_directory(dir)) {</span></div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;    <span class="comment">//   std::cerr &lt;&lt; &quot;Output Cage directory created\n&quot;;</span></div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;    <span class="comment">// }</span></div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;    <span class="comment">// ----------------</span></div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;    <span class="comment">// Subdirectory</span></div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160; </div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;    <span class="keyword">const</span> fs::path path1(<span class="stringliteral">&quot;../output/perfect/basalRings&quot;</span>);</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;    <span class="comment">// fs::create_directories(path1);</span></div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160; </div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;    <span class="comment">// Write output to file inside the output directory</span></div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;    <a class="codeRef" href="http://en.cppreference.com/w/cpp/string/basic_string.html">std::string</a> fileOutNameFull = <span class="stringliteral">&quot;../output/perfect/basalRings/&quot;</span> + filename;</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;    outputFile.<a class="codeRef" href="http://en.cppreference.com/w/cpp/io/basic_ofstream/open.html">open</a>(fileOutNameFull);</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;  } <span class="comment">// end of creating file paths</span></div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160; </div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;  <span class="comment">// Format:</span></div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;  <span class="comment">// Coordinate IDs (starting from 1), ordered according to the input XYZ file</span></div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;  <span class="comment">// The first line is a comment line</span></div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;  outputFile &lt;&lt; <span class="stringliteral">&quot;# Particle IDs in the two basal rings\n&quot;</span>;</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160; </div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;  <span class="comment">// ---------------</span></div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;  <span class="comment">// Find the nearest neighbours of basal1 elements in basal2</span></div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160; </div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;  nBonds = 0;</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;  isNeighbour = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;  <span class="comment">// Loop through every element of basal1</span></div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> l = 0; l &lt; ringSize; l++) {</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;    l_k = (*basal1)[l]; <span class="comment">// This is the atom particle ID, not the C++ index</span></div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160; </div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;    <span class="comment">// Search for the nearest neighbour of l_k in basal2</span></div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;    <span class="comment">// Loop through basal2 elements</span></div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> m = 0; m &lt; ringSize; m++) {</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;      m_k = (*basal2)[m]; <span class="comment">// Atom ID to find in the neighbour list of iatom</span></div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160; </div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;      <span class="comment">// Find m_k inside l_k neighbour list</span></div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;      <span class="keyword">auto</span> it = <a class="codeRef" href="http://en.cppreference.com/w/cpp/algorithm/find.html">std::find</a>(nList[l_k].begin() + 1, nList[l_k].end(), m_k);</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160; </div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;      <span class="comment">// If the element has been found, for l1</span></div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;      <span class="keywordflow">if</span> (it != nList[l_k].end()) {</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;        isNeighbour = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;        iatom = l; <span class="comment">// index of basal1</span></div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;        jatom = m; <span class="comment">// index of basal2</span></div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;      } <span class="comment">// found element</span></div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160; </div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;    } <span class="comment">// end of loop through all atomIDs in basal2</span></div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160; </div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;    <span class="keywordflow">if</span> (isNeighbour) {</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;    } <span class="comment">// nearest neighbour found</span></div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;  }   <span class="comment">// end of loop through all the atomIDs in basal1</span></div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160; </div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;  <span class="keywordflow">if</span> (!isNeighbour) {</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;    <a class="codeRef" href="http://en.cppreference.com/w/cpp/io/basic_ostream.html">std::cerr</a> &lt;&lt; <span class="stringliteral">&quot;Something is wrong with your deformed prism.\n&quot;</span>;</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;    <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;  }</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;  <span class="comment">// ---------------------------------------------------</span></div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;  <span class="comment">// Find out if the order of basal2 is &#39;clockwise&#39; or &#39;anticlockwise&#39;</span></div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;  isClock = <span class="keyword">false</span>; <span class="comment">// init</span></div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;  isAntiClock = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160; </div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;  <span class="comment">// atom index (not ID)</span></div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;  <span class="keywordtype">int</span> tempJfor, tempJback;</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160; </div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;  tempJfor = jatom + 1;</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;  tempJback = jatom - 1;</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160; </div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;  <span class="keywordflow">if</span> (jatom == ringSize - 1) {</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;    tempJfor = 0;</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;    tempJback = ringSize - 2;</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;  }</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;  <span class="keywordflow">if</span> (jatom == 0) {</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;    tempJfor = 1;</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;    tempJback = ringSize - 1;</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;  }</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160; </div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;  <span class="keywordtype">int</span> forwardJ = (*basal2)[tempJfor];</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;  <span class="keywordtype">int</span> backwardJ = (*basal2)[tempJback];</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;  <span class="keywordtype">int</span> currentI = (*basal1)[iatom];</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160; </div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;  <span class="comment">// Check clockwise</span></div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;  <span class="keywordtype">double</span> distClock = <a class="code" href="group__gen.html#ga881e045598dd517609383d8a3fec5913">gen::periodicDist</a>(yCloud, currentI, forwardJ);</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;  <span class="keywordtype">double</span> distAntiClock = <a class="code" href="group__gen.html#ga881e045598dd517609383d8a3fec5913">gen::periodicDist</a>(yCloud, currentI, backwardJ);</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160; </div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;  <span class="comment">// Clockwise</span></div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;  <span class="keywordflow">if</span> (distClock &lt; distAntiClock) {</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;    isClock = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;  } <span class="comment">// end of clockwise check</span></div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;  <span class="comment">// Anti-clockwise</span></div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;  <span class="keywordflow">if</span> (distAntiClock &lt; distClock) {</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;    isAntiClock = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;  } <span class="comment">// end of anti-clockwise check</span></div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;  <span class="comment">// Some error</span></div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;  <span class="keywordflow">if</span> (isClock == <span class="keyword">false</span> &amp;&amp; isAntiClock == <span class="keyword">false</span>) {</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;    <span class="comment">// std::cerr &lt;&lt; &quot;The points are equidistant.\n&quot;;</span></div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;    <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;  } <span class="comment">// end of error handling</span></div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;  <span class="comment">// ---------------------------------------------------</span></div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;  <span class="comment">// Get the order of basal1 and basal2</span></div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; ringSize; i++) {</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;    currentIatom = iatom + i;</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;    <span class="keywordflow">if</span> (currentIatom &gt;= ringSize) {</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;      currentIatom -= ringSize;</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;    } <span class="comment">// end of basal1 element wrap-around</span></div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160; </div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;    <span class="comment">// In clockwise order</span></div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;    <span class="keywordflow">if</span> (isClock) {</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;      currentJatom = jatom + i;</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;      <span class="keywordflow">if</span> (currentJatom &gt;= ringSize) {</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;        currentJatom -= ringSize;</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;      } <span class="comment">// wrap around</span></div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;    }   <span class="comment">// end of clockwise update</span></div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;      currentJatom = jatom - i;</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;      <span class="keywordflow">if</span> (currentJatom &lt; 0) {</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;        currentJatom += ringSize;</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;      } <span class="comment">// wrap around</span></div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;    }   <span class="comment">// end of anti-clockwise update</span></div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160; </div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;    <span class="comment">// Add to matchedBasal1 and matchedBasal2 now</span></div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;    matchedBasal1.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/push_back.html">push_back</a>((*basal1)[currentIatom]);</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;    matchedBasal2.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/push_back.html">push_back</a>((*basal2)[currentJatom]);</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;  }</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;  <span class="comment">// ---------------------------------------------------</span></div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;  <span class="comment">// Print out the ordered rings</span></div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;  <span class="comment">// For hexagonal cages:</span></div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;  <span class="comment">// Only print out basal1 and basal2</span></div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160; </div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;  <span class="comment">// BASAL1</span></div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; matchedBasal1.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/size.html">size</a>(); i++) {</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;    outputFile &lt;&lt; matchedBasal1[i] &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;  } <span class="comment">// end of loop through basal1</span></div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;  outputFile &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160; </div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;  <span class="comment">// BASAL2</span></div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; matchedBasal2.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/size.html">size</a>(); i++) {</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;    outputFile &lt;&lt; matchedBasal2[i] &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;  } <span class="comment">// end of loop through basal2</span></div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160; </div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;  <span class="comment">// Close the output file</span></div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;  outputFile.<a class="codeRef" href="http://en.cppreference.com/w/cpp/io/basic_ofstream/close.html">close</a>();</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160; </div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;  <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;}</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160; </div>
<div class="line"><a name="l00840"></a><span class="lineno"><a class="line" href="namespacesout.html#aee17b8438205b4b88aad8a481c533ba5">  840</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="namespacesout.html#aee17b8438205b4b88aad8a481c533ba5">sout::writeClusterStats</a>(<a class="codeRef" href="http://en.cppreference.com/w/cpp/string/basic_string.html">std::string</a> path, <span class="keywordtype">int</span> currentFrame,</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;                            <span class="keywordtype">int</span> largestCluster, <span class="keywordtype">int</span> numOfClusters,</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;                            <span class="keywordtype">int</span> smallestCluster, <span class="keywordtype">double</span> avgClusterSize,</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;                            <span class="keywordtype">int</span> firstFrame) {</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/io/basic_ofstream.html">std::ofstream</a> outputFile;</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;  <span class="comment">// ----------------</span></div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;  <span class="comment">// Make the output directory if it doesn&#39;t exist</span></div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;  <a class="code" href="namespacesout.html#a3985775f30d7920fbf13f12386abefc1">sout::makePath</a>(path);</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;  <span class="comment">// ----------------</span></div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;  <span class="comment">// Write output to file inside the output directory</span></div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;  outputFile.<a class="codeRef" href="http://en.cppreference.com/w/cpp/io/basic_ofstream/open.html">open</a>(path + <span class="stringliteral">&quot;clusterStats.dat&quot;</span>,</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;                  std::ios_base::app | std::ios_base::out);</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160; </div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;  <span class="comment">// Format:</span></div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;  <span class="comment">// Comment line</span></div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;  <span class="comment">// 1 3 0 0 4 35 40 ....</span></div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160; </div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;  <span class="comment">// ----------------</span></div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;  <span class="comment">// Comment line for the first frame</span></div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;  <span class="keywordflow">if</span> (currentFrame == firstFrame) {</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;    outputFile &lt;&lt; <span class="stringliteral">&quot;Frame largestCluster numOfClusters smallestCluster &quot;</span></div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;                  <span class="stringliteral">&quot;avgClusterSize\n&quot;</span>;</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;  }</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;  <span class="comment">// ----------------</span></div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160; </div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;  outputFile &lt;&lt; currentFrame &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; largestCluster &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; numOfClusters</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;             &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; smallestCluster &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; avgClusterSize &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160; </div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;  outputFile.<a class="codeRef" href="http://en.cppreference.com/w/cpp/io/basic_ofstream/close.html">close</a>();</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160; </div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;  <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;}</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160; </div>
<div class="line"><a name="l00877"></a><span class="lineno"><a class="line" href="namespacesout.html#a1cfbcd0f8d90f3033ee5e505c07e0400">  877</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="namespacesout.html#a1cfbcd0f8d90f3033ee5e505c07e0400">sout::writeMoleculeIDsInSlice</a>(<a class="codeRef" href="http://en.cppreference.com/w/cpp/string/basic_string.html">std::string</a> path,</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;                            <a class="code" href="structmolSys_1_1PointCloud.html">molSys::PointCloud</a>&lt;<a class="code" href="structmolSys_1_1Point.html">molSys::Point&lt;double&gt;</a>, <span class="keywordtype">double</span>&gt; *yCloud) {</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/io/basic_ofstream.html">std::ofstream</a> outputFile;</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/string/basic_string.html">std::string</a> filename =</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;      <span class="stringliteral">&quot;molID-&quot;</span> + <a class="codeRef" href="http://en.cppreference.com/w/cpp/string/basic_string/to_string.html">std::to_string</a>(yCloud-&gt;currentFrame) + <span class="stringliteral">&quot;.dat&quot;</span>;</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a> idVec; <span class="comment">// Vector which will contain all molecule IDs present in the slice</span></div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;  <span class="comment">// Eventually we will sort this and only keep unique molecule IDs. </span></div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;  <span class="keywordtype">int</span> prevElem, currentElem; <span class="comment">// previous and current mol ID in the sequence</span></div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;  <span class="keywordtype">int</span> lastPrintedElemSeries; <span class="comment">// Last element printed </span></div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;  <span class="comment">// ----------------</span></div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;  <span class="comment">// Make the output directory if it doesn&#39;t exist</span></div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;  <a class="code" href="namespacesout.html#a3985775f30d7920fbf13f12386abefc1">sout::makePath</a>(path);</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;  <a class="code" href="namespacesout.html#a3985775f30d7920fbf13f12386abefc1">sout::makePath</a>(path+<span class="stringliteral">&quot;selection&quot;</span>);</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;  <a class="code" href="namespacesout.html#a3985775f30d7920fbf13f12386abefc1">sout::makePath</a>(path+<span class="stringliteral">&quot;selection/IDtextFiles&quot;</span>);</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;  <span class="comment">// ----------------</span></div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;  <span class="comment">// Write output to file inside the output directory</span></div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;  outputFile.<a class="codeRef" href="http://en.cppreference.com/w/cpp/io/basic_ofstream/open.html">open</a>(path + <span class="stringliteral">&quot;selection/IDtextFiles/&quot;</span> + filename);</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160; </div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;  <span class="comment">// ----------------</span></div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;  <span class="comment">// Find all molecule IDs from yCloud </span></div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;  <span class="comment">// Loop through all iatom in yCloud</span></div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iatom = 0; iatom &lt; yCloud-&gt;nop; iatom++)</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;  {</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;    <span class="comment">// If iatom is in the slice, add the molecule ID to idVec</span></div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;    <span class="keywordflow">if</span> (yCloud-&gt;pts[iatom].inSlice)</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;    {</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;      idVec.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/push_back.html">push_back</a>(yCloud-&gt;pts[iatom].molID);</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;    } <span class="comment">// end of adding molecule ID to vector for slice </span></div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;  } <span class="comment">// end of loop through iatom</span></div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;  <span class="comment">// ----------------</span></div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;  <span class="comment">// Sort in ascending order</span></div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/algorithm/sort.html">std::sort</a>(idVec.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/begin.html">begin</a>(), idVec.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/end.html">end</a>());</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;  <span class="keyword">auto</span> it = <a class="codeRef" href="http://en.cppreference.com/w/cpp/algorithm/unique.html">std::unique</a>(idVec.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/begin.html">begin</a>(), idVec.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/end.html">end</a>());</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;  <span class="comment">// Get rid of undefined elements</span></div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;  idVec.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/resize.html">resize</a>(<a class="codeRef" href="http://en.cppreference.com/w/cpp/iterator/distance.html">std::distance</a>(idVec.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/begin.html">begin</a>(), it));</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;  <span class="comment">// ----------------</span></div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160; </div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;  <span class="comment">// Format:</span></div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;  <span class="comment">// Comment line</span></div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;  <span class="comment">// 1 2 3 4 6 7</span></div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160; </div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;  <span class="comment">// ----------------</span></div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;  <span class="comment">// Comment line </span></div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;  outputFile &lt;&lt; <span class="stringliteral">&quot;# Molecule IDs in slice\n&quot;</span>;</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;  outputFile &lt;&lt; <span class="stringliteral">&quot;# LAMMPS command : group groupName molecule 100:10000 \n&quot;</span>;</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;  <span class="comment">// Format</span></div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;  <span class="comment">// In LAMMPS, groups can be assigned by ID using the following command </span></div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;  <span class="comment">// group groupName molecule 100:10000 </span></div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;  <span class="comment">// ----------------</span></div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;  <span class="comment">// First element </span></div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;  outputFile &lt;&lt; idVec[0];</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;  prevElem = idVec[0];</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;  lastPrintedElemSeries = idVec[0];</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;  <span class="comment">// ----------------</span></div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160; </div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;  <span class="comment">// Print other molecule IDs to the file</span></div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=1; i&lt;idVec.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/size.html">size</a>(); i++)</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;  {</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;    currentElem = idVec[i]; <span class="comment">// current mol ID</span></div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;    <span class="comment">// prevElem is the previous mol ID</span></div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;    <span class="comment">// if the currentElem-prevElem&gt;1</span></div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;    <span class="keywordflow">if</span> (currentElem-prevElem&gt;1 || i==idVec.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/size.html">size</a>()-1)</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;    {</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;      <span class="keywordflow">if</span> (lastPrintedElemSeries!=prevElem)</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;      {</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;        outputFile &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; prevElem &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; currentElem;</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;        lastPrintedElemSeries = currentElem;</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;      } <span class="comment">// the previous element has not been printed</span></div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;      <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;        outputFile &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; currentElem;</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;        lastPrintedElemSeries = currentElem;</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;      } <span class="comment">// the previous element has already been printed </span></div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;      <span class="comment">//</span></div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;    } <span class="comment">// print currentElem</span></div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;    prevElem = currentElem;</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;  } <span class="comment">// end of printing all elements to file </span></div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160; </div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;  outputFile.<a class="codeRef" href="http://en.cppreference.com/w/cpp/io/basic_ofstream/close.html">close</a>();</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160; </div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;  <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;}</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160; </div>
<div class="line"><a name="l00964"></a><span class="lineno"><a class="line" href="namespacesout.html#a96aa8c9d78c09d7cd77c4d46182e7b3b">  964</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="namespacesout.html#a96aa8c9d78c09d7cd77c4d46182e7b3b">sout::writeMoleculeIDsExpressionSelectOVITO</a>(<a class="codeRef" href="http://en.cppreference.com/w/cpp/string/basic_string.html">std::string</a> path,</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;                            <a class="code" href="structmolSys_1_1PointCloud.html">molSys::PointCloud</a>&lt;<a class="code" href="structmolSys_1_1Point.html">molSys::Point&lt;double&gt;</a>, <span class="keywordtype">double</span>&gt; *yCloud) {</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/io/basic_ofstream.html">std::ofstream</a> outputFile;</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/string/basic_string.html">std::string</a> filename =</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;      <span class="stringliteral">&quot;ovito-molIDSelect-&quot;</span> + <a class="codeRef" href="http://en.cppreference.com/w/cpp/string/basic_string/to_string.html">std::to_string</a>(yCloud-&gt;currentFrame) + <span class="stringliteral">&quot;.dat&quot;</span>;</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a> idVec; <span class="comment">// Vector which will contain all molecule IDs present in the slice</span></div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;  <span class="comment">// Eventually we will sort this and only keep unique molecule IDs. </span></div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;  <span class="keywordtype">int</span> prevElem, currentElem; <span class="comment">// previous and current mol ID in the sequence</span></div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;  <span class="keywordtype">int</span> lastPrintedElemSeries; <span class="comment">// Last element printed </span></div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;  <span class="comment">// ----------------</span></div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;  <span class="comment">// Make the output directory if it doesn&#39;t exist</span></div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;  <a class="code" href="namespacesout.html#a3985775f30d7920fbf13f12386abefc1">sout::makePath</a>(path);</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;  <a class="code" href="namespacesout.html#a3985775f30d7920fbf13f12386abefc1">sout::makePath</a>(path+<span class="stringliteral">&quot;selection&quot;</span>);</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;  <a class="code" href="namespacesout.html#a3985775f30d7920fbf13f12386abefc1">sout::makePath</a>(path+<span class="stringliteral">&quot;selection/IDovitoFiles&quot;</span>);</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;  <span class="comment">// ----------------</span></div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;  <span class="comment">// Write output to file inside the output directory</span></div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;  outputFile.<a class="codeRef" href="http://en.cppreference.com/w/cpp/io/basic_ofstream/open.html">open</a>(path + <span class="stringliteral">&quot;selection/IDovitoFiles/&quot;</span> + filename);</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160; </div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;  <span class="comment">// ----------------</span></div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;  <span class="comment">// Find all molecule IDs from yCloud </span></div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;  <span class="comment">// Loop through all iatom in yCloud</span></div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iatom = 0; iatom &lt; yCloud-&gt;nop; iatom++)</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;  {</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;    <span class="comment">// If iatom is in the slice, add the molecule ID to idVec</span></div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;    <span class="keywordflow">if</span> (yCloud-&gt;pts[iatom].inSlice)</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;    {</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;      idVec.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/push_back.html">push_back</a>(yCloud-&gt;pts[iatom].molID);</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;    } <span class="comment">// end of adding molecule ID to vector for slice </span></div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;  } <span class="comment">// end of loop through iatom</span></div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;  <span class="comment">// ----------------</span></div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;  <span class="comment">// Sort in ascending order</span></div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/algorithm/sort.html">std::sort</a>(idVec.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/begin.html">begin</a>(), idVec.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/end.html">end</a>());</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;  <span class="keyword">auto</span> it = <a class="codeRef" href="http://en.cppreference.com/w/cpp/algorithm/unique.html">std::unique</a>(idVec.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/begin.html">begin</a>(), idVec.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/end.html">end</a>());</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;  <span class="comment">// Get rid of undefined elements</span></div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;  idVec.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/resize.html">resize</a>(<a class="codeRef" href="http://en.cppreference.com/w/cpp/iterator/distance.html">std::distance</a>(idVec.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/begin.html">begin</a>(), it));</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;  <span class="comment">// ----------------</span></div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160; </div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;  <span class="comment">// Format:</span></div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;  <span class="comment">// Comment line</span></div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;  <span class="comment">// 1 2 3 4 6 7</span></div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160; </div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;  <span class="comment">// ----------------</span></div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;  <span class="comment">// Comment line </span></div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;  outputFile &lt;&lt; <span class="stringliteral">&quot;# Molecule IDs in slice\n&quot;</span>;</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;  outputFile &lt;&lt; <span class="stringliteral">&quot;# OVITO Expression select command \n&quot;</span>;</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;  <span class="comment">// ----------------</span></div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160; </div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;  <span class="comment">// Print other molecule IDs to the file</span></div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;idVec.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/size.html">size</a>()-1; i++)</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;  {</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;    currentElem = idVec[i]; <span class="comment">// current mol ID</span></div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160; </div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;    outputFile &lt;&lt; <span class="stringliteral">&quot;MoleculeIdentifier == &quot;</span> &lt;&lt; currentElem &lt;&lt; <span class="stringliteral">&quot; || &quot;</span>;</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160; </div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;  } <span class="comment">// end of printing all elements to file except the last one </span></div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160; </div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;  <span class="comment">// Print the last element</span></div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;  outputFile &lt;&lt; <span class="stringliteral">&quot;MoleculeIdentifier == &quot;</span> &lt;&lt; idVec.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/back.html">back</a>();</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160; </div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;  outputFile.<a class="codeRef" href="http://en.cppreference.com/w/cpp/io/basic_ofstream/close.html">close</a>();</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160; </div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;  <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;}</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160; </div>
<div class="line"><a name="l01031"></a><span class="lineno"><a class="line" href="namespacesout.html#a27b0ed070347ff0351e2d0882d1d6ddd"> 1031</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="namespacesout.html#a27b0ed070347ff0351e2d0882d1d6ddd">sout::writePrismNum</a>(<a class="codeRef" href="http://en.cppreference.com/w/cpp/string/basic_string.html">std::string</a> path, <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a> nPrisms,</div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;                        <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a> nDefPrisms,</div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;                        <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;double&gt;</a> heightPercent, <span class="keywordtype">int</span> maxDepth,</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;                        <span class="keywordtype">int</span> currentFrame, <span class="keywordtype">int</span> firstFrame) {</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/io/basic_ofstream.html">std::ofstream</a> outputFile;</div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;  <span class="keywordtype">int</span> totalPrisms; <span class="comment">// Number of total prisms</span></div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;  <span class="comment">// ----------------</span></div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;  <span class="comment">// Make the output directory if it doesn&#39;t exist</span></div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;  <a class="code" href="namespacesout.html#a3985775f30d7920fbf13f12386abefc1">sout::makePath</a>(path);</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/string/basic_string.html">std::string</a> outputDirName = path + <span class="stringliteral">&quot;topoINT&quot;</span>;</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;  <a class="code" href="namespacesout.html#a3985775f30d7920fbf13f12386abefc1">sout::makePath</a>(outputDirName);</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;  <span class="comment">// ----------------</span></div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;  <span class="comment">// Write output to file inside the output directory</span></div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;  outputFile.<a class="codeRef" href="http://en.cppreference.com/w/cpp/io/basic_ofstream/open.html">open</a>(path + <span class="stringliteral">&quot;topoINT/nPrisms.dat&quot;</span>,</div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;                  std::ios_base::app | std::ios_base::out);</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160; </div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;  <span class="comment">// ----------------</span></div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;  <span class="comment">// Write the comment line if the first frame is being written out</span></div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;  <span class="keywordflow">if</span> (currentFrame == firstFrame) {</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;    outputFile &lt;&lt; <span class="stringliteral">&quot;Frame RingSize Num_of_prisms Height% RingSize ... Height\n&quot;</span>;</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;  }</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;  <span class="comment">// ----------------</span></div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;  <span class="comment">// Format:</span></div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;  <span class="comment">// Frame RingSize Num_of_prisms Height% RingSize ... Height%</span></div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;  <span class="comment">// 1 3 0 0 4 35 40 ....</span></div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160; </div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;  outputFile &lt;&lt; currentFrame &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160; </div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ringSize = 3; ringSize &lt;= maxDepth; ringSize++) {</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;    totalPrisms = nPrisms[ringSize - 3] + nDefPrisms[ringSize - 3];</div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;    <span class="comment">// Write out</span></div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;    outputFile &lt;&lt; ringSize &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; totalPrisms &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;               &lt;&lt; nDefPrisms[ringSize - 3] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; heightPercent[ringSize - 3]</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;               &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;  }</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160; </div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;  outputFile &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160; </div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;  outputFile.<a class="codeRef" href="http://en.cppreference.com/w/cpp/io/basic_ofstream/close.html">close</a>();</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160; </div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;  <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;}</div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160; </div>
<div class="line"><a name="l01077"></a><span class="lineno"><a class="line" href="namespacesout.html#a3775e3decf75faac38693c4b13143938"> 1077</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="namespacesout.html#a3775e3decf75faac38693c4b13143938">sout::writeRingNum</a>(<a class="codeRef" href="http://en.cppreference.com/w/cpp/string/basic_string.html">std::string</a> path, <span class="keywordtype">int</span> currentFrame,</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;                       <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a> nRings,</div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;                       <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;double&gt;</a> coverageAreaXY,</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;                       <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;double&gt;</a> coverageAreaXZ,</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;                       <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;double&gt;</a> coverageAreaYZ, <span class="keywordtype">int</span> maxDepth,</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;                       <span class="keywordtype">int</span> firstFrame) {</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/io/basic_ofstream.html">std::ofstream</a> outputFileXY;</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/io/basic_ofstream.html">std::ofstream</a> outputFileXZ;</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/io/basic_ofstream.html">std::ofstream</a> outputFileYZ;</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;  <span class="comment">// ----------------</span></div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;  <span class="comment">// Make the output directory if it doesn&#39;t exist</span></div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;  <a class="code" href="namespacesout.html#a3985775f30d7920fbf13f12386abefc1">sout::makePath</a>(path);</div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/string/basic_string.html">std::string</a> outputDirName = path + <span class="stringliteral">&quot;topoMonolayer&quot;</span>;</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;  <a class="code" href="namespacesout.html#a3985775f30d7920fbf13f12386abefc1">sout::makePath</a>(outputDirName);</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;  <span class="comment">// ----------------</span></div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;  <span class="comment">// Coverage Area of XY</span></div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;  <span class="comment">// Write output to file inside the output directory</span></div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;  outputFileXY.<a class="codeRef" href="http://en.cppreference.com/w/cpp/io/basic_ofstream/open.html">open</a>(path + <span class="stringliteral">&quot;topoMonolayer/coverageAreaXY.dat&quot;</span>,</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;                    std::ios_base::app | std::ios_base::out);</div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160; </div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;  <span class="comment">// Format:</span></div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;  <span class="comment">// Comment line</span></div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;  <span class="comment">// 1 3 0 0 4 35 40 ....</span></div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160; </div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;  <span class="comment">// ----------------</span></div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;  <span class="comment">// Add comment for the first frame</span></div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;  <span class="keywordflow">if</span> (currentFrame == firstFrame) {</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;    outputFileXY &lt;&lt; <span class="stringliteral">&quot;Frame RingSize Num_of_rings CoverageAreaXY% RingSize ... &quot;</span></div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;                    <span class="stringliteral">&quot;CoverageAreaXY%\n&quot;</span>;</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;  }</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;  <span class="comment">// ----------------</span></div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160; </div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;  outputFileXY &lt;&lt; currentFrame &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160; </div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ringSize = 3; ringSize &lt;= maxDepth; ringSize++) {</div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;    outputFileXY &lt;&lt; ringSize &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; nRings[ringSize - 3] &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;                 &lt;&lt; coverageAreaXY[ringSize - 3] &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;  }</div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160; </div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;  outputFileXY &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160; </div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;  outputFileXY.<a class="codeRef" href="http://en.cppreference.com/w/cpp/io/basic_ofstream/close.html">close</a>();</div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;  <span class="comment">// ----------------</span></div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;  <span class="comment">// Coverage Area of XZ</span></div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;  <span class="comment">// Write output to file inside the output directory</span></div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;  outputFileXZ.<a class="codeRef" href="http://en.cppreference.com/w/cpp/io/basic_ofstream/open.html">open</a>(path + <span class="stringliteral">&quot;topoMonolayer/coverageAreaXZ.dat&quot;</span>,</div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;                    std::ios_base::app | std::ios_base::out);</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160; </div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;  <span class="comment">// ----------------</span></div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;  <span class="comment">// Add comment for the first frame</span></div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;  <span class="keywordflow">if</span> (currentFrame == firstFrame) {</div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;    outputFileXZ &lt;&lt; <span class="stringliteral">&quot;Frame RingSize Num_of_rings CoverageAreaXZ% RingSize ... &quot;</span></div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;                    <span class="stringliteral">&quot;CoverageAreaXZ%\n&quot;</span>;</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;  }</div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;  <span class="comment">// ----------------</span></div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160; </div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;  <span class="comment">// Format:</span></div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;  <span class="comment">// Frame RingSize Num_of_prisms Height% RingSize ... Height%</span></div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;  <span class="comment">// 1 3 0 0 4 35 40 ....</span></div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160; </div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;  outputFileXZ &lt;&lt; currentFrame &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160; </div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ringSize = 3; ringSize &lt;= maxDepth; ringSize++) {</div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;    outputFileXZ &lt;&lt; ringSize &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; nRings[ringSize - 3] &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;                 &lt;&lt; coverageAreaXZ[ringSize - 3] &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;  }</div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160; </div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;  outputFileXZ &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160; </div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;  outputFileXZ.<a class="codeRef" href="http://en.cppreference.com/w/cpp/io/basic_ofstream/close.html">close</a>();</div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;  <span class="comment">// ----------------</span></div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;  <span class="comment">// Coverage Area of YZ</span></div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;  <span class="comment">// Write output to file inside the output directory</span></div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;  outputFileYZ.<a class="codeRef" href="http://en.cppreference.com/w/cpp/io/basic_ofstream/open.html">open</a>(path + <span class="stringliteral">&quot;topoMonolayer/coverageAreaYZ.dat&quot;</span>,</div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;                    std::ios_base::app | std::ios_base::out);</div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160; </div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;  <span class="comment">// ----------------</span></div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;  <span class="comment">// Add comment for the first frame</span></div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;  <span class="keywordflow">if</span> (currentFrame == firstFrame) {</div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;    outputFileYZ &lt;&lt; <span class="stringliteral">&quot;Frame RingSize Num_of_rings CoverageAreaYZ% RingSize ... &quot;</span></div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;                    <span class="stringliteral">&quot;CoverageAreaYZ%\n&quot;</span>;</div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;  }</div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;  <span class="comment">// ----------------</span></div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160; </div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;  <span class="comment">// Format:</span></div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;  <span class="comment">// Frame RingSize Num_of_prisms Height% RingSize ... Height%</span></div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;  <span class="comment">// 1 3 0 0 4 35 40 ....</span></div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160; </div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;  outputFileYZ &lt;&lt; currentFrame &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160; </div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ringSize = 3; ringSize &lt;= maxDepth; ringSize++) {</div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;    outputFileYZ &lt;&lt; ringSize &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; nRings[ringSize - 3] &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;                 &lt;&lt; coverageAreaYZ[ringSize - 3] &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;  }</div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160; </div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;  outputFileYZ &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160; </div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;  outputFileYZ.<a class="codeRef" href="http://en.cppreference.com/w/cpp/io/basic_ofstream/close.html">close</a>();</div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160; </div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;  <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;}</div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160; </div>
<div class="line"><a name="l01182"></a><span class="lineno"><a class="line" href="namespacesout.html#a2aa4853345a006e923069cbf9602417f"> 1182</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="namespacesout.html#a2aa4853345a006e923069cbf9602417f">sout::writeRingNumBulk</a>(<a class="codeRef" href="http://en.cppreference.com/w/cpp/string/basic_string.html">std::string</a> path, <span class="keywordtype">int</span> currentFrame,</div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;                       <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a> nRings,</div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;                       <span class="keywordtype">int</span> maxDepth,</div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;                       <span class="keywordtype">int</span> firstFrame) {</div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/io/basic_ofstream.html">std::ofstream</a> outputFile;</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;  <span class="comment">// ----------------</span></div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;  <span class="comment">// Make the output directory if it doesn&#39;t exist</span></div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;  <a class="code" href="namespacesout.html#a3985775f30d7920fbf13f12386abefc1">sout::makePath</a>(path);</div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/string/basic_string.html">std::string</a> outputDirName = path + <span class="stringliteral">&quot;bulkTopo&quot;</span>;</div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;  <a class="code" href="namespacesout.html#a3985775f30d7920fbf13f12386abefc1">sout::makePath</a>(outputDirName);</div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;  <span class="comment">// ----------------</span></div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;  <span class="comment">// Ring output file</span></div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;  <span class="comment">// Write output to file inside the output directory</span></div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;  outputFile.<a class="codeRef" href="http://en.cppreference.com/w/cpp/io/basic_ofstream/open.html">open</a>(path + <span class="stringliteral">&quot;bulkTopo/num_rings.dat&quot;</span>,</div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;                    std::ios_base::app | std::ios_base::out);</div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160; </div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;  <span class="comment">// Format:</span></div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;  <span class="comment">// Comment line</span></div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;  <span class="comment">// 1 3 0 4 35 ....</span></div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160; </div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;  <span class="comment">// ----------------</span></div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;  <span class="comment">// Add comment for the first frame</span></div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;  <span class="keywordflow">if</span> (currentFrame == firstFrame) {</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;    outputFile &lt;&lt; <span class="stringliteral">&quot;Frame RingSize Num_of_rings RingSize Num_of_rings...\n&quot;</span>;</div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;  }</div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;  <span class="comment">// ----------------</span></div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160; </div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;  outputFile &lt;&lt; currentFrame &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160; </div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ringSize = 3; ringSize &lt;= maxDepth; ringSize++) {</div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;    outputFile &lt;&lt; ringSize &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; nRings[ringSize - 3] &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;  }</div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160; </div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;  outputFile &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160; </div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;  outputFile.<a class="codeRef" href="http://en.cppreference.com/w/cpp/io/basic_ofstream/close.html">close</a>();</div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160; </div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;  <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;}</div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160; </div>
<div class="line"><a name="l01226"></a><span class="lineno"><a class="line" href="namespacesout.html#a8a9d39fa590c92dbb4556edb767e1d8f"> 1226</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="namespacesout.html#a8a9d39fa590c92dbb4556edb767e1d8f">sout::printRDF</a>(<a class="codeRef" href="http://en.cppreference.com/w/cpp/string/basic_string.html">std::string</a> fileName, <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;double&gt;</a> *rdfValues,</div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;                   <span class="keywordtype">double</span> binwidth, <span class="keywordtype">int</span> nbin) {</div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/io/basic_ofstream.html">std::ofstream</a> outputFile; <span class="comment">// For the output file</span></div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;  <span class="keywordtype">double</span> r;                 <span class="comment">// Distance for the current bin</span></div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160; </div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;  <span class="comment">// Append to the file</span></div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;  outputFile.<a class="codeRef" href="http://en.cppreference.com/w/cpp/io/basic_ofstream/open.html">open</a>(fileName, std::ios_base::app | std::ios_base::out);</div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160; </div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;  <span class="comment">// Loop through all the bins</span></div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ibin = 0; ibin &lt; nbin; ibin++) {</div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;    r = binwidth * (ibin + 0.5); <span class="comment">// Current distance for ibin</span></div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;    outputFile &lt;&lt; r &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; (*rdfValues)[ibin] &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;  } <span class="comment">// end of loop through all bins</span></div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160; </div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;  outputFile.<a class="codeRef" href="http://en.cppreference.com/w/cpp/io/basic_ofstream/close.html">close</a>();</div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160; </div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;  <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;}</div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160; </div>
<div class="line"><a name="l01251"></a><span class="lineno"><a class="line" href="namespacesout.html#a5ca5eeff9edc702cdcf1b26e8501dc0c"> 1251</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="namespacesout.html#a5ca5eeff9edc702cdcf1b26e8501dc0c">sout::writeTopoBulkData</a>(<a class="codeRef" href="http://en.cppreference.com/w/cpp/string/basic_string.html">std::string</a> path, <span class="keywordtype">int</span> currentFrame, <span class="keywordtype">int</span> numHC,</div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;                            <span class="keywordtype">int</span> numDDC, <span class="keywordtype">int</span> mixedRings, <span class="keywordtype">int</span> basalRings,</div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;                            <span class="keywordtype">int</span> prismaticRings, <span class="keywordtype">int</span> firstFrame) {</div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/io/basic_ofstream.html">std::ofstream</a> outputFile;</div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;  <span class="comment">// ----------------</span></div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;  <span class="comment">// Make the output directory if it doesn&#39;t exist</span></div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;  <a class="code" href="namespacesout.html#a3985775f30d7920fbf13f12386abefc1">sout::makePath</a>(path);</div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/string/basic_string.html">std::string</a> outputDirName = path + <span class="stringliteral">&quot;bulkTopo&quot;</span>;</div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;  <a class="code" href="namespacesout.html#a3985775f30d7920fbf13f12386abefc1">sout::makePath</a>(outputDirName);</div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;  <span class="comment">// ----------------</span></div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;  <span class="comment">// Write output to file inside the output directory</span></div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;  outputFile.<a class="codeRef" href="http://en.cppreference.com/w/cpp/io/basic_ofstream/open.html">open</a>(path + <span class="stringliteral">&quot;bulkTopo/cageData.dat&quot;</span>,</div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;                  std::ios_base::app | std::ios_base::out);</div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160; </div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;  <span class="comment">// Format:</span></div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;  <span class="comment">// Frame RingSize Num_of_prisms Height% RingSize ... Height%</span></div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;  <span class="comment">// 1 3 0 0 4 35 40 ....</span></div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;  <span class="comment">// -------------------</span></div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;  <span class="comment">// If first frame then write the comment line</span></div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;  <span class="keywordflow">if</span> (currentFrame == firstFrame) {</div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;    outputFile &lt;&lt; <span class="stringliteral">&quot;Frame HCnumber DDCnumber MixedRingNumber PrismaticRings &quot;</span></div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;                  <span class="stringliteral">&quot;basalRings\n&quot;</span>;</div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;  }</div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;  <span class="comment">// -------------------</span></div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;  outputFile &lt;&lt; currentFrame &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; numHC &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; numDDC &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;             &lt;&lt; mixedRings &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; prismaticRings &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; basalRings</div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;             &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160; </div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;  outputFile.<a class="codeRef" href="http://en.cppreference.com/w/cpp/io/basic_ofstream/close.html">close</a>();</div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;  <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;} <span class="comment">// end of function</span></div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160; </div>
<div class="line"><a name="l01288"></a><span class="lineno"><a class="line" href="namespacesout.html#ad297dfa82170796cedea7f111e7694df"> 1288</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="namespacesout.html#ad297dfa82170796cedea7f111e7694df">sout::writeLAMMPSdumpCages</a>(</div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;    <a class="code" href="structmolSys_1_1PointCloud.html">molSys::PointCloud</a>&lt;<a class="code" href="structmolSys_1_1Point.html">molSys::Point&lt;double&gt;</a>, <span class="keywordtype">double</span>&gt; *yCloud,</div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;    <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;double&gt;</a> rmsdPerAtom, <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a> atomTypes,</div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;    <a class="codeRef" href="http://en.cppreference.com/w/cpp/string/basic_string.html">std::string</a> path, <span class="keywordtype">int</span> firstFrame) {</div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/io/basic_ofstream.html">std::ofstream</a> outputFile;</div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;  <span class="keywordtype">int</span> iatom; <span class="comment">// Index, not atom ID</span></div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/string/basic_string.html">std::string</a> filename =</div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;      <span class="stringliteral">&quot;dump-&quot;</span> + <a class="codeRef" href="http://en.cppreference.com/w/cpp/string/basic_string/to_string.html">std::to_string</a>(yCloud-&gt;currentFrame) + <span class="stringliteral">&quot;.lammpstrj&quot;</span>;</div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;  <span class="comment">// ----------------</span></div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;  <span class="comment">// Make the output directory if it doesn&#39;t exist</span></div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/string/basic_string.html">std::string</a> outputDirName = path + <span class="stringliteral">&quot;bulkTopo/dumpFiles&quot;</span>;</div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;  <a class="code" href="namespacesout.html#a3985775f30d7920fbf13f12386abefc1">sout::makePath</a>(outputDirName);</div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;  <span class="comment">// ----------------</span></div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;  <span class="comment">// Write out information about the data types</span></div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;  <span class="keywordflow">if</span> (yCloud-&gt;currentFrame == firstFrame) {</div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;    outputFile.<a class="codeRef" href="http://en.cppreference.com/w/cpp/io/basic_ofstream/open.html">open</a>(path + <span class="stringliteral">&quot;bulkTopo/typeInfo.dat&quot;</span>);</div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;    outputFile &lt;&lt; <span class="stringliteral">&quot;Atom types in the dump files are:\n&quot;</span>;</div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;    outputFile &lt;&lt; <span class="stringliteral">&quot; Type 0 (dummy) = unidentified phase\n&quot;</span>;</div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;    outputFile &lt;&lt; <span class="stringliteral">&quot; Type 1 (hc) = atom belonging to a Hexagonal Cage.\n&quot;</span>;</div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;    outputFile &lt;&lt; <span class="stringliteral">&quot; Type 2 (ddc) = atom belonging to a Double-Diamond Cage\n&quot;</span>;</div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;    outputFile &lt;&lt; <span class="stringliteral">&quot; Type 3 (mixed) = atom belonging to a mixed ring shared by &quot;</span></div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;                  <span class="stringliteral">&quot;a DDC and HC\n&quot;</span>;</div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;    outputFile</div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;        &lt;&lt; <span class="stringliteral">&quot; Type 4 (pnc) = atom belonging to a pair of pentagonal rings\n&quot;</span>;</div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;    outputFile &lt;&lt; <span class="stringliteral">&quot; Type 5 (mixed2) = atom belonging to a pentagonal &quot;</span></div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;                  <span class="stringliteral">&quot;nanochannel, shared by DDCs/HCs\n&quot;</span>;</div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;    outputFile.<a class="codeRef" href="http://en.cppreference.com/w/cpp/io/basic_ofstream/close.html">close</a>();</div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;  } <span class="comment">// end of writing out information</span></div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;  <span class="comment">// ----------------</span></div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;  <span class="comment">// Write output to file inside the output directory</span></div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;  outputFile.<a class="codeRef" href="http://en.cppreference.com/w/cpp/io/basic_ofstream/open.html">open</a>(path + <span class="stringliteral">&quot;bulkTopo/dumpFiles/&quot;</span> + filename);</div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;  <span class="comment">// ----------------------------------------------------</span></div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;  <span class="comment">// Header Format</span></div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160; </div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;  <span class="comment">// ITEM: TIMESTEP</span></div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;  <span class="comment">// 0</span></div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;  <span class="comment">// ITEM: NUMBER OF ATOMS</span></div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;  <span class="comment">// 500</span></div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;  <span class="comment">// ITEM: BOX BOUNDS pp pp pp</span></div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;  <span class="comment">// -9.0400100000000005e-01 1.7170999999999999e+01</span></div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;  <span class="comment">// -9.0400100000000005e-01 1.7170999999999999e+01</span></div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;  <span class="comment">// -9.0400100000000005e-01 1.7170999999999999e+01</span></div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;  <span class="comment">// ITEM: ATOMS id mol type x y z rmsd</span></div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160; </div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;  <span class="comment">// -----------------</span></div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;  <span class="comment">// -------</span></div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;  <span class="comment">// Write the header</span></div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;  <span class="comment">// ITEM: TIMESTEP</span></div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;  outputFile &lt;&lt; <span class="stringliteral">&quot;ITEM: TIMESTEP\n&quot;</span>;</div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;  <span class="comment">// Write out frame number</span></div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;  outputFile &lt;&lt; yCloud-&gt;currentFrame &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;  <span class="comment">// ITEM: NUMBER OF ATOMS</span></div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;  outputFile &lt;&lt; <span class="stringliteral">&quot;ITEM: NUMBER OF ATOMS\n&quot;</span>;</div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;  <span class="comment">// Number of atoms</span></div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;  outputFile &lt;&lt; yCloud-&gt;pts.size() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;  <span class="comment">// ITEM: BOX BOUNDS pp pp pp</span></div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;  outputFile &lt;&lt; <span class="stringliteral">&quot;ITEM: BOX BOUNDS pp pp pp\n&quot;</span>;</div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;  <span class="comment">// Box lengths</span></div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;  outputFile &lt;&lt; yCloud-&gt;boxLow[0] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; yCloud-&gt;boxLow[0] + yCloud-&gt;box[0]</div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;             &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;  outputFile &lt;&lt; yCloud-&gt;boxLow[1] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; yCloud-&gt;boxLow[1] + yCloud-&gt;box[1]</div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;             &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;  outputFile &lt;&lt; yCloud-&gt;boxLow[2] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; yCloud-&gt;boxLow[2] + yCloud-&gt;box[2]</div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;             &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;  <span class="comment">// ITEM: ATOMS id mol type x y z rmsd</span></div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;  outputFile &lt;&lt; <span class="stringliteral">&quot;ITEM: ATOMS id mol type x y z rmsd\n&quot;</span>;</div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;  <span class="comment">// -------</span></div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;  <span class="comment">// Write out the atom coordinates</span></div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;  <span class="comment">// Format</span></div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;  <span class="comment">// ITEM: ATOMS id mol type x y z rmsd</span></div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;  <span class="comment">// Loop through atoms</span></div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; yCloud-&gt;pts.size(); i++) {</div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;    iatom =</div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;        yCloud-&gt;pts[i].atomID; <span class="comment">// The actual ID can be different from the index</span></div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;    <span class="comment">// Write out coordinates</span></div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;    outputFile &lt;&lt; iatom &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; yCloud-&gt;pts[i].molID &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; atomTypes[i]</div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;               &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; yCloud-&gt;pts[i].x &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; yCloud-&gt;pts[i].y &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;               &lt;&lt; yCloud-&gt;pts[i].z &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; rmsdPerAtom[i] &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160; </div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;  } <span class="comment">// end of loop through all atoms in pointCloud</span></div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;  <span class="comment">// -----------------------------------------------------</span></div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;  outputFile.<a class="codeRef" href="http://en.cppreference.com/w/cpp/io/basic_ofstream/close.html">close</a>(); <span class="comment">// Close the file</span></div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;  <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;} <span class="comment">// end of function</span></div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160; </div>
<div class="line"><a name="l01378"></a><span class="lineno"><a class="line" href="namespacesout.html#a6ecf4c61a66360ec154723bffe21b2b2"> 1378</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="namespacesout.html#a6ecf4c61a66360ec154723bffe21b2b2">sout::writeLAMMPSdumpINT</a>(</div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;    <a class="code" href="structmolSys_1_1PointCloud.html">molSys::PointCloud</a>&lt;<a class="code" href="structmolSys_1_1Point.html">molSys::Point&lt;double&gt;</a>, <span class="keywordtype">double</span>&gt; *yCloud,</div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;    <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;double&gt;</a> rmsdPerAtom, <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a> atomTypes, <span class="keywordtype">int</span> maxDepth,</div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;    <a class="codeRef" href="http://en.cppreference.com/w/cpp/string/basic_string.html">std::string</a> path) {</div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/io/basic_ofstream.html">std::ofstream</a> outputFile;</div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;  <span class="keywordtype">int</span> iatom; <span class="comment">// Index, not atom ID</span></div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/string/basic_string.html">std::string</a> filename =</div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;      <span class="stringliteral">&quot;dump-&quot;</span> + <a class="codeRef" href="http://en.cppreference.com/w/cpp/string/basic_string/to_string.html">std::to_string</a>(yCloud-&gt;currentFrame) + <span class="stringliteral">&quot;.lammpstrj&quot;</span>;</div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;  <span class="comment">// ----------------</span></div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;  <span class="comment">// Make the output directory if it doesn&#39;t exist</span></div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/string/basic_string.html">std::string</a> outputDirName = path + <span class="stringliteral">&quot;topoINT/dumpFiles&quot;</span>;</div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;  <a class="code" href="namespacesout.html#a3985775f30d7920fbf13f12386abefc1">sout::makePath</a>(outputDirName);</div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;  <span class="comment">// ----------------</span></div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;  <span class="comment">// Write output to file inside the output directory</span></div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;  outputFile.<a class="codeRef" href="http://en.cppreference.com/w/cpp/io/basic_ofstream/open.html">open</a>(path + <span class="stringliteral">&quot;topoINT/dumpFiles/&quot;</span> + filename);</div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;  <span class="comment">// ----------------------------------------------------</span></div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;  <span class="comment">// Header Format</span></div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160; </div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;  <span class="comment">// ITEM: TIMESTEP</span></div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;  <span class="comment">// 0</span></div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;  <span class="comment">// ITEM: NUMBER OF ATOMS</span></div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;  <span class="comment">// 500</span></div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;  <span class="comment">// ITEM: BOX BOUNDS pp pp pp</span></div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;  <span class="comment">// -9.0400100000000005e-01 1.7170999999999999e+01</span></div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;  <span class="comment">// -9.0400100000000005e-01 1.7170999999999999e+01</span></div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;  <span class="comment">// -9.0400100000000005e-01 1.7170999999999999e+01</span></div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;  <span class="comment">// ITEM: ATOMS id mol type x y z rmsd</span></div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160; </div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;  <span class="comment">// -----------------</span></div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;  <span class="comment">// -------</span></div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;  <span class="comment">// Write the header</span></div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;  <span class="comment">// ITEM: TIMESTEP</span></div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;  outputFile &lt;&lt; <span class="stringliteral">&quot;ITEM: TIMESTEP\n&quot;</span>;</div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;  <span class="comment">// Write out frame number</span></div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;  outputFile &lt;&lt; yCloud-&gt;currentFrame &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;  <span class="comment">// ITEM: NUMBER OF ATOMS</span></div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;  outputFile &lt;&lt; <span class="stringliteral">&quot;ITEM: NUMBER OF ATOMS\n&quot;</span>;</div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;  <span class="comment">// Number of atoms</span></div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;  outputFile &lt;&lt; yCloud-&gt;pts.size() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;  <span class="comment">// ITEM: BOX BOUNDS pp pp pp</span></div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;  outputFile &lt;&lt; <span class="stringliteral">&quot;ITEM: BOX BOUNDS pp pp pp\n&quot;</span>;</div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;  <span class="comment">// Box lengths</span></div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;  outputFile &lt;&lt; yCloud-&gt;boxLow[0] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; yCloud-&gt;boxLow[0] + yCloud-&gt;box[0]</div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;             &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;  outputFile &lt;&lt; yCloud-&gt;boxLow[1] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; yCloud-&gt;boxLow[1] + yCloud-&gt;box[1]</div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;             &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;  outputFile &lt;&lt; yCloud-&gt;boxLow[2] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; yCloud-&gt;boxLow[2] + yCloud-&gt;box[2]</div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;             &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;  <span class="comment">// ITEM: ATOMS id mol type x y z rmsd</span></div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;  outputFile &lt;&lt; <span class="stringliteral">&quot;ITEM: ATOMS id mol type x y z rmsd\n&quot;</span>;</div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;  <span class="comment">// -------</span></div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;  <span class="comment">// Write out the atom coordinates</span></div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;  <span class="comment">// Format</span></div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;  <span class="comment">// ITEM: ATOMS id mol type x y z rmsd</span></div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;  <span class="comment">// Loop through atoms</span></div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; yCloud-&gt;pts.size(); i++) {</div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;    iatom =</div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;        yCloud-&gt;pts[i].atomID; <span class="comment">// The actual ID can be different from the index</span></div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;    <span class="comment">// Write out coordinates</span></div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;    outputFile &lt;&lt; iatom &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; yCloud-&gt;pts[i].molID &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; atomTypes[i]</div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;               &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; yCloud-&gt;pts[i].x &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; yCloud-&gt;pts[i].y &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;               &lt;&lt; yCloud-&gt;pts[i].z &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; rmsdPerAtom[i] &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160; </div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;  } <span class="comment">// end of loop through all atoms in pointCloud</span></div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;  <span class="comment">// -----------------------------------------------------</span></div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;  <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;} <span class="comment">// end of function</span></div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160; </div>
<div class="line"><a name="l01452"></a><span class="lineno"><a class="line" href="namespacesout.html#a31d215aac08b1a890f73e074eae808a1"> 1452</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="namespacesout.html#a31d215aac08b1a890f73e074eae808a1">sout::writeLAMMPSdumpSlice</a>(</div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;    <a class="code" href="structmolSys_1_1PointCloud.html">molSys::PointCloud</a>&lt;<a class="code" href="structmolSys_1_1Point.html">molSys::Point&lt;double&gt;</a>, <span class="keywordtype">double</span>&gt; *yCloud,</div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;    <a class="codeRef" href="http://en.cppreference.com/w/cpp/string/basic_string.html">std::string</a> path) {</div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/io/basic_ofstream.html">std::ofstream</a> outputFile;</div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;  <span class="keywordtype">int</span> iatom; <span class="comment">// Index, not atom ID</span></div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/string/basic_string.html">std::string</a> filename =</div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;      <span class="stringliteral">&quot;dump-&quot;</span> + <a class="codeRef" href="http://en.cppreference.com/w/cpp/string/basic_string/to_string.html">std::to_string</a>(yCloud-&gt;currentFrame) + <span class="stringliteral">&quot;.lammpstrj&quot;</span>;</div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;  <span class="comment">// ----------------</span></div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;  <span class="comment">// Make the output directory if it doesn&#39;t exist</span></div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;  <a class="code" href="namespacesout.html#a3985775f30d7920fbf13f12386abefc1">sout::makePath</a>(path+<span class="stringliteral">&quot;selection&quot;</span>);</div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/string/basic_string.html">std::string</a> outputDirName = path + <span class="stringliteral">&quot;selection/dumpFiles&quot;</span>;</div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;  <a class="code" href="namespacesout.html#a3985775f30d7920fbf13f12386abefc1">sout::makePath</a>(outputDirName);</div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;  <span class="comment">// ----------------</span></div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;  <span class="comment">// Write output to file inside the output directory</span></div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;  outputFile.<a class="codeRef" href="http://en.cppreference.com/w/cpp/io/basic_ofstream/open.html">open</a>(path + <span class="stringliteral">&quot;selection/dumpFiles/&quot;</span> + filename);</div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;  <span class="comment">// ----------------------------------------------------</span></div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;  <span class="comment">// Header Format</span></div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160; </div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;  <span class="comment">// ITEM: TIMESTEP</span></div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;  <span class="comment">// 0</span></div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;  <span class="comment">// ITEM: NUMBER OF ATOMS</span></div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;  <span class="comment">// 500</span></div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;  <span class="comment">// ITEM: BOX BOUNDS pp pp pp</span></div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;  <span class="comment">// -9.0400100000000005e-01 1.7170999999999999e+01</span></div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;  <span class="comment">// -9.0400100000000005e-01 1.7170999999999999e+01</span></div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;  <span class="comment">// -9.0400100000000005e-01 1.7170999999999999e+01</span></div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;  <span class="comment">// ITEM: ATOMS id mol type x y z rmsd</span></div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160; </div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;  <span class="comment">// -----------------</span></div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;  <span class="comment">// -------</span></div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;  <span class="comment">// Write the header</span></div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;  <span class="comment">// ITEM: TIMESTEP</span></div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;  outputFile &lt;&lt; <span class="stringliteral">&quot;ITEM: TIMESTEP\n&quot;</span>;</div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;  <span class="comment">// Write out frame number</span></div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;  outputFile &lt;&lt; yCloud-&gt;currentFrame &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;  <span class="comment">// ITEM: NUMBER OF ATOMS</span></div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;  outputFile &lt;&lt; <span class="stringliteral">&quot;ITEM: NUMBER OF ATOMS\n&quot;</span>;</div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;  <span class="comment">// Number of atoms</span></div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;  outputFile &lt;&lt; yCloud-&gt;pts.size() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;  <span class="comment">// ITEM: BOX BOUNDS pp pp pp</span></div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;  outputFile &lt;&lt; <span class="stringliteral">&quot;ITEM: BOX BOUNDS pp pp pp\n&quot;</span>;</div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;  <span class="comment">// Box lengths</span></div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;  outputFile &lt;&lt; yCloud-&gt;boxLow[0] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; yCloud-&gt;boxLow[0] + yCloud-&gt;box[0]</div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;             &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;  outputFile &lt;&lt; yCloud-&gt;boxLow[1] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; yCloud-&gt;boxLow[1] + yCloud-&gt;box[1]</div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;             &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;  outputFile &lt;&lt; yCloud-&gt;boxLow[2] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; yCloud-&gt;boxLow[2] + yCloud-&gt;box[2]</div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;             &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;  <span class="comment">// ITEM: ATOMS id mol type x y z rmsd</span></div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;  outputFile &lt;&lt; <span class="stringliteral">&quot;ITEM: ATOMS id mol type x y z inSlice\n&quot;</span>;</div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;  <span class="comment">// -------</span></div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;  <span class="comment">// Write out the atom coordinates</span></div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;  <span class="comment">// Format</span></div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;  <span class="comment">// ITEM: ATOMS id mol type x y z rmsd</span></div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;  <span class="comment">// Loop through atoms</span></div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; yCloud-&gt;pts.size(); i++) {</div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;    iatom =</div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;        yCloud-&gt;pts[i].atomID; <span class="comment">// The actual ID can be different from the index</span></div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;    <span class="comment">// Write out coordinates</span></div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;    outputFile &lt;&lt; iatom &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; yCloud-&gt;pts[i].molID &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; yCloud-&gt;pts[i].type</div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;               &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; yCloud-&gt;pts[i].x &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; yCloud-&gt;pts[i].y &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;               &lt;&lt; yCloud-&gt;pts[i].z &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; yCloud-&gt;pts[i].inSlice &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160; </div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;  } <span class="comment">// end of loop through all atoms in pointCloud</span></div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;  <span class="comment">// -----------------------------------------------------</span></div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;  <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;} <span class="comment">// end of function</span></div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160; </div>
<div class="line"><a name="l01527"></a><span class="lineno"><a class="line" href="namespacesout.html#ae3038ae689d60cc3529b95caa0b75ae1"> 1527</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="namespacesout.html#ae3038ae689d60cc3529b95caa0b75ae1">sout::writeLAMMPSdataAllPrisms</a>(</div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;    <a class="code" href="structmolSys_1_1PointCloud.html">molSys::PointCloud</a>&lt;<a class="code" href="structmolSys_1_1Point.html">molSys::Point&lt;double&gt;</a>, <span class="keywordtype">double</span>&gt; *yCloud,</div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;    <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt;<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a>&gt; nList, <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a> atomTypes,</div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;    <span class="keywordtype">int</span> maxDepth, <a class="codeRef" href="http://en.cppreference.com/w/cpp/string/basic_string.html">std::string</a> path, <span class="keywordtype">bool</span> doShapeMatching) {</div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/io/basic_ofstream.html">std::ofstream</a> outputFile;</div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;  <span class="keywordtype">int</span> iatom; <span class="comment">// Index, not atom ID</span></div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;  <span class="keywordtype">int</span> bondTypes = 1;</div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;  <span class="comment">// Bond stuff</span></div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;std::vector&lt;int&gt;</a>&gt; bonds; <span class="comment">// Vector of vector, with each row</span></div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;                                       <span class="comment">// containing the atom IDs of each bond</span></div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/string/basic_string.html">std::string</a> filename =</div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;      <span class="stringliteral">&quot;system-prisms-&quot;</span> + <a class="codeRef" href="http://en.cppreference.com/w/cpp/string/basic_string/to_string.html">std::to_string</a>(yCloud-&gt;currentFrame) + <span class="stringliteral">&quot;.data&quot;</span>;</div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160; </div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;  <span class="comment">// ---------------</span></div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;  <span class="comment">// Get the bonds</span></div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;  bonds = <a class="code" href="group__bond.html#ga99a6b8a519741c767bd8bed063276b5a">bond::populateBonds</a>(nList, yCloud);</div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;  <span class="comment">// ----------------</span></div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;  <span class="comment">// Make the output directory if it doesn&#39;t exist</span></div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;  <a class="code" href="namespacesout.html#a3985775f30d7920fbf13f12386abefc1">sout::makePath</a>(path);</div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/string/basic_string.html">std::string</a> outputDirName = path + <span class="stringliteral">&quot;topoINT&quot;</span>;</div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;  <a class="code" href="namespacesout.html#a3985775f30d7920fbf13f12386abefc1">sout::makePath</a>(outputDirName);</div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;  outputDirName = path + <span class="stringliteral">&quot;topoINT/dataFiles/&quot;</span>;</div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;  <a class="code" href="namespacesout.html#a3985775f30d7920fbf13f12386abefc1">sout::makePath</a>(outputDirName);</div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;  <span class="comment">// ----------------</span></div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;  <span class="comment">// Write output to file inside the output directory</span></div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;  outputFile.<a class="codeRef" href="http://en.cppreference.com/w/cpp/io/basic_ofstream/open.html">open</a>(path + <span class="stringliteral">&quot;topoINT/dataFiles/&quot;</span> + filename);</div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;  <span class="comment">// FORMAT:</span></div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;  <span class="comment">//  Comment Line</span></div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;  <span class="comment">//  4 atoms</span></div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;  <span class="comment">//  4 bonds</span></div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;  <span class="comment">//  0 angles</span></div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;  <span class="comment">//  0 dihedrals</span></div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;  <span class="comment">//  0 impropers</span></div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;  <span class="comment">//  1 atom types</span></div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;  <span class="comment">//  1 bond types</span></div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;  <span class="comment">//  0 angle types</span></div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;  <span class="comment">//  0 dihedral types</span></div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;  <span class="comment">//  0 improper types</span></div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;  <span class="comment">//  -1.124000 52.845002  xlo xhi</span></div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;  <span class="comment">//  0.000000 54.528999  ylo yhi</span></div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;  <span class="comment">//  1.830501 53.087501  zlo zhi</span></div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160; </div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;  <span class="comment">//  Masses</span></div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160; </div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;  <span class="comment">//  1 15.999400 # O</span></div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160; </div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;  <span class="comment">//  Atoms</span></div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160; </div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;  <span class="comment">// 1 1 1 0 20.239  1.298 6.873 # O</span></div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;  <span class="comment">// 2 1 1 0 0 5.193 6.873 # O</span></div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;  <span class="comment">// 3 1 1 0 2.249 1.298 6.873 # O</span></div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160; </div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;  <span class="comment">// -------</span></div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;  <span class="comment">// Write the header</span></div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;  <span class="comment">// Write comment line</span></div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;  outputFile &lt;&lt; <span class="stringliteral">&quot;Written out by D-SEAMS\n&quot;</span>;</div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;  <span class="comment">// Write out the number of atoms</span></div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;  outputFile &lt;&lt; yCloud-&gt;pts.size() &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;             &lt;&lt; <span class="stringliteral">&quot;atoms&quot;</span></div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;             &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;  <span class="comment">// Number of bonds</span></div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;  outputFile &lt;&lt; bonds.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/size.html">size</a>() &lt;&lt; <span class="stringliteral">&quot; bonds&quot;</span></div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;             &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;  outputFile &lt;&lt; <span class="stringliteral">&quot;0 angles\n0 dihedrals\n0 impropers\n&quot;</span>;</div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;  <span class="comment">// There are maxDepth-2 total types of prisms + dummy</span></div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;  <span class="keywordflow">if</span> (doShapeMatching) {</div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;    outputFile &lt;&lt; 2 * maxDepth - 2 &lt;&lt; <span class="stringliteral">&quot; atom types\n&quot;</span>;</div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;    outputFile &lt;&lt; maxDepth &lt;&lt; <span class="stringliteral">&quot; atom types\n&quot;</span>;</div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;  }</div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;  <span class="comment">// Bond types</span></div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;  outputFile</div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;      &lt;&lt; bondTypes</div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;      &lt;&lt; <span class="stringliteral">&quot; bond types\n0 angle types\n0 dihedral types\n0 improper types\n&quot;</span>;</div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;  <span class="comment">// Box lengths</span></div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;  outputFile &lt;&lt; yCloud-&gt;boxLow[0] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; yCloud-&gt;boxLow[0] + yCloud-&gt;box[0]</div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;             &lt;&lt; <span class="stringliteral">&quot; xlo xhi\n&quot;</span>;</div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;  outputFile &lt;&lt; yCloud-&gt;boxLow[1] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; yCloud-&gt;boxLow[1] + yCloud-&gt;box[1]</div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;             &lt;&lt; <span class="stringliteral">&quot; ylo yhi\n&quot;</span>;</div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;  outputFile &lt;&lt; yCloud-&gt;boxLow[2] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; yCloud-&gt;boxLow[2] + yCloud-&gt;box[2]</div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;             &lt;&lt; <span class="stringliteral">&quot; zlo zhi\n&quot;</span>;</div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;  <span class="comment">// Masses</span></div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;  outputFile &lt;&lt; <span class="stringliteral">&quot;\nMasses\n\n&quot;</span>;</div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;  outputFile &lt;&lt; <span class="stringliteral">&quot;1 15.999400 # dummy\n&quot;</span>;</div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;  outputFile &lt;&lt; <span class="stringliteral">&quot;2 1.0 # mixedRings \n&quot;</span>;</div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;  <span class="comment">// There are maxDepth-2 other prism types</span></div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ringSize = 3; ringSize &lt;= maxDepth; ringSize++) {</div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;    outputFile &lt;&lt; ringSize &lt;&lt; <span class="stringliteral">&quot; 15.999400 # prism&quot;</span> &lt;&lt; ringSize &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;  } <span class="comment">// end of writing out perfect atom types</span></div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;  <span class="comment">// Write out the types for the deformed prism blocks</span></div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;  <span class="keywordflow">if</span> (doShapeMatching) {</div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ringSize = maxDepth + 1; ringSize &lt;= 2 * maxDepth - 2;</div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;         ringSize++) {</div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;      <span class="keywordtype">int</span> p = ringSize - maxDepth + 2;</div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;      outputFile &lt;&lt; ringSize &lt;&lt; <span class="stringliteral">&quot; 15.999400 # deformPrism&quot;</span> &lt;&lt; p &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;    } <span class="comment">// end of writing out perfect atom types</span></div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;  }   <span class="comment">// Deformed prism types</span></div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;  <span class="comment">// Atoms</span></div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;  outputFile &lt;&lt; <span class="stringliteral">&quot;\nAtoms\n\n&quot;</span>;</div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;  <span class="comment">// -------</span></div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;  <span class="comment">// Write out the atom coordinates</span></div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;  <span class="comment">// Loop through atoms</span></div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; yCloud-&gt;pts.size(); i++) {</div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;    iatom =</div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;        yCloud-&gt;pts[i].atomID; <span class="comment">// The actual ID can be different from the index</span></div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;    <span class="comment">// Write out coordinates</span></div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;    <span class="comment">// atomID molecule-tag atom-type q x y z</span></div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;    outputFile &lt;&lt; iatom &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; yCloud-&gt;pts[i].molID &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; atomTypes[i]</div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;               &lt;&lt; <span class="stringliteral">&quot; 0 &quot;</span> &lt;&lt; yCloud-&gt;pts[i].x &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; yCloud-&gt;pts[i].y &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;               &lt;&lt; yCloud-&gt;pts[i].z &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160; </div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;  } <span class="comment">// end of loop through all atoms in pointCloud</span></div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160; </div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;  <span class="comment">// Print the bonds now!</span></div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;  outputFile &lt;&lt; <span class="stringliteral">&quot;\nBonds\n\n&quot;</span>;</div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;  <span class="comment">// Loop through all bonds</span></div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ibond = 0; ibond &lt; bonds.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/size.html">size</a>(); ibond++) {</div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;    outputFile &lt;&lt; ibond + 1 &lt;&lt; <span class="stringliteral">&quot; 1 &quot;</span> &lt;&lt; bonds[ibond][0] &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;               &lt;&lt; bonds[ibond][1] &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;  } <span class="comment">// end of for loop for bonds</span></div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160; </div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;  outputFile.<a class="codeRef" href="http://en.cppreference.com/w/cpp/io/basic_ofstream/close.html">close</a>();</div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;  <span class="comment">// Once the datafile has been printed, exit</span></div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;  <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;}</div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160; </div>
<div class="line"><a name="l01661"></a><span class="lineno"><a class="line" href="namespacesout.html#a39e0081b79852366fd17b377a9925ae0"> 1661</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="namespacesout.html#a39e0081b79852366fd17b377a9925ae0">sout::writeLAMMPSdataAllRings</a>(</div>
<div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;    <a class="code" href="structmolSys_1_1PointCloud.html">molSys::PointCloud</a>&lt;<a class="code" href="structmolSys_1_1Point.html">molSys::Point&lt;double&gt;</a>, <span class="keywordtype">double</span>&gt; *yCloud,</div>
<div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;    <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt;<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a>&gt; nList, <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a> atomTypes,</div>
<div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;    <span class="keywordtype">int</span> maxDepth, <a class="codeRef" href="http://en.cppreference.com/w/cpp/string/basic_string.html">std::string</a> path, <span class="keywordtype">bool</span> isMonolayer) {</div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/io/basic_ofstream.html">std::ofstream</a> outputFile;</div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;  <span class="keywordtype">int</span> iatom; <span class="comment">// Index, not atom ID</span></div>
<div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;  <span class="keywordtype">int</span> bondTypes = 1;</div>
<div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;  <span class="comment">// Bond stuff</span></div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;std::vector&lt;int&gt;</a>&gt; bonds; <span class="comment">// Vector of vector, with each row</span></div>
<div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;                                       <span class="comment">// containing the atom IDs of each bond</span></div>
<div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/string/basic_string.html">std::string</a> filename =</div>
<div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;      <span class="stringliteral">&quot;system-rings-&quot;</span> + <a class="codeRef" href="http://en.cppreference.com/w/cpp/string/basic_string/to_string.html">std::to_string</a>(yCloud-&gt;currentFrame) + <span class="stringliteral">&quot;.data&quot;</span>;</div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/string/basic_string.html">std::string</a> pathName, pathFolder;</div>
<div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160; </div>
<div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;  <span class="comment">// ---------------</span></div>
<div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;  <span class="comment">// Get the bonds</span></div>
<div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;  bonds = <a class="code" href="group__bond.html#ga99a6b8a519741c767bd8bed063276b5a">bond::populateBonds</a>(nList, yCloud);</div>
<div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;  <span class="comment">// ----------------</span></div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;  <span class="comment">// Make the output directory if it doesn&#39;t exist</span></div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;  <span class="keywordflow">if</span> (isMonolayer)</div>
<div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;  {</div>
<div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;    pathFolder = <span class="stringliteral">&quot;topoMonolayer&quot;</span>;</div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;    pathName = <span class="stringliteral">&quot;topoMonolayer/dataFiles/&quot;</span>;</div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;  } <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;    pathFolder = <span class="stringliteral">&quot;bulkTopo&quot;</span>;</div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;    pathName = <span class="stringliteral">&quot;bulkTopo/dataFiles/&quot;</span>;</div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;  }</div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;  </div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;  <a class="code" href="namespacesout.html#a3985775f30d7920fbf13f12386abefc1">sout::makePath</a>(path);</div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/string/basic_string.html">std::string</a> outputDirName = path + pathFolder;</div>
<div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;  <a class="code" href="namespacesout.html#a3985775f30d7920fbf13f12386abefc1">sout::makePath</a>(outputDirName);</div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;  outputDirName = path + pathName;</div>
<div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;  <a class="code" href="namespacesout.html#a3985775f30d7920fbf13f12386abefc1">sout::makePath</a>(outputDirName);</div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160; </div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;  <span class="comment">// Write output to file inside the output directory</span></div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;  outputFile.<a class="codeRef" href="http://en.cppreference.com/w/cpp/io/basic_ofstream/open.html">open</a>(path + pathName + filename);</div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160; </div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;  <span class="comment">// FORMAT:</span></div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;  <span class="comment">//  Comment Line</span></div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;  <span class="comment">//  4 atoms</span></div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;  <span class="comment">//  4 bonds</span></div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;  <span class="comment">//  0 angles</span></div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;  <span class="comment">//  0 dihedrals</span></div>
<div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;  <span class="comment">//  0 impropers</span></div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;  <span class="comment">//  1 atom types</span></div>
<div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;  <span class="comment">//  1 bond types</span></div>
<div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;  <span class="comment">//  0 angle types</span></div>
<div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;  <span class="comment">//  0 dihedral types</span></div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;  <span class="comment">//  0 improper types</span></div>
<div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;  <span class="comment">//  -1.124000 52.845002  xlo xhi</span></div>
<div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;  <span class="comment">//  0.000000 54.528999  ylo yhi</span></div>
<div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;  <span class="comment">//  1.830501 53.087501  zlo zhi</span></div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160; </div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;  <span class="comment">//  Masses</span></div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160; </div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;  <span class="comment">//  1 15.999400 # O</span></div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160; </div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;  <span class="comment">//  Atoms</span></div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160; </div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;  <span class="comment">// 1 1 1 0 20.239  1.298 6.873 # O</span></div>
<div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;  <span class="comment">// 2 1 1 0 0 5.193 6.873 # O</span></div>
<div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;  <span class="comment">// 3 1 1 0 2.249 1.298 6.873 # O</span></div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160; </div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;  <span class="comment">// -------</span></div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;  <span class="comment">// Write the header</span></div>
<div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;  <span class="comment">// Write comment line</span></div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;  outputFile &lt;&lt; <span class="stringliteral">&quot;Written out by D-SEAMS\n&quot;</span>;</div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;  <span class="comment">// Write out the number of atoms</span></div>
<div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;  outputFile &lt;&lt; yCloud-&gt;pts.size() &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;             &lt;&lt; <span class="stringliteral">&quot;atoms&quot;</span></div>
<div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;             &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;  <span class="comment">// Number of bonds</span></div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;  outputFile &lt;&lt; bonds.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/size.html">size</a>() &lt;&lt; <span class="stringliteral">&quot; bonds&quot;</span></div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;             &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;  outputFile &lt;&lt; <span class="stringliteral">&quot;0 angles\n0 dihedrals\n0 impropers\n&quot;</span>;</div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;  <span class="comment">// There are maxDepth-2 total types of prisms + dummy</span></div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;  outputFile &lt;&lt; maxDepth &lt;&lt; <span class="stringliteral">&quot; atom types\n&quot;</span>;</div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;  <span class="comment">// Bond types</span></div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;  outputFile</div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;      &lt;&lt; bondTypes</div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;      &lt;&lt; <span class="stringliteral">&quot; bond types\n0 angle types\n0 dihedral types\n0 improper types\n&quot;</span>;</div>
<div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;  <span class="comment">// Box lengths</span></div>
<div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;  outputFile &lt;&lt; yCloud-&gt;boxLow[0] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; yCloud-&gt;boxLow[0] + yCloud-&gt;box[0]</div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;             &lt;&lt; <span class="stringliteral">&quot; xlo xhi\n&quot;</span>;</div>
<div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;  outputFile &lt;&lt; yCloud-&gt;boxLow[1] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; yCloud-&gt;boxLow[1] + yCloud-&gt;box[1]</div>
<div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;             &lt;&lt; <span class="stringliteral">&quot; ylo yhi\n&quot;</span>;</div>
<div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;  outputFile &lt;&lt; yCloud-&gt;boxLow[2] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; yCloud-&gt;boxLow[2] + yCloud-&gt;box[2]</div>
<div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;             &lt;&lt; <span class="stringliteral">&quot; zlo zhi\n&quot;</span>;</div>
<div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;  <span class="comment">// Masses</span></div>
<div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;  outputFile &lt;&lt; <span class="stringliteral">&quot;\nMasses\n\n&quot;</span>;</div>
<div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;  outputFile &lt;&lt; <span class="stringliteral">&quot;1 15.999400 # dummy\n&quot;</span>;</div>
<div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;  outputFile &lt;&lt; <span class="stringliteral">&quot;2 1.0 # \n&quot;</span>;</div>
<div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;  <span class="comment">// There are maxDepth-2 other prism types</span></div>
<div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ringSize = 3; ringSize &lt;= maxDepth; ringSize++) {</div>
<div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;    outputFile &lt;&lt; ringSize &lt;&lt; <span class="stringliteral">&quot; 15.999400 # ring&quot;</span> &lt;&lt; ringSize &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;  } <span class="comment">// end of writing out atom types</span></div>
<div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;  <span class="comment">// Atoms</span></div>
<div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;  outputFile &lt;&lt; <span class="stringliteral">&quot;\nAtoms\n\n&quot;</span>;</div>
<div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;  <span class="comment">// -------</span></div>
<div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;  <span class="comment">// Write out the atom coordinates</span></div>
<div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;  <span class="comment">// Loop through atoms</span></div>
<div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; yCloud-&gt;pts.size(); i++) {</div>
<div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;    iatom =</div>
<div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;        yCloud-&gt;pts[i].atomID; <span class="comment">// The actual ID can be different from the index</span></div>
<div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;    <span class="comment">// Write out coordinates</span></div>
<div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;    <span class="comment">// atomID molecule-tag atom-type q x y z</span></div>
<div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;    outputFile &lt;&lt; iatom &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; yCloud-&gt;pts[i].molID &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; atomTypes[i]</div>
<div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;               &lt;&lt; <span class="stringliteral">&quot; 0 &quot;</span> &lt;&lt; yCloud-&gt;pts[i].x &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; yCloud-&gt;pts[i].y &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;               &lt;&lt; yCloud-&gt;pts[i].z &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160; </div>
<div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;  } <span class="comment">// end of loop through all atoms in pointCloud</span></div>
<div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160; </div>
<div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;  <span class="comment">// Print the bonds now!</span></div>
<div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;  outputFile &lt;&lt; <span class="stringliteral">&quot;\nBonds\n\n&quot;</span>;</div>
<div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;  <span class="comment">// Loop through all bonds</span></div>
<div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ibond = 0; ibond &lt; bonds.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/size.html">size</a>(); ibond++) {</div>
<div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;    outputFile &lt;&lt; ibond + 1 &lt;&lt; <span class="stringliteral">&quot; 1 &quot;</span> &lt;&lt; bonds[ibond][0] &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;               &lt;&lt; bonds[ibond][1] &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;  } <span class="comment">// end of for loop for bonds</span></div>
<div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160; </div>
<div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;  outputFile.<a class="codeRef" href="http://en.cppreference.com/w/cpp/io/basic_ofstream/close.html">close</a>();</div>
<div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;  <span class="comment">// Once the datafile has been printed, exit</span></div>
<div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;  <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;}</div>
<div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160; </div>
<div class="line"><a name="l01793"></a><span class="lineno"><a class="line" href="namespacesout.html#aab0f5ab6c315ea6f2aacb509a4b808f5"> 1793</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="namespacesout.html#aab0f5ab6c315ea6f2aacb509a4b808f5">sout::writeLAMMPSdataPrisms</a>(</div>
<div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;    <a class="code" href="structmolSys_1_1PointCloud.html">molSys::PointCloud</a>&lt;<a class="code" href="structmolSys_1_1Point.html">molSys::Point&lt;double&gt;</a>, <span class="keywordtype">double</span>&gt; *yCloud,</div>
<div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;    <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt;<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a>&gt; rings, <span class="keywordtype">bool</span> useBondFile, <a class="codeRef" href="http://en.cppreference.com/w/cpp/string/basic_string.html">std::string</a> bondFile,</div>
<div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;    <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a> listPrism, <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt;<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a>&gt; nList,</div>
<div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;    <a class="codeRef" href="http://en.cppreference.com/w/cpp/string/basic_string.html">std::string</a> filename) {</div>
<div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/io/basic_ofstream.html">std::ofstream</a> outputFile;</div>
<div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a> atoms;         <span class="comment">// Holds all atom IDs to print</span></div>
<div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;  <span class="keywordtype">int</span> ringSize = rings[0].<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/size.html">size</a>(); <span class="comment">// Ring size of each ring in rings</span></div>
<div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;  <span class="keywordtype">int</span> iatom;                      <span class="comment">// Index, not atom ID</span></div>
<div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;  <span class="keywordtype">bool</span> padAtoms = <span class="keyword">false</span>;          <span class="comment">// Add extra atoms if the atom IDs are skipped</span></div>
<div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;  <span class="keywordtype">int</span> prevAtomID = 0;             <span class="comment">// Check for previous atom ID</span></div>
<div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;  <span class="keywordtype">int</span> dummyAtoms = 0;             <span class="comment">// Number of dummy atoms to fill</span></div>
<div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;  <span class="keywordtype">int</span> dummyID;</div>
<div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;  <span class="keywordtype">int</span> jatom; <span class="comment">// Array index is 1 less than the ID (index for dummy atom)</span></div>
<div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;  <span class="keywordtype">int</span> bondTypes = 1;</div>
<div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;  <span class="comment">// Bond stuff</span></div>
<div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;std::vector&lt;int&gt;</a>&gt; bonds; <span class="comment">// Vector of vector, with each row</span></div>
<div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;                                       <span class="comment">// containing the atom IDs of each bond</span></div>
<div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;  <span class="keywordtype">bool</span> atomOne, atomTwo;               <span class="comment">// If bond atoms are in the prism or not</span></div>
<div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;  <span class="keywordtype">bool</span> isPrismBond;</div>
<div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160; </div>
<div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;  <span class="comment">// ----------------</span></div>
<div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;  <span class="comment">// Return if there are no prisms</span></div>
<div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;  <span class="keywordflow">if</span> (listPrism.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/size.html">size</a>() == 0) {</div>
<div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;    <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;  }</div>
<div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160; </div>
<div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;  <span class="comment">// ---------------</span></div>
<div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;  <span class="comment">// Get the bonds</span></div>
<div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;  <span class="keywordflow">if</span> (useBondFile) {</div>
<div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;    <span class="comment">// Bonds from file</span></div>
<div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;    bonds = <a class="code" href="group__sinp.html#gada34d9d30df182a408a6b69ba7310509">sinp::readBonds</a>(bondFile);</div>
<div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;  } <span class="comment">// get bonds from file</span></div>
<div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;  <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;    bonds = <a class="code" href="group__bond.html#ga99a6b8a519741c767bd8bed063276b5a">bond::populateBonds</a>(nList, yCloud);</div>
<div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;  } <span class="comment">// Bonds from rings</span></div>
<div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;  <span class="comment">// ----------------</span></div>
<div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;  <span class="comment">// Otherwise create file</span></div>
<div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;  <span class="comment">// Create output dir if it doesn&#39;t exist already</span></div>
<div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span> *path = <span class="stringliteral">&quot;../output&quot;</span>; <span class="comment">// relative to the build directory</span></div>
<div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;  fs::path dir(path);</div>
<div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;  <span class="comment">// if (fs::create_directory(dir)) {</span></div>
<div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;  <span class="comment">//   std::cerr &lt;&lt; &quot;Output directory created\n&quot;;</span></div>
<div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;  <span class="comment">// }</span></div>
<div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;  <span class="comment">// ----------------</span></div>
<div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;  <span class="comment">// Get all the unique atomIDs of the atoms in the rings of this type</span></div>
<div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;  <span class="comment">// Put all atom IDs into one 1-D vector</span></div>
<div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;  <span class="keywordtype">size_t</span> total_size{0};</div>
<div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;  <span class="comment">// Get the total number of atoms (repeated)</span></div>
<div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;  total_size = listPrism.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/size.html">size</a>() * ringSize;</div>
<div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;  <span class="comment">// Reserve this size inside atoms</span></div>
<div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;  atoms.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/reserve.html">reserve</a>(total_size);</div>
<div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;  <span class="comment">// Fill up all these atom IDs</span></div>
<div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iring = 0; iring &lt; listPrism.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/size.html">size</a>(); iring++) {</div>
<div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;    <a class="codeRef" href="http://en.cppreference.com/w/cpp/utility/move.html">std::move</a>(rings[listPrism[iring]].begin(), rings[listPrism[iring]].end(),</div>
<div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;              <a class="codeRef" href="http://en.cppreference.com/w/cpp/iterator/back_inserter.html">std::back_inserter</a>(atoms));</div>
<div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;  } <span class="comment">// end of loop through all rings in the list</span></div>
<div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160; </div>
<div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;  <span class="comment">// Sort the array according to atom ID, which will be needed to get the</span></div>
<div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;  <span class="comment">// unique IDs and to remove duplicates</span></div>
<div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;  sort(atoms.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/begin.html">begin</a>(), atoms.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/end.html">end</a>());</div>
<div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;  <span class="comment">// Get the unique atom IDs</span></div>
<div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;  <span class="keyword">auto</span> ip = <a class="codeRef" href="http://en.cppreference.com/w/cpp/algorithm/unique.html">std::unique</a>(atoms.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/begin.html">begin</a>(), atoms.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/end.html">end</a>());</div>
<div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;  <span class="comment">// Resize the vector to remove undefined terms</span></div>
<div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;  atoms.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/resize.html">resize</a>(<a class="codeRef" href="http://en.cppreference.com/w/cpp/iterator/distance.html">std::distance</a>(atoms.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/begin.html">begin</a>(), ip));</div>
<div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;  <span class="comment">// If the number of atoms is less than the total nop, add dummy atoms</span></div>
<div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;  <span class="keywordflow">if</span> (atoms.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/size.html">size</a>() != yCloud-&gt;nop) {</div>
<div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;    padAtoms = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;    bondTypes = 2;</div>
<div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;  }</div>
<div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;  <span class="comment">// ----------------</span></div>
<div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;  <span class="comment">// Write output to file inside the output directory</span></div>
<div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;  outputFile.<a class="codeRef" href="http://en.cppreference.com/w/cpp/io/basic_ofstream/open.html">open</a>(<span class="stringliteral">&quot;../output/&quot;</span> + filename);</div>
<div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;  <span class="comment">// FORMAT:</span></div>
<div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;  <span class="comment">//  Comment Line</span></div>
<div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;  <span class="comment">//  4 atoms</span></div>
<div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;  <span class="comment">//  4 bonds</span></div>
<div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;  <span class="comment">//  0 angles</span></div>
<div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;  <span class="comment">//  0 dihedrals</span></div>
<div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;  <span class="comment">//  0 impropers</span></div>
<div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;  <span class="comment">//  1 atom types</span></div>
<div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;  <span class="comment">//  1 bond types</span></div>
<div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;  <span class="comment">//  0 angle types</span></div>
<div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;  <span class="comment">//  0 dihedral types</span></div>
<div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;  <span class="comment">//  0 improper types</span></div>
<div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;  <span class="comment">//  -1.124000 52.845002  xlo xhi</span></div>
<div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;  <span class="comment">//  0.000000 54.528999  ylo yhi</span></div>
<div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;  <span class="comment">//  1.830501 53.087501  zlo zhi</span></div>
<div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160; </div>
<div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;  <span class="comment">//  Masses</span></div>
<div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160; </div>
<div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;  <span class="comment">//  1 15.999400 # O</span></div>
<div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160; </div>
<div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;  <span class="comment">//  Atoms</span></div>
<div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160; </div>
<div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;  <span class="comment">// 1 1 1 0 20.239  1.298 6.873 # O</span></div>
<div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;  <span class="comment">// 2 1 1 0 0 5.193 6.873 # O</span></div>
<div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;  <span class="comment">// 3 1 1 0 2.249 1.298 6.873 # O</span></div>
<div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160; </div>
<div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;  <span class="comment">// -------</span></div>
<div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;  <span class="comment">// Write the header</span></div>
<div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;  <span class="comment">// Write comment line</span></div>
<div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;  outputFile &lt;&lt; <span class="stringliteral">&quot;Written out by D-SEAMS\n&quot;</span>;</div>
<div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;  <span class="comment">// Write out the number of atoms</span></div>
<div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;  outputFile &lt;&lt; yCloud-&gt;pts.size() &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;             &lt;&lt; <span class="stringliteral">&quot;atoms&quot;</span></div>
<div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;             &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;  <span class="comment">// Number of bonds</span></div>
<div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;  outputFile &lt;&lt; bonds.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/size.html">size</a>() &lt;&lt; <span class="stringliteral">&quot; bonds&quot;</span></div>
<div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;             &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;  outputFile &lt;&lt; <span class="stringliteral">&quot;0 angles\n0 dihedrals\n0 impropers\n&quot;</span>;</div>
<div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;  <span class="comment">// If padded atoms are required, two atom types will be required</span></div>
<div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;  <span class="keywordflow">if</span> (padAtoms) {</div>
<div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;    outputFile &lt;&lt; <span class="stringliteral">&quot;2 atom types\n&quot;</span>;</div>
<div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;    outputFile &lt;&lt; <span class="stringliteral">&quot;1 atom types\n&quot;</span>;</div>
<div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;  } <span class="comment">// end of atom types</span></div>
<div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;  outputFile</div>
<div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;      &lt;&lt; bondTypes</div>
<div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;      &lt;&lt; <span class="stringliteral">&quot; bond types\n0 angle types\n0 dihedral types\n0 improper types\n&quot;</span>;</div>
<div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;  <span class="comment">// Box lengths</span></div>
<div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;  outputFile &lt;&lt; <span class="stringliteral">&quot;0 &quot;</span> &lt;&lt; yCloud-&gt;box[0] &lt;&lt; <span class="stringliteral">&quot; xlo xhi\n&quot;</span>;</div>
<div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;  outputFile &lt;&lt; <span class="stringliteral">&quot;0 &quot;</span> &lt;&lt; yCloud-&gt;box[1] &lt;&lt; <span class="stringliteral">&quot; ylo yhi\n&quot;</span>;</div>
<div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;  outputFile &lt;&lt; <span class="stringliteral">&quot;0 &quot;</span> &lt;&lt; yCloud-&gt;box[2] &lt;&lt; <span class="stringliteral">&quot; zlo zhi\n&quot;</span>;</div>
<div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;  <span class="comment">// Masses</span></div>
<div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;  outputFile &lt;&lt; <span class="stringliteral">&quot;\nMasses\n\n&quot;</span>;</div>
<div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;  outputFile &lt;&lt; <span class="stringliteral">&quot;1 15.999400 # O\n&quot;</span>;</div>
<div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;  <span class="keywordflow">if</span> (padAtoms) {</div>
<div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;    outputFile &lt;&lt; <span class="stringliteral">&quot;2 1.0 # dummy\n&quot;</span>;</div>
<div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;  }</div>
<div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;  <span class="comment">// Atoms</span></div>
<div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;  outputFile &lt;&lt; <span class="stringliteral">&quot;\nAtoms\n\n&quot;</span>;</div>
<div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;  <span class="comment">// -------</span></div>
<div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;  <span class="comment">// Write out the atom coordinates</span></div>
<div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;  <span class="comment">// Loop through atoms</span></div>
<div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; atoms.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/size.html">size</a>(); i++) {</div>
<div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;    iatom = atoms[i] - 1; <span class="comment">// The actual index is one less than the ID</span></div>
<div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;    <span class="comment">// -----------</span></div>
<div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;    <span class="comment">// Pad out</span></div>
<div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;    <span class="comment">// Fill in dummy atoms if some have been skipped</span></div>
<div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;    <span class="keywordflow">if</span> (atoms[i] != prevAtomID + 1) {</div>
<div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;      dummyAtoms = atoms[i] - prevAtomID - 1;</div>
<div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;      dummyID = prevAtomID;</div>
<div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;      <span class="comment">// Loop to write out dummy atoms</span></div>
<div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; dummyAtoms; j++) {</div>
<div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;        dummyID++;</div>
<div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;        jatom = dummyID - 1;</div>
<div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;        <span class="comment">// 1 molecule-tag atom-type q x y z</span></div>
<div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;        outputFile &lt;&lt; dummyID &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; yCloud-&gt;pts[jatom].molID &lt;&lt; <span class="stringliteral">&quot; 2 0 &quot;</span></div>
<div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;                   &lt;&lt; yCloud-&gt;pts[jatom].x &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; yCloud-&gt;pts[jatom].y &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;                   &lt;&lt; yCloud-&gt;pts[jatom].z &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;      } <span class="comment">// end of dummy atom write-out</span></div>
<div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;    }   <span class="comment">// end of check for dummy atom printing</span></div>
<div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;    <span class="comment">// -----------</span></div>
<div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;    <span class="comment">// Write out coordinates</span></div>
<div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;    <span class="comment">// 1 molecule-tag atom-type q x y z</span></div>
<div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;    outputFile &lt;&lt; atoms[i] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; yCloud-&gt;pts[iatom].molID &lt;&lt; <span class="stringliteral">&quot; 1 0 &quot;</span></div>
<div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;               &lt;&lt; yCloud-&gt;pts[iatom].x &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; yCloud-&gt;pts[iatom].y &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;               &lt;&lt; yCloud-&gt;pts[iatom].z &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;    <span class="comment">// update the previous atom ID</span></div>
<div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;    prevAtomID = atoms[i];</div>
<div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;  } <span class="comment">// end of loop through all atoms in atomID</span></div>
<div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160; </div>
<div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;  <span class="comment">// Fill in the rest of the dummy atoms</span></div>
<div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;  <span class="keywordflow">if</span> (atoms[atoms.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/size.html">size</a>() - 1] != yCloud-&gt;nop) {</div>
<div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <span class="keywordtype">id</span> = atoms[atoms.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/size.html">size</a>() - 1] + 1; id &lt;= yCloud-&gt;nop; <span class="keywordtype">id</span>++) {</div>
<div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;      jatom = <span class="keywordtype">id</span> - 1;</div>
<div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;      outputFile &lt;&lt; <span class="keywordtype">id</span> &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; yCloud-&gt;pts[jatom].molID &lt;&lt; <span class="stringliteral">&quot; 2 0 &quot;</span></div>
<div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;                 &lt;&lt; yCloud-&gt;pts[jatom].x &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; yCloud-&gt;pts[jatom].y &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;                 &lt;&lt; yCloud-&gt;pts[jatom].z &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;    } <span class="comment">// end of printing out dummy atoms</span></div>
<div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;  }</div>
<div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160; </div>
<div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;  <span class="comment">// Print the bonds now!</span></div>
<div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;  outputFile &lt;&lt; <span class="stringliteral">&quot;\nBonds\n\n&quot;</span>;</div>
<div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;  <span class="comment">// Loop through all bonds</span></div>
<div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ibond = 0; ibond &lt; bonds.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/size.html">size</a>(); ibond++) {</div>
<div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;    <span class="comment">// Init</span></div>
<div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;    isPrismBond = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;    atomOne = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;    atomTwo = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;    <span class="comment">// --------</span></div>
<div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;    <span class="comment">// Check if the bond is in the prism or not</span></div>
<div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;    <span class="keyword">auto</span> it = <a class="codeRef" href="http://en.cppreference.com/w/cpp/algorithm/find.html">std::find</a>(atoms.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/begin.html">begin</a>() + 1, atoms.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/end.html">end</a>(), bonds[ibond][0]);</div>
<div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;    <span class="keywordflow">if</span> (it != atoms.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/end.html">end</a>()) {</div>
<div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;      atomOne = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (bonds[ibond][0] == atoms[0]) {</div>
<div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;      atomOne = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (bonds[ibond][0] == atoms[atoms.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/size.html">size</a>() - 1]) {</div>
<div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;      atomOne = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;    }</div>
<div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160; </div>
<div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;    <span class="keyword">auto</span> it1 = <a class="codeRef" href="http://en.cppreference.com/w/cpp/algorithm/find.html">std::find</a>(atoms.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/begin.html">begin</a>() + 1, atoms.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/end.html">end</a>(), bonds[ibond][1]);</div>
<div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;    <span class="keywordflow">if</span> (it1 != atoms.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/end.html">end</a>()) {</div>
<div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;      atomTwo = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (bonds[ibond][1] == atoms[0]) {</div>
<div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;      atomTwo = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (bonds[ibond][1] == atoms[atoms.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/size.html">size</a>() - 1]) {</div>
<div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;      atomTwo = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;    }</div>
<div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160; </div>
<div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;    <span class="keywordflow">if</span> (atomOne == <span class="keyword">false</span> || atomTwo == <span class="keyword">false</span>) {</div>
<div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;      isPrismBond = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;      isPrismBond = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;    }</div>
<div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;    <span class="comment">// --------</span></div>
<div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;    <span class="keywordflow">if</span> (isPrismBond) {</div>
<div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;      <span class="comment">// is inside the prism (type 1)</span></div>
<div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;      outputFile &lt;&lt; ibond + 1 &lt;&lt; <span class="stringliteral">&quot; 1 &quot;</span> &lt;&lt; bonds[ibond][0] &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;                 &lt;&lt; bonds[ibond][1] &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;      <span class="comment">// not inside the prism (type 2)</span></div>
<div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;      outputFile &lt;&lt; ibond + 1 &lt;&lt; <span class="stringliteral">&quot; 2 &quot;</span> &lt;&lt; bonds[ibond][0] &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;                 &lt;&lt; bonds[ibond][1] &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;    }</div>
<div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160; </div>
<div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;  } <span class="comment">// end of for loop for bonds</span></div>
<div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160; </div>
<div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;  outputFile.<a class="codeRef" href="http://en.cppreference.com/w/cpp/io/basic_ofstream/close.html">close</a>();</div>
<div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;  <span class="comment">// Once the datafile has been printed, exit</span></div>
<div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;  <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;}</div>
<div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160; </div>
<div class="line"><a name="l02023"></a><span class="lineno"><a class="line" href="namespacesout.html#a4cad3c06043b96b56ad95c8bf30c74d2"> 2023</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="namespacesout.html#a4cad3c06043b96b56ad95c8bf30c74d2">sout::writeLAMMPSdataCages</a>(</div>
<div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;    <a class="code" href="structmolSys_1_1PointCloud.html">molSys::PointCloud</a>&lt;<a class="code" href="structmolSys_1_1Point.html">molSys::Point&lt;double&gt;</a>, <span class="keywordtype">double</span>&gt; *yCloud,</div>
<div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;    <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt;<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a>&gt; rings, <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;cage::Cage&gt;</a> *cageList,</div>
<div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;    <a class="code" href="group__cage.html#ga5787314f51b5927c213db48b81c21d95">cage::cageType</a> type, <span class="keywordtype">int</span> numCages, <a class="codeRef" href="http://en.cppreference.com/w/cpp/string/basic_string.html">std::string</a> filename) {</div>
<div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/io/basic_ofstream.html">std::ofstream</a> outputFile;</div>
<div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a> atoms;         <span class="comment">// Holds all atom IDs to print</span></div>
<div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;  <span class="keywordtype">int</span> ringSize = rings[0].<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/size.html">size</a>(); <span class="comment">// Ring size of each ring in rings</span></div>
<div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;  <span class="keywordtype">int</span> iatom;                      <span class="comment">// Index, not atom ID</span></div>
<div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;  <span class="keywordtype">bool</span> padAtoms = <span class="keyword">false</span>;          <span class="comment">// Add extra atoms if the atom IDs are skipped</span></div>
<div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;  <span class="keywordtype">int</span> prevAtomID = 0;             <span class="comment">// Check for previous atom ID</span></div>
<div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;  <span class="keywordtype">int</span> dummyAtoms = 0;             <span class="comment">// Number of dummy atoms to fill</span></div>
<div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;  <span class="keywordtype">int</span> dummyID;</div>
<div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;  <span class="keywordtype">int</span> iring; <span class="comment">// Current ring index (vector index)</span></div>
<div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;  <span class="keywordtype">int</span> jatom; <span class="comment">// Array index is 1 less than the ID (index for dummy atom)</span></div>
<div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;  <span class="keywordtype">int</span> bondTypes = 1;</div>
<div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/string/basic_string.html">std::string</a> actualCageType; <span class="comment">// The actual name of the cage types</span></div>
<div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;  <span class="comment">// Bond stuff</span></div>
<div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;std::vector&lt;int&gt;</a>&gt; bonds; <span class="comment">// Vector of vector, with each row</span></div>
<div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;                                       <span class="comment">// containing the atom IDs of each bond</span></div>
<div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;  <span class="keywordtype">int</span> nRings = 0;                      <span class="comment">// Number of rings</span></div>
<div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160; </div>
<div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;  <span class="comment">// ----------------</span></div>
<div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;  <span class="comment">// Return if there are no cages at all</span></div>
<div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;  <span class="keywordflow">if</span> ((*cageList).size() == 0) {</div>
<div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;    <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;  }</div>
<div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160; </div>
<div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;  <span class="comment">// Return if there are no cages of the required type</span></div>
<div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;  <span class="keywordflow">if</span> (numCages == 0) {</div>
<div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;    <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;  }</div>
<div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;  <span class="comment">// ---------------</span></div>
<div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;  <span class="comment">// Get the bonds</span></div>
<div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;  bonds = <a class="code" href="group__bond.html#gaea75576194f28a141cee66548c309e1a">bond::createBondsFromCages</a>(rings, cageList, type, &amp;nRings);</div>
<div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;  <span class="comment">// ----------------</span></div>
<div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;  <span class="comment">// Otherwise create file</span></div>
<div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;  <span class="comment">// Create output dir if it doesn&#39;t exist already</span></div>
<div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span> *path = <span class="stringliteral">&quot;../output&quot;</span>; <span class="comment">// relative to the build directory</span></div>
<div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;  fs::path dir(path);</div>
<div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;  <span class="comment">// if (fs::create_directory(dir)) {</span></div>
<div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;  <span class="comment">//   std::cerr &lt;&lt; &quot;Output directory created\n&quot;;</span></div>
<div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;  <span class="comment">// }</span></div>
<div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;  <span class="comment">// ----------------</span></div>
<div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;  <span class="comment">// Get all the unique atomIDs of the atoms in the rings of this type</span></div>
<div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;  <span class="comment">// Put all atom IDs into one 1-D vector</span></div>
<div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;  <span class="keywordtype">size_t</span> total_size{0};</div>
<div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;  <span class="comment">// Get the total number of atoms (repeated)</span></div>
<div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;  total_size = nRings * ringSize;</div>
<div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;  <span class="comment">// Reserve this size inside atoms</span></div>
<div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;  atoms.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/reserve.html">reserve</a>(total_size);</div>
<div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;  <span class="comment">// Fill up all these atom IDs</span></div>
<div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;  <span class="comment">// Loop through every cage in cageList</span></div>
<div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> icage = 0; icage &lt; (*cageList).size(); icage++) {</div>
<div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;    <span class="comment">// Skip if the cage is of a different type</span></div>
<div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;    <span class="keywordflow">if</span> ((*cageList)[icage].type != type) {</div>
<div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;    }</div>
<div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;    <span class="comment">// Loop through every ring inside Cage</span></div>
<div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; (*cageList)[icage].rings.size(); k++) {</div>
<div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;      iring = (*cageList)[icage].rings[k]; <span class="comment">// Current ring index</span></div>
<div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;      <a class="codeRef" href="http://en.cppreference.com/w/cpp/utility/move.html">std::move</a>(rings[iring].begin(), rings[iring].end(),</div>
<div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;                <a class="codeRef" href="http://en.cppreference.com/w/cpp/iterator/back_inserter.html">std::back_inserter</a>(atoms));</div>
<div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;    } <span class="comment">// end of loop through every ring in icage</span></div>
<div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160; </div>
<div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;  } <span class="comment">// end of loop through all cages in cageList</span></div>
<div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160; </div>
<div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;  <span class="comment">// Sort the array according to atom ID, which will be needed to get the</span></div>
<div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;  <span class="comment">// unique IDs and to remove duplicates</span></div>
<div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;  sort(atoms.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/begin.html">begin</a>(), atoms.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/end.html">end</a>());</div>
<div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;  <span class="comment">// Get the unique atom IDs</span></div>
<div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;  <span class="keyword">auto</span> ip = <a class="codeRef" href="http://en.cppreference.com/w/cpp/algorithm/unique.html">std::unique</a>(atoms.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/begin.html">begin</a>(), atoms.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/end.html">end</a>());</div>
<div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;  <span class="comment">// Resize the vector to remove undefined terms</span></div>
<div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;  atoms.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/resize.html">resize</a>(<a class="codeRef" href="http://en.cppreference.com/w/cpp/iterator/distance.html">std::distance</a>(atoms.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/begin.html">begin</a>(), ip));</div>
<div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;  <span class="comment">// If the number of atoms is less than the total nop, add dummy atoms</span></div>
<div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;  <span class="keywordflow">if</span> (atoms.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/size.html">size</a>() != yCloud-&gt;nop) {</div>
<div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;    padAtoms = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;    bondTypes = 1;</div>
<div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;  }</div>
<div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;  <span class="comment">// ----------------</span></div>
<div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;  <span class="comment">// Write output to file inside the output directory</span></div>
<div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160;  outputFile.<a class="codeRef" href="http://en.cppreference.com/w/cpp/io/basic_ofstream/open.html">open</a>(<span class="stringliteral">&quot;../output/&quot;</span> + filename);</div>
<div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;  <span class="comment">// FORMAT:</span></div>
<div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;  <span class="comment">//  Comment Line</span></div>
<div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;  <span class="comment">//  4 atoms</span></div>
<div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;  <span class="comment">//  4 bonds</span></div>
<div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;  <span class="comment">//  0 angles</span></div>
<div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;  <span class="comment">//  0 dihedrals</span></div>
<div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;  <span class="comment">//  0 impropers</span></div>
<div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;  <span class="comment">//  1 atom types</span></div>
<div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;  <span class="comment">//  1 bond types</span></div>
<div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;  <span class="comment">//  0 angle types</span></div>
<div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;  <span class="comment">//  0 dihedral types</span></div>
<div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;  <span class="comment">//  0 improper types</span></div>
<div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;  <span class="comment">//  -1.124000 52.845002  xlo xhi</span></div>
<div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160;  <span class="comment">//  0.000000 54.528999  ylo yhi</span></div>
<div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;  <span class="comment">//  1.830501 53.087501  zlo zhi</span></div>
<div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160; </div>
<div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;  <span class="comment">//  Masses</span></div>
<div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160; </div>
<div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;  <span class="comment">//  1 15.999400 # O</span></div>
<div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160; </div>
<div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;  <span class="comment">//  Atoms</span></div>
<div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160; </div>
<div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;  <span class="comment">// 1 1 1 0 20.239  1.298 6.873 # O</span></div>
<div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;  <span class="comment">// 2 1 1 0 0 5.193 6.873 # O</span></div>
<div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;  <span class="comment">// 3 1 1 0 2.249 1.298 6.873 # O</span></div>
<div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160; </div>
<div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;  <span class="comment">// -------</span></div>
<div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;  <span class="comment">// Write the header</span></div>
<div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;  <span class="comment">// Write comment line</span></div>
<div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;  outputFile &lt;&lt; <span class="stringliteral">&quot;Written out by D-SEAMS\n&quot;</span>;</div>
<div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;  <span class="comment">// Write out the number of atoms</span></div>
<div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;  outputFile &lt;&lt; yCloud-&gt;pts.size() &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;             &lt;&lt; <span class="stringliteral">&quot;atoms&quot;</span></div>
<div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;             &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;  <span class="comment">// Number of bonds</span></div>
<div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160;  outputFile &lt;&lt; bonds.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/size.html">size</a>() &lt;&lt; <span class="stringliteral">&quot; bonds&quot;</span></div>
<div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;             &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;  outputFile &lt;&lt; <span class="stringliteral">&quot;0 angles\n0 dihedrals\n0 impropers\n&quot;</span>;</div>
<div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;  <span class="comment">// If padded atoms are required, two atom types will be required</span></div>
<div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;  <span class="keywordflow">if</span> (padAtoms) {</div>
<div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160;    outputFile &lt;&lt; <span class="stringliteral">&quot;2 atom types\n&quot;</span>;</div>
<div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160;    outputFile &lt;&lt; <span class="stringliteral">&quot;1 atom types\n&quot;</span>;</div>
<div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;  } <span class="comment">// end of atom types</span></div>
<div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;  outputFile</div>
<div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;      &lt;&lt; bondTypes</div>
<div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160;      &lt;&lt; <span class="stringliteral">&quot; bond types\n0 angle types\n0 dihedral types\n0 improper types\n&quot;</span>;</div>
<div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;  <span class="comment">// Box lengths</span></div>
<div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;  outputFile &lt;&lt; <span class="stringliteral">&quot;0 &quot;</span> &lt;&lt; yCloud-&gt;box[0] &lt;&lt; <span class="stringliteral">&quot; xlo xhi\n&quot;</span>;</div>
<div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;  outputFile &lt;&lt; <span class="stringliteral">&quot;0 &quot;</span> &lt;&lt; yCloud-&gt;box[1] &lt;&lt; <span class="stringliteral">&quot; ylo yhi\n&quot;</span>;</div>
<div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;  outputFile &lt;&lt; <span class="stringliteral">&quot;0 &quot;</span> &lt;&lt; yCloud-&gt;box[2] &lt;&lt; <span class="stringliteral">&quot; zlo zhi\n&quot;</span>;</div>
<div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;  <span class="comment">// Masses</span></div>
<div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;  outputFile &lt;&lt; <span class="stringliteral">&quot;\nMasses\n\n&quot;</span>;</div>
<div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;  <span class="comment">// For DDCs and HCs</span></div>
<div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;  <span class="keywordflow">if</span> (type == <a class="code" href="group__cage.html#gga5787314f51b5927c213db48b81c21d95a0ff989d0b3eed06750ff06c8bc95c84d">cage::HexC</a>) {</div>
<div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;    actualCageType = <span class="stringliteral">&quot;HC&quot;</span>;</div>
<div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (type == <a class="code" href="group__cage.html#gga5787314f51b5927c213db48b81c21d95ac5a9e4f20bab07bef66bb6e15c49682d">cage::DoubleDiaC</a>) {</div>
<div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;    actualCageType = <span class="stringliteral">&quot;DDC&quot;</span>;</div>
<div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160;    actualCageType = <span class="stringliteral">&quot;error&quot;</span>;</div>
<div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;  }</div>
<div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;  outputFile &lt;&lt; <span class="stringliteral">&quot;1 15.999400 # &quot;</span> &lt;&lt; actualCageType &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;  <span class="keywordflow">if</span> (padAtoms) {</div>
<div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;    outputFile &lt;&lt; <span class="stringliteral">&quot;2 1.0 # dummy\n&quot;</span>;</div>
<div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;  }</div>
<div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;  <span class="comment">// Atoms</span></div>
<div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;  outputFile &lt;&lt; <span class="stringliteral">&quot;\nAtoms\n\n&quot;</span>;</div>
<div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;  <span class="comment">// -------</span></div>
<div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;  <span class="comment">// Write out the atom coordinates</span></div>
<div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;  <span class="comment">// Loop through atoms</span></div>
<div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; atoms.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/size.html">size</a>(); i++) {</div>
<div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;    iatom = atoms[i] - 1; <span class="comment">// The actual index is one less than the ID</span></div>
<div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;    <span class="comment">// -----------</span></div>
<div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160;    <span class="comment">// Pad out</span></div>
<div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;    <span class="comment">// Fill in dummy atoms if some have been skipped</span></div>
<div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;    <span class="keywordflow">if</span> (atoms[i] != prevAtomID + 1) {</div>
<div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;      dummyAtoms = atoms[i] - prevAtomID - 1;</div>
<div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;      dummyID = prevAtomID;</div>
<div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160;      <span class="comment">// Loop to write out dummy atoms</span></div>
<div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; dummyAtoms; j++) {</div>
<div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;        dummyID++;</div>
<div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;        jatom = dummyID - 1;</div>
<div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;        <span class="comment">// 1 molecule-tag atom-type q x y z</span></div>
<div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;        outputFile &lt;&lt; dummyID &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; yCloud-&gt;pts[jatom].molID &lt;&lt; <span class="stringliteral">&quot; 2 0 &quot;</span></div>
<div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;                   &lt;&lt; yCloud-&gt;pts[jatom].x &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; yCloud-&gt;pts[jatom].y &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;                   &lt;&lt; yCloud-&gt;pts[jatom].z &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;      } <span class="comment">// end of dummy atom write-out</span></div>
<div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;    }   <span class="comment">// end of check for dummy atom printing</span></div>
<div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;    <span class="comment">// -----------</span></div>
<div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;    <span class="comment">// Write out coordinates</span></div>
<div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;    <span class="comment">// 1 molecule-tag atom-type q x y z</span></div>
<div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;    outputFile &lt;&lt; atoms[i] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; yCloud-&gt;pts[iatom].molID &lt;&lt; <span class="stringliteral">&quot; 1 0 &quot;</span></div>
<div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;               &lt;&lt; yCloud-&gt;pts[iatom].x &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; yCloud-&gt;pts[iatom].y &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;               &lt;&lt; yCloud-&gt;pts[iatom].z &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;    <span class="comment">// update the previous atom ID</span></div>
<div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;    prevAtomID = atoms[i];</div>
<div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;  } <span class="comment">// end of loop through all atoms in atomID</span></div>
<div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160; </div>
<div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;  <span class="comment">// Fill in the rest of the dummy atoms</span></div>
<div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;  <span class="keywordflow">if</span> (atoms[atoms.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/size.html">size</a>() - 1] != yCloud-&gt;nop) {</div>
<div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <span class="keywordtype">id</span> = atoms[atoms.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/size.html">size</a>() - 1] + 1; id &lt;= yCloud-&gt;nop; <span class="keywordtype">id</span>++) {</div>
<div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160;      jatom = <span class="keywordtype">id</span> - 1;</div>
<div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160;      outputFile &lt;&lt; <span class="keywordtype">id</span> &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; yCloud-&gt;pts[jatom].molID &lt;&lt; <span class="stringliteral">&quot; 2 0 &quot;</span></div>
<div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160;                 &lt;&lt; yCloud-&gt;pts[jatom].x &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; yCloud-&gt;pts[jatom].y &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160;                 &lt;&lt; yCloud-&gt;pts[jatom].z &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160;    } <span class="comment">// end of printing out dummy atoms</span></div>
<div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;  }</div>
<div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160; </div>
<div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160;  <span class="comment">// Print the bonds now!</span></div>
<div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;  outputFile &lt;&lt; <span class="stringliteral">&quot;\nBonds\n\n&quot;</span>;</div>
<div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160;  <span class="comment">// Loop through all bonds</span></div>
<div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ibond = 0; ibond &lt; bonds.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/size.html">size</a>(); ibond++) {</div>
<div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160;    <span class="comment">// write out the bond</span></div>
<div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160;    outputFile &lt;&lt; ibond + 1 &lt;&lt; <span class="stringliteral">&quot; 1 &quot;</span> &lt;&lt; bonds[ibond][0] &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160;               &lt;&lt; bonds[ibond][1] &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160; </div>
<div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160;  } <span class="comment">// end of for loop for bonds</span></div>
<div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160; </div>
<div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;  outputFile.<a class="codeRef" href="http://en.cppreference.com/w/cpp/io/basic_ofstream/close.html">close</a>();</div>
<div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160;  <span class="comment">// Once the datafile has been printed, exit</span></div>
<div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160;  <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;}</div>
<div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160; </div>
<div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;<span class="comment">// Legacy</span></div>
<div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160; </div>
<div class="line"><a name="l02235"></a><span class="lineno"><a class="line" href="namespacesout.html#a6d957535efb45598e954f073d95e4d31"> 2235</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="namespacesout.html#a6d957535efb45598e954f073d95e4d31">sout::writeDump</a>(<a class="code" href="structmolSys_1_1PointCloud.html">molSys::PointCloud</a>&lt;<a class="code" href="structmolSys_1_1Point.html">molSys::Point&lt;double&gt;</a>, <span class="keywordtype">double</span>&gt; *yCloud,</div>
<div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;                    <a class="codeRef" href="http://en.cppreference.com/w/cpp/string/basic_string.html">std::string</a> path, <a class="codeRef" href="http://en.cppreference.com/w/cpp/string/basic_string.html">std::string</a> outFile) {</div>
<div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/io/basic_ofstream.html">std::ofstream</a> outputFile;</div>
<div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160;  <span class="comment">// ----------------</span></div>
<div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160;  <span class="comment">// Make the output directory if it doesn&#39;t exist</span></div>
<div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;  <a class="code" href="namespacesout.html#a3985775f30d7920fbf13f12386abefc1">sout::makePath</a>(path);</div>
<div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160;  <span class="comment">// ----------------</span></div>
<div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160;  <span class="comment">// Create a new file in the output directory</span></div>
<div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160;  outputFile.<a class="codeRef" href="http://en.cppreference.com/w/cpp/io/basic_ofstream/open.html">open</a>(path + outFile, std::ios_base::app);</div>
<div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160; </div>
<div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160;  <span class="comment">// Append stuff</span></div>
<div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160;  <span class="comment">// -----------------------</span></div>
<div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160;  <span class="comment">// Header</span></div>
<div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160; </div>
<div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160;  <span class="comment">// The format of the LAMMPS trajectory file is:</span></div>
<div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;  <span class="comment">// ITEM: TIMESTEP</span></div>
<div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;  <span class="comment">// 0</span></div>
<div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160;  <span class="comment">// ITEM: NUMBER OF ATOMS</span></div>
<div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;  <span class="comment">// 4096</span></div>
<div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160;  <span class="comment">// ITEM: BOX BOUNDS pp pp pp</span></div>
<div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160;  <span class="comment">// -7.9599900000000001e-01 5.0164000000000001e+01</span></div>
<div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160;  <span class="comment">// -7.9599900000000001e-01 5.0164000000000001e+01</span></div>
<div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;  <span class="comment">// -7.9599900000000001e-01 5.0164000000000001e+01</span></div>
<div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160;  <span class="comment">// ITEM: ATOMS id type x y z</span></div>
<div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;  <span class="comment">// 1 1 0 0 0 etc</span></div>
<div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160;  outputFile &lt;&lt; <span class="stringliteral">&quot;ITEM: TIMESTEP\n&quot;</span>;</div>
<div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160;  outputFile &lt;&lt; yCloud-&gt;currentFrame &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l02262"></a><span class="lineno"> 2262</span>&#160;  outputFile &lt;&lt; <span class="stringliteral">&quot;ITEM: NUMBER OF ATOMS\n&quot;</span>;</div>
<div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160;  outputFile &lt;&lt; yCloud-&gt;nop &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l02264"></a><span class="lineno"> 2264</span>&#160;  outputFile &lt;&lt; <span class="stringliteral">&quot;ITEM: BOX BOUNDS pp pp pp\n&quot;</span>;</div>
<div class="line"><a name="l02265"></a><span class="lineno"> 2265</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; yCloud-&gt;boxLow.size(); k++) {</div>
<div class="line"><a name="l02266"></a><span class="lineno"> 2266</span>&#160;    outputFile &lt;&lt; yCloud-&gt;boxLow[k] &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l02267"></a><span class="lineno"> 2267</span>&#160;               &lt;&lt; yCloud-&gt;boxLow[k] + yCloud-&gt;box[k]; <span class="comment">// print xlo xhi etc</span></div>
<div class="line"><a name="l02268"></a><span class="lineno"> 2268</span>&#160;    <span class="comment">// print out the tilt factors too if it is a triclinic box</span></div>
<div class="line"><a name="l02269"></a><span class="lineno"> 2269</span>&#160;    <span class="keywordflow">if</span> (yCloud-&gt;box.size() == 2 * yCloud-&gt;boxLow.size()) {</div>
<div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160;      outputFile &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160;                 &lt;&lt; yCloud-&gt;box[k + yCloud-&gt;boxLow.size()]; <span class="comment">// this would be +2</span></div>
<div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160;                                                            <span class="comment">// for a 2D box</span></div>
<div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160;    }</div>
<div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160;    outputFile &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>; <span class="comment">// print end of line</span></div>
<div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160;  }                     <span class="comment">// end of printing box lengths</span></div>
<div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160;  outputFile &lt;&lt; <span class="stringliteral">&quot;ITEM: ATOMS id mol type x y z\n&quot;</span>;</div>
<div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160;  <span class="comment">// -----------------------</span></div>
<div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160;  <span class="comment">// Atom lines</span></div>
<div class="line"><a name="l02279"></a><span class="lineno"> 2279</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iatom = 0; iatom &lt; yCloud-&gt;nop; iatom++) {</div>
<div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160;    outputFile &lt;&lt; yCloud-&gt;pts[iatom].atomID &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; yCloud-&gt;pts[iatom].molID;</div>
<div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160; </div>
<div class="line"><a name="l02282"></a><span class="lineno"> 2282</span>&#160;    <span class="comment">// Cubic ice</span></div>
<div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160;    <span class="keywordflow">if</span> (yCloud-&gt;pts[iatom].iceType == <a class="code" href="group__molSys.html#gga13ffe3a39a0816627553f195e102abb5a129c76a33f8ebd1a8dedd378543af193">molSys::cubic</a>) {</div>
<div class="line"><a name="l02284"></a><span class="lineno"> 2284</span>&#160;      outputFile &lt;&lt; <span class="stringliteral">&quot; Ic &quot;</span> &lt;&lt; yCloud-&gt;pts[iatom].x &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l02285"></a><span class="lineno"> 2285</span>&#160;                 &lt;&lt; yCloud-&gt;pts[iatom].y &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; yCloud-&gt;pts[iatom].z &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l02286"></a><span class="lineno"> 2286</span>&#160;    } <span class="comment">// end of cubic ice</span></div>
<div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160;    <span class="comment">// Hexagonal ice</span></div>
<div class="line"><a name="l02288"></a><span class="lineno"> 2288</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (yCloud-&gt;pts[iatom].iceType == <a class="code" href="group__molSys.html#gga13ffe3a39a0816627553f195e102abb5a22e673e9b130fe029c171fdf2a2e419a">molSys::hexagonal</a>) {</div>
<div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160;      outputFile &lt;&lt; <span class="stringliteral">&quot; Ih &quot;</span> &lt;&lt; yCloud-&gt;pts[iatom].x &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160;                 &lt;&lt; yCloud-&gt;pts[iatom].y &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; yCloud-&gt;pts[iatom].z &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160;    } <span class="comment">// end hexagonal ice</span></div>
<div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160;    <span class="comment">// water</span></div>
<div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (yCloud-&gt;pts[iatom].iceType == <a class="code" href="group__molSys.html#gga13ffe3a39a0816627553f195e102abb5aa701d941ff4dc44b45faa7fd0e1f163f">molSys::water</a>) {</div>
<div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160;      outputFile &lt;&lt; <span class="stringliteral">&quot; wat &quot;</span> &lt;&lt; yCloud-&gt;pts[iatom].x &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160;                 &lt;&lt; yCloud-&gt;pts[iatom].y &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; yCloud-&gt;pts[iatom].z &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l02296"></a><span class="lineno"> 2296</span>&#160;    } <span class="comment">// end water</span></div>
<div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160;    <span class="comment">// interfacial</span></div>
<div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (yCloud-&gt;pts[iatom].iceType == <a class="code" href="group__molSys.html#gga13ffe3a39a0816627553f195e102abb5a2a1eeeb73264d00a89f53b3ec3544b2c">molSys::interfacial</a>) {</div>
<div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;      outputFile &lt;&lt; <span class="stringliteral">&quot; intFc &quot;</span> &lt;&lt; yCloud-&gt;pts[iatom].x &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160;                 &lt;&lt; yCloud-&gt;pts[iatom].y &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; yCloud-&gt;pts[iatom].z &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160;    } <span class="comment">// end interfacial</span></div>
<div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160;    <span class="comment">// clathrate</span></div>
<div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (yCloud-&gt;pts[iatom].iceType == <a class="code" href="group__molSys.html#gga13ffe3a39a0816627553f195e102abb5a9e48b0390667a2a6606fb9bd47752ebd">molSys::clathrate</a>) {</div>
<div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160;      outputFile &lt;&lt; <span class="stringliteral">&quot; clathrate &quot;</span> &lt;&lt; yCloud-&gt;pts[iatom].x &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160;                 &lt;&lt; yCloud-&gt;pts[iatom].y &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; yCloud-&gt;pts[iatom].z &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160;    } <span class="comment">// end clathrate</span></div>
<div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160;    <span class="comment">// interClathrate</span></div>
<div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (yCloud-&gt;pts[iatom].iceType == <a class="code" href="group__molSys.html#gga13ffe3a39a0816627553f195e102abb5a2307822a42416cc62fcbd5afe887491f">molSys::interClathrate</a>) {</div>
<div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160;      outputFile &lt;&lt; <span class="stringliteral">&quot; interClathrate &quot;</span> &lt;&lt; yCloud-&gt;pts[iatom].x &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l02310"></a><span class="lineno"> 2310</span>&#160;                 &lt;&lt; yCloud-&gt;pts[iatom].y &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; yCloud-&gt;pts[iatom].z &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l02311"></a><span class="lineno"> 2311</span>&#160;    } <span class="comment">// end interClathrate</span></div>
<div class="line"><a name="l02312"></a><span class="lineno"> 2312</span>&#160;    <span class="comment">// unclassified</span></div>
<div class="line"><a name="l02313"></a><span class="lineno"> 2313</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (yCloud-&gt;pts[iatom].iceType == <a class="code" href="group__molSys.html#gga13ffe3a39a0816627553f195e102abb5ad19ecf271dba48ef8dd8175326f669b4">molSys::unclassified</a>) {</div>
<div class="line"><a name="l02314"></a><span class="lineno"> 2314</span>&#160;      outputFile &lt;&lt; <span class="stringliteral">&quot; unclassified &quot;</span> &lt;&lt; yCloud-&gt;pts[iatom].x &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l02315"></a><span class="lineno"> 2315</span>&#160;                 &lt;&lt; yCloud-&gt;pts[iatom].y &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; yCloud-&gt;pts[iatom].z &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l02316"></a><span class="lineno"> 2316</span>&#160;    } <span class="comment">// end unclassified</span></div>
<div class="line"><a name="l02317"></a><span class="lineno"> 2317</span>&#160;    <span class="comment">// reCubic</span></div>
<div class="line"><a name="l02318"></a><span class="lineno"> 2318</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (yCloud-&gt;pts[iatom].iceType == <a class="code" href="group__molSys.html#gga13ffe3a39a0816627553f195e102abb5a5300236c5e45c59840b336b4e735fa0a">molSys::reCubic</a>) {</div>
<div class="line"><a name="l02319"></a><span class="lineno"> 2319</span>&#160;      outputFile &lt;&lt; <span class="stringliteral">&quot; reIc &quot;</span> &lt;&lt; yCloud-&gt;pts[iatom].x &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l02320"></a><span class="lineno"> 2320</span>&#160;                 &lt;&lt; yCloud-&gt;pts[iatom].y &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; yCloud-&gt;pts[iatom].z &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160;    } <span class="comment">// end reCubic</span></div>
<div class="line"><a name="l02322"></a><span class="lineno"> 2322</span>&#160;    <span class="comment">// reHexagonal</span></div>
<div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02324"></a><span class="lineno"> 2324</span>&#160;      outputFile &lt;&lt; <span class="stringliteral">&quot; reIh &quot;</span> &lt;&lt; yCloud-&gt;pts[iatom].x &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160;                 &lt;&lt; yCloud-&gt;pts[iatom].y &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; yCloud-&gt;pts[iatom].z &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160;    } <span class="comment">// end reHex</span></div>
<div class="line"><a name="l02327"></a><span class="lineno"> 2327</span>&#160; </div>
<div class="line"><a name="l02328"></a><span class="lineno"> 2328</span>&#160;  } <span class="comment">// end of loop through all atoms</span></div>
<div class="line"><a name="l02329"></a><span class="lineno"> 2329</span>&#160; </div>
<div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160;  <span class="comment">// Close the file</span></div>
<div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160;  outputFile.<a class="codeRef" href="http://en.cppreference.com/w/cpp/io/basic_ofstream/close.html">close</a>();</div>
<div class="line"><a name="l02332"></a><span class="lineno"> 2332</span>&#160;  <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l02333"></a><span class="lineno"> 2333</span>&#160;}</div>
<div class="line"><a name="l02334"></a><span class="lineno"> 2334</span>&#160; </div>
<div class="line"><a name="l02339"></a><span class="lineno"><a class="line" href="namespacesout.html#af815e27a565e45396f0f4315c49a354c"> 2339</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="namespacesout.html#af815e27a565e45396f0f4315c49a354c">sout::writeHisto</a>(<a class="code" href="structmolSys_1_1PointCloud.html">molSys::PointCloud</a>&lt;<a class="code" href="structmolSys_1_1Point.html">molSys::Point&lt;double&gt;</a>, <span class="keywordtype">double</span>&gt; *yCloud,</div>
<div class="line"><a name="l02340"></a><span class="lineno"> 2340</span>&#160;                     <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt;<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a>&gt; nList,</div>
<div class="line"><a name="l02341"></a><span class="lineno"> 2341</span>&#160;                     <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;double&gt;</a> avgQ6) {</div>
<div class="line"><a name="l02342"></a><span class="lineno"> 2342</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/io/basic_ofstream.html">std::ofstream</a> cijFile;</div>
<div class="line"><a name="l02343"></a><span class="lineno"> 2343</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/io/basic_ofstream.html">std::ofstream</a> q3File;</div>
<div class="line"><a name="l02344"></a><span class="lineno"> 2344</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/io/basic_ofstream.html">std::ofstream</a> q6File;</div>
<div class="line"><a name="l02345"></a><span class="lineno"> 2345</span>&#160;  <span class="comment">// Create a new file in the output directory</span></div>
<div class="line"><a name="l02346"></a><span class="lineno"> 2346</span>&#160;  <span class="keywordtype">int</span> nNumNeighbours;</div>
<div class="line"><a name="l02347"></a><span class="lineno"> 2347</span>&#160;  <span class="keywordtype">double</span> avgQ3;</div>
<div class="line"><a name="l02348"></a><span class="lineno"> 2348</span>&#160; </div>
<div class="line"><a name="l02349"></a><span class="lineno"> 2349</span>&#160;  cijFile.<a class="codeRef" href="http://en.cppreference.com/w/cpp/io/basic_ofstream/open.html">open</a>(<span class="stringliteral">&quot;cij.txt&quot;</span>, std::ofstream::out | std::ofstream::app);</div>
<div class="line"><a name="l02350"></a><span class="lineno"> 2350</span>&#160;  q3File.<a class="codeRef" href="http://en.cppreference.com/w/cpp/io/basic_ofstream/open.html">open</a>(<span class="stringliteral">&quot;q3.txt&quot;</span>, std::ofstream::out | std::ofstream::app);</div>
<div class="line"><a name="l02351"></a><span class="lineno"> 2351</span>&#160;  q6File.<a class="codeRef" href="http://en.cppreference.com/w/cpp/io/basic_ofstream/open.html">open</a>(<span class="stringliteral">&quot;q6.txt&quot;</span>, std::ofstream::out | std::ofstream::app);</div>
<div class="line"><a name="l02352"></a><span class="lineno"> 2352</span>&#160; </div>
<div class="line"><a name="l02353"></a><span class="lineno"> 2353</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iatom = 0; iatom &lt; yCloud-&gt;nop; iatom++) {</div>
<div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160;    <span class="keywordflow">if</span> (yCloud-&gt;pts[iatom].type != 1) {</div>
<div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160;    }</div>
<div class="line"><a name="l02357"></a><span class="lineno"> 2357</span>&#160;    <span class="comment">// Check for slice later</span></div>
<div class="line"><a name="l02358"></a><span class="lineno"> 2358</span>&#160;    nNumNeighbours = nList[iatom].size() - 1;</div>
<div class="line"><a name="l02359"></a><span class="lineno"> 2359</span>&#160;    avgQ3 = 0.0;</div>
<div class="line"><a name="l02360"></a><span class="lineno"> 2360</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; nNumNeighbours; j++) {</div>
<div class="line"><a name="l02361"></a><span class="lineno"> 2361</span>&#160;      cijFile &lt;&lt; yCloud-&gt;pts[iatom].c_ij[j].c_value &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l02362"></a><span class="lineno"> 2362</span>&#160;      avgQ3 += yCloud-&gt;pts[iatom].c_ij[j].c_value;</div>
<div class="line"><a name="l02363"></a><span class="lineno"> 2363</span>&#160;    } <span class="comment">// Loop through neighbours</span></div>
<div class="line"><a name="l02364"></a><span class="lineno"> 2364</span>&#160;    avgQ3 /= nNumNeighbours;</div>
<div class="line"><a name="l02365"></a><span class="lineno"> 2365</span>&#160;    q3File &lt;&lt; avgQ3 &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l02366"></a><span class="lineno"> 2366</span>&#160;    q6File &lt;&lt; avgQ6[iatom] &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l02367"></a><span class="lineno"> 2367</span>&#160;  } <span class="comment">// loop through all atoms</span></div>
<div class="line"><a name="l02368"></a><span class="lineno"> 2368</span>&#160; </div>
<div class="line"><a name="l02369"></a><span class="lineno"> 2369</span>&#160;  <span class="comment">// Close the file</span></div>
<div class="line"><a name="l02370"></a><span class="lineno"> 2370</span>&#160;  cijFile.<a class="codeRef" href="http://en.cppreference.com/w/cpp/io/basic_ofstream/close.html">close</a>();</div>
<div class="line"><a name="l02371"></a><span class="lineno"> 2371</span>&#160;  q3File.<a class="codeRef" href="http://en.cppreference.com/w/cpp/io/basic_ofstream/close.html">close</a>();</div>
<div class="line"><a name="l02372"></a><span class="lineno"> 2372</span>&#160;  q6File.<a class="codeRef" href="http://en.cppreference.com/w/cpp/io/basic_ofstream/close.html">close</a>();</div>
<div class="line"><a name="l02373"></a><span class="lineno"> 2373</span>&#160; </div>
<div class="line"><a name="l02374"></a><span class="lineno"> 2374</span>&#160;  <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l02375"></a><span class="lineno"> 2375</span>&#160;}</div>
<div class="line"><a name="l02376"></a><span class="lineno"> 2376</span>&#160; </div>
<div class="line"><a name="l02380"></a><span class="lineno"><a class="line" href="namespacesout.html#ae800e10d206146b10745c20d060456f8"> 2380</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="namespacesout.html#ae800e10d206146b10745c20d060456f8">sout::writeCluster</a>(</div>
<div class="line"><a name="l02381"></a><span class="lineno"> 2381</span>&#160;    <a class="code" href="structmolSys_1_1PointCloud.html">molSys::PointCloud</a>&lt;<a class="code" href="structmolSys_1_1Point.html">molSys::Point&lt;double&gt;</a>, <span class="keywordtype">double</span>&gt; *yCloud,</div>
<div class="line"><a name="l02382"></a><span class="lineno"> 2382</span>&#160;    <a class="codeRef" href="http://en.cppreference.com/w/cpp/string/basic_string.html">std::string</a> fileName, <span class="keywordtype">bool</span> isSlice, <span class="keywordtype">int</span> <a class="code" href="group__clump.html#gad4824638fa14ec355ab99804c9119e35">largestIceCluster</a>) {</div>
<div class="line"><a name="l02383"></a><span class="lineno"> 2383</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/io/basic_ofstream.html">std::ofstream</a> clusterFile;</div>
<div class="line"><a name="l02384"></a><span class="lineno"> 2384</span>&#160;  <span class="comment">// Create a new file in the output directory</span></div>
<div class="line"><a name="l02385"></a><span class="lineno"> 2385</span>&#160;  clusterFile.<a class="codeRef" href="http://en.cppreference.com/w/cpp/io/basic_ofstream/open.html">open</a>(fileName, std::ofstream::out | std::ofstream::app);</div>
<div class="line"><a name="l02386"></a><span class="lineno"> 2386</span>&#160;  clusterFile &lt;&lt; yCloud-&gt;currentFrame &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="group__clump.html#gad4824638fa14ec355ab99804c9119e35">largestIceCluster</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l02387"></a><span class="lineno"> 2387</span>&#160;  <span class="comment">// Close the file</span></div>
<div class="line"><a name="l02388"></a><span class="lineno"> 2388</span>&#160;  clusterFile.<a class="codeRef" href="http://en.cppreference.com/w/cpp/io/basic_ofstream/close.html">close</a>();</div>
<div class="line"><a name="l02389"></a><span class="lineno"> 2389</span>&#160;  <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l02390"></a><span class="lineno"> 2390</span>&#160;}</div>
<div class="line"><a name="l02391"></a><span class="lineno"> 2391</span>&#160; </div>
<div class="line"><a name="l02397"></a><span class="lineno"><a class="line" href="namespacesout.html#aabeb7b712f568256cf3ed782fa91c518"> 2397</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="namespacesout.html#aabeb7b712f568256cf3ed782fa91c518">sout::writeLAMMPSdataTopoBulk</a>(</div>
<div class="line"><a name="l02398"></a><span class="lineno"> 2398</span>&#160;    <a class="code" href="structmolSys_1_1PointCloud.html">molSys::PointCloud</a>&lt;<a class="code" href="structmolSys_1_1Point.html">molSys::Point&lt;double&gt;</a>, <span class="keywordtype">double</span>&gt; *yCloud,</div>
<div class="line"><a name="l02399"></a><span class="lineno"> 2399</span>&#160;    <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt;<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a>&gt; nList, <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;cage::iceType&gt;</a> atomTypes,</div>
<div class="line"><a name="l02400"></a><span class="lineno"> 2400</span>&#160;    <a class="codeRef" href="http://en.cppreference.com/w/cpp/string/basic_string.html">std::string</a> path, <span class="keywordtype">bool</span> bondsBetweenDummy) {</div>
<div class="line"><a name="l02401"></a><span class="lineno"> 2401</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l02402"></a><span class="lineno"> 2402</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/io/basic_ofstream.html">std::ofstream</a> outputFile;</div>
<div class="line"><a name="l02403"></a><span class="lineno"> 2403</span>&#160;  <span class="keywordtype">int</span> iatom;            <span class="comment">// Index, not atom ID</span></div>
<div class="line"><a name="l02404"></a><span class="lineno"> 2404</span>&#160;  <span class="keywordtype">int</span> currentAtomType;  <span class="comment">// Current atom type: a value from 1 to 4</span></div>
<div class="line"><a name="l02405"></a><span class="lineno"> 2405</span>&#160;  <span class="keywordtype">int</span> numAtomTypes = 6; <span class="comment">// DDC, HC, Mixed, dummy, mixed2 and pnc</span></div>
<div class="line"><a name="l02406"></a><span class="lineno"> 2406</span>&#160;  <span class="keywordtype">int</span> bondTypes = 1;</div>
<div class="line"><a name="l02407"></a><span class="lineno"> 2407</span>&#160;  <span class="comment">// Bond stuff</span></div>
<div class="line"><a name="l02408"></a><span class="lineno"> 2408</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;std::vector&lt;int&gt;</a>&gt; bonds; <span class="comment">// Vector of vector, with each row</span></div>
<div class="line"><a name="l02409"></a><span class="lineno"> 2409</span>&#160;                                       <span class="comment">// containing the atom IDs of each bond</span></div>
<div class="line"><a name="l02410"></a><span class="lineno"> 2410</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/string/basic_string.html">std::string</a> filename =</div>
<div class="line"><a name="l02411"></a><span class="lineno"> 2411</span>&#160;      <span class="stringliteral">&quot;system-&quot;</span> + <a class="codeRef" href="http://en.cppreference.com/w/cpp/string/basic_string/to_string.html">std::to_string</a>(yCloud-&gt;currentFrame) + <span class="stringliteral">&quot;.data&quot;</span>;</div>
<div class="line"><a name="l02412"></a><span class="lineno"> 2412</span>&#160; </div>
<div class="line"><a name="l02413"></a><span class="lineno"> 2413</span>&#160;  <span class="comment">// ---------------</span></div>
<div class="line"><a name="l02414"></a><span class="lineno"> 2414</span>&#160;  <span class="comment">// Get the bonds</span></div>
<div class="line"><a name="l02415"></a><span class="lineno"> 2415</span>&#160;  <span class="keywordflow">if</span> (bondsBetweenDummy) {</div>
<div class="line"><a name="l02416"></a><span class="lineno"> 2416</span>&#160;    bonds = <a class="code" href="group__bond.html#ga99a6b8a519741c767bd8bed063276b5a">bond::populateBonds</a>(nList, yCloud);</div>
<div class="line"><a name="l02417"></a><span class="lineno"> 2417</span>&#160;  } <span class="comment">// create bonds between dummy atoms</span></div>
<div class="line"><a name="l02418"></a><span class="lineno"> 2418</span>&#160;  <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02419"></a><span class="lineno"> 2419</span>&#160;    bonds = <a class="code" href="group__bond.html#ga99a6b8a519741c767bd8bed063276b5a">bond::populateBonds</a>(nList, yCloud, atomTypes);</div>
<div class="line"><a name="l02420"></a><span class="lineno"> 2420</span>&#160;  } <span class="comment">// only create bonds between non-dummy atoms</span></div>
<div class="line"><a name="l02421"></a><span class="lineno"> 2421</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l02422"></a><span class="lineno"> 2422</span>&#160;  <span class="comment">// ----------------</span></div>
<div class="line"><a name="l02423"></a><span class="lineno"> 2423</span>&#160;  <span class="comment">// Make the output directory if it doesn&#39;t exist</span></div>
<div class="line"><a name="l02424"></a><span class="lineno"> 2424</span>&#160;  <a class="code" href="namespacesout.html#a3985775f30d7920fbf13f12386abefc1">sout::makePath</a>(path);</div>
<div class="line"><a name="l02425"></a><span class="lineno"> 2425</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/string/basic_string.html">std::string</a> outputDirName = path + <span class="stringliteral">&quot;bulkTopo&quot;</span>;</div>
<div class="line"><a name="l02426"></a><span class="lineno"> 2426</span>&#160;  <a class="code" href="namespacesout.html#a3985775f30d7920fbf13f12386abefc1">sout::makePath</a>(outputDirName);</div>
<div class="line"><a name="l02427"></a><span class="lineno"> 2427</span>&#160;  outputDirName = path + <span class="stringliteral">&quot;bulkTopo/dataFiles/&quot;</span>;</div>
<div class="line"><a name="l02428"></a><span class="lineno"> 2428</span>&#160;  <a class="code" href="namespacesout.html#a3985775f30d7920fbf13f12386abefc1">sout::makePath</a>(outputDirName);</div>
<div class="line"><a name="l02429"></a><span class="lineno"> 2429</span>&#160;  <span class="comment">// ----------------</span></div>
<div class="line"><a name="l02430"></a><span class="lineno"> 2430</span>&#160;  <span class="comment">// Write output to file inside the output directory</span></div>
<div class="line"><a name="l02431"></a><span class="lineno"> 2431</span>&#160;  outputFile.<a class="codeRef" href="http://en.cppreference.com/w/cpp/io/basic_ofstream/open.html">open</a>(path + <span class="stringliteral">&quot;bulkTopo/dataFiles/&quot;</span> + filename);</div>
<div class="line"><a name="l02432"></a><span class="lineno"> 2432</span>&#160;  <span class="comment">// FORMAT:</span></div>
<div class="line"><a name="l02433"></a><span class="lineno"> 2433</span>&#160;  <span class="comment">//  Comment Line</span></div>
<div class="line"><a name="l02434"></a><span class="lineno"> 2434</span>&#160;  <span class="comment">//  4 atoms</span></div>
<div class="line"><a name="l02435"></a><span class="lineno"> 2435</span>&#160;  <span class="comment">//  4 bonds</span></div>
<div class="line"><a name="l02436"></a><span class="lineno"> 2436</span>&#160;  <span class="comment">//  0 angles</span></div>
<div class="line"><a name="l02437"></a><span class="lineno"> 2437</span>&#160;  <span class="comment">//  0 dihedrals</span></div>
<div class="line"><a name="l02438"></a><span class="lineno"> 2438</span>&#160;  <span class="comment">//  0 impropers</span></div>
<div class="line"><a name="l02439"></a><span class="lineno"> 2439</span>&#160;  <span class="comment">//  1 atom types</span></div>
<div class="line"><a name="l02440"></a><span class="lineno"> 2440</span>&#160;  <span class="comment">//  1 bond types</span></div>
<div class="line"><a name="l02441"></a><span class="lineno"> 2441</span>&#160;  <span class="comment">//  0 angle types</span></div>
<div class="line"><a name="l02442"></a><span class="lineno"> 2442</span>&#160;  <span class="comment">//  0 dihedral types</span></div>
<div class="line"><a name="l02443"></a><span class="lineno"> 2443</span>&#160;  <span class="comment">//  0 improper types</span></div>
<div class="line"><a name="l02444"></a><span class="lineno"> 2444</span>&#160;  <span class="comment">//  -1.124000 52.845002  xlo xhi</span></div>
<div class="line"><a name="l02445"></a><span class="lineno"> 2445</span>&#160;  <span class="comment">//  0.000000 54.528999  ylo yhi</span></div>
<div class="line"><a name="l02446"></a><span class="lineno"> 2446</span>&#160;  <span class="comment">//  1.830501 53.087501  zlo zhi</span></div>
<div class="line"><a name="l02447"></a><span class="lineno"> 2447</span>&#160; </div>
<div class="line"><a name="l02448"></a><span class="lineno"> 2448</span>&#160;  <span class="comment">//  Masses</span></div>
<div class="line"><a name="l02449"></a><span class="lineno"> 2449</span>&#160; </div>
<div class="line"><a name="l02450"></a><span class="lineno"> 2450</span>&#160;  <span class="comment">//  1 15.999400 # O</span></div>
<div class="line"><a name="l02451"></a><span class="lineno"> 2451</span>&#160; </div>
<div class="line"><a name="l02452"></a><span class="lineno"> 2452</span>&#160;  <span class="comment">//  Atoms</span></div>
<div class="line"><a name="l02453"></a><span class="lineno"> 2453</span>&#160; </div>
<div class="line"><a name="l02454"></a><span class="lineno"> 2454</span>&#160;  <span class="comment">// 1 1 1 0 20.239  1.298 6.873 # O</span></div>
<div class="line"><a name="l02455"></a><span class="lineno"> 2455</span>&#160;  <span class="comment">// 2 1 1 0 0 5.193 6.873 # O</span></div>
<div class="line"><a name="l02456"></a><span class="lineno"> 2456</span>&#160;  <span class="comment">// 3 1 1 0 2.249 1.298 6.873 # O</span></div>
<div class="line"><a name="l02457"></a><span class="lineno"> 2457</span>&#160; </div>
<div class="line"><a name="l02458"></a><span class="lineno"> 2458</span>&#160;  <span class="comment">// -------</span></div>
<div class="line"><a name="l02459"></a><span class="lineno"> 2459</span>&#160;  <span class="comment">// Write the header</span></div>
<div class="line"><a name="l02460"></a><span class="lineno"> 2460</span>&#160;  <span class="comment">// Write comment line</span></div>
<div class="line"><a name="l02461"></a><span class="lineno"> 2461</span>&#160;  outputFile &lt;&lt; <span class="stringliteral">&quot;Written out by D-SEAMS\n&quot;</span>;</div>
<div class="line"><a name="l02462"></a><span class="lineno"> 2462</span>&#160;  <span class="comment">// Write out the number of atoms</span></div>
<div class="line"><a name="l02463"></a><span class="lineno"> 2463</span>&#160;  outputFile &lt;&lt; yCloud-&gt;pts.size() &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l02464"></a><span class="lineno"> 2464</span>&#160;             &lt;&lt; <span class="stringliteral">&quot;atoms&quot;</span></div>
<div class="line"><a name="l02465"></a><span class="lineno"> 2465</span>&#160;             &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l02466"></a><span class="lineno"> 2466</span>&#160;  <span class="comment">// Number of bonds</span></div>
<div class="line"><a name="l02467"></a><span class="lineno"> 2467</span>&#160;  outputFile &lt;&lt; bonds.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/size.html">size</a>() &lt;&lt; <span class="stringliteral">&quot; bonds&quot;</span></div>
<div class="line"><a name="l02468"></a><span class="lineno"> 2468</span>&#160;             &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l02469"></a><span class="lineno"> 2469</span>&#160;  outputFile &lt;&lt; <span class="stringliteral">&quot;0 angles\n0 dihedrals\n0 impropers\n&quot;</span>;</div>
<div class="line"><a name="l02470"></a><span class="lineno"> 2470</span>&#160;  <span class="comment">// There are maxDepth-2 total types of prisms + dummy</span></div>
<div class="line"><a name="l02471"></a><span class="lineno"> 2471</span>&#160;  outputFile &lt;&lt; numAtomTypes &lt;&lt; <span class="stringliteral">&quot; atom types\n&quot;</span>;</div>
<div class="line"><a name="l02472"></a><span class="lineno"> 2472</span>&#160;  <span class="comment">// Bond types</span></div>
<div class="line"><a name="l02473"></a><span class="lineno"> 2473</span>&#160;  outputFile</div>
<div class="line"><a name="l02474"></a><span class="lineno"> 2474</span>&#160;      &lt;&lt; bondTypes</div>
<div class="line"><a name="l02475"></a><span class="lineno"> 2475</span>&#160;      &lt;&lt; <span class="stringliteral">&quot; bond types\n0 angle types\n0 dihedral types\n0 improper types\n&quot;</span>;</div>
<div class="line"><a name="l02476"></a><span class="lineno"> 2476</span>&#160;  <span class="comment">// Box lengths</span></div>
<div class="line"><a name="l02477"></a><span class="lineno"> 2477</span>&#160;  outputFile &lt;&lt; yCloud-&gt;boxLow[0] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; yCloud-&gt;boxLow[0] + yCloud-&gt;box[0]</div>
<div class="line"><a name="l02478"></a><span class="lineno"> 2478</span>&#160;             &lt;&lt; <span class="stringliteral">&quot; xlo xhi\n&quot;</span>;</div>
<div class="line"><a name="l02479"></a><span class="lineno"> 2479</span>&#160;  outputFile &lt;&lt; yCloud-&gt;boxLow[1] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; yCloud-&gt;boxLow[1] + yCloud-&gt;box[1]</div>
<div class="line"><a name="l02480"></a><span class="lineno"> 2480</span>&#160;             &lt;&lt; <span class="stringliteral">&quot; ylo yhi\n&quot;</span>;</div>
<div class="line"><a name="l02481"></a><span class="lineno"> 2481</span>&#160;  outputFile &lt;&lt; yCloud-&gt;boxLow[2] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; yCloud-&gt;boxLow[2] + yCloud-&gt;box[2]</div>
<div class="line"><a name="l02482"></a><span class="lineno"> 2482</span>&#160;             &lt;&lt; <span class="stringliteral">&quot; zlo zhi\n&quot;</span>;</div>
<div class="line"><a name="l02483"></a><span class="lineno"> 2483</span>&#160;  <span class="comment">// Masses</span></div>
<div class="line"><a name="l02484"></a><span class="lineno"> 2484</span>&#160;  outputFile &lt;&lt; <span class="stringliteral">&quot;\nMasses\n\n&quot;</span>;</div>
<div class="line"><a name="l02485"></a><span class="lineno"> 2485</span>&#160;  outputFile &lt;&lt; <span class="stringliteral">&quot;1 15.999400 # dummy\n&quot;</span>;</div>
<div class="line"><a name="l02486"></a><span class="lineno"> 2486</span>&#160;  outputFile &lt;&lt; <span class="stringliteral">&quot;2 15.999400 # hc \n&quot;</span>;</div>
<div class="line"><a name="l02487"></a><span class="lineno"> 2487</span>&#160;  outputFile &lt;&lt; <span class="stringliteral">&quot;3 15.999400 # ddc \n&quot;</span>;</div>
<div class="line"><a name="l02488"></a><span class="lineno"> 2488</span>&#160;  outputFile &lt;&lt; <span class="stringliteral">&quot;4 15.999400 # mixed \n&quot;</span>;</div>
<div class="line"><a name="l02489"></a><span class="lineno"> 2489</span>&#160;  outputFile &lt;&lt; <span class="stringliteral">&quot;5 15.999400 # pnc \n&quot;</span>;</div>
<div class="line"><a name="l02490"></a><span class="lineno"> 2490</span>&#160;  outputFile &lt;&lt; <span class="stringliteral">&quot;6 15.999400 # pncHexaMixed \n&quot;</span>;</div>
<div class="line"><a name="l02491"></a><span class="lineno"> 2491</span>&#160;  <span class="comment">// Atoms</span></div>
<div class="line"><a name="l02492"></a><span class="lineno"> 2492</span>&#160;  outputFile &lt;&lt; <span class="stringliteral">&quot;\nAtoms\n\n&quot;</span>;</div>
<div class="line"><a name="l02493"></a><span class="lineno"> 2493</span>&#160;  <span class="comment">// -------</span></div>
<div class="line"><a name="l02494"></a><span class="lineno"> 2494</span>&#160;  <span class="comment">// Write out the atom coordinates</span></div>
<div class="line"><a name="l02495"></a><span class="lineno"> 2495</span>&#160;  <span class="comment">// Loop through atoms</span></div>
<div class="line"><a name="l02496"></a><span class="lineno"> 2496</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; yCloud-&gt;pts.size(); i++) {</div>
<div class="line"><a name="l02497"></a><span class="lineno"> 2497</span>&#160;    iatom =</div>
<div class="line"><a name="l02498"></a><span class="lineno"> 2498</span>&#160;        yCloud-&gt;pts[i].atomID; <span class="comment">// The actual ID can be different from the index</span></div>
<div class="line"><a name="l02499"></a><span class="lineno"> 2499</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l02500"></a><span class="lineno"> 2500</span>&#160;    <span class="comment">// Get the atom type</span></div>
<div class="line"><a name="l02501"></a><span class="lineno"> 2501</span>&#160;    <span class="comment">// hc atom type</span></div>
<div class="line"><a name="l02502"></a><span class="lineno"> 2502</span>&#160;    <span class="keywordflow">if</span> (atomTypes[i] == <a class="code" href="group__cage.html#ggaaac41828990e32b9d6e7db4426b61529abf805fba4c226956825175c4514f14ce">cage::hc</a>) {</div>
<div class="line"><a name="l02503"></a><span class="lineno"> 2503</span>&#160;      currentAtomType = 2;</div>
<div class="line"><a name="l02504"></a><span class="lineno"> 2504</span>&#160;    } <span class="comment">// hc</span></div>
<div class="line"><a name="l02505"></a><span class="lineno"> 2505</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (atomTypes[i] == <a class="code" href="group__cage.html#ggaaac41828990e32b9d6e7db4426b61529a508c36a9ffc7ba85f325a253be11312f">cage::ddc</a>) {</div>
<div class="line"><a name="l02506"></a><span class="lineno"> 2506</span>&#160;      currentAtomType = 3;</div>
<div class="line"><a name="l02507"></a><span class="lineno"> 2507</span>&#160;    } <span class="comment">// ddc</span></div>
<div class="line"><a name="l02508"></a><span class="lineno"> 2508</span>&#160;    <span class="comment">// mixed</span></div>
<div class="line"><a name="l02509"></a><span class="lineno"> 2509</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (atomTypes[i] == <a class="code" href="group__cage.html#ggaaac41828990e32b9d6e7db4426b61529a8da31aa983c518632b4a522086415492">cage::mixed</a>) {</div>
<div class="line"><a name="l02510"></a><span class="lineno"> 2510</span>&#160;      currentAtomType = 4;</div>
<div class="line"><a name="l02511"></a><span class="lineno"> 2511</span>&#160;    } <span class="comment">// mixed</span></div>
<div class="line"><a name="l02512"></a><span class="lineno"> 2512</span>&#160;    <span class="comment">// pnc</span></div>
<div class="line"><a name="l02513"></a><span class="lineno"> 2513</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (atomTypes[i] == <a class="code" href="group__cage.html#ggaaac41828990e32b9d6e7db4426b61529a3eae6b3c7c54d5cecb3d82d838cc6d60">cage::pnc</a>) {</div>
<div class="line"><a name="l02514"></a><span class="lineno"> 2514</span>&#160;      currentAtomType = 5;</div>
<div class="line"><a name="l02515"></a><span class="lineno"> 2515</span>&#160;    } <span class="comment">// mixed</span></div>
<div class="line"><a name="l02516"></a><span class="lineno"> 2516</span>&#160;    <span class="comment">// pnc and DDCs/HCs mixed</span></div>
<div class="line"><a name="l02517"></a><span class="lineno"> 2517</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (atomTypes[i] == <a class="code" href="group__cage.html#ggaaac41828990e32b9d6e7db4426b61529acbad0158a8f2811fd4136831fa2b3072">cage::mixed2</a>) {</div>
<div class="line"><a name="l02518"></a><span class="lineno"> 2518</span>&#160;      currentAtomType = 6;</div>
<div class="line"><a name="l02519"></a><span class="lineno"> 2519</span>&#160;    } <span class="comment">// mixed</span></div>
<div class="line"><a name="l02520"></a><span class="lineno"> 2520</span>&#160;    <span class="comment">// dummy</span></div>
<div class="line"><a name="l02521"></a><span class="lineno"> 2521</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02522"></a><span class="lineno"> 2522</span>&#160;      currentAtomType = 1;</div>
<div class="line"><a name="l02523"></a><span class="lineno"> 2523</span>&#160;    } <span class="comment">// dummy</span></div>
<div class="line"><a name="l02524"></a><span class="lineno"> 2524</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l02525"></a><span class="lineno"> 2525</span>&#160;    <span class="comment">// Write out coordinates</span></div>
<div class="line"><a name="l02526"></a><span class="lineno"> 2526</span>&#160;    <span class="comment">// atomID molecule-tag atom-type q x y z</span></div>
<div class="line"><a name="l02527"></a><span class="lineno"> 2527</span>&#160;    outputFile &lt;&lt; iatom &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; yCloud-&gt;pts[i].molID &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; currentAtomType</div>
<div class="line"><a name="l02528"></a><span class="lineno"> 2528</span>&#160;               &lt;&lt; <span class="stringliteral">&quot; 0 &quot;</span> &lt;&lt; yCloud-&gt;pts[i].x &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; yCloud-&gt;pts[i].y &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l02529"></a><span class="lineno"> 2529</span>&#160;               &lt;&lt; yCloud-&gt;pts[i].z &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l02530"></a><span class="lineno"> 2530</span>&#160; </div>
<div class="line"><a name="l02531"></a><span class="lineno"> 2531</span>&#160;  } <span class="comment">// end of loop through all atoms in pointCloud</span></div>
<div class="line"><a name="l02532"></a><span class="lineno"> 2532</span>&#160; </div>
<div class="line"><a name="l02533"></a><span class="lineno"> 2533</span>&#160;  <span class="comment">// Print the bonds now!</span></div>
<div class="line"><a name="l02534"></a><span class="lineno"> 2534</span>&#160;  outputFile &lt;&lt; <span class="stringliteral">&quot;\nBonds\n\n&quot;</span>;</div>
<div class="line"><a name="l02535"></a><span class="lineno"> 2535</span>&#160;  <span class="comment">// Loop through all bonds</span></div>
<div class="line"><a name="l02536"></a><span class="lineno"> 2536</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ibond = 0; ibond &lt; bonds.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/size.html">size</a>(); ibond++) {</div>
<div class="line"><a name="l02537"></a><span class="lineno"> 2537</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l02538"></a><span class="lineno"> 2538</span>&#160;    outputFile &lt;&lt; ibond + 1 &lt;&lt; <span class="stringliteral">&quot; 1 &quot;</span> &lt;&lt; bonds[ibond][0] &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l02539"></a><span class="lineno"> 2539</span>&#160;               &lt;&lt; bonds[ibond][1] &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l02540"></a><span class="lineno"> 2540</span>&#160;  } <span class="comment">// end of for loop for bonds</span></div>
<div class="line"><a name="l02541"></a><span class="lineno"> 2541</span>&#160; </div>
<div class="line"><a name="l02542"></a><span class="lineno"> 2542</span>&#160;  <span class="comment">// Once the datafile has been printed, exit</span></div>
<div class="line"><a name="l02543"></a><span class="lineno"> 2543</span>&#160;  <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l02544"></a><span class="lineno"> 2544</span>&#160;}</div>
<div class="line"><a name="l02545"></a><span class="lineno"> 2545</span>&#160; </div>
<div class="line"><a name="l02550"></a><span class="lineno"><a class="line" href="namespacesout.html#ad80ee9773d7921a87ef5bbbe76541a91"> 2550</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="namespacesout.html#ad80ee9773d7921a87ef5bbbe76541a91">sout::writeXYZcluster</a>(</div>
<div class="line"><a name="l02551"></a><span class="lineno"> 2551</span>&#160;    <a class="codeRef" href="http://en.cppreference.com/w/cpp/string/basic_string.html">std::string</a> path, <a class="code" href="structmolSys_1_1PointCloud.html">molSys::PointCloud</a>&lt;<a class="code" href="structmolSys_1_1Point.html">molSys::Point&lt;double&gt;</a>, <span class="keywordtype">double</span>&gt; *yCloud,</div>
<div class="line"><a name="l02552"></a><span class="lineno"> 2552</span>&#160;    <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a> atoms, <span class="keywordtype">int</span> clusterID, <a class="code" href="group__cage.html#ga5787314f51b5927c213db48b81c21d95">cage::cageType</a> type) {</div>
<div class="line"><a name="l02553"></a><span class="lineno"> 2553</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l02554"></a><span class="lineno"> 2554</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/io/basic_ofstream.html">std::ofstream</a> outputFile;</div>
<div class="line"><a name="l02555"></a><span class="lineno"> 2555</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/string/basic_string.html">std::string</a> filename = <span class="stringliteral">&quot;cluster-&quot;</span> + <a class="codeRef" href="http://en.cppreference.com/w/cpp/string/basic_string/to_string.html">std::to_string</a>(clusterID) + <span class="stringliteral">&quot;.xyz&quot;</span>;</div>
<div class="line"><a name="l02556"></a><span class="lineno"> 2556</span>&#160;  <span class="keywordtype">int</span> nAtoms = atoms.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/size.html">size</a>(); <span class="comment">// Number of atoms</span></div>
<div class="line"><a name="l02557"></a><span class="lineno"> 2557</span>&#160;  <span class="keywordtype">int</span> iatom;                 <span class="comment">// Current atom</span></div>
<div class="line"><a name="l02558"></a><span class="lineno"> 2558</span>&#160;  <span class="comment">// ----------------</span></div>
<div class="line"><a name="l02559"></a><span class="lineno"> 2559</span>&#160;  <span class="comment">// Make the output directory if it doesn&#39;t exist</span></div>
<div class="line"><a name="l02560"></a><span class="lineno"> 2560</span>&#160;  <a class="code" href="namespacesout.html#a3985775f30d7920fbf13f12386abefc1">sout::makePath</a>(path);</div>
<div class="line"><a name="l02561"></a><span class="lineno"> 2561</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/string/basic_string.html">std::string</a> outputDirName = path + <span class="stringliteral">&quot;bulkTopo&quot;</span>;</div>
<div class="line"><a name="l02562"></a><span class="lineno"> 2562</span>&#160;  <a class="code" href="namespacesout.html#a3985775f30d7920fbf13f12386abefc1">sout::makePath</a>(outputDirName);</div>
<div class="line"><a name="l02563"></a><span class="lineno"> 2563</span>&#160;  outputDirName = path + <span class="stringliteral">&quot;bulkTopo/clusterXYZ/&quot;</span>;</div>
<div class="line"><a name="l02564"></a><span class="lineno"> 2564</span>&#160;  <a class="code" href="namespacesout.html#a3985775f30d7920fbf13f12386abefc1">sout::makePath</a>(outputDirName);</div>
<div class="line"><a name="l02565"></a><span class="lineno"> 2565</span>&#160;  outputDirName = path + <span class="stringliteral">&quot;bulkTopo/clusterXYZ/frame-&quot;</span> +</div>
<div class="line"><a name="l02566"></a><span class="lineno"> 2566</span>&#160;                  <a class="codeRef" href="http://en.cppreference.com/w/cpp/string/basic_string/to_string.html">std::to_string</a>(yCloud-&gt;currentFrame);</div>
<div class="line"><a name="l02567"></a><span class="lineno"> 2567</span>&#160;  <a class="code" href="namespacesout.html#a3985775f30d7920fbf13f12386abefc1">sout::makePath</a>(outputDirName);</div>
<div class="line"><a name="l02568"></a><span class="lineno"> 2568</span>&#160;  <span class="comment">// ----------------</span></div>
<div class="line"><a name="l02569"></a><span class="lineno"> 2569</span>&#160;  <span class="comment">// Write output to file inside the output directory</span></div>
<div class="line"><a name="l02570"></a><span class="lineno"> 2570</span>&#160;  outputFile.<a class="codeRef" href="http://en.cppreference.com/w/cpp/io/basic_ofstream/open.html">open</a>(path + <span class="stringliteral">&quot;bulkTopo/clusterXYZ/frame-&quot;</span> +</div>
<div class="line"><a name="l02571"></a><span class="lineno"> 2571</span>&#160;                  <a class="codeRef" href="http://en.cppreference.com/w/cpp/string/basic_string/to_string.html">std::to_string</a>(yCloud-&gt;currentFrame) + <span class="stringliteral">&quot;/&quot;</span> + filename);</div>
<div class="line"><a name="l02572"></a><span class="lineno"> 2572</span>&#160; </div>
<div class="line"><a name="l02573"></a><span class="lineno"> 2573</span>&#160;  <span class="comment">// Format of an XYZ file:</span></div>
<div class="line"><a name="l02574"></a><span class="lineno"> 2574</span>&#160;  <span class="comment">//  1970</span></div>
<div class="line"><a name="l02575"></a><span class="lineno"> 2575</span>&#160;  <span class="comment">// generated by VMD</span></div>
<div class="line"><a name="l02576"></a><span class="lineno"> 2576</span>&#160;  <span class="comment">//  O         43.603500       16.926201       15.215700</span></div>
<div class="line"><a name="l02577"></a><span class="lineno"> 2577</span>&#160;  <span class="comment">//  O         39.912601       14.775100       19.379200</span></div>
<div class="line"><a name="l02578"></a><span class="lineno"> 2578</span>&#160;  outputFile &lt;&lt; nAtoms &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>; <span class="comment">// Number of atoms</span></div>
<div class="line"><a name="l02579"></a><span class="lineno"> 2579</span>&#160;  outputFile</div>
<div class="line"><a name="l02580"></a><span class="lineno"> 2580</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;Generated by d-SEAMS. 0 type=hc and 1 type =ddc\n&quot;</span>; <span class="comment">// Comment line</span></div>
<div class="line"><a name="l02581"></a><span class="lineno"> 2581</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l02582"></a><span class="lineno"> 2582</span>&#160;  <span class="comment">// Write out all the atom coordinates</span></div>
<div class="line"><a name="l02583"></a><span class="lineno"> 2583</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; nAtoms; i++) {</div>
<div class="line"><a name="l02584"></a><span class="lineno"> 2584</span>&#160;    iatom = atoms[i]; <span class="comment">// Atom index to be printed out</span></div>
<div class="line"><a name="l02585"></a><span class="lineno"> 2585</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l02586"></a><span class="lineno"> 2586</span>&#160;    outputFile &lt;&lt; type &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; yCloud-&gt;pts[iatom].x &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l02587"></a><span class="lineno"> 2587</span>&#160;               &lt;&lt; yCloud-&gt;pts[iatom].y &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; yCloud-&gt;pts[iatom].z &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l02588"></a><span class="lineno"> 2588</span>&#160;  } <span class="comment">// end of loop through all atoms</span></div>
<div class="line"><a name="l02589"></a><span class="lineno"> 2589</span>&#160; </div>
<div class="line"><a name="l02590"></a><span class="lineno"> 2590</span>&#160;  outputFile.<a class="codeRef" href="http://en.cppreference.com/w/cpp/io/basic_ofstream/close.html">close</a>();</div>
<div class="line"><a name="l02591"></a><span class="lineno"> 2591</span>&#160; </div>
<div class="line"><a name="l02592"></a><span class="lineno"> 2592</span>&#160;  <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l02593"></a><span class="lineno"> 2593</span>&#160;}</div>
<div class="ttc" id="aback_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/container/vector/back.html">std::vector::back</a></div><div class="ttdeci">T back(T... args)</div></div>
<div class="ttc" id="aback_inserter_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/iterator/back_inserter.html">std::back_inserter</a></div><div class="ttdeci">T back_inserter(T... args)</div></div>
<div class="ttc" id="abasic_ofstream_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/io/basic_ofstream.html">std::ofstream</a></div></div>
<div class="ttc" id="abasic_ostream_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/io/basic_ostream.html">std::cerr</a></div></div>
<div class="ttc" id="abasic_string_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/string/basic_string.html">std::string</a></div></div>
<div class="ttc" id="abegin_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/container/vector/begin.html">std::vector::begin</a></div><div class="ttdeci">T begin(T... args)</div></div>
<div class="ttc" id="aclose_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/io/basic_ofstream/close.html">std::ofstream::close</a></div><div class="ttdeci">T close(T... args)</div></div>
<div class="ttc" id="adistance_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/iterator/distance.html">std::distance</a></div><div class="ttdeci">T distance(T... args)</div></div>
<div class="ttc" id="aend_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/container/vector/end.html">std::vector::end</a></div><div class="ttdeci">T end(T... args)</div></div>
<div class="ttc" id="afind_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/algorithm/find.html">std::find</a></div><div class="ttdeci">T find(T... args)</div></div>
<div class="ttc" id="agroup__bond_html_ga99a6b8a519741c767bd8bed063276b5a"><div class="ttname"><a href="group__bond.html#ga99a6b8a519741c767bd8bed063276b5a">bond::populateBonds</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; int &gt; &gt; populateBonds(std::vector&lt; std::vector&lt; int &gt;&gt; nList, molSys::PointCloud&lt; molSys::Point&lt; double &gt;, double &gt; *yCloud)</div><div class="ttdef"><b>Definition:</b> <a href="bond_8cpp_source.html#l00026">bond.cpp:26</a></div></div>
<div class="ttc" id="agroup__bond_html_gaea75576194f28a141cee66548c309e1a"><div class="ttname"><a href="group__bond.html#gaea75576194f28a141cee66548c309e1a">bond::createBondsFromCages</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; int &gt; &gt; createBondsFromCages(std::vector&lt; std::vector&lt; int &gt;&gt; rings, std::vector&lt; cage::Cage &gt; *cageList, cage::cageType type, int *nRings)</div><div class="ttdef"><b>Definition:</b> <a href="bond_8cpp_source.html#l00529">bond.cpp:529</a></div></div>
<div class="ttc" id="agroup__cage_html_ga5787314f51b5927c213db48b81c21d95"><div class="ttname"><a href="group__cage.html#ga5787314f51b5927c213db48b81c21d95">cage::cageType</a></div><div class="ttdeci">cageType</div><div class="ttdef"><b>Definition:</b> <a href="cage_8hpp_source.html#l00054">cage.hpp:54</a></div></div>
<div class="ttc" id="agroup__cage_html_gga5787314f51b5927c213db48b81c21d95a0ff989d0b3eed06750ff06c8bc95c84d"><div class="ttname"><a href="group__cage.html#gga5787314f51b5927c213db48b81c21d95a0ff989d0b3eed06750ff06c8bc95c84d">cage::HexC</a></div><div class="ttdeci">@ HexC</div><div class="ttdef"><b>Definition:</b> <a href="cage_8hpp_source.html#l00054">cage.hpp:54</a></div></div>
<div class="ttc" id="agroup__cage_html_gga5787314f51b5927c213db48b81c21d95ac5a9e4f20bab07bef66bb6e15c49682d"><div class="ttname"><a href="group__cage.html#gga5787314f51b5927c213db48b81c21d95ac5a9e4f20bab07bef66bb6e15c49682d">cage::DoubleDiaC</a></div><div class="ttdeci">@ DoubleDiaC</div><div class="ttdef"><b>Definition:</b> <a href="cage_8hpp_source.html#l00054">cage.hpp:54</a></div></div>
<div class="ttc" id="agroup__cage_html_ggaaac41828990e32b9d6e7db4426b61529a3eae6b3c7c54d5cecb3d82d838cc6d60"><div class="ttname"><a href="group__cage.html#ggaaac41828990e32b9d6e7db4426b61529a3eae6b3c7c54d5cecb3d82d838cc6d60">cage::pnc</a></div><div class="ttdeci">@ pnc</div><div class="ttdef"><b>Definition:</b> <a href="cage_8hpp_source.html#l00075">cage.hpp:75</a></div></div>
<div class="ttc" id="agroup__cage_html_ggaaac41828990e32b9d6e7db4426b61529a508c36a9ffc7ba85f325a253be11312f"><div class="ttname"><a href="group__cage.html#ggaaac41828990e32b9d6e7db4426b61529a508c36a9ffc7ba85f325a253be11312f">cage::ddc</a></div><div class="ttdeci">@ ddc</div><div class="ttdef"><b>Definition:</b> <a href="cage_8hpp_source.html#l00075">cage.hpp:75</a></div></div>
<div class="ttc" id="agroup__cage_html_ggaaac41828990e32b9d6e7db4426b61529a8da31aa983c518632b4a522086415492"><div class="ttname"><a href="group__cage.html#ggaaac41828990e32b9d6e7db4426b61529a8da31aa983c518632b4a522086415492">cage::mixed</a></div><div class="ttdeci">@ mixed</div><div class="ttdef"><b>Definition:</b> <a href="cage_8hpp_source.html#l00075">cage.hpp:75</a></div></div>
<div class="ttc" id="agroup__cage_html_ggaaac41828990e32b9d6e7db4426b61529abf805fba4c226956825175c4514f14ce"><div class="ttname"><a href="group__cage.html#ggaaac41828990e32b9d6e7db4426b61529abf805fba4c226956825175c4514f14ce">cage::hc</a></div><div class="ttdeci">@ hc</div><div class="ttdef"><b>Definition:</b> <a href="cage_8hpp_source.html#l00075">cage.hpp:75</a></div></div>
<div class="ttc" id="agroup__cage_html_ggaaac41828990e32b9d6e7db4426b61529acbad0158a8f2811fd4136831fa2b3072"><div class="ttname"><a href="group__cage.html#ggaaac41828990e32b9d6e7db4426b61529acbad0158a8f2811fd4136831fa2b3072">cage::mixed2</a></div><div class="ttdeci">@ mixed2</div><div class="ttdef"><b>Definition:</b> <a href="cage_8hpp_source.html#l00075">cage.hpp:75</a></div></div>
<div class="ttc" id="agroup__clump_html_gad4824638fa14ec355ab99804c9119e35"><div class="ttname"><a href="group__clump.html#gad4824638fa14ec355ab99804c9119e35">clump::largestIceCluster</a></div><div class="ttdeci">int largestIceCluster(std::string path, molSys::PointCloud&lt; molSys::Point&lt; double &gt;, double &gt; *yCloud, molSys::PointCloud&lt; molSys::Point&lt; double &gt;, double &gt; *iceCloud, std::vector&lt; std::vector&lt; int &gt;&gt; nList, std::vector&lt; bool &gt; *isIce, std::vector&lt; int &gt; *clusterID, std::vector&lt; int &gt; *nClusters, std::unordered_map&lt; int, int &gt; *indexNumber, int firstFrame)</div><div class="ttdoc">Finds the largest ice cluster.</div><div class="ttdef"><b>Definition:</b> <a href="cluster_8cpp_source.html#l00040">cluster.cpp:40</a></div></div>
<div class="ttc" id="agroup__gen_html_ga881e045598dd517609383d8a3fec5913"><div class="ttname"><a href="group__gen.html#ga881e045598dd517609383d8a3fec5913">gen::periodicDist</a></div><div class="ttdeci">double periodicDist(molSys::PointCloud&lt; molSys::Point&lt; double &gt;, double &gt; *yCloud, int iatom, int jatom)</div><div class="ttdoc">Inline generic function for obtaining the unwrapped periodic distance between two particles,...</div><div class="ttdef"><b>Definition:</b> <a href="generic_8hpp_source.html#l00108">generic.hpp:108</a></div></div>
<div class="ttc" id="agroup__molSys_html_gga13ffe3a39a0816627553f195e102abb5a129c76a33f8ebd1a8dedd378543af193"><div class="ttname"><a href="group__molSys.html#gga13ffe3a39a0816627553f195e102abb5a129c76a33f8ebd1a8dedd378543af193">molSys::cubic</a></div><div class="ttdeci">@ cubic</div><div class="ttdoc">Ic, or particle type signifying Cubic Ice.</div><div class="ttdef"><b>Definition:</b> <a href="mol__sys_8hpp_source.html#l00114">mol_sys.hpp:114</a></div></div>
<div class="ttc" id="agroup__molSys_html_gga13ffe3a39a0816627553f195e102abb5a22e673e9b130fe029c171fdf2a2e419a"><div class="ttname"><a href="group__molSys.html#gga13ffe3a39a0816627553f195e102abb5a22e673e9b130fe029c171fdf2a2e419a">molSys::hexagonal</a></div><div class="ttdeci">@ hexagonal</div><div class="ttdoc">Ih, or particle type signifying Hexagonal Ice.</div><div class="ttdef"><b>Definition:</b> <a href="mol__sys_8hpp_source.html#l00115">mol_sys.hpp:115</a></div></div>
<div class="ttc" id="agroup__molSys_html_gga13ffe3a39a0816627553f195e102abb5a2307822a42416cc62fcbd5afe887491f"><div class="ttname"><a href="group__molSys.html#gga13ffe3a39a0816627553f195e102abb5a2307822a42416cc62fcbd5afe887491f">molSys::interClathrate</a></div><div class="ttdeci">@ interClathrate</div><div class="ttdoc">Interfacial clathrate ice phase.</div><div class="ttdef"><b>Definition:</b> <a href="mol__sys_8hpp_source.html#l00119">mol_sys.hpp:119</a></div></div>
<div class="ttc" id="agroup__molSys_html_gga13ffe3a39a0816627553f195e102abb5a2a1eeeb73264d00a89f53b3ec3544b2c"><div class="ttname"><a href="group__molSys.html#gga13ffe3a39a0816627553f195e102abb5a2a1eeeb73264d00a89f53b3ec3544b2c">molSys::interfacial</a></div><div class="ttdeci">@ interfacial</div><div class="ttdoc">Interfacial ice: ice-like molecules which do not fulfill the strict criteria of the Ic or Ih phases.</div><div class="ttdef"><b>Definition:</b> <a href="mol__sys_8hpp_source.html#l00117">mol_sys.hpp:117</a></div></div>
<div class="ttc" id="agroup__molSys_html_gga13ffe3a39a0816627553f195e102abb5a5300236c5e45c59840b336b4e735fa0a"><div class="ttname"><a href="group__molSys.html#gga13ffe3a39a0816627553f195e102abb5a5300236c5e45c59840b336b4e735fa0a">molSys::reCubic</a></div><div class="ttdeci">@ reCubic</div><div class="ttdoc">Reclassified as cubic ice, according to the  order parameter.</div><div class="ttdef"><b>Definition:</b> <a href="mol__sys_8hpp_source.html#l00121">mol_sys.hpp:121</a></div></div>
<div class="ttc" id="agroup__molSys_html_gga13ffe3a39a0816627553f195e102abb5a9e48b0390667a2a6606fb9bd47752ebd"><div class="ttname"><a href="group__molSys.html#gga13ffe3a39a0816627553f195e102abb5a9e48b0390667a2a6606fb9bd47752ebd">molSys::clathrate</a></div><div class="ttdeci">@ clathrate</div><div class="ttdoc">Clathrate ice phase.</div><div class="ttdef"><b>Definition:</b> <a href="mol__sys_8hpp_source.html#l00118">mol_sys.hpp:118</a></div></div>
<div class="ttc" id="agroup__molSys_html_gga13ffe3a39a0816627553f195e102abb5aa701d941ff4dc44b45faa7fd0e1f163f"><div class="ttname"><a href="group__molSys.html#gga13ffe3a39a0816627553f195e102abb5aa701d941ff4dc44b45faa7fd0e1f163f">molSys::water</a></div><div class="ttdeci">@ water</div><div class="ttdoc">Liquid/amorphous phase.</div><div class="ttdef"><b>Definition:</b> <a href="mol__sys_8hpp_source.html#l00116">mol_sys.hpp:116</a></div></div>
<div class="ttc" id="agroup__molSys_html_gga13ffe3a39a0816627553f195e102abb5ad19ecf271dba48ef8dd8175326f669b4"><div class="ttname"><a href="group__molSys.html#gga13ffe3a39a0816627553f195e102abb5ad19ecf271dba48ef8dd8175326f669b4">molSys::unclassified</a></div><div class="ttdeci">@ unclassified</div><div class="ttdoc">Not classified into any other category.</div><div class="ttdef"><b>Definition:</b> <a href="mol__sys_8hpp_source.html#l00120">mol_sys.hpp:120</a></div></div>
<div class="ttc" id="agroup__sinp_html_gada34d9d30df182a408a6b69ba7310509"><div class="ttname"><a href="group__sinp.html#gada34d9d30df182a408a6b69ba7310509">sinp::readBonds</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; int &gt; &gt; readBonds(std::string filename)</div><div class="ttdoc">Reads bonds into a vector of vectors from a file with a specific format.</div><div class="ttdef"><b>Definition:</b> <a href="seams__input_8cpp_source.html#l00024">seams_input.cpp:24</a></div></div>
<div class="ttc" id="amove_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/utility/move.html">std::move</a></div><div class="ttdeci">T move(T... args)</div></div>
<div class="ttc" id="anamespacesout_html_a01b11b3b1d2830a9e2724526ee40712b"><div class="ttname"><a href="namespacesout.html#a01b11b3b1d2830a9e2724526ee40712b">sout::writeBasalRingsPrism</a></div><div class="ttdeci">int writeBasalRingsPrism(std::vector&lt; int &gt; *basal1, std::vector&lt; int &gt; *basal2, int prismNum, std::vector&lt; std::vector&lt; int &gt;&gt; nList, molSys::PointCloud&lt; molSys::Point&lt; double &gt;, double &gt; *yCloud, bool isDeformed)</div><div class="ttdoc">Write out the basal rings for a particular prism.</div><div class="ttdef"><b>Definition:</b> <a href="seams__output_8cpp_source.html#l00650">seams_output.cpp:650</a></div></div>
<div class="ttc" id="anamespacesout_html_a18a4f9b414456914c2b21c664a543cc2"><div class="ttname"><a href="namespacesout.html#a18a4f9b414456914c2b21c664a543cc2">sout::writeLAMMPSdata</a></div><div class="ttdeci">int writeLAMMPSdata(molSys::PointCloud&lt; molSys::Point&lt; double &gt;, double &gt; *yCloud, std::vector&lt; std::vector&lt; int &gt;&gt; rings, std::vector&lt; std::vector&lt; int &gt;&gt; bonds, std::string filename=&quot;system-rings.data&quot;)</div><div class="ttdoc">Write a data file for rings.</div><div class="ttdef"><b>Definition:</b> <a href="seams__output_8cpp_source.html#l00022">seams_output.cpp:22</a></div></div>
<div class="ttc" id="anamespacesout_html_a1cfbcd0f8d90f3033ee5e505c07e0400"><div class="ttname"><a href="namespacesout.html#a1cfbcd0f8d90f3033ee5e505c07e0400">sout::writeMoleculeIDsInSlice</a></div><div class="ttdeci">int writeMoleculeIDsInSlice(std::string path, molSys::PointCloud&lt; molSys::Point&lt; double &gt;, double &gt; *yCloud)</div><div class="ttdef"><b>Definition:</b> <a href="seams__output_8cpp_source.html#l00877">seams_output.cpp:877</a></div></div>
<div class="ttc" id="anamespacesout_html_a24a195019ec838ff8db628a31cf9ebb2"><div class="ttname"><a href="namespacesout.html#a24a195019ec838ff8db628a31cf9ebb2">sout::writeAllCages</a></div><div class="ttdeci">int writeAllCages(std::string path, std::vector&lt; cage::Cage &gt; *cageList, std::vector&lt; std::vector&lt; int &gt;&gt; rings, std::vector&lt; std::vector&lt; int &gt;&gt; nList, molSys::PointCloud&lt; molSys::Point&lt; double &gt;, double &gt; *yCloud, int currentFrame)</div><div class="ttdef"><b>Definition:</b> <a href="seams__output_8cpp_source.html#l00287">seams_output.cpp:287</a></div></div>
<div class="ttc" id="anamespacesout_html_a27b0ed070347ff0351e2d0882d1d6ddd"><div class="ttname"><a href="namespacesout.html#a27b0ed070347ff0351e2d0882d1d6ddd">sout::writePrismNum</a></div><div class="ttdeci">int writePrismNum(std::string path, std::vector&lt; int &gt; nPrisms, std::vector&lt; int &gt; nDefPrisms, std::vector&lt; double &gt; heightPercent, int maxDepth, int currentFrame, int firstFrame)</div><div class="ttdef"><b>Definition:</b> <a href="seams__output_8cpp_source.html#l01031">seams_output.cpp:1031</a></div></div>
<div class="ttc" id="anamespacesout_html_a2aa4853345a006e923069cbf9602417f"><div class="ttname"><a href="namespacesout.html#a2aa4853345a006e923069cbf9602417f">sout::writeRingNumBulk</a></div><div class="ttdeci">int writeRingNumBulk(std::string path, int currentFrame, std::vector&lt; int &gt; nRings, int maxDepth, int firstFrame)</div><div class="ttdef"><b>Definition:</b> <a href="seams__output_8cpp_source.html#l01182">seams_output.cpp:1182</a></div></div>
<div class="ttc" id="anamespacesout_html_a31d215aac08b1a890f73e074eae808a1"><div class="ttname"><a href="namespacesout.html#a31d215aac08b1a890f73e074eae808a1">sout::writeLAMMPSdumpSlice</a></div><div class="ttdeci">int writeLAMMPSdumpSlice(molSys::PointCloud&lt; molSys::Point&lt; double &gt;, double &gt; *yCloud, std::string path)</div><div class="ttdef"><b>Definition:</b> <a href="seams__output_8cpp_source.html#l01452">seams_output.cpp:1452</a></div></div>
<div class="ttc" id="anamespacesout_html_a3775e3decf75faac38693c4b13143938"><div class="ttname"><a href="namespacesout.html#a3775e3decf75faac38693c4b13143938">sout::writeRingNum</a></div><div class="ttdeci">int writeRingNum(std::string path, int currentFrame, std::vector&lt; int &gt; nRings, std::vector&lt; double &gt; coverageAreaXY, std::vector&lt; double &gt; coverageAreaXZ, std::vector&lt; double &gt; coverageAreaYZ, int maxDepth, int firstFrame)</div><div class="ttdef"><b>Definition:</b> <a href="seams__output_8cpp_source.html#l01077">seams_output.cpp:1077</a></div></div>
<div class="ttc" id="anamespacesout_html_a3985775f30d7920fbf13f12386abefc1"><div class="ttname"><a href="namespacesout.html#a3985775f30d7920fbf13f12386abefc1">sout::makePath</a></div><div class="ttdeci">int makePath(const std::string &amp;path)</div><div class="ttdef"><b>Definition:</b> <a href="seams__output_8hpp_source.html#l00064">seams_output.hpp:64</a></div></div>
<div class="ttc" id="anamespacesout_html_a39e0081b79852366fd17b377a9925ae0"><div class="ttname"><a href="namespacesout.html#a39e0081b79852366fd17b377a9925ae0">sout::writeLAMMPSdataAllRings</a></div><div class="ttdeci">int writeLAMMPSdataAllRings(molSys::PointCloud&lt; molSys::Point&lt; double &gt;, double &gt; *yCloud, std::vector&lt; std::vector&lt; int &gt;&gt; nList, std::vector&lt; int &gt; atomTypes, int maxDepth, std::string path, bool isMonolayer=true)</div><div class="ttdoc">Write a data file for rings of every type for a monolayer.</div><div class="ttdef"><b>Definition:</b> <a href="seams__output_8cpp_source.html#l01661">seams_output.cpp:1661</a></div></div>
<div class="ttc" id="anamespacesout_html_a4cad3c06043b96b56ad95c8bf30c74d2"><div class="ttname"><a href="namespacesout.html#a4cad3c06043b96b56ad95c8bf30c74d2">sout::writeLAMMPSdataCages</a></div><div class="ttdeci">int writeLAMMPSdataCages(molSys::PointCloud&lt; molSys::Point&lt; double &gt;, double &gt; *yCloud, std::vector&lt; std::vector&lt; int &gt;&gt; rings, std::vector&lt; cage::Cage &gt; *cageList, cage::cageType type, int numCages, std::string filename=&quot;system-cages.data&quot;)</div><div class="ttdef"><b>Definition:</b> <a href="seams__output_8cpp_source.html#l02023">seams_output.cpp:2023</a></div></div>
<div class="ttc" id="anamespacesout_html_a5ca5eeff9edc702cdcf1b26e8501dc0c"><div class="ttname"><a href="namespacesout.html#a5ca5eeff9edc702cdcf1b26e8501dc0c">sout::writeTopoBulkData</a></div><div class="ttdeci">int writeTopoBulkData(std::string path, int currentFrame, int numHC, int numDDC, int mixedRings, int basalRings, int prismaticRings, int firstFrame)</div><div class="ttdef"><b>Definition:</b> <a href="seams__output_8cpp_source.html#l01251">seams_output.cpp:1251</a></div></div>
<div class="ttc" id="anamespacesout_html_a6d957535efb45598e954f073d95e4d31"><div class="ttname"><a href="namespacesout.html#a6d957535efb45598e954f073d95e4d31">sout::writeDump</a></div><div class="ttdeci">int writeDump(molSys::PointCloud&lt; molSys::Point&lt; double &gt;, double &gt; *yCloud, std::string path, std::string outFile)</div><div class="ttdoc">Generic function for writing out to a dump file.</div><div class="ttdef"><b>Definition:</b> <a href="seams__output_8cpp_source.html#l02235">seams_output.cpp:2235</a></div></div>
<div class="ttc" id="anamespacesout_html_a6ecf4c61a66360ec154723bffe21b2b2"><div class="ttname"><a href="namespacesout.html#a6ecf4c61a66360ec154723bffe21b2b2">sout::writeLAMMPSdumpINT</a></div><div class="ttdeci">int writeLAMMPSdumpINT(molSys::PointCloud&lt; molSys::Point&lt; double &gt;, double &gt; *yCloud, std::vector&lt; double &gt; rmsdPerAtom, std::vector&lt; int &gt; atomTypes, int maxDepth, std::string path)</div><div class="ttdoc">Write out a LAMMPS dump file containing the RMSD per atom.</div><div class="ttdef"><b>Definition:</b> <a href="seams__output_8cpp_source.html#l01378">seams_output.cpp:1378</a></div></div>
<div class="ttc" id="anamespacesout_html_a7390840ba628261c9d817c99369b1207"><div class="ttname"><a href="namespacesout.html#a7390840ba628261c9d817c99369b1207">sout::writeBasalRingsHex</a></div><div class="ttdeci">int writeBasalRingsHex(std::vector&lt; int &gt; currentCage, int cageNum, std::vector&lt; std::vector&lt; int &gt;&gt; nList, std::vector&lt; std::vector&lt; int &gt;&gt; rings)</div><div class="ttdoc">Write out the basal rings of a particular Hexagonal cage.</div><div class="ttdef"><b>Definition:</b> <a href="seams__output_8cpp_source.html#l00441">seams_output.cpp:441</a></div></div>
<div class="ttc" id="anamespacesout_html_a749ab343b193903acb8489f113e6b1e8"><div class="ttname"><a href="namespacesout.html#a749ab343b193903acb8489f113e6b1e8">sout::writePrisms</a></div><div class="ttdeci">int writePrisms(std::vector&lt; int &gt; *basal1, std::vector&lt; int &gt; *basal2, int prismNum, molSys::PointCloud&lt; molSys::Point&lt; double &gt;, double &gt; *yCloud)</div><div class="ttdoc">Function for writing out each prism.</div><div class="ttdef"><b>Definition:</b> <a href="seams__output_8cpp_source.html#l00216">seams_output.cpp:216</a></div></div>
<div class="ttc" id="anamespacesout_html_a8a9d39fa590c92dbb4556edb767e1d8f"><div class="ttname"><a href="namespacesout.html#a8a9d39fa590c92dbb4556edb767e1d8f">sout::printRDF</a></div><div class="ttdeci">int printRDF(std::string fileName, std::vector&lt; double &gt; *rdfValues, double binwidth, int nbin)</div><div class="ttdoc">Function for printing out the RDF, given the filename.</div><div class="ttdef"><b>Definition:</b> <a href="seams__output_8cpp_source.html#l01226">seams_output.cpp:1226</a></div></div>
<div class="ttc" id="anamespacesout_html_a96aa8c9d78c09d7cd77c4d46182e7b3b"><div class="ttname"><a href="namespacesout.html#a96aa8c9d78c09d7cd77c4d46182e7b3b">sout::writeMoleculeIDsExpressionSelectOVITO</a></div><div class="ttdeci">int writeMoleculeIDsExpressionSelectOVITO(std::string path, molSys::PointCloud&lt; molSys::Point&lt; double &gt;, double &gt; *yCloud)</div><div class="ttdef"><b>Definition:</b> <a href="seams__output_8cpp_source.html#l00964">seams_output.cpp:964</a></div></div>
<div class="ttc" id="anamespacesout_html_aab0f5ab6c315ea6f2aacb509a4b808f5"><div class="ttname"><a href="namespacesout.html#aab0f5ab6c315ea6f2aacb509a4b808f5">sout::writeLAMMPSdataPrisms</a></div><div class="ttdeci">int writeLAMMPSdataPrisms(molSys::PointCloud&lt; molSys::Point&lt; double &gt;, double &gt; *yCloud, std::vector&lt; std::vector&lt; int &gt;&gt; rings, bool useBondFile, std::string bondFile, std::vector&lt; int &gt; listPrism, std::vector&lt; std::vector&lt; int &gt;&gt; nList, std::string filename=&quot;system-prisms.data&quot;)</div><div class="ttdoc">Write a data file for prisms of a single type.</div><div class="ttdef"><b>Definition:</b> <a href="seams__output_8cpp_source.html#l01793">seams_output.cpp:1793</a></div></div>
<div class="ttc" id="anamespacesout_html_aabeb7b712f568256cf3ed782fa91c518"><div class="ttname"><a href="namespacesout.html#aabeb7b712f568256cf3ed782fa91c518">sout::writeLAMMPSdataTopoBulk</a></div><div class="ttdeci">int writeLAMMPSdataTopoBulk(molSys::PointCloud&lt; molSys::Point&lt; double &gt;, double &gt; *yCloud, std::vector&lt; std::vector&lt; int &gt;&gt; nList, std::vector&lt; cage::iceType &gt; atomTypes, std::string path, bool bondsBetweenDummy=false)</div><div class="ttdef"><b>Definition:</b> <a href="seams__output_8cpp_source.html#l02397">seams_output.cpp:2397</a></div></div>
<div class="ttc" id="anamespacesout_html_aafb7e57984a7fdc5d7563aea08148a42"><div class="ttname"><a href="namespacesout.html#aafb7e57984a7fdc5d7563aea08148a42">sout::writeRings</a></div><div class="ttdeci">int writeRings(std::vector&lt; std::vector&lt; int &gt;&gt; rings, std::string filename=&quot;rings.dat&quot;)</div><div class="ttdoc">Function for printing out ring info, when there is no volume slice.</div><div class="ttdef"><b>Definition:</b> <a href="seams__output_8cpp_source.html#l00182">seams_output.cpp:182</a></div></div>
<div class="ttc" id="anamespacesout_html_ad297dfa82170796cedea7f111e7694df"><div class="ttname"><a href="namespacesout.html#ad297dfa82170796cedea7f111e7694df">sout::writeLAMMPSdumpCages</a></div><div class="ttdeci">int writeLAMMPSdumpCages(molSys::PointCloud&lt; molSys::Point&lt; double &gt;, double &gt; *yCloud, std::vector&lt; double &gt; rmsdPerAtom, std::vector&lt; int &gt; atomTypes, std::string path, int firstFrame)</div><div class="ttdoc">Write out a LAMMPS dump file containing the RMSD per atom for bulk ice.</div><div class="ttdef"><b>Definition:</b> <a href="seams__output_8cpp_source.html#l01288">seams_output.cpp:1288</a></div></div>
<div class="ttc" id="anamespacesout_html_ad80ee9773d7921a87ef5bbbe76541a91"><div class="ttname"><a href="namespacesout.html#ad80ee9773d7921a87ef5bbbe76541a91">sout::writeXYZcluster</a></div><div class="ttdeci">int writeXYZcluster(std::string path, molSys::PointCloud&lt; molSys::Point&lt; double &gt;, double &gt; *yCloud, std::vector&lt; int &gt; atoms, int clusterID, cage::cageType type)</div><div class="ttdoc">Function for writing out the XYZ files for each cluster.</div><div class="ttdef"><b>Definition:</b> <a href="seams__output_8cpp_source.html#l02550">seams_output.cpp:2550</a></div></div>
<div class="ttc" id="anamespacesout_html_ae3038ae689d60cc3529b95caa0b75ae1"><div class="ttname"><a href="namespacesout.html#ae3038ae689d60cc3529b95caa0b75ae1">sout::writeLAMMPSdataAllPrisms</a></div><div class="ttdeci">int writeLAMMPSdataAllPrisms(molSys::PointCloud&lt; molSys::Point&lt; double &gt;, double &gt; *yCloud, std::vector&lt; std::vector&lt; int &gt;&gt; nList, std::vector&lt; int &gt; atomTypes, int maxDepth, std::string path, bool doShapeMatching=false)</div><div class="ttdoc">Write a data file for prisms of every type.</div><div class="ttdef"><b>Definition:</b> <a href="seams__output_8cpp_source.html#l01527">seams_output.cpp:1527</a></div></div>
<div class="ttc" id="anamespacesout_html_ae323bc5bea39c66f2efee0f05600fd32"><div class="ttname"><a href="namespacesout.html#ae323bc5bea39c66f2efee0f05600fd32">sout::writeEachCage</a></div><div class="ttdeci">int writeEachCage(std::vector&lt; int &gt; currentCage, int cageNum, cage::cageType type, std::vector&lt; std::vector&lt; int &gt;&gt; rings, molSys::PointCloud&lt; molSys::Point&lt; double &gt;, double &gt; *yCloud)</div><div class="ttdoc">Write out a particular cage to a file.</div><div class="ttdef"><b>Definition:</b> <a href="seams__output_8cpp_source.html#l00348">seams_output.cpp:348</a></div></div>
<div class="ttc" id="anamespacesout_html_ae800e10d206146b10745c20d060456f8"><div class="ttname"><a href="namespacesout.html#ae800e10d206146b10745c20d060456f8">sout::writeCluster</a></div><div class="ttdeci">int writeCluster(molSys::PointCloud&lt; molSys::Point&lt; double &gt;, double &gt; *yCloud, std::string fileName=&quot;cluster.txt&quot;, bool isSlice=false, int largestIceCluster=0)</div><div class="ttdoc">Function for printing the largest ice cluster.</div><div class="ttdef"><b>Definition:</b> <a href="seams__output_8cpp_source.html#l02380">seams_output.cpp:2380</a></div></div>
<div class="ttc" id="anamespacesout_html_aee17b8438205b4b88aad8a481c533ba5"><div class="ttname"><a href="namespacesout.html#aee17b8438205b4b88aad8a481c533ba5">sout::writeClusterStats</a></div><div class="ttdeci">int writeClusterStats(std::string path, int currentFrame, int largestCluster, int numOfClusters, int smallestCluster, double avgClusterSize, int firstFrame)</div><div class="ttdoc">Function for writing out cluster statistics.</div><div class="ttdef"><b>Definition:</b> <a href="seams__output_8cpp_source.html#l00840">seams_output.cpp:840</a></div></div>
<div class="ttc" id="anamespacesout_html_af815e27a565e45396f0f4315c49a354c"><div class="ttname"><a href="namespacesout.html#af815e27a565e45396f0f4315c49a354c">sout::writeHisto</a></div><div class="ttdeci">int writeHisto(molSys::PointCloud&lt; molSys::Point&lt; double &gt;, double &gt; *yCloud, std::vector&lt; std::vector&lt; int &gt;&gt; nList, std::vector&lt; double &gt; avgQ6)</div><div class="ttdef"><b>Definition:</b> <a href="seams__output_8cpp_source.html#l02339">seams_output.cpp:2339</a></div></div>
<div class="ttc" id="aopen_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/io/basic_ofstream/open.html">std::ofstream::open</a></div><div class="ttdeci">T open(T... args)</div></div>
<div class="ttc" id="apush_back_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/container/vector/push_back.html">std::vector::push_back</a></div><div class="ttdeci">T push_back(T... args)</div></div>
<div class="ttc" id="areserve_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/container/vector/reserve.html">std::vector::reserve</a></div><div class="ttdeci">T reserve(T... args)</div></div>
<div class="ttc" id="aresize_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/container/vector/resize.html">std::vector::resize</a></div><div class="ttdeci">T resize(T... args)</div></div>
<div class="ttc" id="aseams__input_8hpp_html"><div class="ttname"><a href="seams__input_8hpp.html">seams_input.hpp</a></div><div class="ttdoc">File for functions that read in files).</div></div>
<div class="ttc" id="aseams__output_8hpp_html"><div class="ttname"><a href="seams__output_8hpp.html">seams_output.hpp</a></div></div>
<div class="ttc" id="asize_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/container/vector/size.html">std::vector::size</a></div><div class="ttdeci">T size(T... args)</div></div>
<div class="ttc" id="asort_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/algorithm/sort.html">std::sort</a></div><div class="ttdeci">T sort(T... args)</div></div>
<div class="ttc" id="astructmolSys_1_1PointCloud_html"><div class="ttname"><a href="structmolSys_1_1PointCloud.html">molSys::PointCloud</a></div><div class="ttdoc">This contains a collection of points; contains information for a particular frame.</div><div class="ttdef"><b>Definition:</b> <a href="mol__sys_8hpp_source.html#l00170">mol_sys.hpp:170</a></div></div>
<div class="ttc" id="astructmolSys_1_1Point_html"><div class="ttname"><a href="structmolSys_1_1Point.html">molSys::Point</a></div><div class="ttdoc">This contains per-particle information.</div><div class="ttdef"><b>Definition:</b> <a href="mol__sys_8hpp_source.html#l00149">mol_sys.hpp:149</a></div></div>
<div class="ttc" id="ato_string_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/string/basic_string/to_string.html">std::to_string</a></div><div class="ttdeci">T to_string(T... args)</div></div>
<div class="ttc" id="aunique_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/algorithm/unique.html">std::unique</a></div><div class="ttdeci">T unique(T... args)</div></div>
<div class="ttc" id="avector_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- Copyright 2020 Rohit Goswami <rog32@hi.is>
     Licensed under the Apache License, Version 2.0 (the "License");
     you may not use this file except in compliance with the License.
     You may obtain a copy of the License at
     http://www.apache.org/licenses/LICENSE-2.0
     Unless required by applicable law or agreed to in writing, software
     distributed under the License is distributed on an "AS IS" BASIS,
     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     See the License for the specific language governing permissions and
     limitations under the License. -->
<!-- HTML footer for doxygen 1.9.1-->
<!-- start footer part -->
<div class="footer">
<hr class="footline"/><address class="footline"><small>
    Generated by&#160;<a href="https://www.doxygen.org/index.html">Doxygen 1.9.1</a> and the <a class="outlink" href="https://github.com/HaoZeke/doxyYoda">doxyYoda theme</a>
</small></address>
</div>
</div>
</body>
</html>
