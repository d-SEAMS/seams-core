<!-- Copyright 2020 Rohit Goswami <rog32@hi.is>
     Licensed under the Apache License, Version 2.0 (the "License");
     you may not use this file except in compliance with the License.
     You may obtain a copy of the License at
     http://www.apache.org/licenses/LICENSE-2.0
     Unless required by applicable law or agreed to in writing, software
     distributed under the License is distributed on an "AS IS" BASIS,
     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     See the License for the specific language governing permissions and
     limitations under the License. -->
<!-- HTML header for doxygen 1.9.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>d-SEAMS: src/topo_bulk.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script>
MathJax = {
  tex: {
    inlineMath: [['$', '$'], ['\\(', '\\)']]
  },
  svg: {
    fontCache: 'global'
  }
  loader: { load: ["[tex]/unicode", "[tex]/ams"] },
  tex: {
    packages: { "[+]": ["unicode", "ams"] },
    tags: "ams",
  },
};
</script>
<script type="text/javascript" id="MathJax-script" async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js">
</script>
<!-- <link href="doxygen.css" rel="stylesheet" type="text/css" /> -->
<link href="doxyYoda.min.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" >
$(document).ready(function() {
     $(".fragment").wrap("<details class='code-details'></details>");
     $(".code-details").append("<summary>Code</summary>");
 }
)
</script>
</head>
<body>
<div class="grid-contents">
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<nav class="title_area">
<a class="project_logo" href="#">
<img src="dSeamsLogo.png" width="30" height="30" alt="Logo">
</a>
<span class="project_info">d-SEAMS v1.0.0</span>
</nav>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">topo_bulk.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="topo__bulk_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">// d-SEAMS - Deferred Structural Elucidation Analysis for Molecular Simulations</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">// Copyright (c) 2018--present d-SEAMS core team</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">// This program is free software: you can redistribute it and/or modify</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">// it under the terms of the MIT License as published by</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">// the Open Source Initiative.</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">// A copy of the MIT License is included in the LICENSE file of this repository.</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">// You should have received a copy of the MIT License along with this program.</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">// If not, see &lt;https://opensource.org/licenses/MIT&gt;.</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160; </div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="topo__bulk_8hpp.html">topo_bulk.hpp</a>&gt;</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160; </div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">// -----------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">// DDC / HC ALGORITHMS</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">// -----------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160; </div>
<div class="line"><a name="l00052"></a><span class="lineno"><a class="line" href="group__prism3.html#gac811a7fb090a75aaf3bca9e56bf92a26">   52</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="group__prism3.html#gac811a7fb090a75aaf3bca9e56bf92a26">ring::topoBulkAnalysis</a>(</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    <a class="codeRef" href="http://en.cppreference.com/w/cpp/string/basic_string.html">std::string</a> path, <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt;<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a>&gt; rings,</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt;<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a>&gt; nList,</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <a class="code" href="structmolSys_1_1PointCloud.html">molSys::PointCloud</a>&lt;<a class="code" href="structmolSys_1_1Point.html">molSys::Point&lt;double&gt;</a>, <span class="keywordtype">double</span>&gt; *yCloud, <span class="keywordtype">int</span> firstFrame,</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <span class="keywordtype">bool</span> onlyTetrahedral) {</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  <span class="comment">// Ring IDs of each type will be saved in these vectors</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a> listDDC; <span class="comment">// Vector for ring indices of DDC</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a> listHC;  <span class="comment">// Vector for ring indices of HC</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;      listMixed; <span class="comment">// Vector for ring indices of rings that are both DDC and HC</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;ring::strucType&gt;</a></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;      ringType; <span class="comment">// This vector will have a value for each ring inside</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;                <span class="comment">// ringList, of type enum strucType in gen.hpp</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;  <span class="comment">// Make a list of all the DDCs and HCs</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;cage::Cage&gt;</a> cageList;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;std::vector&lt;int&gt;</a>&gt;</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;      ringsOneType;    <span class="comment">// Vector of vectors of rings of a single size</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;  <span class="keywordtype">int</span> initRingSize;    <span class="comment">// Todo or not: calculate the PNCs or not</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  <span class="keywordtype">int</span> maxRingSize = 6; <span class="comment">// DDCs and HCs are for 6-membered rings</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;cage::iceType&gt;</a></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;      atomTypes; <span class="comment">// This vector will have a value for every atom</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  <span class="comment">// Number of types</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  <span class="keywordtype">int</span> numHC, numDDC, mixedRings, prismaticRings, basalRings;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160; </div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  <span class="comment">// TODO: handle shapeMatching</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;  <span class="keywordtype">bool</span> doShapeMatching = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;  <span class="comment">// Qualifier for the RMSD per atom:</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;double&gt;</a> rmsdPerAtom;</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160; </div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;  <span class="comment">// test</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  <span class="comment">// std::cout &lt;&lt; &quot;rings&quot;</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  <span class="comment">//           &lt;&lt; &quot;\n&quot;;</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;  <span class="comment">// for (int i = 0; i &lt; rings.size(); i++) {</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;  <span class="comment">//   for (int j = 0; j &lt; rings[i].size(); j++) {</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;  <span class="comment">//     std::cout &lt;&lt; rings[i][j] &lt;&lt; &quot; &quot;;</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  <span class="comment">//   }</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  <span class="comment">//   std::cout &lt;&lt; &quot;\n&quot;;</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  <span class="comment">// }</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  <span class="comment">// std::cout &lt;&lt; &quot;\n&quot;;</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160; </div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;  <span class="keywordflow">if</span> (onlyTetrahedral) {</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    initRingSize = 6;</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    initRingSize = 5;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  }</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160; </div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  <span class="comment">// Init the atom type vector</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  atomTypes.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/resize.html">resize</a>(yCloud-&gt;nop); <span class="comment">// Has a value for each atom</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  <span class="comment">// Init the rmsd per atom (not used yet)</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  rmsdPerAtom.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/resize.html">resize</a>(yCloud-&gt;nop); <span class="comment">// Has a value for each atom</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160; </div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  <span class="comment">// ----------------------------------------------</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  <span class="comment">// Init</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  <span class="comment">// Get rings of size 5 or 6.</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ringSize = initRingSize; ringSize &lt;= maxRingSize; ringSize++) {</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    <span class="comment">// Clear ringsOneType</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    <a class="code" href="group__ring.html#ga76f3cb7aa8a713aeafecdf3a6fffee31">ring::clearRingList</a>(ringsOneType);</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    <span class="comment">// Get rings of the current ring size</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    ringsOneType = <a class="code" href="group__ring.html#gae9254c83de03fcf18b4cb5dcb2625011">ring::getSingleRingSize</a>(rings, ringSize);</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    <span class="comment">// Skip for zero rings</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    <span class="keywordflow">if</span> (ringsOneType.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/size.html">size</a>() == 0) {</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    } <span class="comment">// skip for no rings of ringSize</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    <span class="comment">// Init the ringType vector</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    ringType.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/resize.html">resize</a>(</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        ringsOneType.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/size.html">size</a>()); <span class="comment">// Has a value for each ring. init to zero.</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    <span class="comment">// ----------------------------------------------</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    <span class="keywordflow">if</span> (ringSize == 6) {</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;      <span class="comment">// Get the cages</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160; </div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;      <span class="comment">// Find HC rings, saving the ring IDs (starting from 0) to listHC</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;      listHC = <a class="code" href="group__prism3.html#gaf6c8e26a55c976c7ae810914bd1c7362">ring::findHC</a>(ringsOneType, &amp;ringType, nList, &amp;cageList);</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160; </div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;      <span class="comment">// Find DDC rings, saving the IDs to listDDC</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;      listDDC = <a class="code" href="group__prism3.html#ga35816c398a355ca472fddeb2869fce15">ring::findDDC</a>(ringsOneType, &amp;ringType, listHC, &amp;cageList);</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160; </div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;      <span class="comment">// Find rings which are both DDCs and HCs (mixed)</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;      <span class="comment">// A dummy value of -10 in the listDDC and listHC vectors for mixed rings</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;      listMixed =</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;          <a class="code" href="group__prism3.html#gadb3c8127d84cb2e90aafff55419f2c85">ring::findMixedRings</a>(ringsOneType, &amp;ringType, &amp;listDDC, &amp;listHC);</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160; </div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;      <span class="comment">// Get the number of structures (DDCs, HCs, mixed rings, basal rings,</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;      <span class="comment">// prismatic rings)</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;      <a class="code" href="group__prism3.html#ga6fcfac293a750bd14cbf1f94ab2a3976">ring::getStrucNumbers</a>(ringType, cageList, &amp;numHC, &amp;numDDC, &amp;mixedRings,</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;                            &amp;prismaticRings, &amp;basalRings);</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160; </div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;      <span class="comment">// Write out to a file</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;      <a class="code" href="namespacesout.html#a5ca5eeff9edc702cdcf1b26e8501dc0c">sout::writeTopoBulkData</a>(path, yCloud-&gt;currentFrame, numHC, numDDC,</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;                              mixedRings, basalRings, prismaticRings,</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;                              firstFrame);</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;      <span class="comment">// Gets the atom type for every atom, to be used for printing out the ice</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;      <span class="comment">// types found</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;      <a class="code" href="group__prism3.html#ga584708a1ea3d1503d7f38f0904b7f5f1">ring::getAtomTypesTopoBulk</a>(ringsOneType, ringType, &amp;atomTypes);</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    }</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    <span class="comment">// Finding prismatic blocks</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;      <span class="comment">// Get the prism block classifications</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;      <a class="code" href="group__prism3.html#gacb2bc68638bd794af38bcd503e17be0f">prism3::findBulkPrisms</a>(ringsOneType, &amp;ringType, nList, yCloud,</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;                             &amp;rmsdPerAtom);</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;      <span class="comment">// Gets the atom type for every atom, to be used for printing out the ice</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;      <span class="comment">// types found</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;      <a class="code" href="group__prism3.html#ga584708a1ea3d1503d7f38f0904b7f5f1">ring::getAtomTypesTopoBulk</a>(ringsOneType, ringType, &amp;atomTypes);</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    }</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;  }</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160; </div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;  <span class="comment">// Print out the lammps data file with the bonds</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;  <a class="code" href="namespacesout.html#aabeb7b712f568256cf3ed782fa91c518">sout::writeLAMMPSdataTopoBulk</a>(yCloud, nList, atomTypes, path);</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;  <span class="comment">// To output the bonds between dummy atoms, uncomment the following line</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;  <span class="comment">// sout::writeLAMMPSdataTopoBulk(yCloud, nList, atomTypes, path, true);</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160; </div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;  <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;}</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160; </div>
<div class="line"><a name="l00203"></a><span class="lineno"><a class="line" href="group__prism3.html#ga35816c398a355ca472fddeb2869fce15">  203</a></span>&#160;<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a> <a class="code" href="group__prism3.html#ga35816c398a355ca472fddeb2869fce15">ring::findDDC</a>(<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt;<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a>&gt; rings,</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;                               <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;ring::strucType&gt;</a> *ringType,</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;                               <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a> listHC,</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;                               <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;cage::Cage&gt;</a> *cageList) {</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a> listDDC;</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;  <span class="keywordtype">int</span> totalRingNum = rings.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/size.html">size</a>();  <span class="comment">// Total number of hexagonal rings</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a> peripheralRings; <span class="comment">// Indices which may be peripheral rings</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;  <span class="keywordtype">bool</span> cond1, cond2, cond3;         <span class="comment">// Conditions for DDC</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;  <span class="keywordtype">int</span> jring;                        <span class="comment">// Index for peripheral ring being added</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a> DDCRings; <span class="comment">// Indices of rings which constitute a single DDC,</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;                             <span class="comment">// with the equatorial ring first</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;  <span class="comment">// Vector for checking if a ring is basal, prismatic or peripheral</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;bool&gt;</a></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;      notEquatorial; <span class="comment">// true if the ring is prismatic, basal or peripheral.</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;  notEquatorial.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/resize.html">resize</a>(totalRingNum); <span class="comment">// Initialized to false</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160; </div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;  <span class="comment">// --------</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;  <span class="comment">// Set all basal and prismatic rings to true (which are part of an HC)</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; listHC.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/size.html">size</a>(); i++) {</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    <span class="keywordtype">int</span> currentRingIndex = listHC[i];</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    <span class="comment">// Set this to true</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    notEquatorial[currentRingIndex] = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;  } <span class="comment">// end of update of notEquatorial</span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;  <span class="comment">// --------</span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160; </div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;  <span class="comment">// To search for equatorial rings, loop through all</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;  <span class="comment">// the hexagonal rings</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iring = 0; iring &lt; totalRingNum; iring++) {</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    <span class="comment">// ------------</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    <span class="comment">// Step zero: If the ring has been classified as a basal or prismatic ring</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    <span class="comment">// in an HC or is a peripheral ring, then it cannot be the equatiorial ring</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    <span class="comment">// in a DDC</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    <span class="keywordflow">if</span> (notEquatorial[iring]) {</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    } <span class="comment">// skip for rings which are not equatorial</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    <span class="comment">// ------------</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    <span class="comment">// Init</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    peripheralRings.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/clear.html">clear</a>();</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    <span class="comment">// ------------</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    <span class="comment">// Step one: Find all rings which contain each index (m_k) of the equatorial</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    <span class="comment">// ring, iring, in at least three other rings</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    cond1 = <a class="code" href="group__prism3.html#ga09ce2b64c2b6b9bbd6cebc0f408c8f0e">ring::conditionOneDDC</a>(rings, &amp;peripheralRings, iring);</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    <span class="keywordflow">if</span> (cond1 == <span class="keyword">false</span>) {</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    }</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    <span class="comment">// ------------</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    <span class="comment">// Step two: For every triplet in iring, there is at least one</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    <span class="comment">// hexagonal ring other than iring that passes through the triplet.</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    <span class="comment">// The peripheral rings are stored in order of the starting element</span></div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    <span class="comment">// of each triplet.</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    cond2 = <a class="code" href="group__prism3.html#ga4da0e6df71b3f90131d1e38870644947">ring::conditionTwoDDC</a>(rings, &amp;peripheralRings, iring);</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    <span class="keywordflow">if</span> (cond2 == <span class="keyword">false</span>) {</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    }</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    <span class="comment">// ------------</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    <span class="comment">// Step three: For every triplet in the equatorial ring, there is at least</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    <span class="comment">// one hexagonal ring other than iring that passes through the triplet.</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    <span class="comment">// Rings corresponding to triplets need not be searched again since</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    <span class="comment">// peripheralRings are stored in that order. Rings corresponding to T1, T3,</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    <span class="comment">// T5 must have a common element. Similarly rings corresponding to T2, T4,</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    <span class="comment">// T6 must have at least one common element. Alternating rings corresponding</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    <span class="comment">// to triplets must have at least three common elements</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    cond3 = <a class="code" href="group__prism3.html#gacac718ff48a33be9c78d7b1cee16b04f">ring::conditionThreeDDC</a>(rings, &amp;peripheralRings);</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    <span class="keywordflow">if</span> (cond3 == <span class="keyword">false</span>) {</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    }</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    <span class="comment">// ------------</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    <span class="comment">// If the peripheral rings are duplicates, skip everything</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    sort(peripheralRings.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/begin.html">begin</a>(), peripheralRings.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/end.html">end</a>());</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    peripheralRings.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/erase.html">erase</a>(</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;        unique(peripheralRings.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/begin.html">begin</a>(), peripheralRings.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/end.html">end</a>()),</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;        peripheralRings.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/end.html">end</a>());</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    <span class="comment">// There should be 6 unique peripheral rings</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    <span class="keywordflow">if</span> (peripheralRings.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/size.html">size</a>() != 6) {</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    }</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    <span class="comment">// ------------</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    <span class="comment">// If iring is an equatorial ring, add it to the listDDC vector</span></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    <span class="keywordflow">if</span> ((*ringType)[iring] == <a class="code" href="group__ring.html#gga301cfdc88452cfe51bd4f745d223a7e1a60cc60f3804efaf86af8c2c2fbbe7208">ring::unclassified</a>) {</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;      (*ringType)[iring] = <a class="code" href="group__ring.html#gga301cfdc88452cfe51bd4f745d223a7e1a37a9bfe125a811135f6c77d832cef242">ring::DDC</a>;</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;      listDDC.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/push_back.html">push_back</a>(iring);</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    }</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <span class="comment">// Add the peripheral ring IDs too</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; peripheralRings.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/size.html">size</a>(); j++) {</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;      jring = peripheralRings[j];</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;      <span class="keywordflow">if</span> ((*ringType)[jring] == <a class="code" href="group__ring.html#gga301cfdc88452cfe51bd4f745d223a7e1a60cc60f3804efaf86af8c2c2fbbe7208">ring::unclassified</a>) {</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;        (*ringType)[jring] = <a class="code" href="group__ring.html#gga301cfdc88452cfe51bd4f745d223a7e1a37a9bfe125a811135f6c77d832cef242">ring::DDC</a>;</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;        listDDC.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/push_back.html">push_back</a>(jring);</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((*ringType)[jring] == <a class="code" href="group__ring.html#gga301cfdc88452cfe51bd4f745d223a7e1a48c3c5c40739122c0bf68fb9faeee9da">ring::HCbasal</a>) {</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;        (*ringType)[jring] = <a class="code" href="group__ring.html#gga301cfdc88452cfe51bd4f745d223a7e1a074049f7a1a6ea8338d256f5b4e586a2">ring::bothBasal</a>;</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;        listDDC.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/push_back.html">push_back</a>(jring);</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;      } <span class="comment">// end of update</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;      <span class="comment">// never true</span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((*ringType)[jring] == <a class="code" href="group__ring.html#gga301cfdc88452cfe51bd4f745d223a7e1a66afb615d90d5df19cce1df68e24d7f2">ring::HCprismatic</a>) {</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;        (*ringType)[jring] = <a class="code" href="group__ring.html#gga301cfdc88452cfe51bd4f745d223a7e1a6681861f6a3ec92005e0d5a0e4b7dfce">ring::bothPrismatic</a>;</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;        listDDC.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/push_back.html">push_back</a>(jring);</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;      }</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;      <span class="comment">//</span></div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;      <span class="comment">// Update the notEquatorial vector</span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;      notEquatorial[jring] = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    } <span class="comment">// end of update for peripheral rings</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    <span class="comment">// Add rings to the cageList vector of struct Cages.</span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    DDCRings.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/clear.html">clear</a>();          <span class="comment">// init</span></div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    DDCRings.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/push_back.html">push_back</a>(iring); <span class="comment">// Add the equatorial ring first</span></div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    DDCRings.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/insert.html">insert</a>(<a class="codeRef" href="http://en.cppreference.com/w/cpp/iterator/end.html">std::end</a>(DDCRings), <a class="codeRef" href="http://en.cppreference.com/w/cpp/iterator/begin.html">std::begin</a>(peripheralRings),</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;                    <a class="codeRef" href="http://en.cppreference.com/w/cpp/iterator/end.html">std::end</a>(peripheralRings));</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    (*cageList).push_back({<a class="code" href="group__cage.html#gga5787314f51b5927c213db48b81c21d95ac5a9e4f20bab07bef66bb6e15c49682d">cage::DoubleDiaC</a>, DDCRings});</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    <span class="comment">// ------------</span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;  } <span class="comment">// end of loop through all hexagonal rings</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160; </div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;  <span class="keywordflow">return</span> listDDC;</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;}</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160; </div>
<div class="line"><a name="l00334"></a><span class="lineno"><a class="line" href="group__prism3.html#ga09ce2b64c2b6b9bbd6cebc0f408c8f0e">  334</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="group__prism3.html#ga09ce2b64c2b6b9bbd6cebc0f408c8f0e">ring::conditionOneDDC</a>(<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt;<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a>&gt; rings,</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;                           <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a> *peripheralRings, <span class="keywordtype">int</span> iring) {</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;  <span class="keywordtype">int</span> index; <span class="comment">// Atom ID to be compared</span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;  <span class="keywordtype">int</span> noOfCommonRings =</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;      0;        <span class="comment">// No of rings in which the element to be matched has been found</span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;  <span class="keywordtype">int</span> jElement; <span class="comment">// Atom ID being compared to index</span></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160; </div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;  <span class="comment">// Loop through each element of iring for finding matches</span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> m = 0; m &lt; 6; m++) {</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    index = rings[iring][m]; <span class="comment">// Atom Index to be compared and matched with</span></div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    noOfCommonRings = 0;     <span class="comment">// init to zero.</span></div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    <span class="comment">// Loop through every ring except iring</span></div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> jring = 0; jring &lt; rings.size(); jring++) {</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;      <span class="keywordflow">if</span> (iring == jring) {</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;      } <span class="comment">// Skip for iring</span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;      <span class="comment">// -------</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;      <span class="comment">// Search every element of jring</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; 6; k++) {</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;        jElement = rings[jring][k];</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;        <span class="keywordflow">if</span> (jElement == index) {</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;          noOfCommonRings++;</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;          (*peripheralRings).push_back(jring);</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;        } <span class="comment">// if index is found inside jring</span></div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;          <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;        }</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;      } <span class="comment">// end of loop through every element of jring</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;      <span class="comment">// -------</span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    } <span class="comment">// end of loop through all rings except iring</span></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    <span class="comment">// If less than 3 rings have been found for each element, then this is</span></div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    <span class="comment">// not an equatorial ring</span></div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    <span class="keywordflow">if</span> (noOfCommonRings &lt; 3) {</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    } <span class="comment">// end of check for common ring number per element in iring</span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;  }   <span class="comment">// end of loop through each element of iring</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160; </div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;  <span class="comment">// iring is an equatorial ring. The duplicate ring IDs inside</span></div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;  <span class="comment">// peripheralRings should be removed</span></div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;::iterator</a> ip; <span class="comment">// Iterator to find the last element upto</span></div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;                                 <span class="comment">// which unique elements are present</span></div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;  <span class="comment">// Duplicate IDs must be removed</span></div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;  <span class="keywordtype">int</span> numElements =</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;      (*peripheralRings).<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/size.html">size</a>(); <span class="comment">// number of elements in peripheralRings</span></div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;  sort((*peripheralRings).begin(), (*peripheralRings).end());</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;  ip = <a class="codeRef" href="http://en.cppreference.com/w/cpp/algorithm/unique.html">std::unique</a>((*peripheralRings).begin(),</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;                   (*peripheralRings).begin() + numElements);</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;  <span class="comment">// Resize peripheral rings to remove undefined terms</span></div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;  (*peripheralRings).resize(<a class="codeRef" href="http://en.cppreference.com/w/cpp/iterator/distance.html">std::distance</a>((*peripheralRings).begin(), ip));</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160; </div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;}</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160; </div>
<div class="line"><a name="l00406"></a><span class="lineno"><a class="line" href="group__prism3.html#ga4da0e6df71b3f90131d1e38870644947">  406</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="group__prism3.html#ga4da0e6df71b3f90131d1e38870644947">ring::conditionTwoDDC</a>(<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt;<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a>&gt; rings,</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;                           <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a> *peripheralRings, <span class="keywordtype">int</span> iring) {</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a> triplet; <span class="comment">//  Triplet formed from iring</span></div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;  <span class="keywordtype">int</span> ringSize = 6;         <span class="comment">// Here, all the rings are hexagons</span></div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;  <span class="keywordtype">int</span> j;                    <span class="comment">// Used for making the triplet</span></div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;  <span class="keywordtype">int</span> jring;                <span class="comment">// Peripheral ring ID to be searched</span></div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;  <span class="keywordtype">int</span> count;                <span class="comment">// Number of  rings found that match the triplet</span></div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a></div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;      newPeripherals; <span class="comment">// Vector in which the new peripheral ring IDs are saved.</span></div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;                      <span class="comment">// This will be swapped with peripheralRings later</span></div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160; </div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; ringSize; k++) {</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    triplet.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/clear.html">clear</a>(); <span class="comment">// Clear the triplet</span></div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    <span class="comment">// Get a triplet</span></div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = k; i &lt; k + 3; i++) {</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;      j = i;</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;      <span class="keywordflow">if</span> (i &gt;= ringSize) {</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;        j = i - ringSize;</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;      }</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;      triplet.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/push_back.html">push_back</a>(rings[iring][j]);</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    } <span class="comment">// end of getting a triplet from k</span></div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    <span class="comment">// -------------</span></div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    <span class="comment">// Compare the triplet with every possible peripheral</span></div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    <span class="comment">// ring inside peripheralRings.</span></div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    count = 0; <span class="comment">// init to zero</span></div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    <span class="comment">// Loop through all possible peripheral rings</span></div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> m = 0; m &lt; (*peripheralRings).size(); m++) {</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;      jring = (*peripheralRings)[m]; <span class="comment">// Ring ID of ring to be searched</span></div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;      <span class="comment">// Search inside the ring with index jring for the triplet</span></div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;      <span class="keywordtype">bool</span> foundTriplet = <a class="code" href="group__ring.html#ga3cca615046ff98165863e95fdadce530">ring::findTripletInRing</a>(rings[jring], triplet);</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160; </div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;      <span class="comment">// If the triplet has been found inside jring</span></div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;      <span class="keywordflow">if</span> (foundTriplet) {</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;        newPeripherals.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/push_back.html">push_back</a>(jring); <span class="comment">// Update new peripheral vector</span></div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;        count++;</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;      } <span class="comment">// end of ring found</span></div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    }   <span class="comment">// end of loop through all possible peripheral rings</span></div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;    <span class="comment">// If count is 0, then the triplet was not found in any peripheral ring</span></div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;    <span class="keywordflow">if</span> (count == 0) {</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    } <span class="comment">// Return false since the triplet was not found</span></div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    <span class="comment">// -------------</span></div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;  } <span class="comment">// end of looping through 0-6 to get triplets</span></div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160; </div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;  <span class="comment">// Swap the old peripheral rings vector with the new one</span></div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;  (*peripheralRings).swap(newPeripherals);</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160; </div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;  <span class="comment">// If there are more than 6 peripheral rings, the code will fail</span></div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;  <span class="comment">// Comment this out if you want</span></div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;  <span class="keywordflow">if</span> ((*peripheralRings).size() &gt; 6) {</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    <a class="codeRef" href="http://en.cppreference.com/w/cpp/io/basic_ostream.html">std::cerr</a></div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;There are more than 6 peripheral rings. The code will fail. \n&quot;</span>;</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;  } <span class="comment">// end of check for more than 6 peripherals</span></div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160; </div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;}</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160; </div>
<div class="line"><a name="l00487"></a><span class="lineno"><a class="line" href="group__prism3.html#gacac718ff48a33be9c78d7b1cee16b04f">  487</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="group__prism3.html#gacac718ff48a33be9c78d7b1cee16b04f">ring::conditionThreeDDC</a>(<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt;<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a>&gt; rings,</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;                             <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a> *peripheralRings) {</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;  <span class="comment">// New</span></div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a> common; <span class="comment">// Vector containing common elements</span></div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;  <span class="keywordtype">bool</span> hasCommon;          <span class="comment">// true if the rings have a common element</span></div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;  <span class="keywordtype">int</span> iring, jring;        <span class="comment">// Pairs of peripheral rings</span></div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;  <span class="comment">// ----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;  <span class="comment">// CONDITION 1: Rings corresponding to T1, T3, T5 should have at least one</span></div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;  <span class="comment">// common element.</span></div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;  hasCommon = <a class="code" href="group__ring.html#ga0d4e6d1dca2b07091dc0d94999c36ed9">ring::commonElementsInThreeRings</a>(rings[(*peripheralRings)[0]],</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;                                               rings[(*peripheralRings)[2]],</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;                                               rings[(*peripheralRings)[4]]);</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160; </div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;  <span class="comment">// If T1, T3, T5 don&#39;t have a common element, return false</span></div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;  <span class="keywordflow">if</span> (!hasCommon) {</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;  } <span class="comment">// not a DDC</span></div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;  <span class="comment">// ----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;  <span class="comment">// CONDITION 2: Rings corresponding to T1, T3, T5 should have at least one</span></div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;  <span class="comment">// common element.</span></div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;  hasCommon = <a class="code" href="group__ring.html#ga0d4e6d1dca2b07091dc0d94999c36ed9">ring::commonElementsInThreeRings</a>(rings[(*peripheralRings)[1]],</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;                                               rings[(*peripheralRings)[3]],</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;                                               rings[(*peripheralRings)[5]]);</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160; </div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;  <span class="comment">// If T1, T3, T5 don&#39;t have a common element, return false</span></div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;  <span class="keywordflow">if</span> (!hasCommon) {</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;  } <span class="comment">// not a DDC</span></div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;  <span class="comment">// ----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;  <span class="comment">// CONDITION 3: Rings corresponding to {T1, T3}, {T2, T4}, {T3, T5}, {T4,</span></div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;  <span class="comment">// T6}</span></div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;  <span class="comment">// must have three elements in common amongst them</span></div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160; </div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;  <span class="comment">// Loops to get pairs of rings corresponding to the right triplets</span></div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt;= 3; i++) {</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;    common.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/clear.html">clear</a>(); <span class="comment">// init</span></div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;    <span class="comment">// Pairs of rings corresponding to triplets.</span></div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;    iring = (*peripheralRings)[i];</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;    jring = (*peripheralRings)[i + 2];</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;    <span class="comment">// Get the common elements</span></div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;    common = <a class="code" href="group__ring.html#gaed5f39c14a4d76c1746aed53e0d0a2dc">ring::findsCommonElements</a>(rings[iring], rings[jring]);</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;    <span class="comment">// There should be at least three elements</span></div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;    <span class="keywordflow">if</span> (common.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/size.html">size</a>() &lt; 3) {</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;    } <span class="comment">// not a DDC</span></div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;  }   <span class="comment">// end of getting iring and jring</span></div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;  <span class="comment">// ----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160; </div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;  <span class="comment">// iring is an equatorial ring and peripheralRings has the 6 peripheral rings</span></div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;}</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160; </div>
<div class="line"><a name="l00569"></a><span class="lineno"><a class="line" href="group__prism3.html#gaf6c8e26a55c976c7ae810914bd1c7362">  569</a></span>&#160;<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a> <a class="code" href="group__prism3.html#gaf6c8e26a55c976c7ae810914bd1c7362">ring::findHC</a>(<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt;<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a>&gt; rings,</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;                              <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;ring::strucType&gt;</a> *ringType,</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;                              <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt;<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a>&gt; nList,</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;                              <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;cage::Cage&gt;</a> *cageList) {</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a> listHC;</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;  <span class="keywordtype">int</span> totalRingNum = rings.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/size.html">size</a>(); <span class="comment">// Total number of hexagonal rings</span></div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a> basal1;         <span class="comment">// First basal ring</span></div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a> basal2;         <span class="comment">// Second basal ring</span></div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;  <span class="keywordtype">bool</span> cond1, cond2; <span class="comment">// Conditions for rings to be basal (true) or not (false)</span></div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a></div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;      HCRings; <span class="comment">// Indices of rings which constitute a single HC, with the basal</span></div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;               <span class="comment">// rings first, followed by prismatic rings</span></div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a> prismaticRings; <span class="comment">// Ring indices of prismatic rings</span></div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;  <span class="keywordtype">int</span> kring;                       <span class="comment">// Ring index of the prismatic rings</span></div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;bool&gt;</a></div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;      isPrismatic; <span class="comment">// Flag for checking if the ring is prismatic (true) or not</span></div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;                   <span class="comment">// (false), since the basal rings are checked</span></div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;  isPrismatic.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/resize.html">resize</a>(totalRingNum); <span class="comment">// Initialized to false</span></div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160; </div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;  <span class="comment">// Two loops through all the rings are required to find pairs of basal rings</span></div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iring = 0; iring &lt; totalRingNum - 1; iring++) {</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;    <span class="comment">// -----------------------</span></div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;    <span class="comment">// Skip if iring is prismatic</span></div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;    <span class="keywordflow">if</span> (isPrismatic[iring]) {</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;    } <span class="comment">// Skip if prismatic</span></div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;    <span class="comment">// -----------------------</span></div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;    cond1 = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;    cond2 = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;    basal1 = rings[iring]; <span class="comment">// Assign iring to basal1</span></div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;    <span class="comment">// Loop through the other rings to get a pair</span></div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> jring = iring + 1; jring &lt; totalRingNum; jring++) {</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;      <span class="comment">// -----------------------</span></div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;      <span class="comment">// Skip if iring is prismatic</span></div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;      <span class="keywordflow">if</span> (isPrismatic[jring]) {</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;      }                      <span class="comment">// Skip if prismatic</span></div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;                             <span class="comment">// -----------------------</span></div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;      basal2 = rings[jring]; <span class="comment">// Assign jring to basal2</span></div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;      <span class="comment">// ------------</span></div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;      <span class="comment">// Step one: Check to see if basal1 and basal2 have common</span></div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;      <span class="comment">// elements or not. If they don&#39;t, then they cannot be basal rings</span></div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;      cond1 = <a class="code" href="group__ring.html#gac30855d0daa2b20c29e4dee39f5cd92f">ring::hasCommonElements</a>(basal1, basal2);</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;      <span class="keywordflow">if</span> (cond1 == <span class="keyword">true</span>) {</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;      }</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;      <span class="comment">// -----------</span></div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;      <span class="comment">// Step two and three: One of the elements of basal2 must be the nearest</span></div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;      <span class="comment">// neighbour of either the first (index0; l1) or second (index1; l2)</span></div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;      <span class="comment">// element of basal1. If m_k is the nearest neighbour of l1, m_{k+2} and</span></div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;      <span class="comment">// m_{k+4} must be neighbours of l3 and l5(l5 or l3). Modify for l2.</span></div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;      cond2 = <a class="code" href="group__prism3.html#gaab56bd69fb1698bf7fde8f04774c000f">ring::basalConditions</a>(nList, &amp;basal1, &amp;basal2);</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;      <span class="keywordflow">if</span> (cond2 == <span class="keyword">false</span>) {</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;      }</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;      <span class="comment">// -----------</span></div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;      <span class="comment">// iring and jring are basal rings!</span></div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;      <span class="comment">// Update iring</span></div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;      <span class="keywordflow">if</span> ((*ringType)[iring] == <a class="code" href="group__ring.html#gga301cfdc88452cfe51bd4f745d223a7e1a60cc60f3804efaf86af8c2c2fbbe7208">ring::unclassified</a>) {</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;        (*ringType)[iring] = <a class="code" href="group__ring.html#gga301cfdc88452cfe51bd4f745d223a7e1a48c3c5c40739122c0bf68fb9faeee9da">ring::HCbasal</a>;</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;        listHC.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/push_back.html">push_back</a>(iring);</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((*ringType)[iring] == <a class="code" href="group__ring.html#gga301cfdc88452cfe51bd4f745d223a7e1a37a9bfe125a811135f6c77d832cef242">ring::DDC</a>) {</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;        (*ringType)[iring] = <a class="code" href="group__ring.html#gga301cfdc88452cfe51bd4f745d223a7e1a074049f7a1a6ea8338d256f5b4e586a2">ring::bothBasal</a>;</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;        listHC.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/push_back.html">push_back</a>(iring);</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;      }</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;      <span class="comment">// Update jring</span></div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;      <span class="keywordflow">if</span> ((*ringType)[jring] == <a class="code" href="group__ring.html#gga301cfdc88452cfe51bd4f745d223a7e1a60cc60f3804efaf86af8c2c2fbbe7208">ring::unclassified</a>) {</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;        (*ringType)[jring] = <a class="code" href="group__ring.html#gga301cfdc88452cfe51bd4f745d223a7e1a48c3c5c40739122c0bf68fb9faeee9da">ring::HCbasal</a>;</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;        listHC.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/push_back.html">push_back</a>(jring);</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((*ringType)[jring] == <a class="code" href="group__ring.html#gga301cfdc88452cfe51bd4f745d223a7e1a37a9bfe125a811135f6c77d832cef242">ring::DDC</a>) {</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;        (*ringType)[jring] = <a class="code" href="group__ring.html#gga301cfdc88452cfe51bd4f745d223a7e1a074049f7a1a6ea8338d256f5b4e586a2">ring::bothBasal</a>;</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;        listHC.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/push_back.html">push_back</a>(jring);</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;      }</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;      <span class="comment">// Find the prismatic rings</span></div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;      prismaticRings.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/clear.html">clear</a>(); <span class="comment">// Clear the prismatic ring vector first</span></div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;      <a class="code" href="group__prism3.html#gac3fdc9b1b49afad809867bb4def9a16c">ring::findPrismatic</a>(rings, &amp;listHC, ringType, iring, jring,</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;                          &amp;prismaticRings);</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;      <span class="comment">// Update the prismatic rings</span></div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; prismaticRings.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/size.html">size</a>(); k++) {</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;        kring =</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;            prismaticRings[k]; <span class="comment">// Current ring index of the (3) prismatic rings</span></div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;        <span class="comment">// Update kring</span></div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;        <span class="keywordflow">if</span> ((*ringType)[kring] == <a class="code" href="group__ring.html#gga301cfdc88452cfe51bd4f745d223a7e1a60cc60f3804efaf86af8c2c2fbbe7208">ring::unclassified</a>) {</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;          (*ringType)[kring] = <a class="code" href="group__ring.html#gga301cfdc88452cfe51bd4f745d223a7e1a66afb615d90d5df19cce1df68e24d7f2">ring::HCprismatic</a>;</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;          listHC.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/push_back.html">push_back</a>(kring);</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((*ringType)[kring] == <a class="code" href="group__ring.html#gga301cfdc88452cfe51bd4f745d223a7e1a37a9bfe125a811135f6c77d832cef242">ring::DDC</a>) {</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;          (*ringType)[kring] = <a class="code" href="group__ring.html#gga301cfdc88452cfe51bd4f745d223a7e1a6681861f6a3ec92005e0d5a0e4b7dfce">ring::bothPrismatic</a>;</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;          listHC.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/push_back.html">push_back</a>(kring);</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;        }</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;        <span class="comment">// Update the isPrismatic vector</span></div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;        isPrismatic[kring] = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;      } <span class="comment">// End of update of prismatic rings in listHC</span></div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;      <span class="comment">// -----------</span></div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;      <span class="comment">// Update the cageList vector of Cages</span></div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;      <span class="comment">// Update the basal rings</span></div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;      HCRings.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/clear.html">clear</a>();</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;      HCRings.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/push_back.html">push_back</a>(iring);</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;      HCRings.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/push_back.html">push_back</a>(jring);</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;      <span class="comment">// Add the prismaticRings</span></div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;      HCRings.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/insert.html">insert</a>(<a class="codeRef" href="http://en.cppreference.com/w/cpp/iterator/end.html">std::end</a>(HCRings), <a class="codeRef" href="http://en.cppreference.com/w/cpp/iterator/begin.html">std::begin</a>(prismaticRings),</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;                     <a class="codeRef" href="http://en.cppreference.com/w/cpp/iterator/end.html">std::end</a>(prismaticRings));</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;      (*cageList).push_back({<a class="code" href="group__cage.html#gga5787314f51b5927c213db48b81c21d95a0ff989d0b3eed06750ff06c8bc95c84d">cage::HexC</a>, HCRings});</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;      <span class="comment">// -----------</span></div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;    } <span class="comment">// end of loop through rest of the rings to get the second basal ring</span></div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;  }   <span class="comment">// end of loop through all rings for first basal ring</span></div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160; </div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;  sort(listHC.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/begin.html">begin</a>(), listHC.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/end.html">end</a>());</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;  <span class="keyword">auto</span> ip = <a class="codeRef" href="http://en.cppreference.com/w/cpp/algorithm/unique.html">std::unique</a>(listHC.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/begin.html">begin</a>(), listHC.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/end.html">end</a>());</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;  <span class="comment">// Resize peripheral rings to remove undefined terms</span></div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;  listHC.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/resize.html">resize</a>(<a class="codeRef" href="http://en.cppreference.com/w/cpp/iterator/distance.html">std::distance</a>(listHC.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/begin.html">begin</a>(), ip));</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160; </div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;  <span class="keywordflow">return</span> listHC;</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;}</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160; </div>
<div class="line"><a name="l00704"></a><span class="lineno"><a class="line" href="group__prism3.html#gaab56bd69fb1698bf7fde8f04774c000f">  704</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="group__prism3.html#gaab56bd69fb1698bf7fde8f04774c000f">ring::basalConditions</a>(<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt;<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a>&gt; nList,</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;                           <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a> *basal1, <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a> *basal2) {</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;  <span class="keywordtype">int</span> l1 = (*basal1)[0]; <span class="comment">// first element of basal1 ring</span></div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;  <span class="keywordtype">int</span> l2 = (*basal1)[1]; <span class="comment">// second element of basal1 ring</span></div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;  <span class="keywordtype">int</span> ringSize = 6;      <span class="comment">// Size of the ring; each ring contains 6 elements</span></div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;  <span class="keywordtype">int</span> m_k;               <span class="comment">// Atom Index (in pointCloud) of element in basal2</span></div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;  <span class="keywordtype">int</span> kIndex;            <span class="comment">// Index of m_k in basal2, corresponding to m_k</span></div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;  <span class="keywordtype">int</span> currentKindex;     <span class="comment">// Current k index when finding alternating elements of</span></div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;                         <span class="comment">// basal2</span></div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a> evenTriplet; <span class="comment">// contains m_k, m_{k+2}, m_{k+4}</span></div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a> oddTriplet;  <span class="comment">// contains m_{k+1}, m_{k+3}, m_{k+5}</span></div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;  <span class="keywordtype">int</span> compare1, compare2;       <span class="comment">// l3 and l5 OR l4 and l6</span></div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;  <span class="keywordtype">int</span> index;</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;  <span class="keywordtype">bool</span> l1_neighbour, l2_neighbour; <span class="comment">// m_k is a neighbour of l1(true) or not</span></div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;                                   <span class="comment">// (false); m_k is a neighbour of l2(true)</span></div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;  <span class="keywordtype">bool</span> isNeigh, notNeigh; <span class="comment">// Used to check if the rings are basal or not</span></div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160; </div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;  <span class="comment">// ---------------------------------------------</span></div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;  <span class="comment">// SEARCH FOR L1_NEIGHBOUR OR L2_NEIGHBOUR</span></div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;  <span class="comment">// Search for whether an element of basal2 is a neighbour of l1 or l2</span></div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; ringSize; k++) {</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;    <span class="comment">// init</span></div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;    l1_neighbour = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;    l2_neighbour = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;    m_k = (*basal2)[k];</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160; </div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;    <span class="comment">// ---------------</span></div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;    <span class="comment">// CHECK IF M_K MATCHES L1 NEIGHBOURS</span></div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;    <span class="keyword">auto</span> it1 = <a class="codeRef" href="http://en.cppreference.com/w/cpp/algorithm/find.html">std::find</a>(nList[l1].begin() + 1, nList[l1].end(), m_k);</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;    <span class="comment">// If m_k was found in l1&#39;s nList</span></div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;    <span class="keywordflow">if</span> (it1 != nList[l1].end()) {</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;      compare1 = (*basal1)[2]; <span class="comment">// l3</span></div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;      compare2 = (*basal1)[4]; <span class="comment">// l5</span></div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;      kIndex = k;              <span class="comment">// Saving the array index of m_k</span></div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;      l1_neighbour = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;    } <span class="comment">// m_k found in l1&#39;s nList</span></div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;    <span class="comment">// ---------------</span></div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;    <span class="comment">// CHECK IF M_K MATCHES L2 NEIGHBOURS</span></div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;    <span class="keyword">auto</span> it2 = <a class="codeRef" href="http://en.cppreference.com/w/cpp/algorithm/find.html">std::find</a>(nList[l2].begin() + 1, nList[l2].end(), m_k);</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;    <span class="comment">// If m_k was found in l1&#39;s nList</span></div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;    <span class="keywordflow">if</span> (it2 != nList[l2].end()) {</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;      compare1 = (*basal1)[3]; <span class="comment">// l4</span></div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;      compare2 = (*basal1)[5]; <span class="comment">// l6</span></div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;      kIndex = k;              <span class="comment">// Saving the array index of m_k</span></div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;      l2_neighbour = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;    } <span class="comment">// m_k found in l1&#39;s nList</span></div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;    <span class="comment">// ---------------</span></div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;  } <span class="comment">// End of search for basal2 elements in l1 or l2&#39;s nList</span></div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;  <span class="comment">// ---------------------------------------------</span></div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160; </div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;  <span class="comment">// Return false if neither l1 nor l2 have any neighbours</span></div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;  <span class="comment">// in basal2</span></div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160; </div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;  <span class="keywordflow">if</span> (l1_neighbour == <span class="keyword">false</span> &amp;&amp; l2_neighbour == <span class="keyword">false</span>) {</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;  } <span class="comment">// basal conditions not fulfilled</span></div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160; </div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;  <span class="comment">// Get the alternating elements starting with kIndex.</span></div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;  <span class="comment">// &#39;evenTriplet&#39;: m_k, m_{k+2}, m_{k+4} - neighbours of compare1 and compare2.</span></div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;  <span class="comment">// &#39;oddTriplet&#39;: m_{k+1}, m_{k+3}, m_{k+5}- cannot be neighbours of basal1</span></div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt;= 5; k++) {</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;    currentKindex = kIndex + k; <span class="comment">// k</span></div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;    <span class="comment">// Wrap-around</span></div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;    <span class="keywordflow">if</span> (currentKindex &gt;= ringSize) {</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;      currentKindex -= ringSize;</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;    } <span class="comment">// end of wrap-around of k</span></div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;    <span class="comment">// Update &#39;evenTriplet&#39;</span></div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;    <span class="keywordflow">if</span> (k % 2 == 0) {</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;      evenTriplet.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/push_back.html">push_back</a>((*basal2)[currentKindex]);</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;    } <span class="comment">// end of update of evenTriplet</span></div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;    <span class="comment">// Update &#39;oddTriplet&#39;</span></div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;      oddTriplet.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/push_back.html">push_back</a>((*basal2)[currentKindex]);</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;    } <span class="comment">// end of update of oddTriplet</span></div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;  }   <span class="comment">// End of getting alternating triplets</span></div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160; </div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;  <span class="comment">// ---------------------------------------------</span></div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;  <span class="comment">// CONDITION1: m_{k+2} and m_{k+4} must be bonded to l3 and l5 (if l1 is a</span></div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;  <span class="comment">// neighbour) or m_{k+2} and m_{k+4} must be bonded to l4 and l6 (if l2 is a</span></div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;  <span class="comment">// neighbour) Basically, this boils down to checking whether compare1 and</span></div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;  <span class="comment">// compare2 are in the neighbour lists of the last two elements of evenTriplet</span></div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160; </div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;  isNeigh = <a class="code" href="group__prism3.html#ga0e7cb0c140c8e1ed43878202a7380eca">ring::basalNeighbours</a>(nList, &amp;evenTriplet, compare1, compare2);</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160; </div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;  <span class="comment">// If condition1 is not true, then the candidate</span></div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;  <span class="comment">// rings are not part of an HC</span></div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;  <span class="keywordflow">if</span> (!isNeigh) {</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;  } <span class="comment">// Not an HC</span></div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160; </div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;  <span class="comment">// ---------------------------------------------</span></div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;  <span class="comment">// CONDITION2: m_{k+1}, m_{k+3} and m_{k+5} must NOT be bonded to any element</span></div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;  <span class="comment">// in basal1.</span></div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;  <span class="comment">// Basically, this boils down to checking whether the elements of oddTriplet</span></div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;  <span class="comment">// are in the neighbour lists of all the elements of basal1.</span></div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160; </div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;  <span class="comment">// condition 2. This must be true for an HC</span></div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;  notNeigh = <a class="code" href="group__prism3.html#ga094fa5ff41584671fed91ac60396d141">ring::notNeighboursOfRing</a>(nList, &amp;oddTriplet, basal1);</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160; </div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;  <span class="comment">// If condition2 is not true, the the candidate rings</span></div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;  <span class="comment">// are not part of an HC</span></div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;  <span class="keywordflow">if</span> (!notNeigh) {</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;  } <span class="comment">// Not an HC</span></div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160; </div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;  <span class="comment">// Otherwise, all the conditions are true and this is an HC</span></div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160; </div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;} <span class="comment">// end of function</span></div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160; </div>
<div class="line"><a name="l00826"></a><span class="lineno"><a class="line" href="group__prism3.html#ga0e7cb0c140c8e1ed43878202a7380eca">  826</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="group__prism3.html#ga0e7cb0c140c8e1ed43878202a7380eca">ring::basalNeighbours</a>(<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt;<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a>&gt; nList,</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;                           <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a> *triplet, <span class="keywordtype">int</span> atomOne,</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;                           <span class="keywordtype">int</span> atomTwo) {</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;  <span class="comment">// Search for needles in a haystack :)</span></div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;  <span class="keywordtype">int</span> needle1 = (*triplet)[1];</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;  <span class="keywordtype">int</span> needle2 = (*triplet)[2];</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;  <span class="keywordtype">bool</span> neighbourFound = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;  <span class="keywordtype">bool</span> neighOne = <span class="keyword">false</span>,</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;       neighTwo = <span class="keyword">false</span>; <span class="comment">// Neighbour for atomOne, or neighbour for atomTwo</span></div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;  <span class="comment">// ----------------------------</span></div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;  <span class="comment">// For first element needle1, which must belong to either atomOne&#39;s or</span></div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;  <span class="comment">// atomTwo&#39;s neighbour list Search atomOne&#39;s neighbours</span></div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;  <span class="keyword">auto</span> it =</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;      <a class="codeRef" href="http://en.cppreference.com/w/cpp/algorithm/find.html">std::find</a>(nList[atomOne].begin() + 1, nList[atomOne].end(), needle1);</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;  <span class="keywordflow">if</span> (it != nList[atomOne].end()) {</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;    neighbourFound = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;    neighOne = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;  } <span class="comment">// atomOne&#39;s neighbour</span></div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;  <span class="comment">// If it is not atomOne&#39;s neighbour, it might be atomTwo&#39;s neighbour</span></div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;  <span class="keywordflow">if</span> (!neighOne) {</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;    it = <a class="codeRef" href="http://en.cppreference.com/w/cpp/algorithm/find.html">std::find</a>(nList[atomTwo].begin() + 1, nList[atomTwo].end(), needle1);</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;    <span class="keywordflow">if</span> (it != nList[atomTwo].end()) {</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;      neighbourFound = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;      neighTwo = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;    } <span class="comment">// end of check to see if neighbour was found</span></div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;  }   <span class="comment">// End of check to see if needle1 is atomTwo&#39;s neighbour</span></div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;  <span class="comment">// ----------------------------</span></div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;  <span class="comment">// If needle1 is not a neighbour of atomOne or atomTwo, return false</span></div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;  <span class="keywordflow">if</span> (neighbourFound == <span class="keyword">false</span>) {</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;  }</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160; </div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;  <span class="comment">// Check to see if needle2 is a neighbour of either atomOne or atomTwo</span></div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;  <span class="comment">// ===============</span></div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;  <span class="comment">// if atomOne was a neighbour of needle1, needle2 must be a neighbour of</span></div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;  <span class="comment">// atomTwo</span></div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;  <span class="keywordflow">if</span> (neighOne) {</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;    it = <a class="codeRef" href="http://en.cppreference.com/w/cpp/algorithm/find.html">std::find</a>(nList[atomTwo].begin() + 1, nList[atomTwo].end(), needle2);</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;    <span class="comment">// It is a neighbour</span></div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;    <span class="keywordflow">if</span> (it != nList[atomTwo].end()) {</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;    }</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;    <span class="comment">// It is not a neighbour</span></div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;    }</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;  } <span class="comment">// End of check for neighbour of atomTwo</span></div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;  <span class="comment">// ===============</span></div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;  <span class="comment">// if atomTwo was a neighbour of needle1, needle2 must be a neighbour of</span></div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;  <span class="comment">// atomOne</span></div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;  <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;    it = <a class="codeRef" href="http://en.cppreference.com/w/cpp/algorithm/find.html">std::find</a>(nList[atomOne].begin() + 1, nList[atomOne].end(), needle2);</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;    <span class="comment">// It is a neighbour</span></div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;    <span class="keywordflow">if</span> (it != nList[atomOne].end()) {</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;    }</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;    <span class="comment">// It is not a neighbour</span></div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;    }</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;  }</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;  <span class="comment">// ===============</span></div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;}</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160; </div>
<div class="line"><a name="l00899"></a><span class="lineno"><a class="line" href="group__prism3.html#ga094fa5ff41584671fed91ac60396d141">  899</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="group__prism3.html#ga094fa5ff41584671fed91ac60396d141">ring::notNeighboursOfRing</a>(<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt;<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a>&gt; nList,</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;                               <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a> *triplet,</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;                               <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a> *<a class="code" href="namespacering.html">ring</a>) {</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;  <span class="keywordtype">int</span> iatom; <span class="comment">// AtomID of the atom to be searched for inside the neighbour</span></div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;             <span class="comment">// lists</span></div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;  <span class="keywordtype">int</span> jatom; <span class="comment">// AtomID of in whose neighbour list iatom will be searched for</span></div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;::iterator</a> it;</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160; </div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; (*triplet).size(); i++) {</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;    iatom = (*triplet)[i]; <span class="comment">// AtomID to be searched for</span></div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;    <span class="comment">// iatom must be searched for in the neighbour lists of all elements</span></div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;    <span class="comment">// of the ring vector</span></div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; (*ring).size(); j++) {</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;      jatom = (*ring)[j];</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;      <span class="comment">// ------------------</span></div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;      <span class="comment">// Search for iatom in the neighbour list of jatom</span></div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;      it = <a class="codeRef" href="http://en.cppreference.com/w/cpp/algorithm/find.html">std::find</a>(nList[jatom].begin() + 1, nList[jatom].end(), iatom);</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;      <span class="comment">// It is a neighbour!</span></div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;      <span class="keywordflow">if</span> (it != nList[jatom].end()) {</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;      }</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;      <span class="comment">// ------------------</span></div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;    } <span class="comment">// end of loop through every element of ring</span></div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;  }   <span class="comment">// end of loop through all triplet elements</span></div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160; </div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;}</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160; </div>
<div class="line"><a name="l00939"></a><span class="lineno"><a class="line" href="group__prism3.html#gac3fdc9b1b49afad809867bb4def9a16c">  939</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="group__prism3.html#gac3fdc9b1b49afad809867bb4def9a16c">ring::findPrismatic</a>(<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt;<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a>&gt; rings,</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;                        <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a> *listHC,</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;                        <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;ring::strucType&gt;</a> *ringType, <span class="keywordtype">int</span> iring,</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;                        <span class="keywordtype">int</span> jring, <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a> *prismaticRings) {</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;  <span class="keywordtype">int</span> iIndex, jIndex;             <span class="comment">// Used for making rings to be searched</span></div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;  <span class="keywordtype">int</span> ringSize = rings[0].size(); <span class="comment">// This is 6 for hexagons</span></div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a> iTriplet;      <span class="comment">// triplet formed from iring</span></div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a> jTriplet;      <span class="comment">// triplet formed from jring</span></div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a> common;        <span class="comment">// Common elements</span></div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160; </div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;  <span class="comment">// Make all possible triplets out of iring</span></div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; ringSize; i++) {</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;    <span class="comment">// init</span></div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;    iTriplet.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/clear.html">clear</a>();</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;    <span class="comment">// ------</span></div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;    <span class="comment">// Get a triplet</span></div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> m = 0; m &lt; 3; m++) {</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;      iIndex = i + m;</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;      <span class="keywordflow">if</span> (iIndex &gt;= ringSize) {</div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;        iIndex -= ringSize;</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;      }</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;      iTriplet.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/push_back.html">push_back</a>(rings[iring][iIndex]);</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;    } <span class="comment">// end of getting a triplet from iring</span></div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160; </div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;    <span class="comment">// -------------------------------------------</span></div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;    <span class="comment">// Now that a triplet has been found, find all rings with that triplet in</span></div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;    <span class="comment">// it!</span></div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> kring = 0; kring &lt; rings.size(); kring++) {</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;      <span class="comment">// If this is the same as iring or jring, skip</span></div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;      <span class="keywordflow">if</span> (kring == iring || kring == jring) {</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;      } <span class="comment">// is not prismatic</span></div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;      <span class="comment">//</span></div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;      <span class="comment">// Now find out whether kring has the triplet or not!</span></div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;      common = <a class="code" href="group__ring.html#gaed5f39c14a4d76c1746aed53e0d0a2dc">ring::findsCommonElements</a>(iTriplet, rings[kring]);</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160; </div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;      <span class="comment">// If this triplet is not shared by  kring</span></div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;      <span class="comment">// skip</span></div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;      <span class="keywordflow">if</span> (common.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/size.html">size</a>() != 3) {</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;      } <span class="comment">// kring does not have iTriplet</span></div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160; </div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;      <span class="comment">// -----------------</span></div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;      <span class="comment">// If kring does have the triplet, check to see if at least three other</span></div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;      <span class="comment">// elements of kring are shared by jring</span></div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;      jTriplet.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/clear.html">clear</a>(); <span class="comment">// init</span></div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;      <span class="comment">// Make jTriplet</span></div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; ringSize; j++) {</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;        <span class="keywordtype">int</span> katom = rings[kring][j];</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;        <span class="keyword">auto</span> it = <a class="codeRef" href="http://en.cppreference.com/w/cpp/algorithm/find.html">std::find</a>(iTriplet.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/begin.html">begin</a>(), iTriplet.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/end.html">end</a>(), katom);</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160; </div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;        <span class="comment">// If not found, add it to jTriplet</span></div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;        <span class="keywordflow">if</span> (it == iTriplet.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/end.html">end</a>()) {</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;          jTriplet.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/push_back.html">push_back</a>(katom);</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;        } <span class="comment">// update jTriplet</span></div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;      }   <span class="comment">// end of making jTriplet out of kring</span></div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;      <span class="comment">// -----------------</span></div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160; </div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;      <span class="comment">// Now search for jTriplet inside jring</span></div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;      common = <a class="code" href="group__ring.html#gaed5f39c14a4d76c1746aed53e0d0a2dc">ring::findsCommonElements</a>(jTriplet, rings[jring]);</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160; </div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;      <span class="comment">// Update the prismatic rings</span></div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;      <span class="keywordflow">if</span> (common.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/size.html">size</a>() == 3) {</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;        (*listHC).push_back(kring);         <span class="comment">// Update listHC vector</span></div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;        (*prismaticRings).push_back(kring); <span class="comment">// Update prismatic rings</span></div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;        <span class="comment">// Update the type inside ringType</span></div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;        <span class="comment">// If the ring is already a DDC ring, it is a mixed ring</span></div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;        <span class="keywordflow">if</span> ((*ringType)[kring] == <a class="code" href="group__ring.html#gga301cfdc88452cfe51bd4f745d223a7e1a37a9bfe125a811135f6c77d832cef242">ring::DDC</a>) {</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;          (*ringType)[kring] = <a class="code" href="group__ring.html#gga301cfdc88452cfe51bd4f745d223a7e1a6681861f6a3ec92005e0d5a0e4b7dfce">ring::bothPrismatic</a>;</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;        }</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;        <span class="comment">// If it is unclassified, it is just a prismatic ring</span></div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;        <span class="keywordflow">if</span> ((*ringType)[kring] == <a class="code" href="group__ring.html#gga301cfdc88452cfe51bd4f745d223a7e1a60cc60f3804efaf86af8c2c2fbbe7208">ring::unclassified</a>) {</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;          (*ringType)[kring] = <a class="code" href="group__ring.html#gga301cfdc88452cfe51bd4f745d223a7e1a66afb615d90d5df19cce1df68e24d7f2">ring::HCprismatic</a>;</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;        } <span class="comment">// end ring update</span></div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;      }   <span class="comment">// add kring to the list of prismatic rings</span></div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;    }     <span class="comment">// end of searching through rings for kring</span></div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;    <span class="comment">// -------------------------------------------</span></div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;  } <span class="comment">// end of getting pairs of triplets</span></div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160; </div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;  <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;}</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160; </div>
<div class="line"><a name="l01035"></a><span class="lineno"><a class="line" href="group__prism3.html#gadb3c8127d84cb2e90aafff55419f2c85"> 1035</a></span>&#160;<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a> <a class="code" href="group__prism3.html#gadb3c8127d84cb2e90aafff55419f2c85">ring::findMixedRings</a>(<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt;<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a>&gt; rings,</div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;                                      <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;strucType&gt;</a> *ringType,</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;                                      <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a> *listDDC,</div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;                                      <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a> *listHC) {</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a> listMixed;</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;  <span class="keywordtype">int</span> dummyValue = -10;</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160; </div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;  <span class="comment">// Loop through all rings in the ringType and</span></div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;  <span class="comment">// adds the ring Indices of all rings which are both DDCs and HCs</span></div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iring = 0; iring &lt; (*ringType).size(); iring++) {</div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;    <span class="comment">// If iring is of mixed type, add it to the listMixed vector</span></div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;    <span class="keywordflow">if</span> ((*ringType)[iring] == <a class="code" href="group__ring.html#gga301cfdc88452cfe51bd4f745d223a7e1a074049f7a1a6ea8338d256f5b4e586a2">ring::bothBasal</a> ||</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;        (*ringType)[iring] == <a class="code" href="group__ring.html#gga301cfdc88452cfe51bd4f745d223a7e1a6681861f6a3ec92005e0d5a0e4b7dfce">ring::bothPrismatic</a>) {</div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;      listMixed.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/push_back.html">push_back</a>(iring);</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160; </div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;      <span class="comment">//-----------------</span></div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;      <span class="comment">// Search for iring in listDDC</span></div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;      <a class="codeRef" href="http://en.cppreference.com/w/cpp/algorithm/sort.html">std::sort</a>((*listDDC).begin(), (*listDDC).end());</div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;      <span class="keyword">auto</span> iter = <a class="codeRef" href="http://en.cppreference.com/w/cpp/algorithm/find.html">std::find</a>((*listDDC).begin(), (*listDDC).end(), iring);</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;      <span class="keywordflow">if</span> (iter != (*listDDC).end()) {</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;        *iter = dummyValue; <span class="comment">// Assign dummy value to the mixed ring</span></div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;      }                     <span class="comment">// found in listDDC</span></div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;      <span class="comment">//-----------------</span></div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;      <span class="comment">//-----------------</span></div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;      <span class="comment">// Search for iring in listHC</span></div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;      <a class="codeRef" href="http://en.cppreference.com/w/cpp/algorithm/sort.html">std::sort</a>((*listHC).begin(), (*listHC).end());</div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;      <span class="keyword">auto</span> itr = <a class="codeRef" href="http://en.cppreference.com/w/cpp/algorithm/find.html">std::find</a>((*listHC).begin(), (*listHC).end(), iring);</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;      <span class="keywordflow">if</span> (itr != (*listHC).end()) {</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;        *itr = dummyValue; <span class="comment">// Assign dummy value to the mixed ring</span></div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;      }                    <span class="comment">// found in listHC</span></div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;      <span class="comment">//-----------------</span></div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160; </div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;    } <span class="comment">// end of check for type</span></div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;  }   <span class="comment">// end of loop through all every ring</span></div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160; </div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;  <span class="keywordflow">return</span> listMixed;</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;}</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160; </div>
<div class="line"><a name="l01082"></a><span class="lineno"><a class="line" href="group__prism3.html#ga584708a1ea3d1503d7f38f0904b7f5f1"> 1082</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="group__prism3.html#ga584708a1ea3d1503d7f38f0904b7f5f1">ring::getAtomTypesTopoBulk</a>(<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt;<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a>&gt; rings,</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;                               <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;ring::strucType&gt;</a> ringType,</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;                               <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;cage::iceType&gt;</a> *atomTypes) {</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;  <a class="code" href="group__cage.html#gaaac41828990e32b9d6e7db4426b61529">cage::iceType</a> iRingType;        <span class="comment">// Type of the current ring</span></div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;  <span class="keywordtype">int</span> iatom;                      <span class="comment">// Current ring</span></div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;  <span class="keywordtype">int</span> ringSize = rings[0].size(); <span class="comment">// Size of the ring</span></div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160; </div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;  <span class="comment">// Loop through every ring in ringType</span></div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iring = 0; iring &lt; ringType.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/size.html">size</a>(); iring++) {</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;    <span class="comment">// Skip if the ring is unclassified</span></div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;    <span class="keywordflow">if</span> (ringType[iring] == <a class="code" href="group__ring.html#gga301cfdc88452cfe51bd4f745d223a7e1a60cc60f3804efaf86af8c2c2fbbe7208">ring::unclassified</a>) {</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;    } <span class="comment">// skip for unclassified rings</span></div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160; </div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;    <span class="comment">// ------------</span></div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;    <span class="comment">// Get the current ring type</span></div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;    <span class="comment">// DDC</span></div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;    <span class="keywordflow">if</span> (ringType[iring] == <a class="code" href="group__ring.html#gga301cfdc88452cfe51bd4f745d223a7e1a37a9bfe125a811135f6c77d832cef242">ring::DDC</a>) {</div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;      iRingType = <a class="code" href="group__cage.html#ggaaac41828990e32b9d6e7db4426b61529a508c36a9ffc7ba85f325a253be11312f">cage::ddc</a>;</div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;    } <span class="comment">// DDC atoms</span></div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;    <span class="comment">// HC</span></div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ringType[iring] == <a class="code" href="group__ring.html#gga301cfdc88452cfe51bd4f745d223a7e1a48c3c5c40739122c0bf68fb9faeee9da">ring::HCbasal</a> ||</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;             ringType[iring] == <a class="code" href="group__ring.html#gga301cfdc88452cfe51bd4f745d223a7e1a66afb615d90d5df19cce1df68e24d7f2">ring::HCprismatic</a>) {</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;      iRingType = <a class="code" href="group__cage.html#ggaaac41828990e32b9d6e7db4426b61529abf805fba4c226956825175c4514f14ce">cage::hc</a>;</div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;    } <span class="comment">// HC atoms</span></div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;    <span class="comment">// Mixed</span></div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ringType[iring] == <a class="code" href="group__ring.html#gga301cfdc88452cfe51bd4f745d223a7e1a074049f7a1a6ea8338d256f5b4e586a2">ring::bothBasal</a> ||</div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;             ringType[iring] == <a class="code" href="group__ring.html#gga301cfdc88452cfe51bd4f745d223a7e1a6681861f6a3ec92005e0d5a0e4b7dfce">ring::bothPrismatic</a>) {</div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;      iRingType = <a class="code" href="group__cage.html#ggaaac41828990e32b9d6e7db4426b61529a8da31aa983c518632b4a522086415492">cage::mixed</a>;</div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;    } <span class="comment">// HC atoms</span></div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;    <span class="comment">// Prism</span></div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ringType[iring] == <a class="code" href="group__ring.html#gga301cfdc88452cfe51bd4f745d223a7e1ac4295ff0a8263a65de0694cc0b20e9af">ring::Prism</a> ||</div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;             ringType[iring] == <a class="code" href="group__ring.html#gga301cfdc88452cfe51bd4f745d223a7e1a499b694d8386eef89ba2f6e621ed7578">ring::deformedPrism</a> ||</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;             ringType[iring] == <a class="code" href="group__ring.html#gga301cfdc88452cfe51bd4f745d223a7e1aabd9a19704526f9be67c7dcd1c2b4af9">ring::mixedPrismRing</a>) {</div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;      iRingType = <a class="code" href="group__cage.html#ggaaac41828990e32b9d6e7db4426b61529a3eae6b3c7c54d5cecb3d82d838cc6d60">cage::pnc</a>; <span class="comment">// 5 membered pnc</span></div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;    }                        <span class="comment">// prism</span></div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;    <span class="comment">// Should never go here</span></div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;    } <span class="comment">//</span></div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;    <span class="comment">// ------------</span></div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;    <span class="comment">// Otherwise, loop through every inside the ring and assign atomTypes the</span></div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;    <span class="comment">// iRingType</span></div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; ringSize; i++) {</div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;      iatom = rings[iring][i]; <span class="comment">// Atom index in ring</span></div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;      <span class="keywordflow">if</span> ((*atomTypes)[iatom] == <a class="code" href="group__cage.html#ggaaac41828990e32b9d6e7db4426b61529a8da31aa983c518632b4a522086415492">cage::mixed</a> ||</div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;          (*atomTypes)[iatom] == <a class="code" href="group__cage.html#ggaaac41828990e32b9d6e7db4426b61529acbad0158a8f2811fd4136831fa2b3072">cage::mixed2</a>) {</div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;      } <span class="comment">// Don&#39;t reassign</span></div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;      <span class="comment">// For atoms shared by PNCs and DDCs/HCs</span></div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;      <span class="keywordflow">if</span> (ringSize == 6) {</div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;        <span class="keywordflow">if</span> ((*atomTypes)[iatom] == <a class="code" href="group__cage.html#ggaaac41828990e32b9d6e7db4426b61529a3eae6b3c7c54d5cecb3d82d838cc6d60">cage::pnc</a>) {</div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;          (*atomTypes)[iatom] = <a class="code" href="group__cage.html#ggaaac41828990e32b9d6e7db4426b61529acbad0158a8f2811fd4136831fa2b3072">cage::mixed2</a>;</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;          (*atomTypes)[iatom] = iRingType;</div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;        }</div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;        (*atomTypes)[iatom] = iRingType;</div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;      }</div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;    } <span class="comment">// end of loop thorugh the current ring</span></div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;  }   <span class="comment">// end of loop through every ring</span></div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160; </div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;  <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;}</div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160; </div>
<div class="line"><a name="l01165"></a><span class="lineno"><a class="line" href="group__prism3.html#ga6fcfac293a750bd14cbf1f94ab2a3976"> 1165</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="group__prism3.html#ga6fcfac293a750bd14cbf1f94ab2a3976">ring::getStrucNumbers</a>(<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;ring::strucType&gt;</a> ringType,</div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;                          <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;cage::Cage&gt;</a> cageList, <span class="keywordtype">int</span> *numHC,</div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;                          <span class="keywordtype">int</span> *numDDC, <span class="keywordtype">int</span> *mixedRings, <span class="keywordtype">int</span> *prismaticRings,</div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;                          <span class="keywordtype">int</span> *basalRings) {</div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;  <span class="comment">// Determines the number of HCs, DDCs, Mixed rings, prismatic and basal rings</span></div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;  <span class="comment">// Init</span></div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;  *numHC = 0;</div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;  *numDDC = 0;</div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;  *mixedRings = 0;</div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;  *prismaticRings = 0;</div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;  *basalRings = 0;</div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;  <span class="comment">// ------------------------------------</span></div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;  <span class="comment">// GETTING THE CAGES (DDCs and HCs)</span></div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;  <span class="comment">// Loop through cages</span></div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> icage = 0; icage &lt; cageList.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/size.html">size</a>(); icage++) {</div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;    <span class="comment">// HC</span></div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;    <span class="keywordflow">if</span> (cageList[icage].type == <a class="code" href="group__cage.html#gga5787314f51b5927c213db48b81c21d95a0ff989d0b3eed06750ff06c8bc95c84d">cage::HexC</a>) {</div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;      *numHC += 1;</div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;    } <span class="comment">// end of updating HC number</span></div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;    <span class="comment">// DDC</span></div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;    <span class="keywordflow">if</span> (cageList[icage].type == <a class="code" href="group__cage.html#gga5787314f51b5927c213db48b81c21d95ac5a9e4f20bab07bef66bb6e15c49682d">cage::DoubleDiaC</a>) {</div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;      *numDDC += 1;</div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;    } <span class="comment">// end of updating DDC number</span></div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;  }   <span class="comment">// end of loop through cages</span></div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;  <span class="comment">// ------------------------------------</span></div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;  <span class="comment">// GETTING THE RINGSS (Mixed, Prismatic and Basal rings)</span></div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;  <span class="comment">// Loop through the rings</span></div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iring = 0; iring &lt; ringType.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/size.html">size</a>(); iring++) {</div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;    <span class="comment">// Mixed</span></div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;    <span class="keywordflow">if</span> (ringType[iring] == <a class="code" href="group__ring.html#gga301cfdc88452cfe51bd4f745d223a7e1a074049f7a1a6ea8338d256f5b4e586a2">ring::bothBasal</a> ||</div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;        ringType[iring] == <a class="code" href="group__ring.html#gga301cfdc88452cfe51bd4f745d223a7e1a6681861f6a3ec92005e0d5a0e4b7dfce">ring::bothPrismatic</a>) {</div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;      *mixedRings += 1;</div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;      <span class="comment">// Also update basal rings</span></div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;      <span class="keywordflow">if</span> (ringType[iring] == <a class="code" href="group__ring.html#gga301cfdc88452cfe51bd4f745d223a7e1a074049f7a1a6ea8338d256f5b4e586a2">ring::bothBasal</a>) {</div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;        *basalRings += 1;</div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;      } <span class="comment">// mixed basal rings</span></div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;      <span class="comment">// Also update prismatic rings</span></div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;      <span class="keywordflow">if</span> (ringType[iring] == <a class="code" href="group__ring.html#gga301cfdc88452cfe51bd4f745d223a7e1a6681861f6a3ec92005e0d5a0e4b7dfce">ring::bothPrismatic</a>) {</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;        *prismaticRings += 1;</div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;      } <span class="comment">// mixed prismatic rings</span></div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;    }   <span class="comment">// end of updating mixed</span></div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;    <span class="comment">// HCs</span></div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;    <span class="keywordflow">if</span> (ringType[iring] == <a class="code" href="group__ring.html#gga301cfdc88452cfe51bd4f745d223a7e1a66afb615d90d5df19cce1df68e24d7f2">ring::HCprismatic</a>) {</div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;      *prismaticRings += 1;</div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;    } <span class="comment">// HC prismatic</span></div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;    <span class="comment">// basal HCs</span></div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;    <span class="keywordflow">if</span> (ringType[iring] == <a class="code" href="group__ring.html#gga301cfdc88452cfe51bd4f745d223a7e1a48c3c5c40739122c0bf68fb9faeee9da">ring::HCbasal</a>) {</div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;      *basalRings += 1;</div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;    } <span class="comment">// HC basal</span></div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;  }   <span class="comment">// end of loop through every ring</span></div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;  <span class="comment">// ------------------------------------</span></div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160; </div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;  <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;} <span class="comment">// end of function</span></div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160; </div>
<div class="line"><a name="l01246"></a><span class="lineno"><a class="line" href="group__prism3.html#gacb2bc68638bd794af38bcd503e17be0f"> 1246</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="group__prism3.html#gacb2bc68638bd794af38bcd503e17be0f">prism3::findBulkPrisms</a>(</div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;    <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt;<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a>&gt; rings, <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;ring::strucType&gt;</a> *ringType,</div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;    <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt;<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a>&gt; nList,</div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;    <a class="code" href="structmolSys_1_1PointCloud.html">molSys::PointCloud</a>&lt;<a class="code" href="structmolSys_1_1Point.html">molSys::Point&lt;double&gt;</a>, <span class="keywordtype">double</span>&gt; *yCloud,</div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;    <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;double&gt;</a> *rmsdPerAtom, <span class="keywordtype">double</span> heightCutoff) {</div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;  <span class="keywordtype">int</span> totalRingNum = rings.size(); <span class="comment">// Total number of rings</span></div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a> basal1;         <span class="comment">// First basal ring</span></div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a> basal2;         <span class="comment">// Second basal ring</span></div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;  <span class="keywordtype">bool</span> cond1, cond2; <span class="comment">// Conditions for rings to be basal (true) or not (false)</span></div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;  <span class="keywordtype">int</span> ringSize = rings[0].<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/size.html">size</a>(); <span class="comment">// Number of nodes in each ring</span></div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;  <span class="comment">// Matrix for the reference ring for a given ringSize.</span></div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;  Eigen::MatrixXd refPointSet(ringSize, 3);</div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160; </div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;  <span class="keywordtype">int</span> axialDim = 2; <span class="comment">// Default=z</span></div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;  refPointSet = <a class="code" href="namespacepntToPnt.html#a5b2c3bd3984c707965b6cc5ec03ff1da">pntToPnt::getPointSetRefRing</a>(ringSize, axialDim);</div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160; </div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;  <span class="comment">// Two loops through all the rings are required to find pairs of basal rings</span></div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iring = 0; iring &lt; totalRingNum - 1; iring++) {</div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;    cond1 = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;    cond2 = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;    basal1 = rings[iring]; <span class="comment">// Assign iring to basal1</span></div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;    <span class="comment">// Loop through the other rings to get a pair</span></div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> jring = iring + 1; jring &lt; totalRingNum; jring++) {</div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;      basal2 = rings[jring]; <span class="comment">// Assign jring to basal2</span></div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;      <span class="comment">// ------------</span></div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;      <span class="comment">// Put extra check for axial basal rings if shapeMatching is being done</span></div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;      <span class="comment">// ------------</span></div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;      <span class="comment">// Step one: Check to see if basal1 and basal2 have common</span></div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;      <span class="comment">// elements or not. If they don&#39;t, then they cannot be basal rings</span></div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;      cond1 = <a class="code" href="group__ring.html#gac30855d0daa2b20c29e4dee39f5cd92f">ring::hasCommonElements</a>(basal1, basal2);</div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;      <span class="keywordflow">if</span> (cond1 == <span class="keyword">true</span>) {</div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;      }</div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160; </div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;      <span class="comment">// ------------</span></div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;      <span class="keywordtype">bool</span> smallDist =</div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;          <a class="code" href="group__prism3.html#ga9fe2899493b03fdf8fe00e3e58b5961c">prism3::basalRingsSeparation</a>(yCloud, basal1, basal2, heightCutoff);</div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;      <span class="keywordflow">if</span> (!smallDist) {</div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;      } <span class="comment">// the basal rings are too far apart</span></div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160; </div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;      <span class="comment">// Otherwise</span></div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;      <span class="comment">// Do shape matching here</span></div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;      <span class="keywordtype">bool</span> isPrism = <a class="code" href="namespacematch.html#a64b2b2b69cffbaf8ae93583588c63240">match::matchUntetheredPrism</a>(yCloud, nList, refPointSet,</div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;                                                 &amp;basal1, &amp;basal2, rmsdPerAtom);</div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160; </div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;      <span class="comment">// Success! The rings are basal rings of a prism!</span></div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;      <span class="keywordflow">if</span> (isPrism) {</div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;        <span class="comment">// Update iring</span></div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;        <span class="keywordflow">if</span> ((*ringType)[iring] == <a class="code" href="group__ring.html#gga301cfdc88452cfe51bd4f745d223a7e1a60cc60f3804efaf86af8c2c2fbbe7208">ring::unclassified</a>) {</div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;          (*ringType)[iring] = <a class="code" href="group__ring.html#gga301cfdc88452cfe51bd4f745d223a7e1ac4295ff0a8263a65de0694cc0b20e9af">ring::Prism</a>;</div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;        }</div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;        <span class="comment">// Update jring</span></div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;        <span class="keywordflow">if</span> ((*ringType)[jring] == <a class="code" href="group__ring.html#gga301cfdc88452cfe51bd4f745d223a7e1a60cc60f3804efaf86af8c2c2fbbe7208">ring::unclassified</a>) {</div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;          (*ringType)[jring] = <a class="code" href="group__ring.html#gga301cfdc88452cfe51bd4f745d223a7e1ac4295ff0a8263a65de0694cc0b20e9af">ring::Prism</a>;</div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;        }</div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;      } <span class="comment">// end of reduced criteria</span></div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;      <span class="comment">// Strict criteria</span></div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;      <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;        cond2 = <a class="code" href="group__prism3.html#gae71a760356516b591add17377783f9cb">prism3::basalPrismConditions</a>(nList, &amp;basal1, &amp;basal2);</div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;        <span class="comment">// If the condition is false then the strict criterion has not been met</span></div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;        <span class="keywordflow">if</span> (!cond2) {</div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;          <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;        }</div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;        <span class="comment">// Update iring</span></div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;        <span class="keywordflow">if</span> ((*ringType)[iring] == <a class="code" href="group__ring.html#gga301cfdc88452cfe51bd4f745d223a7e1a60cc60f3804efaf86af8c2c2fbbe7208">ring::unclassified</a>) {</div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;          (*ringType)[iring] = <a class="code" href="group__ring.html#gga301cfdc88452cfe51bd4f745d223a7e1ac4295ff0a8263a65de0694cc0b20e9af">ring::Prism</a>;</div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;        }</div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;        <span class="comment">// Update jring</span></div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;        <span class="keywordflow">if</span> ((*ringType)[jring] == <a class="code" href="group__ring.html#gga301cfdc88452cfe51bd4f745d223a7e1a60cc60f3804efaf86af8c2c2fbbe7208">ring::unclassified</a>) {</div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;          (*ringType)[jring] = <a class="code" href="group__ring.html#gga301cfdc88452cfe51bd4f745d223a7e1ac4295ff0a8263a65de0694cc0b20e9af">ring::Prism</a>;</div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;        }</div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;        <span class="comment">// Shape-matching to get the RMSD (if shape-matching is desired)</span></div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160; </div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;        <span class="comment">// bool isKnownPrism = match::matchPrism(</span></div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;        <span class="comment">//     yCloud, nList, refPointSet, &amp;basal1, &amp;basal2, rmsdPerAtom, true);</span></div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160; </div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;        <span class="comment">// -----------</span></div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;      } <span class="comment">// end of strict criteria</span></div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160; </div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;    } <span class="comment">// end of loop through rest of the rings to get the second basal ring</span></div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;  }   <span class="comment">// end of loop through all rings for first basal ring</span></div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160; </div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;  <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;}</div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160; </div>
<div class="line"><a name="l01347"></a><span class="lineno"><a class="line" href="group__prism3.html#gae71a760356516b591add17377783f9cb"> 1347</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="group__prism3.html#gae71a760356516b591add17377783f9cb">prism3::basalPrismConditions</a>(<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt;<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a>&gt; nList,</div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;                                  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a> *basal1,</div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;                                  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a> *basal2) {</div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;  <span class="keywordtype">int</span> l1 = (*basal1)[0]; <span class="comment">// first element of basal1 ring</span></div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;  <span class="keywordtype">int</span> ringSize =</div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;      (*basal1).size(); <span class="comment">// Size of the ring; each ring contains n elements</span></div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;  <span class="keywordtype">int</span> m_k;              <span class="comment">// Atom ID of element in basal2</span></div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;  <span class="keywordtype">bool</span> l1_neighbour;    <span class="comment">// m_k is a neighbour of l1(true) or not (false)</span></div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160; </div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;  <span class="comment">// isNeighbour is initialized to false for all basal2 elements; indication if</span></div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;  <span class="comment">// basal2 elements are neighbours of basal1</span></div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;bool&gt;</a> isNeighbour(ringSize, <span class="keyword">false</span>);</div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;  <span class="keywordtype">int</span> kIndex;  <span class="comment">// m_k index</span></div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;  <span class="keywordtype">int</span> lAtomID; <span class="comment">// atomID of the current element of basal1</span></div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;  <span class="keywordtype">int</span> kAtomID; <span class="comment">// atomID of the current element of basal2</span></div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160; </div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;  <span class="comment">// ---------------------------------------------</span></div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;  <span class="comment">// COMPARISON OF basal2 ELEMENTS WITH l1</span></div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; ringSize; k++) {</div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;    l1_neighbour = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;    m_k = (*basal2)[k];</div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;    <span class="comment">// =================================</span></div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;    <span class="comment">// Checking to seee if m_k is be a neighbour of l1</span></div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;    <span class="comment">// Find m_k inside l1 neighbour list</span></div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;    <span class="keyword">auto</span> it = <a class="codeRef" href="http://en.cppreference.com/w/cpp/algorithm/find.html">std::find</a>(nList[l1].begin() + 1, nList[l1].end(), m_k);</div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160; </div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;    <span class="comment">// If the element has been found, for l1</span></div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;    <span class="keywordflow">if</span> (it != nList[l1].end()) {</div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;      l1_neighbour = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;      kIndex = k;</div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;    }</div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;  } <span class="comment">// l1 is a neighbour of m_k</span></div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160; </div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;  <span class="comment">// If there is no nearest neighbour, then the two rings are not part of the</span></div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;  <span class="comment">// prism</span></div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;  <span class="keywordflow">if</span> (!l1_neighbour) {</div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;  }</div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160; </div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;  <span class="comment">// ---------------------------------------------</span></div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;  <span class="comment">// NEIGHBOURS of basal1 in basal2</span></div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;  isNeighbour[kIndex] = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160; </div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;  <span class="comment">// All elements of basal1 must be neighbours of basal2</span></div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt; ringSize; i++) {</div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;    lAtomID = (*basal1)[i]; <span class="comment">// element of basal1 ring</span></div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; ringSize; k++) {</div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;      <span class="comment">// Skip if already a neighbour</span></div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;      <span class="keywordflow">if</span> (isNeighbour[k]) {</div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;      }</div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;      <span class="comment">// Get the comparison basal2 element</span></div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;      kAtomID = (*basal2)[k]; <span class="comment">// element of basal2 ring;</span></div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160; </div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;      <span class="comment">// Checking to see if kAtomID is a neighbour of lAtomID</span></div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;      <span class="comment">// Find kAtomID inside lAtomID neighbour list</span></div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;      <span class="keyword">auto</span> it1 =</div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;          <a class="codeRef" href="http://en.cppreference.com/w/cpp/algorithm/find.html">std::find</a>(nList[lAtomID].begin() + 1, nList[lAtomID].end(), kAtomID);</div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160; </div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;      <span class="comment">// If the element has been found, for l1</span></div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;      <span class="keywordflow">if</span> (it1 != nList[lAtomID].end()) {</div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;        isNeighbour[k] = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;      }</div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;    } <span class="comment">// Loop through basal2</span></div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;  }   <span class="comment">// end of check for neighbours of basal1</span></div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160; </div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;  <span class="comment">// ---------------------------------------------</span></div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160; </div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;  <span class="comment">// They should all be neighbours</span></div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; ringSize; k++) {</div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;    <span class="comment">// Check to see if any element is false</span></div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;    <span class="keywordflow">if</span> (!isNeighbour[k]) {</div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;    }</div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;  }</div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160; </div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;  <span class="comment">// Everything works out!</span></div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;}</div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160; </div>
<div class="line"><a name="l01434"></a><span class="lineno"><a class="line" href="group__prism3.html#ga3090d50047a2901bb1b017d80ce8379a"> 1434</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="group__prism3.html#ga3090d50047a2901bb1b017d80ce8379a">prism3::relaxedPrismConditions</a>(<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt;<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a>&gt; nList,</div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;                                    <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a> *basal1,</div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;                                    <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a> *basal2) {</div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;  <span class="keywordtype">int</span> ringSize =</div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;      (*basal1).size();     <span class="comment">// Size of the ring; each ring contains n elements</span></div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;  <span class="keywordtype">int</span> m_k;                  <span class="comment">// Atom ID of element in basal2</span></div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;  <span class="keywordtype">bool</span> isNeighbour = <span class="keyword">false</span>; <span class="comment">// This is true if there is at least one bond</span></div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;                            <span class="comment">// between the basal rings</span></div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;  <span class="keywordtype">int</span> l_k;                  <span class="comment">// Atom ID of element in basal1</span></div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160; </div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;  <span class="comment">// ---------------------------------------------</span></div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;  <span class="comment">// COMPARISON OF basal2 ELEMENTS (m_k) WITH basal1 ELEMENTS (l_k)</span></div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;  <span class="comment">// Loop through all the elements of basal1</span></div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> l = 0; l &lt; ringSize; l++) {</div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;    l_k = (*basal1)[l];</div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;    <span class="comment">// Search for the nearest neighbour of l_k in basal2</span></div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;    <span class="comment">// Loop through basal2 elements</span></div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> m = 0; m &lt; ringSize; m++) {</div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;      m_k = (*basal2)[m];</div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;      <span class="comment">// Find m_k inside l_k neighbour list</span></div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;      <span class="keyword">auto</span> it = <a class="codeRef" href="http://en.cppreference.com/w/cpp/algorithm/find.html">std::find</a>(nList[l_k].begin() + 1, nList[l_k].end(), m_k);</div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160; </div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;      <span class="comment">// If the element has been found, for l1</span></div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;      <span class="keywordflow">if</span> (it != nList[l_k].end()) {</div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;        isNeighbour = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;      } <span class="comment">// found element</span></div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;    }   <span class="comment">// end of loop through all the elements of basal2</span></div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160; </div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;    <span class="comment">// If a neighbour has been found then</span></div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;    <span class="keywordflow">if</span> (isNeighbour) {</div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;    }</div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;  } <span class="comment">// end of loop through all the elements of basal1</span></div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160; </div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;  <span class="comment">// If a neighbour has not been found, return false</span></div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;}</div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160; </div>
<div class="line"><a name="l01475"></a><span class="lineno"><a class="line" href="group__prism3.html#ga9fe2899493b03fdf8fe00e3e58b5961c"> 1475</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="group__prism3.html#ga9fe2899493b03fdf8fe00e3e58b5961c">prism3::basalRingsSeparation</a>(</div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;    <a class="code" href="structmolSys_1_1PointCloud.html">molSys::PointCloud</a>&lt;<a class="code" href="structmolSys_1_1Point.html">molSys::Point&lt;double&gt;</a>, <span class="keywordtype">double</span>&gt; *yCloud,</div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;    <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a> basal1, <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a> basal2, <span class="keywordtype">double</span> heightCutoff) {</div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;  <span class="keywordtype">int</span> ringSize = basal1.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/size.html">size</a>();</div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;  <span class="keywordtype">int</span> l_k, m_k; <span class="comment">// Atom indices</span></div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;  <span class="keywordtype">double</span> infHugeNumber = 100000;</div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;  <span class="keywordtype">double</span> leastDist = infHugeNumber;</div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;  <span class="keywordtype">int</span> index = -1; <span class="comment">// starting index</span></div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;  <span class="comment">// For the first element of basal1:</span></div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160; </div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;  l_k = basal1[0]; <span class="comment">// This is the atom particle C++ index</span></div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160; </div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;  <span class="comment">// Search for the nearest neighbour of l_k in basal2</span></div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;  <span class="comment">// Loop through basal2 elements</span></div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> m = 0; m &lt; ringSize; m++) {</div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;    m_k = basal2[m]; <span class="comment">// Atom index to find in the neighbour list of iatom</span></div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160; </div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;    <span class="comment">// Calculate the distance</span></div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;    <span class="keywordtype">double</span> dist = <a class="code" href="group__gen.html#ga881e045598dd517609383d8a3fec5913">gen::periodicDist</a>(yCloud, l_k, m_k);</div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160; </div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;    <span class="comment">// Update the least distance</span></div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;    <span class="keywordflow">if</span> (leastDist &gt; dist) {</div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;      leastDist = dist; <span class="comment">// This is the new least distance</span></div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;      index = m;</div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;    } <span class="comment">// end of update of the least distance</span></div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160; </div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;  } <span class="comment">// found element</span></div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160; </div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;  <span class="comment">// If the element has been found, for l1</span></div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;  <span class="keywordflow">if</span> (leastDist &lt; heightCutoff) {</div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;  } <span class="comment">// end of check</span></div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;  <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;  }</div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;}</div>
<div class="ttc" id="abasic_ostream_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/io/basic_ostream.html">std::cerr</a></div></div>
<div class="ttc" id="abasic_string_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/string/basic_string.html">std::string</a></div></div>
<div class="ttc" id="abegin_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/container/vector/begin.html">std::vector::begin</a></div><div class="ttdeci">T begin(T... args)</div></div>
<div class="ttc" id="aclear_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/container/vector/clear.html">std::vector::clear</a></div><div class="ttdeci">T clear(T... args)</div></div>
<div class="ttc" id="adistance_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/iterator/distance.html">std::distance</a></div><div class="ttdeci">T distance(T... args)</div></div>
<div class="ttc" id="aend_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/container/vector/end.html">std::vector::end</a></div><div class="ttdeci">T end(T... args)</div></div>
<div class="ttc" id="aerase_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/container/vector/erase.html">std::vector::erase</a></div><div class="ttdeci">T erase(T... args)</div></div>
<div class="ttc" id="afind_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/algorithm/find.html">std::find</a></div><div class="ttdeci">T find(T... args)</div></div>
<div class="ttc" id="agroup__cage_html_gaaac41828990e32b9d6e7db4426b61529"><div class="ttname"><a href="group__cage.html#gaaac41828990e32b9d6e7db4426b61529">cage::iceType</a></div><div class="ttdeci">iceType</div><div class="ttdef"><b>Definition:</b> <a href="cage_8hpp_source.html#l00075">cage.hpp:75</a></div></div>
<div class="ttc" id="agroup__cage_html_gga5787314f51b5927c213db48b81c21d95a0ff989d0b3eed06750ff06c8bc95c84d"><div class="ttname"><a href="group__cage.html#gga5787314f51b5927c213db48b81c21d95a0ff989d0b3eed06750ff06c8bc95c84d">cage::HexC</a></div><div class="ttdeci">@ HexC</div><div class="ttdef"><b>Definition:</b> <a href="cage_8hpp_source.html#l00054">cage.hpp:54</a></div></div>
<div class="ttc" id="agroup__cage_html_gga5787314f51b5927c213db48b81c21d95ac5a9e4f20bab07bef66bb6e15c49682d"><div class="ttname"><a href="group__cage.html#gga5787314f51b5927c213db48b81c21d95ac5a9e4f20bab07bef66bb6e15c49682d">cage::DoubleDiaC</a></div><div class="ttdeci">@ DoubleDiaC</div><div class="ttdef"><b>Definition:</b> <a href="cage_8hpp_source.html#l00054">cage.hpp:54</a></div></div>
<div class="ttc" id="agroup__cage_html_ggaaac41828990e32b9d6e7db4426b61529a3eae6b3c7c54d5cecb3d82d838cc6d60"><div class="ttname"><a href="group__cage.html#ggaaac41828990e32b9d6e7db4426b61529a3eae6b3c7c54d5cecb3d82d838cc6d60">cage::pnc</a></div><div class="ttdeci">@ pnc</div><div class="ttdef"><b>Definition:</b> <a href="cage_8hpp_source.html#l00075">cage.hpp:75</a></div></div>
<div class="ttc" id="agroup__cage_html_ggaaac41828990e32b9d6e7db4426b61529a508c36a9ffc7ba85f325a253be11312f"><div class="ttname"><a href="group__cage.html#ggaaac41828990e32b9d6e7db4426b61529a508c36a9ffc7ba85f325a253be11312f">cage::ddc</a></div><div class="ttdeci">@ ddc</div><div class="ttdef"><b>Definition:</b> <a href="cage_8hpp_source.html#l00075">cage.hpp:75</a></div></div>
<div class="ttc" id="agroup__cage_html_ggaaac41828990e32b9d6e7db4426b61529a8da31aa983c518632b4a522086415492"><div class="ttname"><a href="group__cage.html#ggaaac41828990e32b9d6e7db4426b61529a8da31aa983c518632b4a522086415492">cage::mixed</a></div><div class="ttdeci">@ mixed</div><div class="ttdef"><b>Definition:</b> <a href="cage_8hpp_source.html#l00075">cage.hpp:75</a></div></div>
<div class="ttc" id="agroup__cage_html_ggaaac41828990e32b9d6e7db4426b61529abf805fba4c226956825175c4514f14ce"><div class="ttname"><a href="group__cage.html#ggaaac41828990e32b9d6e7db4426b61529abf805fba4c226956825175c4514f14ce">cage::hc</a></div><div class="ttdeci">@ hc</div><div class="ttdef"><b>Definition:</b> <a href="cage_8hpp_source.html#l00075">cage.hpp:75</a></div></div>
<div class="ttc" id="agroup__cage_html_ggaaac41828990e32b9d6e7db4426b61529acbad0158a8f2811fd4136831fa2b3072"><div class="ttname"><a href="group__cage.html#ggaaac41828990e32b9d6e7db4426b61529acbad0158a8f2811fd4136831fa2b3072">cage::mixed2</a></div><div class="ttdeci">@ mixed2</div><div class="ttdef"><b>Definition:</b> <a href="cage_8hpp_source.html#l00075">cage.hpp:75</a></div></div>
<div class="ttc" id="agroup__gen_html_ga881e045598dd517609383d8a3fec5913"><div class="ttname"><a href="group__gen.html#ga881e045598dd517609383d8a3fec5913">gen::periodicDist</a></div><div class="ttdeci">double periodicDist(molSys::PointCloud&lt; molSys::Point&lt; double &gt;, double &gt; *yCloud, int iatom, int jatom)</div><div class="ttdoc">Inline generic function for obtaining the unwrapped periodic distance between two particles,...</div><div class="ttdef"><b>Definition:</b> <a href="generic_8hpp_source.html#l00108">generic.hpp:108</a></div></div>
<div class="ttc" id="agroup__prism3_html_ga094fa5ff41584671fed91ac60396d141"><div class="ttname"><a href="group__prism3.html#ga094fa5ff41584671fed91ac60396d141">ring::notNeighboursOfRing</a></div><div class="ttdeci">bool notNeighboursOfRing(std::vector&lt; std::vector&lt; int &gt;&gt; nList, std::vector&lt; int &gt; *triplet, std::vector&lt; int &gt; *ring)</div><div class="ttdef"><b>Definition:</b> <a href="topo__bulk_8cpp_source.html#l00899">topo_bulk.cpp:899</a></div></div>
<div class="ttc" id="agroup__prism3_html_ga09ce2b64c2b6b9bbd6cebc0f408c8f0e"><div class="ttname"><a href="group__prism3.html#ga09ce2b64c2b6b9bbd6cebc0f408c8f0e">ring::conditionOneDDC</a></div><div class="ttdeci">bool conditionOneDDC(std::vector&lt; std::vector&lt; int &gt;&gt; rings, std::vector&lt; int &gt; *peripheralRings, int iring)</div><div class="ttdef"><b>Definition:</b> <a href="topo__bulk_8cpp_source.html#l00334">topo_bulk.cpp:334</a></div></div>
<div class="ttc" id="agroup__prism3_html_ga0e7cb0c140c8e1ed43878202a7380eca"><div class="ttname"><a href="group__prism3.html#ga0e7cb0c140c8e1ed43878202a7380eca">ring::basalNeighbours</a></div><div class="ttdeci">bool basalNeighbours(std::vector&lt; std::vector&lt; int &gt;&gt; nList, std::vector&lt; int &gt; *triplet, int atomOne, int atomTwo)</div><div class="ttdef"><b>Definition:</b> <a href="topo__bulk_8cpp_source.html#l00826">topo_bulk.cpp:826</a></div></div>
<div class="ttc" id="agroup__prism3_html_ga3090d50047a2901bb1b017d80ce8379a"><div class="ttname"><a href="group__prism3.html#ga3090d50047a2901bb1b017d80ce8379a">prism3::relaxedPrismConditions</a></div><div class="ttdeci">bool relaxedPrismConditions(std::vector&lt; std::vector&lt; int &gt;&gt; nList, std::vector&lt; int &gt; *basal1, std::vector&lt; int &gt; *basal2)</div><div class="ttdef"><b>Definition:</b> <a href="topo__bulk_8cpp_source.html#l01434">topo_bulk.cpp:1434</a></div></div>
<div class="ttc" id="agroup__prism3_html_ga35816c398a355ca472fddeb2869fce15"><div class="ttname"><a href="group__prism3.html#ga35816c398a355ca472fddeb2869fce15">ring::findDDC</a></div><div class="ttdeci">std::vector&lt; int &gt; findDDC(std::vector&lt; std::vector&lt; int &gt;&gt; rings, std::vector&lt; strucType &gt; *ringType, std::vector&lt; int &gt; listHC, std::vector&lt; cage::Cage &gt; *cageList)</div><div class="ttdef"><b>Definition:</b> <a href="topo__bulk_8cpp_source.html#l00203">topo_bulk.cpp:203</a></div></div>
<div class="ttc" id="agroup__prism3_html_ga4da0e6df71b3f90131d1e38870644947"><div class="ttname"><a href="group__prism3.html#ga4da0e6df71b3f90131d1e38870644947">ring::conditionTwoDDC</a></div><div class="ttdeci">bool conditionTwoDDC(std::vector&lt; std::vector&lt; int &gt;&gt; rings, std::vector&lt; int &gt; *peripheralRings, int iring)</div><div class="ttdef"><b>Definition:</b> <a href="topo__bulk_8cpp_source.html#l00406">topo_bulk.cpp:406</a></div></div>
<div class="ttc" id="agroup__prism3_html_ga584708a1ea3d1503d7f38f0904b7f5f1"><div class="ttname"><a href="group__prism3.html#ga584708a1ea3d1503d7f38f0904b7f5f1">ring::getAtomTypesTopoBulk</a></div><div class="ttdeci">int getAtomTypesTopoBulk(std::vector&lt; std::vector&lt; int &gt;&gt; rings, std::vector&lt; ring::strucType &gt; ringType, std::vector&lt; cage::iceType &gt; *atomTypes)</div><div class="ttdef"><b>Definition:</b> <a href="topo__bulk_8cpp_source.html#l01082">topo_bulk.cpp:1082</a></div></div>
<div class="ttc" id="agroup__prism3_html_ga6fcfac293a750bd14cbf1f94ab2a3976"><div class="ttname"><a href="group__prism3.html#ga6fcfac293a750bd14cbf1f94ab2a3976">ring::getStrucNumbers</a></div><div class="ttdeci">int getStrucNumbers(std::vector&lt; ring::strucType &gt; ringType, std::vector&lt; cage::Cage &gt; cageList, int *numHC, int *numDDC, int *mixedRings, int *prismaticRings, int *basalRings)</div><div class="ttdoc">Determines the number of HCs, DDCs, Mixed rings, prismatic and basal rings.</div><div class="ttdef"><b>Definition:</b> <a href="topo__bulk_8cpp_source.html#l01165">topo_bulk.cpp:1165</a></div></div>
<div class="ttc" id="agroup__prism3_html_ga9fe2899493b03fdf8fe00e3e58b5961c"><div class="ttname"><a href="group__prism3.html#ga9fe2899493b03fdf8fe00e3e58b5961c">prism3::basalRingsSeparation</a></div><div class="ttdeci">bool basalRingsSeparation(molSys::PointCloud&lt; molSys::Point&lt; double &gt;, double &gt; *yCloud, std::vector&lt; int &gt; basal1, std::vector&lt; int &gt; basal2, double heightCutoff=8)</div><div class="ttdoc">Check to see that candidate basal prisms are not really far from each other.</div><div class="ttdef"><b>Definition:</b> <a href="topo__bulk_8cpp_source.html#l01475">topo_bulk.cpp:1475</a></div></div>
<div class="ttc" id="agroup__prism3_html_gaab56bd69fb1698bf7fde8f04774c000f"><div class="ttname"><a href="group__prism3.html#gaab56bd69fb1698bf7fde8f04774c000f">ring::basalConditions</a></div><div class="ttdeci">bool basalConditions(std::vector&lt; std::vector&lt; int &gt;&gt; nList, std::vector&lt; int &gt; *basal1, std::vector&lt; int &gt; *basal2)</div><div class="ttdoc">Tests whether two rings are basal rings (true) or not (false)</div><div class="ttdef"><b>Definition:</b> <a href="topo__bulk_8cpp_source.html#l00704">topo_bulk.cpp:704</a></div></div>
<div class="ttc" id="agroup__prism3_html_gac3fdc9b1b49afad809867bb4def9a16c"><div class="ttname"><a href="group__prism3.html#gac3fdc9b1b49afad809867bb4def9a16c">ring::findPrismatic</a></div><div class="ttdeci">int findPrismatic(std::vector&lt; std::vector&lt; int &gt;&gt; rings, std::vector&lt; int &gt; *listHC, std::vector&lt; strucType &gt; *ringType, int iring, int jring, std::vector&lt; int &gt; *prismaticRings)</div><div class="ttdoc">Finds the prismatic rings from basal rings iring and jring.</div><div class="ttdef"><b>Definition:</b> <a href="topo__bulk_8cpp_source.html#l00939">topo_bulk.cpp:939</a></div></div>
<div class="ttc" id="agroup__prism3_html_gac811a7fb090a75aaf3bca9e56bf92a26"><div class="ttname"><a href="group__prism3.html#gac811a7fb090a75aaf3bca9e56bf92a26">ring::topoBulkAnalysis</a></div><div class="ttdeci">int topoBulkAnalysis(std::string path, std::vector&lt; std::vector&lt; int &gt;&gt; rings, std::vector&lt; std::vector&lt; int &gt;&gt; nList, molSys::PointCloud&lt; molSys::Point&lt; double &gt;, double &gt; *yCloud, int firstFrame, bool onlyTetrahedral=true)</div><div class="ttdef"><b>Definition:</b> <a href="topo__bulk_8cpp_source.html#l00052">topo_bulk.cpp:52</a></div></div>
<div class="ttc" id="agroup__prism3_html_gacac718ff48a33be9c78d7b1cee16b04f"><div class="ttname"><a href="group__prism3.html#gacac718ff48a33be9c78d7b1cee16b04f">ring::conditionThreeDDC</a></div><div class="ttdeci">bool conditionThreeDDC(std::vector&lt; std::vector&lt; int &gt;&gt; rings, std::vector&lt; int &gt; *peripheralRings)</div><div class="ttdef"><b>Definition:</b> <a href="topo__bulk_8cpp_source.html#l00487">topo_bulk.cpp:487</a></div></div>
<div class="ttc" id="agroup__prism3_html_gacb2bc68638bd794af38bcd503e17be0f"><div class="ttname"><a href="group__prism3.html#gacb2bc68638bd794af38bcd503e17be0f">prism3::findBulkPrisms</a></div><div class="ttdeci">int findBulkPrisms(std::vector&lt; std::vector&lt; int &gt;&gt; rings, std::vector&lt; ring::strucType &gt; *ringType, std::vector&lt; std::vector&lt; int &gt;&gt; nList, molSys::PointCloud&lt; molSys::Point&lt; double &gt;, double &gt; *yCloud, std::vector&lt; double &gt; *rmsdPerAtom, double heightCutoff=8)</div><div class="ttdoc">Find out which rings are prisms.</div><div class="ttdef"><b>Definition:</b> <a href="topo__bulk_8cpp_source.html#l01246">topo_bulk.cpp:1246</a></div></div>
<div class="ttc" id="agroup__prism3_html_gadb3c8127d84cb2e90aafff55419f2c85"><div class="ttname"><a href="group__prism3.html#gadb3c8127d84cb2e90aafff55419f2c85">ring::findMixedRings</a></div><div class="ttdeci">std::vector&lt; int &gt; findMixedRings(std::vector&lt; std::vector&lt; int &gt;&gt; rings, std::vector&lt; strucType &gt; *ringType, std::vector&lt; int &gt; *listDDC, std::vector&lt; int &gt; *listHC)</div><div class="ttdef"><b>Definition:</b> <a href="topo__bulk_8cpp_source.html#l01035">topo_bulk.cpp:1035</a></div></div>
<div class="ttc" id="agroup__prism3_html_gae71a760356516b591add17377783f9cb"><div class="ttname"><a href="group__prism3.html#gae71a760356516b591add17377783f9cb">prism3::basalPrismConditions</a></div><div class="ttdeci">bool basalPrismConditions(std::vector&lt; std::vector&lt; int &gt;&gt; nList, std::vector&lt; int &gt; *basal1, std::vector&lt; int &gt; *basal2)</div><div class="ttdef"><b>Definition:</b> <a href="topo__bulk_8cpp_source.html#l01347">topo_bulk.cpp:1347</a></div></div>
<div class="ttc" id="agroup__prism3_html_gaf6c8e26a55c976c7ae810914bd1c7362"><div class="ttname"><a href="group__prism3.html#gaf6c8e26a55c976c7ae810914bd1c7362">ring::findHC</a></div><div class="ttdeci">std::vector&lt; int &gt; findHC(std::vector&lt; std::vector&lt; int &gt;&gt; rings, std::vector&lt; strucType &gt; *ringType, std::vector&lt; std::vector&lt; int &gt;&gt; nList, std::vector&lt; cage::Cage &gt; *cageList)</div><div class="ttdef"><b>Definition:</b> <a href="topo__bulk_8cpp_source.html#l00569">topo_bulk.cpp:569</a></div></div>
<div class="ttc" id="agroup__ring_html_ga0d4e6d1dca2b07091dc0d94999c36ed9"><div class="ttname"><a href="group__ring.html#ga0d4e6d1dca2b07091dc0d94999c36ed9">ring::commonElementsInThreeRings</a></div><div class="ttdeci">bool commonElementsInThreeRings(std::vector&lt; int &gt; ring1, std::vector&lt; int &gt; ring2, std::vector&lt; int &gt; ring3)</div><div class="ttdoc">Common elements in 3 rings.</div><div class="ttdef"><b>Definition:</b> <a href="ring_8cpp_source.html#l00067">ring.cpp:67</a></div></div>
<div class="ttc" id="agroup__ring_html_ga3cca615046ff98165863e95fdadce530"><div class="ttname"><a href="group__ring.html#ga3cca615046ff98165863e95fdadce530">ring::findTripletInRing</a></div><div class="ttdeci">bool findTripletInRing(std::vector&lt; int &gt; ring, std::vector&lt; int &gt; triplet)</div><div class="ttdoc">Searches a particular ring for a triplet.</div><div class="ttdef"><b>Definition:</b> <a href="ring_8cpp_source.html#l00101">ring.cpp:101</a></div></div>
<div class="ttc" id="agroup__ring_html_ga76f3cb7aa8a713aeafecdf3a6fffee31"><div class="ttname"><a href="group__ring.html#ga76f3cb7aa8a713aeafecdf3a6fffee31">ring::clearRingList</a></div><div class="ttdeci">int clearRingList(std::vector&lt; std::vector&lt; int &gt;&gt; &amp;rings)</div><div class="ttdoc">Erases memory for a vector of vectors for a list of rings.</div><div class="ttdef"><b>Definition:</b> <a href="ring_8cpp_source.html#l00022">ring.cpp:22</a></div></div>
<div class="ttc" id="agroup__ring_html_gac30855d0daa2b20c29e4dee39f5cd92f"><div class="ttname"><a href="group__ring.html#gac30855d0daa2b20c29e4dee39f5cd92f">ring::hasCommonElements</a></div><div class="ttdeci">bool hasCommonElements(std::vector&lt; int &gt; ring1, std::vector&lt; int &gt; ring2)</div><div class="ttdef"><b>Definition:</b> <a href="ring_8cpp_source.html#l00179">ring.cpp:179</a></div></div>
<div class="ttc" id="agroup__ring_html_gae9254c83de03fcf18b4cb5dcb2625011"><div class="ttname"><a href="group__ring.html#gae9254c83de03fcf18b4cb5dcb2625011">ring::getSingleRingSize</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; int &gt; &gt; getSingleRingSize(std::vector&lt; std::vector&lt; int &gt;&gt; rings, int ringSize)</div><div class="ttdoc">Returns a vector of vectors of rings of a single size.</div><div class="ttdef"><b>Definition:</b> <a href="ring_8cpp_source.html#l00153">ring.cpp:153</a></div></div>
<div class="ttc" id="agroup__ring_html_gaed5f39c14a4d76c1746aed53e0d0a2dc"><div class="ttname"><a href="group__ring.html#gaed5f39c14a4d76c1746aed53e0d0a2dc">ring::findsCommonElements</a></div><div class="ttdeci">std::vector&lt; int &gt; findsCommonElements(std::vector&lt; int &gt; ring1, std::vector&lt; int &gt; ring2)</div><div class="ttdoc">Returns the common elements of two rings.</div><div class="ttdef"><b>Definition:</b> <a href="ring_8cpp_source.html#l00038">ring.cpp:38</a></div></div>
<div class="ttc" id="agroup__ring_html_gga301cfdc88452cfe51bd4f745d223a7e1a074049f7a1a6ea8338d256f5b4e586a2"><div class="ttname"><a href="group__ring.html#gga301cfdc88452cfe51bd4f745d223a7e1a074049f7a1a6ea8338d256f5b4e586a2">ring::bothBasal</a></div><div class="ttdeci">@ bothBasal</div><div class="ttdoc">The ring belongs to both a DDC and HC. It is a 'mixed' ring. The ring is also one of the basal rings ...</div><div class="ttdef"><b>Definition:</b> <a href="ring_8hpp_source.html#l00121">ring.hpp:121</a></div></div>
<div class="ttc" id="agroup__ring_html_gga301cfdc88452cfe51bd4f745d223a7e1a37a9bfe125a811135f6c77d832cef242"><div class="ttname"><a href="group__ring.html#gga301cfdc88452cfe51bd4f745d223a7e1a37a9bfe125a811135f6c77d832cef242">ring::DDC</a></div><div class="ttdeci">@ DDC</div><div class="ttdoc">The ring belongs to a double-diamond cage (DDC).</div><div class="ttdef"><b>Definition:</b> <a href="ring_8hpp_source.html#l00118">ring.hpp:118</a></div></div>
<div class="ttc" id="agroup__ring_html_gga301cfdc88452cfe51bd4f745d223a7e1a48c3c5c40739122c0bf68fb9faeee9da"><div class="ttname"><a href="group__ring.html#gga301cfdc88452cfe51bd4f745d223a7e1a48c3c5c40739122c0bf68fb9faeee9da">ring::HCbasal</a></div><div class="ttdeci">@ HCbasal</div><div class="ttdoc">The ring belongs only to a hexagonal cage (HC). Specifically, the ring is purely a basal ring of an H...</div><div class="ttdef"><b>Definition:</b> <a href="ring_8hpp_source.html#l00119">ring.hpp:119</a></div></div>
<div class="ttc" id="agroup__ring_html_gga301cfdc88452cfe51bd4f745d223a7e1a499b694d8386eef89ba2f6e621ed7578"><div class="ttname"><a href="group__ring.html#gga301cfdc88452cfe51bd4f745d223a7e1a499b694d8386eef89ba2f6e621ed7578">ring::deformedPrism</a></div><div class="ttdeci">@ deformedPrism</div><div class="ttdef"><b>Definition:</b> <a href="ring_8hpp_source.html#l00124">ring.hpp:124</a></div></div>
<div class="ttc" id="agroup__ring_html_gga301cfdc88452cfe51bd4f745d223a7e1a60cc60f3804efaf86af8c2c2fbbe7208"><div class="ttname"><a href="group__ring.html#gga301cfdc88452cfe51bd4f745d223a7e1a60cc60f3804efaf86af8c2c2fbbe7208">ring::unclassified</a></div><div class="ttdeci">@ unclassified</div><div class="ttdoc">The ring is unclassified, which may be either water or a deformed type which cannot be classified by ...</div><div class="ttdef"><b>Definition:</b> <a href="ring_8hpp_source.html#l00117">ring.hpp:117</a></div></div>
<div class="ttc" id="agroup__ring_html_gga301cfdc88452cfe51bd4f745d223a7e1a6681861f6a3ec92005e0d5a0e4b7dfce"><div class="ttname"><a href="group__ring.html#gga301cfdc88452cfe51bd4f745d223a7e1a6681861f6a3ec92005e0d5a0e4b7dfce">ring::bothPrismatic</a></div><div class="ttdeci">@ bothPrismatic</div><div class="ttdoc">The ring belongs to both a DDC and HC and is, thus, a 'mixed' ring. The ring is also one of the prism...</div><div class="ttdef"><b>Definition:</b> <a href="ring_8hpp_source.html#l00122">ring.hpp:122</a></div></div>
<div class="ttc" id="agroup__ring_html_gga301cfdc88452cfe51bd4f745d223a7e1a66afb615d90d5df19cce1df68e24d7f2"><div class="ttname"><a href="group__ring.html#gga301cfdc88452cfe51bd4f745d223a7e1a66afb615d90d5df19cce1df68e24d7f2">ring::HCprismatic</a></div><div class="ttdeci">@ HCprismatic</div><div class="ttdoc">The ring belongs only to a hexagonal cage (HC); specifically the ring is purely a prismatic ring of a...</div><div class="ttdef"><b>Definition:</b> <a href="ring_8hpp_source.html#l00120">ring.hpp:120</a></div></div>
<div class="ttc" id="agroup__ring_html_gga301cfdc88452cfe51bd4f745d223a7e1aabd9a19704526f9be67c7dcd1c2b4af9"><div class="ttname"><a href="group__ring.html#gga301cfdc88452cfe51bd4f745d223a7e1aabd9a19704526f9be67c7dcd1c2b4af9">ring::mixedPrismRing</a></div><div class="ttdeci">@ mixedPrismRing</div><div class="ttdef"><b>Definition:</b> <a href="ring_8hpp_source.html#l00126">ring.hpp:125</a></div></div>
<div class="ttc" id="agroup__ring_html_gga301cfdc88452cfe51bd4f745d223a7e1ac4295ff0a8263a65de0694cc0b20e9af"><div class="ttname"><a href="group__ring.html#gga301cfdc88452cfe51bd4f745d223a7e1ac4295ff0a8263a65de0694cc0b20e9af">ring::Prism</a></div><div class="ttdeci">@ Prism</div><div class="ttdoc">The ring belongs to a prism block, classified according to the prism identification scheme.</div><div class="ttdef"><b>Definition:</b> <a href="ring_8hpp_source.html#l00123">ring.hpp:123</a></div></div>
<div class="ttc" id="ainsert_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/container/vector/insert.html">std::vector::insert</a></div><div class="ttdeci">T insert(T... args)</div></div>
<div class="ttc" id="anamespacematch_html_a64b2b2b69cffbaf8ae93583588c63240"><div class="ttname"><a href="namespacematch.html#a64b2b2b69cffbaf8ae93583588c63240">match::matchUntetheredPrism</a></div><div class="ttdeci">bool matchUntetheredPrism(molSys::PointCloud&lt; molSys::Point&lt; double &gt;, double &gt; *yCloud, std::vector&lt; std::vector&lt; int &gt;&gt; nList, const Eigen::MatrixXd &amp;refPoints, std::vector&lt; int &gt; *basal1, std::vector&lt; int &gt; *basal2, std::vector&lt; double &gt; *rmsdPerAtom)</div><div class="ttdef"><b>Definition:</b> <a href="shapeMatch_8cpp_source.html#l00110">shapeMatch.cpp:110</a></div></div>
<div class="ttc" id="anamespacepntToPnt_html_a5b2c3bd3984c707965b6cc5ec03ff1da"><div class="ttname"><a href="namespacepntToPnt.html#a5b2c3bd3984c707965b6cc5ec03ff1da">pntToPnt::getPointSetRefRing</a></div><div class="ttdeci">Eigen::MatrixXd getPointSetRefRing(int n, int axialDim)</div><div class="ttdef"><b>Definition:</b> <a href="pntCorrespondence_8cpp_source.html#l00022">pntCorrespondence.cpp:22</a></div></div>
<div class="ttc" id="anamespacering_html"><div class="ttname"><a href="namespacering.html">ring</a></div><div class="ttdoc">Topological network criteria functions.</div><div class="ttdef"><b>Definition:</b> <a href="ring_8hpp_source.html#l00064">ring.hpp:64</a></div></div>
<div class="ttc" id="anamespacesout_html_a5ca5eeff9edc702cdcf1b26e8501dc0c"><div class="ttname"><a href="namespacesout.html#a5ca5eeff9edc702cdcf1b26e8501dc0c">sout::writeTopoBulkData</a></div><div class="ttdeci">int writeTopoBulkData(std::string path, int currentFrame, int numHC, int numDDC, int mixedRings, int basalRings, int prismaticRings, int firstFrame)</div><div class="ttdef"><b>Definition:</b> <a href="seams__output_8cpp_source.html#l01053">seams_output.cpp:1053</a></div></div>
<div class="ttc" id="anamespacesout_html_aabeb7b712f568256cf3ed782fa91c518"><div class="ttname"><a href="namespacesout.html#aabeb7b712f568256cf3ed782fa91c518">sout::writeLAMMPSdataTopoBulk</a></div><div class="ttdeci">int writeLAMMPSdataTopoBulk(molSys::PointCloud&lt; molSys::Point&lt; double &gt;, double &gt; *yCloud, std::vector&lt; std::vector&lt; int &gt;&gt; nList, std::vector&lt; cage::iceType &gt; atomTypes, std::string path, bool bondsBetweenDummy=false)</div><div class="ttdef"><b>Definition:</b> <a href="seams__output_8cpp_source.html#l02115">seams_output.cpp:2115</a></div></div>
<div class="ttc" id="apush_back_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/container/vector/push_back.html">std::vector::push_back</a></div><div class="ttdeci">T push_back(T... args)</div></div>
<div class="ttc" id="aresize_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/container/vector/resize.html">std::vector::resize</a></div><div class="ttdeci">T resize(T... args)</div></div>
<div class="ttc" id="asize_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/container/vector/size.html">std::vector::size</a></div><div class="ttdeci">T size(T... args)</div></div>
<div class="ttc" id="asort_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/algorithm/sort.html">std::sort</a></div><div class="ttdeci">T sort(T... args)</div></div>
<div class="ttc" id="astructmolSys_1_1PointCloud_html"><div class="ttname"><a href="structmolSys_1_1PointCloud.html">molSys::PointCloud</a></div><div class="ttdoc">This contains a collection of points; contains information for a particular frame.</div><div class="ttdef"><b>Definition:</b> <a href="mol__sys_8hpp_source.html#l00170">mol_sys.hpp:170</a></div></div>
<div class="ttc" id="astructmolSys_1_1Point_html"><div class="ttname"><a href="structmolSys_1_1Point.html">molSys::Point</a></div><div class="ttdoc">This contains per-particle information.</div><div class="ttdef"><b>Definition:</b> <a href="mol__sys_8hpp_source.html#l00149">mol_sys.hpp:149</a></div></div>
<div class="ttc" id="atopo__bulk_8hpp_html"><div class="ttname"><a href="topo__bulk_8hpp.html">topo_bulk.hpp</a></div><div class="ttdoc">File containing functions used specific to bulk topological network critera.</div></div>
<div class="ttc" id="aunique_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/algorithm/unique.html">std::unique</a></div><div class="ttdeci">T unique(T... args)</div></div>
<div class="ttc" id="avector_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- Copyright 2020 Rohit Goswami <rog32@hi.is>
     Licensed under the Apache License, Version 2.0 (the "License");
     you may not use this file except in compliance with the License.
     You may obtain a copy of the License at
     http://www.apache.org/licenses/LICENSE-2.0
     Unless required by applicable law or agreed to in writing, software
     distributed under the License is distributed on an "AS IS" BASIS,
     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     See the License for the specific language governing permissions and
     limitations under the License. -->
<!-- HTML footer for doxygen 1.9.1-->
<!-- start footer part -->
<div class="footer">
<hr class="footline"/><address class="footline"><small>
    Generated by&#160;<a href="https://www.doxygen.org/index.html">Doxygen 1.9.1</a> and the <a class="outlink" href="https://github.com/HaoZeke/doxyYoda">doxyYoda theme</a>
</small></address>
</div>
</div>
</body>
</html>
