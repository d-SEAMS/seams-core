<!-- Copyright 2020 Rohit Goswami <rog32@hi.is>
     Licensed under the Apache License, Version 2.0 (the "License");
     you may not use this file except in compliance with the License.
     You may obtain a copy of the License at
     http://www.apache.org/licenses/LICENSE-2.0
     Unless required by applicable law or agreed to in writing, software
     distributed under the License is distributed on an "AS IS" BASIS,
     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     See the License for the specific language governing permissions and
     limitations under the License. -->
<!-- HTML header for doxygen 1.9.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>d-SEAMS: src/cluster.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script>
MathJax = {
  tex: {
    inlineMath: [['$', '$'], ['\\(', '\\)']]
  },
  svg: {
    fontCache: 'global'
  }
  loader: { load: ["[tex]/unicode", "[tex]/ams"] },
  tex: {
    packages: { "[+]": ["unicode", "ams"] },
    tags: "ams",
  },
};
</script>
<script type="text/javascript" id="MathJax-script" async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js">
</script>
<!-- <link href="doxygen.css" rel="stylesheet" type="text/css" /> -->
<link href="doxyYoda.min.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" >
$(document).ready(function() {
     $(".fragment").wrap("<details class='code-details'></details>");
     $(".code-details").append("<summary>Code</summary>");
 }
)
</script>
</head>
<body>
<div class="grid-contents">
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<nav class="title_area">
<a class="project_logo" href="#">
<img src="dSeamsLogo.png" width="30" height="30" alt="Logo">
</a>
<span class="project_info">d-SEAMS v1.0.0</span>
</nav>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">cluster.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="cluster_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="cluster_8hpp.html">cluster.hpp</a>&gt;</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160; </div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="keyword">namespace </span>bg = boost::geometry;</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160; </div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160; </div>
<div class="line"><a name="l00026"></a><span class="lineno"><a class="line" href="group__clump.html#gad4824638fa14ec355ab99804c9119e35">   26</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="group__clump.html#gad4824638fa14ec355ab99804c9119e35">clump::largestIceCluster</a>(</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    <a class="codeRef" href="http://en.cppreference.com/w/cpp/string/basic_string.html">std::string</a> path, <a class="code" href="structmolSys_1_1PointCloud.html">molSys::PointCloud</a>&lt;<a class="code" href="structmolSys_1_1Point.html">molSys::Point&lt;double&gt;</a>, <span class="keywordtype">double</span>&gt; *yCloud,</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    <a class="code" href="structmolSys_1_1PointCloud.html">molSys::PointCloud</a>&lt;<a class="code" href="structmolSys_1_1Point.html">molSys::Point&lt;double&gt;</a>, <span class="keywordtype">double</span>&gt; *iceCloud,</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt;<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a>&gt; nList, <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;bool&gt;</a> *isIce,</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a> *list, <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a> *nClusters,</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/unordered_map.html">std::unordered_map&lt;int, int&gt;</a> *indexNumber, <span class="keywordtype">int</span> firstFrame) {</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;  <span class="keywordtype">int</span> kAtomID;                     <span class="comment">// Atom ID of the nearest neighbour</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;  <span class="keywordtype">int</span> iClusterNumber;              <span class="comment">// Number in the current cluster</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;  <span class="keywordtype">int</span> nLargestCluster;             <span class="comment">// Number in the largest cluster</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a> linkedList;     <span class="comment">// Linked list</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;  <span class="keywordtype">int</span> j;                           <span class="comment">// Index</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a> startingIndex;  <span class="comment">// Contains the vector index in list</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;                                   <span class="comment">// corresponding to a particular cluster</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;  <span class="keywordtype">int</span> temp;                        <span class="comment">// For swapping</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;bool&gt;</a></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;      visited;  <span class="comment">// To make sure you don&#39;t go through the same atoms again.</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  <a class="code" href="structmolSys_1_1Point.html">molSys::Point&lt;double&gt;</a> iPoint;  <span class="comment">// Current point</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  <span class="keywordtype">int</span> currentIndex;              <span class="comment">// Current index</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160; </div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  <span class="comment">// -----------------------------------------------------------</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  <span class="comment">// INITIALIZATION</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  linkedList.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/resize.html">resize</a>(yCloud-&gt;nop, -1);  <span class="comment">// init to dummy value</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;  <span class="comment">// Initial values of the list. -1 is a dummy value if the molecule is</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  <span class="comment">// water or not in the slice</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iatom = 0; iatom &lt; yCloud-&gt;nop; iatom++) {</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    <span class="comment">// Skip if the molecule is water or if it is not in the slice</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    <span class="keywordflow">if</span> ((*isIce)[iatom] == <span class="keyword">false</span> || yCloud-&gt;pts[iatom].inSlice == <span class="keyword">false</span>) {</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    }  <span class="comment">// skip for water or not in slice</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <span class="comment">// Otherwise, assign the index as the ID</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    linkedList[iatom] = iatom;</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  }  <span class="comment">// init of cluster IDs</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  <span class="comment">// -----------------------------------------------------------</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  <span class="comment">// Get the linked list</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; yCloud-&gt;nop - 1; i++) {</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    <span class="comment">// Skip if the molecule is water or if it is not in the slice</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    <span class="keywordflow">if</span> (linkedList[i] == -1) {</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    }  <span class="comment">// skip for water or not in slice</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    <span class="comment">// If iatom is already in a cluster, skip it</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <span class="keywordflow">if</span> (linkedList[i] != i) {</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    }  <span class="comment">// Already part of a cluster</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    j = i;  <span class="comment">// Init of j</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    <span class="comment">// Execute the next part of the loop while j is not equal to i</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    <span class="keywordflow">do</span> {</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;      <span class="comment">//</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;      <span class="comment">// Go through the rest of the atoms (KLOOP)</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = i + 1; k &lt; yCloud-&gt;nop; k++) {</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;        <span class="comment">// Skip if not ice</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;        <span class="keywordflow">if</span> ((*isIce)[k] == <span class="keyword">false</span>) {</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;          <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        }  <span class="comment">// not ice</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;        <span class="comment">// Skip if already part of a cluster</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;        <span class="keywordflow">if</span> (linkedList[k] != k) {</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;          <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;        }  <span class="comment">// Already part of a cluster</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;        <span class="comment">// Check to see if k is a nearest neighbour of j</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;        kAtomID = yCloud-&gt;pts[k].atomID;  <span class="comment">// Atom ID</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;        <span class="keyword">auto</span> it = <a class="codeRef" href="http://en.cppreference.com/w/cpp/algorithm/find.html">std::find</a>(nList[j].begin() + 1, nList[j].end(), kAtomID);</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;        <span class="keywordflow">if</span> (it != nList[j].end()) {</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;          <span class="comment">// Swap!</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;          temp = linkedList[j];</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;          linkedList[j] = linkedList[k];</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;          linkedList[k] = temp;</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;        }  <span class="comment">// j and k are nearest neighbours</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;      }    <span class="comment">// end of loop through k (KLOOP)</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;      <span class="comment">//</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;      j = linkedList[j];</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    } <span class="keywordflow">while</span> (j != i);  <span class="comment">// end of control for j!=i</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160; </div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  }  <span class="comment">// end of looping through every i</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160; </div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  <span class="comment">// -----------------------------------------------------------</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  <span class="comment">// Get the starting index (which is the vector index in list) corresponding to</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  <span class="comment">// clusters with more than one molecule in them</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  <span class="keywordtype">int</span> nextElement;  <span class="comment">// value in list</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  <span class="keywordtype">int</span> index;        <span class="comment">// starting index value</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  <span class="comment">// init</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  visited.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/resize.html">resize</a>(yCloud-&gt;nop);</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160; </div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; yCloud-&gt;nop; i++) {</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    <span class="keywordflow">if</span> (visited[i]) {</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    }                   <span class="comment">// Already counted</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    visited[i] = <span class="keyword">true</span>;  <span class="comment">// Visited</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    <span class="keywordflow">if</span> (linkedList[i] == -1) {</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    }  <span class="comment">// not ice</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    <span class="keywordflow">if</span> (linkedList[i] == i) {</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    }  <span class="comment">// only one element</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    currentIndex = i;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    nextElement = linkedList[currentIndex];</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    index = i;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    iClusterNumber = 1;  <span class="comment">// at least one value</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <span class="keywordflow">while</span> (nextElement != index) {</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;      iClusterNumber++;</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;      currentIndex = nextElement;</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;      visited[currentIndex] = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;      nextElement = linkedList[currentIndex];</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    }  <span class="comment">// get number</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    <span class="comment">// Update startingIndex with index</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    startingIndex.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/push_back.html">push_back</a>(index);</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <span class="comment">// Update the number of molecules in the cluster</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    (*nClusters).push_back(iClusterNumber);</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;  }  <span class="comment">// end of loop through</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  <span class="comment">// -----------------------------------------------------------</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  <span class="comment">// Get the largest cluster and save the atoms to the iceCloud pointCloud</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;  nLargestCluster = *<a class="codeRef" href="http://en.cppreference.com/w/cpp/algorithm/max_element.html">std::max_element</a>((*nClusters).begin(), (*nClusters).end());</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;  <span class="keywordtype">int</span> lClusIndex = <a class="code" href="group__gen.html#ga11feba0acc8858c6a8a4b637b994c60a">distance</a>(</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;      (*nClusters).begin(),</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;      max_element(</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;          (*nClusters).begin(),</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;          (*nClusters).end()));  <span class="comment">// index of the cluster with the largest number</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;  <span class="comment">// -----------------------------------------------------------</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;  <span class="comment">// Loop through the linked list from the starting element</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;  <span class="comment">// startingIndex[lClusIndex].</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;  <span class="keywordtype">int</span> startCluster =</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;      startingIndex[lClusIndex];  <span class="comment">// index in linkedList to start from</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160; </div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;  <span class="comment">// L[i]-&gt;j-&gt;L[j]-&gt;k-&gt;L[k]-&gt;i</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;  index = startCluster;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  <span class="comment">// Update iceCloud</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;  iPoint = yCloud-&gt;pts[index];</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;  iceCloud-&gt;pts.push_back(iPoint);</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;  nextElement = linkedList[startCluster];</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;  <span class="keywordflow">while</span> (nextElement != index) {</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    currentIndex = nextElement;</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    <span class="comment">// update with currentIndex</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    iPoint = yCloud-&gt;pts[currentIndex];</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    iceCloud-&gt;pts.push_back(iPoint);</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <span class="comment">// end update</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    nextElement = linkedList[currentIndex];</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;  }  <span class="comment">// get the largest cluster</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;  <span class="comment">// -----------------------------------------------------------</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;  <span class="comment">// Update other variables in iceCloud</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160; </div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;  iceCloud-&gt;currentFrame = yCloud-&gt;currentFrame;</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  iceCloud-&gt;nop = iceCloud-&gt;pts.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/size.html">size</a>();</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;  iceCloud-&gt;box = yCloud-&gt;box;</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;  iceCloud-&gt;boxLow = yCloud-&gt;boxLow;</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160; </div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;  <span class="comment">// Update idIndexMap</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iatom = 0; iatom &lt; iceCloud-&gt;nop; iceCloud++) {</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    iceCloud-&gt;idIndexMap[iceCloud-&gt;pts[iatom].atomID] = iatom;</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;  }  <span class="comment">// end of loop through iceCloud</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160; </div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;  <span class="comment">// -----------------------------------------------------------</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;  <span class="comment">// Write out the cluster statistics</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;  <span class="keywordtype">int</span> totalClusters = (*nClusters).size();  <span class="comment">// Total number of clusters</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;  <span class="keywordtype">int</span> smallestCluster = nLargestCluster =</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;      *<a class="codeRef" href="http://en.cppreference.com/w/cpp/algorithm/min_element.html">std::min_element</a>((*nClusters).begin(),</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;                        (*nClusters).end());  <span class="comment">// Size of the smallest cluster</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;  <span class="keywordtype">double</span> avgClusterSize = 0.0;</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160; </div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;  <span class="comment">// Get the average cluster size</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iCluster = 0; iCluster &lt; totalClusters; iCluster++) {</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    avgClusterSize += (*nClusters)[iCluster];</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;  }  <span class="comment">// Loop through the clusters</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;  <span class="comment">// Normalize by the number</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;  <span class="keywordflow">if</span> (totalClusters == 0) {</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    avgClusterSize = 0;</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    avgClusterSize /= totalClusters;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;  }</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160; </div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;  iceCloud-&gt;currentFrame = yCloud-&gt;currentFrame;</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;  nLargestCluster = (*nClusters)[lClusIndex];</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160; </div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;  <span class="comment">// Write out to the file</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;  <a class="code" href="namespacesout.html#aee17b8438205b4b88aad8a481c533ba5">sout::writeClusterStats</a>(path, yCloud-&gt;currentFrame, nLargestCluster,</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;                          totalClusters, smallestCluster, avgClusterSize,</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;                          firstFrame);</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160; </div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;  <span class="comment">// -----------------------------------------------------------</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;  <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;}</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160; </div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160; </div>
<div class="line"><a name="l00223"></a><span class="lineno"><a class="line" href="group__clump.html#gab83fbf0e06856cbcce3c4279598bd15f">  223</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="group__clump.html#gab83fbf0e06856cbcce3c4279598bd15f">clump::singleClusterLinkedList</a>(</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    <a class="code" href="structmolSys_1_1PointCloud.html">molSys::PointCloud</a>&lt;<a class="code" href="structmolSys_1_1Point.html">molSys::Point&lt;double&gt;</a>, <span class="keywordtype">double</span>&gt; *iceCloud,</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt;<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a>&gt; nList, <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a> *linkedList) {</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;  <span class="keywordtype">int</span> j;</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;  <span class="keywordtype">int</span> temp;  <span class="comment">// For swapping indices</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;  <span class="comment">// -----------------------------------------------------------</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;  <span class="comment">// INITIALIZATION</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;  (*linkedList).resize(iceCloud-&gt;nop);</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;  <span class="comment">// Initial values of the list.</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iatom = 0; iatom &lt; iceCloud-&gt;nop; iatom++) {</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    <span class="comment">// Assign the index as the ID</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    (*linkedList)[iatom] = iatom;</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;  }  <span class="comment">// init of cluster IDs</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;  <span class="comment">// -----------------------------------------------------------</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;  <span class="comment">// Get the linked list</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; iceCloud-&gt;nop - 1; i++) {</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    <span class="comment">// If iatom is already in a cluster, skip it</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    <span class="keywordflow">if</span> ((*linkedList)[i] != i) {</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    }  <span class="comment">// Already part of a cluster</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    j = i;  <span class="comment">// Init of j</span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    <span class="comment">// Execute the next part of the loop while j is not equal to i</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    <span class="keywordflow">do</span> {</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;      <span class="comment">//</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;      <span class="comment">// Go through the rest of the atoms (KLOOP)</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = i + 1; k &lt; iceCloud-&gt;nop; k++) {</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;        <span class="comment">// Skip if already part of a cluster</span></div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;        <span class="keywordflow">if</span> ((*linkedList)[k] != k) {</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;          <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;        }  <span class="comment">// Already part of a cluster</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;        <span class="comment">// Check to see if k is a nearest neighbour of j</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;        <span class="keyword">auto</span> it = <a class="codeRef" href="http://en.cppreference.com/w/cpp/algorithm/find.html">std::find</a>(nList[j].begin() + 1, nList[j].end(), k);</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;        <span class="keywordflow">if</span> (it != nList[j].end()) {</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;          <span class="comment">// Swap!</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;          temp = (*linkedList)[j];</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;          (*linkedList)[j] = (*linkedList)[k];</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;          (*linkedList)[k] = temp;</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;        }  <span class="comment">// j and k are nearest neighbours</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;      }    <span class="comment">// end of loop through k (KLOOP)</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;      <span class="comment">//</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;      j = (*linkedList)[j];</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    } <span class="keywordflow">while</span> (j != i);  <span class="comment">// end of control for j!=i</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160; </div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;  }  <span class="comment">// end of looping through every i</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160; </div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;  <span class="comment">// Return 0</span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;  <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;}  <span class="comment">// end of function</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160; </div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160; </div>
<div class="line"><a name="l00298"></a><span class="lineno"><a class="line" href="group__clump.html#gae3705e982771b2719016d3c6f237515f">  298</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="group__clump.html#gae3705e982771b2719016d3c6f237515f">clump::clusterAnalysis</a>(</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    <a class="codeRef" href="http://en.cppreference.com/w/cpp/string/basic_string.html">std::string</a> path,</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    <a class="code" href="structmolSys_1_1PointCloud.html">molSys::PointCloud</a>&lt;<a class="code" href="structmolSys_1_1Point.html">molSys::Point&lt;double&gt;</a>, <span class="keywordtype">double</span>&gt; *iceCloud,</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    <a class="code" href="structmolSys_1_1PointCloud.html">molSys::PointCloud</a>&lt;<a class="code" href="structmolSys_1_1Point.html">molSys::Point&lt;double&gt;</a>, <span class="keywordtype">double</span>&gt; *yCloud,</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt;<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a>&gt; nList,</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt;<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a>&gt; &amp;iceNeighbourList, <span class="keywordtype">double</span> cutoff,</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    <span class="keywordtype">int</span> firstFrame, <a class="codeRef" href="http://en.cppreference.com/w/cpp/string/basic_string.html">std::string</a> bopAnalysis) {</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;bool&gt;</a> isIce;     <span class="comment">// For every particle in yCloud, has a value</span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;  <span class="keywordtype">int</span> nTotalIce;               <span class="comment">// Total number of ice-like molecules</span></div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a> clusterID;  <span class="comment">// Vector containing the cluster IDs of all the</span></div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;                               <span class="comment">// ice-like molecules.</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a> nClusters;  <span class="comment">// Number of clusters for each index</span></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/unordered_map.html">std::unordered_map&lt;int, int&gt;</a></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;      indexNumber;  <span class="comment">// Map for cluster index and index in the number vector</span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160; </div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;  <span class="comment">// -------------------------------------------------------</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;  <span class="comment">// Init</span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;  <span class="comment">// Clear the largest ice cluster pointCloud.</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;  *iceCloud = <a class="code" href="group__molSys.html#gad8acfb41ee6bc0258612e9cac24269b2">molSys::clearPointCloud</a>(iceCloud);</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;  <span class="comment">// Clear the neighbour list by index</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;  <a class="code" href="group__nneigh.html#gad15a56db7bd85332af86936e51cce9fa">nneigh::clearNeighbourList</a>(iceNeighbourList);</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;  <span class="comment">// Init the vector of bools for every particle in yCloud</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;  isIce.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/resize.html">resize</a>(yCloud-&gt;nop);</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;  nTotalIce = 0;  <span class="comment">// Total number of ice-like molecules</span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;  <span class="comment">// -------------------------------------------------------</span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;  <span class="comment">// Use a bond-orientational parameter to find ice-like particles</span></div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;  <span class="comment">// Q6</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;  <span class="keywordflow">if</span> (bopAnalysis == <span class="stringliteral">&quot;q6&quot;</span>) {</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;double&gt;</a> q6Values;</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    <span class="comment">// Calculate the Q6 parameters for every point in yCloud</span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    q6Values = <a class="code" href="group__chill.html#ga06aa04366cf8d05811e0c0a881464c24">chill::getq6</a>(yCloud, nList);</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    <span class="comment">// Assign values to isIce according to the values</span></div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    <span class="comment">// of the q6 parameter. If q6 is greater than 0.5, it is ice-like.</span></div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iatom = 0; iatom &lt; yCloud-&gt;nop; iatom++) {</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;      <span class="comment">// If q6 is greater than 0.5, it is ice-like</span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;      <span class="keywordflow">if</span> (q6Values[iatom] &gt; 0.5) {</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;        isIce[iatom] = <span class="keyword">true</span>;  <span class="comment">// is ice-like; by default false</span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;        nTotalIce++;          <span class="comment">// Add to the number of ice-like molecules</span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;      }                       <span class="comment">// ice-like molecule found</span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    }                         <span class="comment">// end of loop through every atom in yCloud</span></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;  }  <span class="comment">// end of getting a vector of bools for ice-like particles</span></div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;  <span class="comment">// CHILL</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;  <span class="comment">// Q6</span></div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;  <span class="keywordflow">if</span> (bopAnalysis == <span class="stringliteral">&quot;chill&quot;</span>) {</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    *yCloud = <a class="code" href="group__chill.html#ga4ec7f9663b66377a4156b72039b58f40">chill::getCorrel</a>(yCloud, nList, <span class="keyword">false</span>);</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    <span class="comment">// Get the ice types</span></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    *yCloud = <a class="code" href="group__chill.html#gad8c1ae4aaa660900988e494f682b2b09">chill::getIceTypeNoPrint</a>(yCloud, nList, <span class="keyword">false</span>);</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    <span class="comment">// Assign values to isIce according to the CHILL algorithm</span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iatom = 0; iatom &lt; yCloud-&gt;nop; iatom++) {</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;      <span class="comment">// If it is an ice-like molecule, add it, otherwise skip</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;      <span class="keywordflow">if</span> (yCloud-&gt;pts[iatom].iceType == <a class="code" href="group__molSys.html#gga13ffe3a39a0816627553f195e102abb5aa701d941ff4dc44b45faa7fd0e1f163f">molSys::water</a>) {</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;      }  <span class="comment">// water</span></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;      <span class="keywordflow">if</span> (yCloud-&gt;pts[iatom].iceType == <a class="code" href="group__molSys.html#gga13ffe3a39a0816627553f195e102abb5ad19ecf271dba48ef8dd8175326f669b4">molSys::unclassified</a>) {</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;      }                     <span class="comment">// unclassified</span></div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;      isIce[iatom] = <span class="keyword">true</span>;  <span class="comment">// is ice-like; by default false</span></div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;      nTotalIce++;          <span class="comment">// Add to the number of ice-like molecules</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160; </div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    }  <span class="comment">// end of loop through every atom in yCloud</span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;  }    <span class="comment">// end of getting a vector of bools for ice-like particles</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;  <span class="comment">// -------------------------------------------------------</span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;  <span class="comment">// Get the largest ice cluster and other data</span></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;  <a class="code" href="group__clump.html#gad4824638fa14ec355ab99804c9119e35">clump::largestIceCluster</a>(path, yCloud, iceCloud, nList, &amp;isIce, &amp;clusterID,</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;                           &amp;nClusters, &amp;indexNumber, firstFrame);</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160; </div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;  <span class="comment">// -------------------------------------------------------</span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;  <span class="comment">// Get the neighbour list by index according to the largest ice cluster</span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;  <span class="comment">// pointCloud</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;  iceNeighbourList = <a class="code" href="group__nneigh.html#gaf1f3bc572fb2feaca38f59362af681c6">nneigh::getNewNeighbourListByIndex</a>(iceCloud, cutoff);</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160; </div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;  <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;}  <span class="comment">// end of function</span></div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160; </div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160; </div>
<div class="line"><a name="l00384"></a><span class="lineno"><a class="line" href="group__clump.html#ga05192f1f3166d0a19744345f641da360">  384</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="group__clump.html#ga05192f1f3166d0a19744345f641da360">clump::recenterClusterCloud</a>(</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    <a class="code" href="structmolSys_1_1PointCloud.html">molSys::PointCloud</a>&lt;<a class="code" href="structmolSys_1_1Point.html">molSys::Point&lt;double&gt;</a>, <span class="keywordtype">double</span>&gt; *iceCloud,</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt;<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a>&gt; nList) {</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;  <span class="keywordtype">int</span> dim = 3;  <span class="comment">// Dimensions</span></div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;double&gt;</a> box = iceCloud-&gt;box;</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;double&gt;</a> boxLow = iceCloud-&gt;boxLow;</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;double&gt;</a> boxHigh;</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;  <span class="keywordtype">double</span> xBoxCenter, yBoxCenter, zBoxCenter;  <span class="comment">// Centroid of the simulation box</span></div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;  <span class="keywordtype">double</span> x_centroid, y_centroid, z_centroid;  <span class="comment">// Centroid of the cluster</span></div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;  <span class="comment">// Variables for the linked list</span></div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a> linkedList;  <span class="comment">// Contains the linked list for the cluster</span></div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;bool&gt;</a> visited;  <span class="comment">// Records whether an item has been visited or not</span></div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160; </div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;  <span class="comment">// To avoid long confusing lines, fill boxHigh</span></div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; dim; k++) {</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    boxHigh.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/push_back.html">push_back</a>(boxLow[k] + box[k]);</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;  }  <span class="comment">// end of filling up boxHigh</span></div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160; </div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;  <span class="comment">// --------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;  <span class="comment">// Get the linked list of the cluster</span></div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;  <a class="code" href="group__clump.html#gab83fbf0e06856cbcce3c4279598bd15f">clump::singleClusterLinkedList</a>(iceCloud, nList, &amp;linkedList);</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;  <span class="comment">// --------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;  <span class="comment">// Loop through the entire looped list</span></div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;  <span class="comment">// init</span></div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;  visited.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/resize.html">resize</a>(iceCloud-&gt;nop);</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160; </div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;  <span class="comment">// The starting value is the first atom</span></div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;  <span class="keywordtype">int</span> iatom = 0;     <span class="comment">// Atom index of the &#39;starting value&#39;</span></div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;  <span class="keywordtype">int</span> currentIndex;  <span class="comment">// Current atom</span></div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;  <span class="keywordtype">int</span> nextElement;   <span class="comment">// Next linked atom</span></div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;  <span class="keywordtype">int</span> index;         <span class="comment">// Keeps track of the first element in the linked list</span></div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;  <span class="keywordtype">double</span> x_ij, y_ij, z_ij;  <span class="comment">// Relative distance between the two atoms</span></div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;  <span class="keywordtype">double</span> xPBC, yPBC, zPBC;  <span class="comment">// Actual distance</span></div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160; </div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;  <span class="comment">// Loop through the entire linked list</span></div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; iceCloud-&gt;nop; i++) {</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    <span class="keywordflow">if</span> (visited[i]) {</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    }                   <span class="comment">// Already counted</span></div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    visited[i] = <span class="keyword">true</span>;  <span class="comment">// Visited</span></div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    <span class="comment">// Should never execute</span></div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    <span class="keywordflow">if</span> (linkedList[i] == i) {</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    }  <span class="comment">// only one element</span></div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    currentIndex = i;</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    nextElement = linkedList[currentIndex];</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    index = i;</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    <span class="comment">// Keep looping</span></div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    <span class="keywordflow">while</span> (nextElement != index) {</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;      currentIndex = nextElement;</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;      visited[currentIndex] = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;      nextElement = linkedList[currentIndex];</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;      <span class="comment">// -----------------------------------</span></div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;      <span class="comment">// Get the relative distance between the central atom (iatom)</span></div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;      <span class="comment">// and the next element</span></div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;      <span class="comment">// Coordinates</span></div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;      <span class="comment">// if (nextElement != index) {</span></div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;      x_ij = iceCloud-&gt;pts[currentIndex].x - iceCloud-&gt;pts[nextElement].x;</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;      y_ij = iceCloud-&gt;pts[currentIndex].y - iceCloud-&gt;pts[nextElement].y;</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;      z_ij = iceCloud-&gt;pts[currentIndex].z - iceCloud-&gt;pts[nextElement].z;</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;      <span class="comment">// Shift the nextElement if it&#39;s on the other side of the box</span></div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;      <span class="comment">// Shift x</span></div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;      <span class="keywordflow">if</span> (fabs(x_ij) &gt; 0.5 * box[0]) {</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;        <span class="comment">// Get the actual distance</span></div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;        xPBC = box[0] - fabs(x_ij);</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;        <span class="keywordflow">if</span> (x_ij &lt; 0) {</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;          iceCloud-&gt;pts[nextElement].x = iceCloud-&gt;pts[currentIndex].x - xPBC;</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;        }  <span class="comment">// To the -x side of currentIndex</span></div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;          iceCloud-&gt;pts[nextElement].x = iceCloud-&gt;pts[currentIndex].x + xPBC;</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;        }  <span class="comment">// Add to the + side</span></div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;      }    <span class="comment">// Shift nextElement</span></div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;      <span class="comment">//</span></div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;      <span class="comment">// Shift y</span></div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;      <span class="keywordflow">if</span> (fabs(y_ij) &gt; 0.5 * box[1]) {</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;        <span class="comment">// Get the actual distance</span></div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;        yPBC = box[1] - fabs(y_ij);</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;        <span class="keywordflow">if</span> (y_ij &lt; 0) {</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;          iceCloud-&gt;pts[nextElement].y = iceCloud-&gt;pts[currentIndex].y - yPBC;</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;        }  <span class="comment">// To the -y side of currentIndex</span></div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;          iceCloud-&gt;pts[nextElement].y = iceCloud-&gt;pts[currentIndex].y + yPBC;</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;        }  <span class="comment">// Add to the + side</span></div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;      }    <span class="comment">// Shift nextElement</span></div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;      <span class="comment">//</span></div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;      <span class="comment">// Shift z</span></div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;      <span class="keywordflow">if</span> (fabs(z_ij) &gt; 0.5 * box[2]) {</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;        <span class="comment">// Get the actual distance</span></div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;        zPBC = box[2] - fabs(z_ij);</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;        <span class="keywordflow">if</span> (z_ij &lt; 0) {</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;          iceCloud-&gt;pts[nextElement].z = iceCloud-&gt;pts[currentIndex].z - zPBC;</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;        }  <span class="comment">// To the -z side of currentIndex</span></div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;          iceCloud-&gt;pts[nextElement].z = iceCloud-&gt;pts[currentIndex].z + zPBC;</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;        }  <span class="comment">// Add to the + side</span></div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;      }    <span class="comment">// Shift nextElement</span></div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;           <span class="comment">// -----------------------------------</span></div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;      <span class="comment">// }  // don&#39;t shift the last atom!</span></div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160; </div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    }  <span class="comment">// End of going through linked atoms</span></div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;  }  <span class="comment">// end of loop through atoms</span></div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;  <span class="comment">// --------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;  <span class="comment">// Center of the simulation box</span></div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;  xBoxCenter = 0.5 * (boxLow[0] + boxHigh[0]);</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;  yBoxCenter = 0.5 * (boxLow[1] + boxHigh[1]);</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;  zBoxCenter = 0.5 * (boxLow[2] + boxHigh[2]);</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;  <span class="comment">// --------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;  <span class="comment">// Get the centroid of the ice cluster.</span></div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;  x_centroid = 0.0;</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;  y_centroid = 0.0;</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;  z_centroid = 0.0;</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160; </div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; iceCloud-&gt;nop; i++) {</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;    x_centroid += iceCloud-&gt;pts[i].x;</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;    y_centroid += iceCloud-&gt;pts[i].y;</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;    z_centroid += iceCloud-&gt;pts[i].z;</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;  }  <span class="comment">// end of loop through the particles</span></div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160; </div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;  <span class="keywordflow">if</span> (iceCloud-&gt;nop == 0) {</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;    <a class="codeRef" href="http://en.cppreference.com/w/cpp/io/basic_ostream.html">std::cerr</a> &lt;&lt; <span class="stringliteral">&quot;There are no particles in the cluster.\n&quot;</span>;</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;  }  <span class="comment">// error</span></div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160; </div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;  <span class="comment">// Normalize by the number of particles.</span></div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;  x_centroid /= iceCloud-&gt;nop;</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;  y_centroid /= iceCloud-&gt;nop;</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;  z_centroid /= iceCloud-&gt;nop;</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160; </div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;  <span class="comment">// --------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;  <span class="comment">// Get the distance to shift by:</span></div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;  <span class="keywordtype">double</span> xShift = x_centroid - xBoxCenter;</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;  <span class="keywordtype">double</span> yShift = y_centroid - yBoxCenter;</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;  <span class="keywordtype">double</span> zShift = z_centroid - zBoxCenter;</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160; </div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;  <span class="comment">// Loop through all atoms and shift them</span></div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; iceCloud-&gt;nop; i++) {</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;    iceCloud-&gt;pts[i].x -= xShift;</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;    iceCloud-&gt;pts[i].y -= yShift;</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;    iceCloud-&gt;pts[i].z -= zShift;</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;  }  <span class="comment">// end of loop through the particles</span></div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160; </div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;  <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;}  <span class="comment">// end of function</span></div>
<div class="ttc" id="abasic_ostream_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/io/basic_ostream.html">std::cerr</a></div></div>
<div class="ttc" id="abasic_string_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/string/basic_string.html">std::string</a></div></div>
<div class="ttc" id="acluster_8hpp_html"><div class="ttname"><a href="cluster_8hpp.html">cluster.hpp</a></div><div class="ttdoc">File for the bond order parameter analysis.</div></div>
<div class="ttc" id="afind_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/algorithm/find.html">std::find</a></div><div class="ttdeci">T find(T... args)</div></div>
<div class="ttc" id="agroup__chill_html_ga06aa04366cf8d05811e0c0a881464c24"><div class="ttname"><a href="group__chill.html#ga06aa04366cf8d05811e0c0a881464c24">chill::getq6</a></div><div class="ttdeci">std::vector&lt; double &gt; getq6(molSys::PointCloud&lt; molSys::Point&lt; double &gt;, double &gt; *yCloud, std::vector&lt; std::vector&lt; int &gt;&gt; nList, bool isSlice=false)</div><div class="ttdef"><b>Definition:</b> <a href="bop_8cpp_source.html#l00899">bop.cpp:899</a></div></div>
<div class="ttc" id="agroup__chill_html_ga4ec7f9663b66377a4156b72039b58f40"><div class="ttname"><a href="group__chill.html#ga4ec7f9663b66377a4156b72039b58f40">chill::getCorrel</a></div><div class="ttdeci">molSys::PointCloud&lt; molSys::Point&lt; double &gt;, double &gt; getCorrel(molSys::PointCloud&lt; molSys::Point&lt; double &gt;, double &gt; *yCloud, std::vector&lt; std::vector&lt; int &gt;&gt; nList, bool isSlice=false)</div><div class="ttdef"><b>Definition:</b> <a href="bop_8cpp_source.html#l00325">bop.cpp:325</a></div></div>
<div class="ttc" id="agroup__chill_html_gad8c1ae4aaa660900988e494f682b2b09"><div class="ttname"><a href="group__chill.html#gad8c1ae4aaa660900988e494f682b2b09">chill::getIceTypeNoPrint</a></div><div class="ttdeci">molSys::PointCloud&lt; molSys::Point&lt; double &gt;, double &gt; getIceTypeNoPrint(molSys::PointCloud&lt; molSys::Point&lt; double &gt;, double &gt; *yCloud, std::vector&lt; std::vector&lt; int &gt;&gt; nList, bool isSlice=false)</div><div class="ttdef"><b>Definition:</b> <a href="bop_8cpp_source.html#l00464">bop.cpp:464</a></div></div>
<div class="ttc" id="agroup__clump_html_ga05192f1f3166d0a19744345f641da360"><div class="ttname"><a href="group__clump.html#ga05192f1f3166d0a19744345f641da360">clump::recenterClusterCloud</a></div><div class="ttdeci">int recenterClusterCloud(molSys::PointCloud&lt; molSys::Point&lt; double &gt;, double &gt; *iceCloud, std::vector&lt; std::vector&lt; int &gt;&gt; nList)</div><div class="ttdef"><b>Definition:</b> <a href="cluster_8cpp_source.html#l00384">cluster.cpp:384</a></div></div>
<div class="ttc" id="agroup__clump_html_gab83fbf0e06856cbcce3c4279598bd15f"><div class="ttname"><a href="group__clump.html#gab83fbf0e06856cbcce3c4279598bd15f">clump::singleClusterLinkedList</a></div><div class="ttdeci">int singleClusterLinkedList(molSys::PointCloud&lt; molSys::Point&lt; double &gt;, double &gt; *iceCloud, std::vector&lt; std::vector&lt; int &gt;&gt; nList, std::vector&lt; int &gt; *linkedList)</div><div class="ttdef"><b>Definition:</b> <a href="cluster_8cpp_source.html#l00223">cluster.cpp:223</a></div></div>
<div class="ttc" id="agroup__clump_html_gad4824638fa14ec355ab99804c9119e35"><div class="ttname"><a href="group__clump.html#gad4824638fa14ec355ab99804c9119e35">clump::largestIceCluster</a></div><div class="ttdeci">int largestIceCluster(std::string path, molSys::PointCloud&lt; molSys::Point&lt; double &gt;, double &gt; *yCloud, molSys::PointCloud&lt; molSys::Point&lt; double &gt;, double &gt; *iceCloud, std::vector&lt; std::vector&lt; int &gt;&gt; nList, std::vector&lt; bool &gt; *isIce, std::vector&lt; int &gt; *clusterID, std::vector&lt; int &gt; *nClusters, std::unordered_map&lt; int, int &gt; *indexNumber, int firstFrame)</div><div class="ttdef"><b>Definition:</b> <a href="cluster_8cpp_source.html#l00026">cluster.cpp:26</a></div></div>
<div class="ttc" id="agroup__clump_html_gae3705e982771b2719016d3c6f237515f"><div class="ttname"><a href="group__clump.html#gae3705e982771b2719016d3c6f237515f">clump::clusterAnalysis</a></div><div class="ttdeci">int clusterAnalysis(std::string path, molSys::PointCloud&lt; molSys::Point&lt; double &gt;, double &gt; *iceCloud, molSys::PointCloud&lt; molSys::Point&lt; double &gt;, double &gt; *yCloud, std::vector&lt; std::vector&lt; int &gt;&gt; nList, std::vector&lt; std::vector&lt; int &gt;&gt; &amp;iceNeighbourList, double cutoff, int firstFrame, std::string bopAnalysis=&quot;q6&quot;)</div><div class="ttdef"><b>Definition:</b> <a href="cluster_8cpp_source.html#l00298">cluster.cpp:298</a></div></div>
<div class="ttc" id="agroup__gen_html_ga11feba0acc8858c6a8a4b637b994c60a"><div class="ttname"><a href="group__gen.html#ga11feba0acc8858c6a8a4b637b994c60a">gen::distance</a></div><div class="ttdeci">double distance(molSys::PointCloud&lt; molSys::Point&lt; double &gt;, double &gt; *yCloud, int iatom, int jatom)</div><div class="ttdef"><b>Definition:</b> <a href="generic_8hpp_source.html#l00158">generic.hpp:158</a></div></div>
<div class="ttc" id="agroup__molSys_html_gad8acfb41ee6bc0258612e9cac24269b2"><div class="ttname"><a href="group__molSys.html#gad8acfb41ee6bc0258612e9cac24269b2">molSys::clearPointCloud</a></div><div class="ttdeci">molSys::PointCloud&lt; molSys::Point&lt; double &gt;, double &gt; clearPointCloud(molSys::PointCloud&lt; molSys::Point&lt; double &gt;, double &gt; *yCloud)</div><div class="ttdef"><b>Definition:</b> <a href="mol__sys_8cpp_source.html#l00010">mol_sys.cpp:10</a></div></div>
<div class="ttc" id="agroup__molSys_html_gga13ffe3a39a0816627553f195e102abb5aa701d941ff4dc44b45faa7fd0e1f163f"><div class="ttname"><a href="group__molSys.html#gga13ffe3a39a0816627553f195e102abb5aa701d941ff4dc44b45faa7fd0e1f163f">molSys::water</a></div><div class="ttdeci">@ water</div><div class="ttdef"><b>Definition:</b> <a href="mol__sys_8hpp_source.html#l00097">mol_sys.hpp:97</a></div></div>
<div class="ttc" id="agroup__molSys_html_gga13ffe3a39a0816627553f195e102abb5ad19ecf271dba48ef8dd8175326f669b4"><div class="ttname"><a href="group__molSys.html#gga13ffe3a39a0816627553f195e102abb5ad19ecf271dba48ef8dd8175326f669b4">molSys::unclassified</a></div><div class="ttdeci">@ unclassified</div><div class="ttdef"><b>Definition:</b> <a href="mol__sys_8hpp_source.html#l00101">mol_sys.hpp:101</a></div></div>
<div class="ttc" id="agroup__nneigh_html_gad15a56db7bd85332af86936e51cce9fa"><div class="ttname"><a href="group__nneigh.html#gad15a56db7bd85332af86936e51cce9fa">nneigh::clearNeighbourList</a></div><div class="ttdeci">int clearNeighbourList(std::vector&lt; std::vector&lt; int &gt;&gt; &amp;nList)</div><div class="ttdef"><b>Definition:</b> <a href="neighbours_8cpp_source.html#l00375">neighbours.cpp:375</a></div></div>
<div class="ttc" id="agroup__nneigh_html_gaf1f3bc572fb2feaca38f59362af681c6"><div class="ttname"><a href="group__nneigh.html#gaf1f3bc572fb2feaca38f59362af681c6">nneigh::getNewNeighbourListByIndex</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; int &gt; &gt; getNewNeighbourListByIndex(molSys::PointCloud&lt; molSys::Point&lt; double &gt;, double &gt; *yCloud, double cutoff)</div><div class="ttdef"><b>Definition:</b> <a href="neighbours_8cpp_source.html#l00277">neighbours.cpp:277</a></div></div>
<div class="ttc" id="amax_element_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/algorithm/max_element.html">std::max_element</a></div><div class="ttdeci">T max_element(T... args)</div></div>
<div class="ttc" id="amin_element_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/algorithm/min_element.html">std::min_element</a></div><div class="ttdeci">T min_element(T... args)</div></div>
<div class="ttc" id="anamespacesout_html_aee17b8438205b4b88aad8a481c533ba5"><div class="ttname"><a href="namespacesout.html#aee17b8438205b4b88aad8a481c533ba5">sout::writeClusterStats</a></div><div class="ttdeci">int writeClusterStats(std::string path, int currentFrame, int largestCluster, int numOfClusters, int smallestCluster, double avgClusterSize, int firstFrame)</div><div class="ttdef"><b>Definition:</b> <a href="seams__output_8cpp_source.html#l00833">seams_output.cpp:833</a></div></div>
<div class="ttc" id="apush_back_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/container/vector/push_back.html">std::vector::push_back</a></div><div class="ttdeci">T push_back(T... args)</div></div>
<div class="ttc" id="aresize_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/container/vector/resize.html">std::vector::resize</a></div><div class="ttdeci">T resize(T... args)</div></div>
<div class="ttc" id="asize_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/container/vector/size.html">std::vector::size</a></div><div class="ttdeci">T size(T... args)</div></div>
<div class="ttc" id="astructmolSys_1_1PointCloud_html"><div class="ttname"><a href="structmolSys_1_1PointCloud.html">molSys::PointCloud</a></div><div class="ttdoc">This contains a collection of points; contains information for a particular frame.</div><div class="ttdef"><b>Definition:</b> <a href="mol__sys_8hpp_source.html#l00155">mol_sys.hpp:155</a></div></div>
<div class="ttc" id="astructmolSys_1_1Point_html"><div class="ttname"><a href="structmolSys_1_1Point.html">molSys::Point</a></div><div class="ttdoc">This contains per-particle information.</div><div class="ttdef"><b>Definition:</b> <a href="mol__sys_8hpp_source.html#l00133">mol_sys.hpp:133</a></div></div>
<div class="ttc" id="aunordered_map_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/container/unordered_map.html">std::unordered_map&lt; int, int &gt;</a></div></div>
<div class="ttc" id="avector_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- Copyright 2020 Rohit Goswami <rog32@hi.is>
     Licensed under the Apache License, Version 2.0 (the "License");
     you may not use this file except in compliance with the License.
     You may obtain a copy of the License at
     http://www.apache.org/licenses/LICENSE-2.0
     Unless required by applicable law or agreed to in writing, software
     distributed under the License is distributed on an "AS IS" BASIS,
     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     See the License for the specific language governing permissions and
     limitations under the License. -->
<!-- HTML footer for doxygen 1.9.1-->
<!-- start footer part -->
<div class="footer">
<hr class="footline"/><address class="footline"><small>
    Generated by&#160;<a href="https://www.doxygen.org/index.html">Doxygen 1.9.1</a> and the <a class="outlink" href="https://github.com/HaoZeke/doxyYoda">doxyYoda theme</a>
</small></address>
</div>
</div>
</body>
</html>
