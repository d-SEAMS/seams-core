<!-- Copyright 2020 Rohit Goswami <rog32@hi.is>
     Licensed under the Apache License, Version 2.0 (the "License");
     you may not use this file except in compliance with the License.
     You may obtain a copy of the License at
     http://www.apache.org/licenses/LICENSE-2.0
     Unless required by applicable law or agreed to in writing, software
     distributed under the License is distributed on an "AS IS" BASIS,
     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     See the License for the specific language governing permissions and
     limitations under the License. -->
<!-- HTML header for doxygen 1.9.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>d-SEAMS: src/neighbours.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script>
MathJax = {
  tex: {
    inlineMath: [['$', '$'], ['\\(', '\\)']]
  },
  svg: {
    fontCache: 'global'
  }
  loader: { load: ["[tex]/unicode", "[tex]/ams"] },
  tex: {
    packages: { "[+]": ["unicode", "ams"] },
    tags: "ams",
  },
};
</script>
<script type="text/javascript" id="MathJax-script" async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js">
</script>
<!-- <link href="doxygen.css" rel="stylesheet" type="text/css" /> -->
<link href="doxyYoda.min.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" >
$(document).ready(function() {
     $(".fragment").wrap("<details class='code-details'></details>");
     $(".code-details").append("<summary>Code</summary>");
 }
)
</script>
</head>
<body>
<div class="grid-contents">
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<nav class="title_area">
<a class="project_logo" href="#">
<img src="dSeamsLogo.png" width="30" height="30" alt="Logo">
</a>
<span class="project_info">d-SEAMS v1.0.0</span>
</nav>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.20 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">neighbours.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="neighbours_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="preprocessor">#include &lt;math.h&gt;</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="neighbours_8hpp.html">neighbours.hpp</a>&gt;</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160; </div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160; </div>
<div class="line"><a name="l00015"></a><span class="lineno"><a class="line" href="group__nneigh.html#ga17027fd5c55cdca40c0d07137ecddfc2">   15</a></span>&#160;<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;std::vector&lt;int&gt;</a>&gt; <a class="code" href="group__nneigh.html#ga17027fd5c55cdca40c0d07137ecddfc2">nneigh::neighList</a>(</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;    <span class="keywordtype">double</span> rcutoff, <a class="code" href="structmolSys_1_1PointCloud.html">molSys::PointCloud</a>&lt;<a class="code" href="structmolSys_1_1Point.html">molSys::Point&lt;double&gt;</a>, <span class="keywordtype">double</span>&gt; *yCloud,</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;    <span class="keywordtype">int</span> typeI, <span class="keywordtype">int</span> typeJ) {</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;std::vector&lt;int&gt;</a>&gt; nList;  <span class="comment">// Vector of vector of ints</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;  <span class="keywordtype">int</span> jatomIndex;                       <span class="comment">// Atom ID corresponding to jatom</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;  <span class="keywordtype">int</span> iatomIndex;                       <span class="comment">// Atom ID corresponding to iatom</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;  <span class="keywordtype">double</span> r_ij;                          <span class="comment">// cutoff</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160; </div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;  <span class="comment">// Initialize with nop (irrespective of type)</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;  <span class="comment">// Initialize and fill the first element with the current atom ID whose</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;  <span class="comment">// neighbour list will be filled</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iatom = 0; iatom &lt; yCloud-&gt;nop; iatom++) {</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    <span class="comment">// Find the atom ID (key) given the index or iatom (value)</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    <span class="keyword">auto</span> itr = <a class="codeRef" href="http://en.cppreference.com/w/cpp/algorithm/find.html">std::find_if</a>(</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;        yCloud-&gt;idIndexMap.begin(), yCloud-&gt;idIndexMap.end(),</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;        [&amp;iatom](<span class="keyword">const</span> <a class="codeRef" href="http://en.cppreference.com/w/cpp/utility/pair.html">std::pair&lt;int, int&gt;</a> &amp;p) { return p.second == iatom; });</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    <span class="comment">// If found:</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    <span class="keywordflow">if</span> (itr == yCloud-&gt;idIndexMap.end()) {</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;      <a class="codeRef" href="http://en.cppreference.com/w/cpp/io/basic_ostream.html">std::cerr</a> &lt;&lt; <span class="stringliteral">&quot;Something is wrong with your idIndexMap!\n&quot;</span>;</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;      iatomIndex = itr-&gt;first;</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    }  <span class="comment">// End of finding the atom ID to fill as the first element in the</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;       <span class="comment">// neighbour list</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    nList.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/push_back.html">push_back</a>(<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a>());  <span class="comment">// Empty vector for the index iatom</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    <span class="comment">// Fill the first element with the atom ID of iatom itself</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    nList[iatom].<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/push_back.html">push_back</a>(iatomIndex);</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;  }  <span class="comment">// end of init</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160; </div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  <span class="comment">// pairs of atoms of type I and J</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  <span class="comment">// Loop through every iatom and find nearest neighbours within rcutoff</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iatom = 0; iatom &lt; yCloud-&gt;nop; iatom++) {</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <span class="keywordflow">if</span> (yCloud-&gt;pts[iatom].type != typeI) {</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    }</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    <span class="comment">// Loop through the other atoms</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> jatom = 0; jatom &lt; yCloud-&gt;nop; jatom++) {</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;      <span class="keywordflow">if</span> (yCloud-&gt;pts[jatom].type != typeJ) {</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;      }</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;      <span class="comment">// If the distance is greater than rcutoff, continue</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;      r_ij = <a class="code" href="group__gen.html#ga881e045598dd517609383d8a3fec5913">gen::periodicDist</a>(yCloud, iatom, jatom);</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;      <span class="keywordflow">if</span> (r_ij &gt; rcutoff) {</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;      }</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160; </div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;      <span class="comment">// Get the atom IDs for iatom and jatom</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;      <span class="keyword">auto</span> gotI = <a class="codeRef" href="http://en.cppreference.com/w/cpp/algorithm/find.html">std::find_if</a>(</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;          yCloud-&gt;idIndexMap.begin(), yCloud-&gt;idIndexMap.end(),</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;          [&amp;iatom](<span class="keyword">const</span> <a class="codeRef" href="http://en.cppreference.com/w/cpp/utility/pair.html">std::pair&lt;int, int&gt;</a> &amp;p) { return p.second == iatom; });</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;      <span class="keywordflow">if</span> (gotI == yCloud-&gt;idIndexMap.end()) {</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;        <a class="codeRef" href="http://en.cppreference.com/w/cpp/io/basic_ostream.html">std::cerr</a> &lt;&lt; <span class="stringliteral">&quot;Something is wrong with your idIndexMap!\n&quot;</span>;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;        <span class="keywordflow">return</span> nList;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;        iatomIndex = gotI-&gt;first;</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;      }  <span class="comment">// End of finding the atom ID for iatom</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;      <span class="comment">// Find the atom ID of jatom</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;      <span class="keyword">auto</span> gotJ = <a class="codeRef" href="http://en.cppreference.com/w/cpp/algorithm/find.html">std::find_if</a>(</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;          yCloud-&gt;idIndexMap.begin(), yCloud-&gt;idIndexMap.end(),</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;          [&amp;jatom](<span class="keyword">const</span> <a class="codeRef" href="http://en.cppreference.com/w/cpp/utility/pair.html">std::pair&lt;int, int&gt;</a> &amp;p) { return p.second == jatom; });</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;      <span class="keywordflow">if</span> (gotJ == yCloud-&gt;idIndexMap.end()) {</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;        <a class="codeRef" href="http://en.cppreference.com/w/cpp/io/basic_ostream.html">std::cerr</a> &lt;&lt; <span class="stringliteral">&quot;Something is wrong with your idIndexMap!\n&quot;</span>;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;        <span class="keywordflow">return</span> nList;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;        jatomIndex = gotJ-&gt;first;</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;      }  <span class="comment">// End of finding the atom ID for jatom</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;      <span class="comment">// Update the neighbour indices with atom IDs for iatom and jatom both</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;      <span class="comment">// (full list)</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;      nList[iatom].<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/push_back.html">push_back</a>(jatomIndex);</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;      nList[jatom].<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/push_back.html">push_back</a>(iatomIndex);</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160; </div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    }  <span class="comment">// End of loop through jatom</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;  }    <span class="comment">// End of loop for iatom</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160; </div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  <span class="keywordflow">return</span> nList;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;}</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160; </div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160; </div>
<div class="line"><a name="l00102"></a><span class="lineno"><a class="line" href="group__nneigh.html#gaaaaf74d25014d1c08bb73b8be0a6fe74">  102</a></span>&#160;<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;std::vector&lt;int&gt;</a>&gt; <a class="code" href="group__nneigh.html#gaaaaf74d25014d1c08bb73b8be0a6fe74">nneigh::neighListO</a>(</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <span class="keywordtype">double</span> rcutoff, <a class="code" href="structmolSys_1_1PointCloud.html">molSys::PointCloud</a>&lt;<a class="code" href="structmolSys_1_1Point.html">molSys::Point&lt;double&gt;</a>, <span class="keywordtype">double</span>&gt; *yCloud,</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <span class="keywordtype">int</span> typeI) {</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;std::vector&lt;int&gt;</a>&gt;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;      nList;       <span class="comment">// Vector of vectors of the neighbour list</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  <span class="keywordtype">double</span> r_ij;     <span class="comment">// Distance between iatom and jatom</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  <span class="keywordtype">int</span> iatomIndex;  <span class="comment">// Atomic ID of the atom with index iatom</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  <span class="keywordtype">int</span> jatomIndex;  <span class="comment">// Atomic ID of the atom with index jatom</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  <span class="keywordtype">int</span> indexYay;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a> tempListIatom;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160; </div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  <span class="comment">// Initialize and fill the first element with the current atom ID whose</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  <span class="comment">// neighbour list will be filled</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iatom = 0; iatom &lt; yCloud-&gt;nop; iatom++) {</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    <span class="comment">// Find the atom ID (key) given the index or iatom (value)</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    <span class="keyword">auto</span> itr = <a class="codeRef" href="http://en.cppreference.com/w/cpp/algorithm/find.html">std::find_if</a>(</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        yCloud-&gt;idIndexMap.begin(), yCloud-&gt;idIndexMap.end(),</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;        [&amp;iatom](<span class="keyword">const</span> <a class="codeRef" href="http://en.cppreference.com/w/cpp/utility/pair.html">std::pair&lt;int, int&gt;</a> &amp;p) { return p.second == iatom; });</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    <span class="comment">// If found:</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    <span class="keywordflow">if</span> (itr == yCloud-&gt;idIndexMap.end()) {</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;      <a class="codeRef" href="http://en.cppreference.com/w/cpp/io/basic_ostream.html">std::cerr</a> &lt;&lt; <span class="stringliteral">&quot;Something is wrong with your idIndexMap!\n&quot;</span>;</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;      iatomIndex = itr-&gt;first;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    }  <span class="comment">// End of finding the atom ID to fill as the first element in the</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;       <span class="comment">// neighbour list</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    nList.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/push_back.html">push_back</a>(<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a>());  <span class="comment">// Empty vector for the index iatom</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <span class="comment">// Fill the first element with the atom ID of iatom itself</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    nList[iatom].<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/push_back.html">push_back</a>(iatomIndex);</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;  }  <span class="comment">// end of init</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160; </div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;  <span class="comment">// Loop through every iatom and find nearest neighbours within rcutoff</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iatom = 0; iatom &lt; yCloud-&gt;nop - 1; iatom++) {</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    <span class="keywordflow">if</span> (yCloud-&gt;pts[iatom].type != typeI) {</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    }</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <span class="comment">// Loop through the other atoms</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> jatom = iatom + 1; jatom &lt; yCloud-&gt;nop; jatom++) {</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;      <span class="keywordflow">if</span> (yCloud-&gt;pts[jatom].type != typeI) {</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;      }</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;      <span class="comment">// If the distance is greater than rcutoff, continue</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;      r_ij = <a class="code" href="group__gen.html#ga881e045598dd517609383d8a3fec5913">gen::periodicDist</a>(yCloud, iatom, jatom);</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;      <span class="keywordflow">if</span> (r_ij &gt; rcutoff) {</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;      }</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160; </div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;      <span class="comment">// Get the atom IDs for iatom and jatom</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;      <span class="keyword">auto</span> gotI = <a class="codeRef" href="http://en.cppreference.com/w/cpp/algorithm/find.html">std::find_if</a>(</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;          yCloud-&gt;idIndexMap.begin(), yCloud-&gt;idIndexMap.end(),</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;          [&amp;iatom](<span class="keyword">const</span> <a class="codeRef" href="http://en.cppreference.com/w/cpp/utility/pair.html">std::pair&lt;int, int&gt;</a> &amp;p) { return p.second == iatom; });</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;      <span class="keywordflow">if</span> (gotI == yCloud-&gt;idIndexMap.end()) {</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;        <a class="codeRef" href="http://en.cppreference.com/w/cpp/io/basic_ostream.html">std::cerr</a> &lt;&lt; <span class="stringliteral">&quot;Something is wrong with your idIndexMap!\n&quot;</span>;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;        <span class="keywordflow">return</span> nList;</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;        iatomIndex = gotI-&gt;first;</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;      }  <span class="comment">// End of finding the atom ID for iatom</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;      <span class="comment">// Find the atom ID of jatom</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;      <span class="keyword">auto</span> gotJ = <a class="codeRef" href="http://en.cppreference.com/w/cpp/algorithm/find.html">std::find_if</a>(</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;          yCloud-&gt;idIndexMap.begin(), yCloud-&gt;idIndexMap.end(),</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;          [&amp;jatom](<span class="keyword">const</span> <a class="codeRef" href="http://en.cppreference.com/w/cpp/utility/pair.html">std::pair&lt;int, int&gt;</a> &amp;p) { return p.second == jatom; });</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;      <span class="keywordflow">if</span> (gotJ == yCloud-&gt;idIndexMap.end()) {</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;        <a class="codeRef" href="http://en.cppreference.com/w/cpp/io/basic_ostream.html">std::cerr</a> &lt;&lt; <span class="stringliteral">&quot;Something is wrong with your idIndexMap!\n&quot;</span>;</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;        <span class="keywordflow">return</span> nList;</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;        jatomIndex = gotJ-&gt;first;</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;      }  <span class="comment">// End of finding the atom ID for jatom</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;      <span class="comment">// Update the neighbour indices with atom IDs for iatom and jatom both</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;      <span class="comment">// (full list)</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;      nList[iatom].<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/push_back.html">push_back</a>(jatomIndex);</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;      nList[jatom].<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/push_back.html">push_back</a>(iatomIndex);</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160; </div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    }  <span class="comment">// End of loop through jatom</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;  }    <span class="comment">// End of loop for iatom</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160; </div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;  <span class="keywordflow">return</span> nList;</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;}</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160; </div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160; </div>
<div class="line"><a name="l00190"></a><span class="lineno"><a class="line" href="group__nneigh.html#ga935d274a9660169aec97bf6ae29842e8">  190</a></span>&#160;<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;std::vector&lt;int&gt;</a>&gt; <a class="code" href="group__nneigh.html#ga935d274a9660169aec97bf6ae29842e8">nneigh::halfNeighList</a>(</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    <span class="keywordtype">double</span> rcutoff, <a class="code" href="structmolSys_1_1PointCloud.html">molSys::PointCloud</a>&lt;<a class="code" href="structmolSys_1_1Point.html">molSys::Point&lt;double&gt;</a>, <span class="keywordtype">double</span>&gt; *yCloud,</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <span class="keywordtype">int</span> typeI) {</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;std::vector&lt;int&gt;</a>&gt;</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;      nList;       <span class="comment">// Vector of vectors of the neighbour list</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;  <span class="keywordtype">double</span> r_ij;     <span class="comment">// Distance between iatom and jatom</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;  <span class="keywordtype">int</span> iatomIndex;  <span class="comment">// Atomic ID of the atom with index iatom</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;  <span class="keywordtype">int</span> jatomIndex;  <span class="comment">// Atomic ID of the atom with index jatom</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;  <span class="keywordtype">int</span> indexYay;</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a> tempListIatom;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160; </div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;  <span class="comment">// Initialize and fill the first element with the current atom ID whose</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;  <span class="comment">// neighbour list will be filled</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iatom = 0; iatom &lt; yCloud-&gt;nop; iatom++) {</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    <span class="comment">// Find the atom ID (key) given the index or iatom (value)</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    <span class="keyword">auto</span> itr = <a class="codeRef" href="http://en.cppreference.com/w/cpp/algorithm/find.html">std::find_if</a>(</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;        yCloud-&gt;idIndexMap.begin(), yCloud-&gt;idIndexMap.end(),</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;        [&amp;iatom](<span class="keyword">const</span> <a class="codeRef" href="http://en.cppreference.com/w/cpp/utility/pair.html">std::pair&lt;int, int&gt;</a> &amp;p) { return p.second == iatom; });</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <span class="comment">// If found:</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    <span class="keywordflow">if</span> (itr == yCloud-&gt;idIndexMap.end()) {</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;      <a class="codeRef" href="http://en.cppreference.com/w/cpp/io/basic_ostream.html">std::cerr</a> &lt;&lt; <span class="stringliteral">&quot;Something is wrong with your idIndexMap!\n&quot;</span>;</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;      iatomIndex = itr-&gt;first;</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    }  <span class="comment">// End of finding the atom ID to fill as the first element in the</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;       <span class="comment">// neighbour list</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    nList.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/push_back.html">push_back</a>(<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a>());  <span class="comment">// Empty vector for the index iatom</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    <span class="comment">// Fill the first element with the atom ID of iatom itself</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    nList[iatom].<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/push_back.html">push_back</a>(iatomIndex);</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;  }  <span class="comment">// end of init</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160; </div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;  <span class="comment">// Loop through every iatom and find nearest neighbours within rcutoff</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iatom = 0; iatom &lt; yCloud-&gt;nop - 1; iatom++) {</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    <span class="keywordflow">if</span> (yCloud-&gt;pts[iatom].type != typeI) {</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    }</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    <span class="comment">// Loop through the other atoms</span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> jatom = iatom + 1; jatom &lt; yCloud-&gt;nop; jatom++) {</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;      <span class="keywordflow">if</span> (yCloud-&gt;pts[jatom].type != typeI) {</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;      }</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;      <span class="comment">// If the distance is greater than rcutoff, continue</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;      r_ij = <a class="code" href="group__gen.html#ga881e045598dd517609383d8a3fec5913">gen::periodicDist</a>(yCloud, iatom, jatom);</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;      <span class="keywordflow">if</span> (r_ij &gt; rcutoff) {</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;      }</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160; </div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;      <span class="comment">// Get the atom IDs for iatom and jatom</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;      <span class="keyword">auto</span> gotI = <a class="codeRef" href="http://en.cppreference.com/w/cpp/algorithm/find.html">std::find_if</a>(</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;          yCloud-&gt;idIndexMap.begin(), yCloud-&gt;idIndexMap.end(),</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;          [&amp;iatom](<span class="keyword">const</span> <a class="codeRef" href="http://en.cppreference.com/w/cpp/utility/pair.html">std::pair&lt;int, int&gt;</a> &amp;p) { return p.second == iatom; });</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;      <span class="keywordflow">if</span> (gotI == yCloud-&gt;idIndexMap.end()) {</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;        <a class="codeRef" href="http://en.cppreference.com/w/cpp/io/basic_ostream.html">std::cerr</a> &lt;&lt; <span class="stringliteral">&quot;Something is wrong with your idIndexMap!\n&quot;</span>;</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;        <span class="keywordflow">return</span> nList;</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;        iatomIndex = gotI-&gt;first;</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;      }  <span class="comment">// End of finding the atom ID for iatom</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;      <span class="comment">// Find the atom ID of jatom</span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;      <span class="keyword">auto</span> gotJ = <a class="codeRef" href="http://en.cppreference.com/w/cpp/algorithm/find.html">std::find_if</a>(</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;          yCloud-&gt;idIndexMap.begin(), yCloud-&gt;idIndexMap.end(),</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;          [&amp;jatom](<span class="keyword">const</span> <a class="codeRef" href="http://en.cppreference.com/w/cpp/utility/pair.html">std::pair&lt;int, int&gt;</a> &amp;p) { return p.second == jatom; });</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;      <span class="keywordflow">if</span> (gotJ == yCloud-&gt;idIndexMap.end()) {</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;        <a class="codeRef" href="http://en.cppreference.com/w/cpp/io/basic_ostream.html">std::cerr</a> &lt;&lt; <span class="stringliteral">&quot;Something is wrong with your idIndexMap!\n&quot;</span>;</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;        <span class="keywordflow">return</span> nList;</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;        jatomIndex = gotJ-&gt;first;</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;      }  <span class="comment">// End of finding the atom ID for jatom</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;      <span class="comment">// Update the neighbour indices with atom IDs for iatom and jatom both</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;      <span class="comment">// (full list)</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;      nList[iatom].<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/push_back.html">push_back</a>(jatomIndex);</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160; </div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    }  <span class="comment">// End of loop through jatom</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;  }    <span class="comment">// End of loop for iatom</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160; </div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;  <span class="keywordflow">return</span> nList;</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;}</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160; </div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160; </div>
<div class="line"><a name="l00277"></a><span class="lineno"><a class="line" href="group__nneigh.html#gaf1f3bc572fb2feaca38f59362af681c6">  277</a></span>&#160;<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;std::vector&lt;int&gt;</a>&gt; <a class="code" href="group__nneigh.html#gaf1f3bc572fb2feaca38f59362af681c6">nneigh::getNewNeighbourListByIndex</a>(</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    <a class="code" href="structmolSys_1_1PointCloud.html">molSys::PointCloud</a>&lt;<a class="code" href="structmolSys_1_1Point.html">molSys::Point&lt;double&gt;</a>, <span class="keywordtype">double</span>&gt; *yCloud, <span class="keywordtype">double</span> cutoff) {</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;std::vector&lt;int&gt;</a>&gt; nList;</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;  <span class="keywordtype">double</span> r_ij;  <span class="comment">// Distance between iatom and jatom</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a> tempListIatom;</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160; </div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;  <span class="comment">// Initialize and fill the first element with the current atom ID whose</span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;  <span class="comment">// neighbour list will be filled</span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iatom = 0; iatom &lt; yCloud-&gt;nop; iatom++) {</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    nList.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/push_back.html">push_back</a>(<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a>());  <span class="comment">// Empty vector for the index iatom</span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    <span class="comment">// Fill the first element with the atom ID of iatom itself</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    nList[iatom].<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/push_back.html">push_back</a>(iatom);</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;  }  <span class="comment">// end of init</span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;  <span class="comment">// -------------------------------------------------------</span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;  <span class="comment">// Loop through every iatom and find nearest neighbours within rcutoff</span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iatom = 0; iatom &lt; yCloud-&gt;nop - 1; iatom++) {</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    <span class="comment">// Loop through the other atoms</span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> jatom = iatom + 1; jatom &lt; yCloud-&gt;nop; jatom++) {</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;      <span class="comment">// If the distance is greater than rcutoff, continue</span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;      r_ij = <a class="code" href="group__gen.html#ga881e045598dd517609383d8a3fec5913">gen::periodicDist</a>(yCloud, iatom, jatom);</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;      <span class="keywordflow">if</span> (r_ij &gt; cutoff) {</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;      }</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160; </div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;      <span class="comment">// Update the neighbour indices with atom IDs for iatom and jatom both</span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;      <span class="comment">// (full list)</span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;      nList[iatom].<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/push_back.html">push_back</a>(jatom);</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;      nList[jatom].<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/push_back.html">push_back</a>(iatom);</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160; </div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    }  <span class="comment">// End of loop through jatom</span></div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;  }    <span class="comment">// End of loop for iatom</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160; </div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;  <span class="keywordflow">return</span> nList;</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;}  <span class="comment">// end of function</span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160; </div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160; </div>
<div class="line"><a name="l00324"></a><span class="lineno"><a class="line" href="group__nneigh.html#gab2468daaf43c827b54a88af914d0fee8">  324</a></span>&#160;<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;std::vector&lt;int&gt;</a>&gt; <a class="code" href="group__nneigh.html#gab2468daaf43c827b54a88af914d0fee8">nneigh::neighbourListByIndex</a>(</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    <a class="code" href="structmolSys_1_1PointCloud.html">molSys::PointCloud</a>&lt;<a class="code" href="structmolSys_1_1Point.html">molSys::Point&lt;double&gt;</a>, <span class="keywordtype">double</span>&gt; *yCloud,</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt;<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a>&gt; nList) {</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;std::vector&lt;int&gt;</a>&gt;</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;      indexNlist;              <span class="comment">// Desired neighbour list of indices</span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;  <span class="keywordtype">int</span> iatomID, jatomID;        <span class="comment">// Atom IDs</span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;  <span class="keywordtype">int</span> iatomIndex, jatomIndex;  <span class="comment">// Indices of iatom and jatom</span></div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;  <span class="keywordtype">int</span> nnumNeighbours;          <span class="comment">// Number of nearest neighbours</span></div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160; </div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;  <span class="comment">// Loop through every atom whose neighbours are contained in the neighbour</span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;  <span class="comment">// list</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iatom = 0; iatom &lt; nList.size(); iatom++) {</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    iatomID = nList[iatom][0];  <span class="comment">// Atom ID</span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    <span class="comment">// Get the index of iatom</span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    <span class="keyword">auto</span> gotI = yCloud-&gt;idIndexMap.find(iatomID);</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    <span class="keywordflow">if</span> (gotI != yCloud-&gt;idIndexMap.end()) {</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;      iatomIndex = gotI-&gt;second;</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    }  <span class="comment">// found iatomIndex</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    nnumNeighbours = nList[iatomIndex].<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/size.html">size</a>() - 1;</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    <span class="comment">// Update the new neighbour list</span></div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    indexNlist.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/push_back.html">push_back</a>(</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;        <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a>());  <span class="comment">// Empty vector for the index iatom</span></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    <span class="comment">// Fill the first element with the atom ID of iatom itself</span></div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    indexNlist[iatom].<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/push_back.html">push_back</a>(iatomIndex);</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    <span class="comment">// Loop through the neighbours of iatom</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> jatom = 1; jatom &lt;= nnumNeighbours; jatom++) {</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;      jatomID = nList[iatomIndex][jatom];  <span class="comment">// Atom ID of neighbour</span></div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;      <span class="comment">//</span></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;      <span class="comment">// Get the index of the j^th atom</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;      <span class="keyword">auto</span> gotJ = yCloud-&gt;idIndexMap.find(jatomID);</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;      <span class="keywordflow">if</span> (gotJ != yCloud-&gt;idIndexMap.end()) {</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;        jatomIndex = gotJ-&gt;second;</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;      }  <span class="comment">// found jatomIndex</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;      <span class="comment">// Add to the neighbour list</span></div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;      indexNlist[iatom].<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/push_back.html">push_back</a>(jatomIndex);</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    }  <span class="comment">// end of loop through neighbours</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;  }    <span class="comment">// end of loop through every atom</span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160; </div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;  <span class="comment">// Return the new neighbour list</span></div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;  <span class="keywordflow">return</span> indexNlist;</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;}</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160; </div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160; </div>
<div class="line"><a name="l00375"></a><span class="lineno"><a class="line" href="group__nneigh.html#gad15a56db7bd85332af86936e51cce9fa">  375</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="group__nneigh.html#gad15a56db7bd85332af86936e51cce9fa">nneigh::clearNeighbourList</a>(<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt;<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a>&gt; &amp;nList) {</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;std::vector&lt;int&gt;</a>&gt; tempEmpty;</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160; </div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;  nList.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/swap.html">swap</a>(tempEmpty);</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160; </div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;  <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;}</div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="aneighbours_8hpp_html"><div class="ttname"><a href="neighbours_8hpp.html">neighbours.hpp</a></div><div class="ttdoc">Header file for neighbour list generation.</div></div>
<div class="ttc" id="agroup__gen_html_ga881e045598dd517609383d8a3fec5913"><div class="ttname"><a href="group__gen.html#ga881e045598dd517609383d8a3fec5913">gen::periodicDist</a></div><div class="ttdeci">double periodicDist(molSys::PointCloud&lt; molSys::Point&lt; double &gt;, double &gt; *yCloud, int iatom, int jatom)</div><div class="ttdef"><b>Definition:</b> <a href="generic_8hpp_source.html#l00064">generic.hpp:64</a></div></div>
<div class="ttc" id="agroup__nneigh_html_ga17027fd5c55cdca40c0d07137ecddfc2"><div class="ttname"><a href="group__nneigh.html#ga17027fd5c55cdca40c0d07137ecddfc2">nneigh::neighList</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; int &gt; &gt; neighList(double rcutoff, molSys::PointCloud&lt; molSys::Point&lt; double &gt;, double &gt; *yCloud, int typeI, int typeJ)</div><div class="ttdef"><b>Definition:</b> <a href="neighbours_8cpp_source.html#l00015">neighbours.cpp:15</a></div></div>
<div class="ttc" id="apair_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/utility/pair.html">std::pair</a></div></div>
<div class="ttc" id="avector_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a></div><div class="ttdoc">STL class.</div></div>
<div class="ttc" id="afind_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/algorithm/find.html">std::find_if</a></div><div class="ttdeci">T find_if(T... args)</div></div>
<div class="ttc" id="asize_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/container/vector/size.html">std::vector::size</a></div><div class="ttdeci">T size(T... args)</div></div>
<div class="ttc" id="agroup__nneigh_html_gad15a56db7bd85332af86936e51cce9fa"><div class="ttname"><a href="group__nneigh.html#gad15a56db7bd85332af86936e51cce9fa">nneigh::clearNeighbourList</a></div><div class="ttdeci">int clearNeighbourList(std::vector&lt; std::vector&lt; int &gt;&gt; &amp;nList)</div><div class="ttdef"><b>Definition:</b> <a href="neighbours_8cpp_source.html#l00375">neighbours.cpp:375</a></div></div>
<div class="ttc" id="agroup__nneigh_html_ga935d274a9660169aec97bf6ae29842e8"><div class="ttname"><a href="group__nneigh.html#ga935d274a9660169aec97bf6ae29842e8">nneigh::halfNeighList</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; int &gt; &gt; halfNeighList(double rcutoff, molSys::PointCloud&lt; molSys::Point&lt; double &gt;, double &gt; *yCloud, int typeI=1)</div><div class="ttdef"><b>Definition:</b> <a href="neighbours_8cpp_source.html#l00190">neighbours.cpp:190</a></div></div>
<div class="ttc" id="agroup__nneigh_html_gaf1f3bc572fb2feaca38f59362af681c6"><div class="ttname"><a href="group__nneigh.html#gaf1f3bc572fb2feaca38f59362af681c6">nneigh::getNewNeighbourListByIndex</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; int &gt; &gt; getNewNeighbourListByIndex(molSys::PointCloud&lt; molSys::Point&lt; double &gt;, double &gt; *yCloud, double cutoff)</div><div class="ttdef"><b>Definition:</b> <a href="neighbours_8cpp_source.html#l00277">neighbours.cpp:277</a></div></div>
<div class="ttc" id="apush_back_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/container/vector/push_back.html">std::vector::push_back</a></div><div class="ttdeci">T push_back(T... args)</div></div>
<div class="ttc" id="astructmolSys_1_1PointCloud_html"><div class="ttname"><a href="structmolSys_1_1PointCloud.html">molSys::PointCloud</a></div><div class="ttdoc">This contains a collection of points; contains information for a particular frame.</div><div class="ttdef"><b>Definition:</b> <a href="mol__sys_8hpp_source.html#l00155">mol_sys.hpp:155</a></div></div>
<div class="ttc" id="abasic_ostream_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/io/basic_ostream.html">std::cerr</a></div></div>
<div class="ttc" id="aswap_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/container/vector/swap.html">std::vector::swap</a></div><div class="ttdeci">T swap(T... args)</div></div>
<div class="ttc" id="astructmolSys_1_1Point_html"><div class="ttname"><a href="structmolSys_1_1Point.html">molSys::Point</a></div><div class="ttdoc">This contains per-particle information.</div><div class="ttdef"><b>Definition:</b> <a href="mol__sys_8hpp_source.html#l00133">mol_sys.hpp:133</a></div></div>
<div class="ttc" id="agroup__nneigh_html_gaaaaf74d25014d1c08bb73b8be0a6fe74"><div class="ttname"><a href="group__nneigh.html#gaaaaf74d25014d1c08bb73b8be0a6fe74">nneigh::neighListO</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; int &gt; &gt; neighListO(double rcutoff, molSys::PointCloud&lt; molSys::Point&lt; double &gt;, double &gt; *yCloud, int typeI)</div><div class="ttdef"><b>Definition:</b> <a href="neighbours_8cpp_source.html#l00102">neighbours.cpp:102</a></div></div>
<div class="ttc" id="agroup__nneigh_html_gab2468daaf43c827b54a88af914d0fee8"><div class="ttname"><a href="group__nneigh.html#gab2468daaf43c827b54a88af914d0fee8">nneigh::neighbourListByIndex</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; int &gt; &gt; neighbourListByIndex(molSys::PointCloud&lt; molSys::Point&lt; double &gt;, double &gt; *yCloud, std::vector&lt; std::vector&lt; int &gt;&gt; nList)</div><div class="ttdef"><b>Definition:</b> <a href="neighbours_8cpp_source.html#l00324">neighbours.cpp:324</a></div></div>
<!-- Copyright 2020 Rohit Goswami <rog32@hi.is>
     Licensed under the Apache License, Version 2.0 (the "License");
     you may not use this file except in compliance with the License.
     You may obtain a copy of the License at
     http://www.apache.org/licenses/LICENSE-2.0
     Unless required by applicable law or agreed to in writing, software
     distributed under the License is distributed on an "AS IS" BASIS,
     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     See the License for the specific language governing permissions and
     limitations under the License. -->
<!-- HTML footer for doxygen 1.9.1-->
<!-- start footer part -->
<div class="footer">
<hr class="footline"/><address class="footline"><small>
    Generated by&#160;<a href="https://www.doxygen.org/index.html">Doxygen 1.8.20</a> and the <a class="outlink" href="https://github.com/HaoZeke/doxyYoda">doxyYoda theme</a>
</small></address>
</div>
</div>
</body>
</html>
