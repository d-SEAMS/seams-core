<!-- Copyright 2020 Rohit Goswami <rog32@hi.is>
     Licensed under the Apache License, Version 2.0 (the "License");
     you may not use this file except in compliance with the License.
     You may obtain a copy of the License at
     http://www.apache.org/licenses/LICENSE-2.0
     Unless required by applicable law or agreed to in writing, software
     distributed under the License is distributed on an "AS IS" BASIS,
     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     See the License for the specific language governing permissions and
     limitations under the License. -->
<!-- HTML header for doxygen 1.9.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>d-SEAMS: src/selection.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script>
MathJax = {
  tex: {
    inlineMath: [['$', '$'], ['\\(', '\\)']]
  },
  svg: {
    fontCache: 'global'
  }
  loader: { load: ["[tex]/unicode", "[tex]/ams"] },
  tex: {
    packages: { "[+]": ["unicode", "ams"] },
    tags: "ams",
  },
};
</script>
<script type="text/javascript" id="MathJax-script" async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js">
</script>
<!-- <link href="doxygen.css" rel="stylesheet" type="text/css" /> -->
<link href="doxyYoda.min.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" >
$(document).ready(function() {
     $(".fragment").wrap("<details class='code-details'></details>");
     $(".code-details").append("<summary>Code</summary>");
 }
)
</script>
</head>
<body>
<div class="grid-contents">
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<nav class="title_area">
<a class="project_logo" href="#">
<img src="dSeamsLogo.png" width="30" height="30" alt="Logo">
</a>
<span class="project_info">d-SEAMS v1.0.0</span>
</nav>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">selection.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="selection_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">// d-SEAMS - Deferred Structural Elucidation Analysis for Molecular Simulations</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">// Copyright (c) 2018--present d-SEAMS core team</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">// This program is free software: you can redistribute it and/or modify</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">// it under the terms of the MIT License as published by</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">// the Open Source Initiative.</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">// A copy of the MIT License is included in the LICENSE file of this repository.</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">// You should have received a copy of the MIT License along with this program.</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">// If not, see &lt;https://opensource.org/licenses/MIT&gt;.</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160; </div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="selection_8hpp.html">selection.hpp</a>&gt;</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160; </div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &lt;icecream.hpp&gt;</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160; </div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">// -----------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">// FUNCTIONS FOR SELECTIONS</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">// -----------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160; </div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<a class="code" href="structmolSys_1_1PointCloud.html">molSys::PointCloud&lt;molSys::Point&lt;double&gt;</a>, <span class="keywordtype">double</span>&gt;</div>
<div class="line"><a name="l00037"></a><span class="lineno"><a class="line" href="group__ring.html#ga216eec245aa026b0c9f78f92aa81af34">   37</a></span>&#160;<a class="code" href="group__ring.html#ga216eec245aa026b0c9f78f92aa81af34">gen::getPointCloudOneAtomType</a>(</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    <a class="code" href="structmolSys_1_1PointCloud.html">molSys::PointCloud</a>&lt;<a class="code" href="structmolSys_1_1Point.html">molSys::Point&lt;double&gt;</a>, <span class="keywordtype">double</span>&gt; *yCloud,</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    <a class="code" href="structmolSys_1_1PointCloud.html">molSys::PointCloud</a>&lt;<a class="code" href="structmolSys_1_1Point.html">molSys::Point&lt;double&gt;</a>, <span class="keywordtype">double</span>&gt; *outCloud,</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    <span class="keywordtype">int</span> atomTypeI, <span class="keywordtype">bool</span> isSlice, <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/array.html">std::array&lt;double, 3&gt;</a> coordLow,</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/array.html">std::array&lt;double, 3&gt;</a> coordHigh) {</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  <span class="keywordtype">int</span> natoms = 0;             <span class="comment">// Number of atoms of the desired type </span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  <span class="keywordtype">bool</span> pointInSlice = <span class="keyword">true</span>; <span class="comment">// If the current point is in the slice, this is true (otherwise this is false)</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160; </div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  <span class="comment">// --------</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  <span class="comment">// Before filling up the PointCloud, if the vectors are filled</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  <span class="comment">// empty them</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;  *outCloud = <a class="code" href="group__molSys.html#gad8acfb41ee6bc0258612e9cac24269b2">molSys::clearPointCloud</a>(outCloud);</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  <span class="comment">// --------</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160; </div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  <span class="comment">// Loop through every iatom and check the type</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iatom = 0; iatom &lt; yCloud-&gt;nop; iatom++) {</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    <span class="comment">// Skip if the atom is not of the desired type </span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <span class="keywordflow">if</span> (yCloud-&gt;pts[iatom].type != atomTypeI) {</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    } <span class="comment">// end of checking for the type </span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    <span class="comment">// ----------------</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    <span class="comment">// only if a slice has been requested</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    <span class="keywordflow">if</span> (isSlice) {</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;      pointInSlice = <a class="code" href="group__sinp.html#gad5a8c377d8ed78c413c13d80ac8261ac">sinp::atomInSlice</a>(yCloud-&gt;pts[iatom].x, yCloud-&gt;pts[iatom].y, yCloud-&gt;pts[iatom].z,</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;                                               coordLow, coordHigh);</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;      <span class="comment">// Skip if the atom is not part of the slice</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;      <span class="keywordflow">if</span> (!pointInSlice) {</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;      } <span class="comment">// skipped for atoms not in the slice </span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    } <span class="comment">// end of slice handling </span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <span class="comment">// Actually add the atoms to the outCloud</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    natoms++; <span class="comment">// Update the number of atoms in outCloud</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    outCloud-&gt;pts.push_back(yCloud-&gt;pts[iatom]); <span class="comment">// Update the pts vector</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    outCloud-&gt;idIndexMap[yCloud-&gt;pts[iatom].atomID] =</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;                outCloud-&gt;pts.size() - 1; <span class="comment">// array index</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  }</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160; </div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  <span class="comment">// Update the number of particles in the PointCloud</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  outCloud-&gt;nop = outCloud-&gt;pts.size();</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160; </div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;  <span class="comment">// Box and box lengths </span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;  outCloud-&gt;box = yCloud-&gt;box;</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;  outCloud-&gt;boxLow = yCloud-&gt;boxLow;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160; </div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;  <span class="comment">// Update the frame number</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  outCloud-&gt;currentFrame = yCloud-&gt;currentFrame; </div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160; </div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;  <span class="keywordflow">return</span> *outCloud;</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;}</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160; </div>
<div class="line"><a name="l00101"></a><span class="lineno"><a class="line" href="group__ring.html#ga336353070302bc293ed5261838ee979e">  101</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="group__ring.html#ga336353070302bc293ed5261838ee979e">gen::atomsInSingleSlice</a>(</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <a class="code" href="structmolSys_1_1PointCloud.html">molSys::PointCloud</a>&lt;<a class="code" href="structmolSys_1_1Point.html">molSys::Point&lt;double&gt;</a>, <span class="keywordtype">double</span>&gt; *yCloud,</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <span class="keywordtype">bool</span> clearPreviousSliceSelection,</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/array.html">std::array&lt;double, 3&gt;</a> coordLow,</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/array.html">std::array&lt;double, 3&gt;</a> coordHigh) {</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  <span class="keywordtype">bool</span> pointInSlice = <span class="keyword">true</span>; <span class="comment">// If the current point is in the slice, this is true (otherwise this is false)</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160; </div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  <span class="comment">// --------------------</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  <span class="comment">// Set inSlice to false for every atom first</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  <span class="keywordflow">if</span> (clearPreviousSliceSelection)</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  {</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iatom = 0; iatom &lt; yCloud-&gt;nop; iatom++) {</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;      yCloud-&gt;pts[iatom].inSlice = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    }</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  } <span class="comment">// end of init</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  <span class="comment">// --------------------</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160; </div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;  <span class="comment">// Loop through every iatom and check if the atom is in the slice or not </span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iatom = 0; iatom &lt; yCloud-&gt;nop; iatom++) {</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    <span class="comment">// Check if the current atom is in the slice </span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    pointInSlice = <a class="code" href="group__sinp.html#gad5a8c377d8ed78c413c13d80ac8261ac">sinp::atomInSlice</a>(yCloud-&gt;pts[iatom].x, yCloud-&gt;pts[iatom].y, yCloud-&gt;pts[iatom].z,</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;                                               coordLow, coordHigh);</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160; </div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    yCloud-&gt;pts[iatom].inSlice = pointInSlice; <span class="comment">// iatom is inside the slice</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  }</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160; </div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;}</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160; </div>
<div class="line"><a name="l00147"></a><span class="lineno"><a class="line" href="group__ring.html#ga9decdf9fe1692fc0b03dee64653d9ddf">  147</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="group__ring.html#ga9decdf9fe1692fc0b03dee64653d9ddf">gen::moleculesInSingleSlice</a>(</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <a class="code" href="structmolSys_1_1PointCloud.html">molSys::PointCloud</a>&lt;<a class="code" href="structmolSys_1_1Point.html">molSys::Point&lt;double&gt;</a>, <span class="keywordtype">double</span>&gt; *yCloud,</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    <span class="keywordtype">bool</span> clearPreviousSliceSelection,</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/array.html">std::array&lt;double, 3&gt;</a> coordLow,</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/array.html">std::array&lt;double, 3&gt;</a> coordHigh) {</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;  <span class="keywordtype">bool</span> pointInSlice = <span class="keyword">true</span>; <span class="comment">// If the current point is in the slice, this is true (otherwise this is false)</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/unordered_multimap.html">std::unordered_multimap&lt;int, int&gt;</a></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;      molIDAtomIDmap; <span class="comment">// Unordered multimap with molecule IDs of the atoms as the keys and the</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;                  <span class="comment">// atom IDs as the values. More than one atom can have the same molecule ID</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  <span class="keywordtype">int</span> iatomMolID; <span class="comment">// molID of the current iatom</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;  <span class="keywordtype">int</span> jatomID;    <span class="comment">// atom ID of the current jatom</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;  <span class="keywordtype">int</span> jatomIndex; <span class="comment">// index of jatom</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160; </div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;  <span class="comment">// --------------------</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;  <span class="comment">// Get the unordered map of the atom IDs (keys) and the molecular IDs</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;  <span class="comment">// (values)</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;  molIDAtomIDmap = <a class="code" href="group__molSys.html#ga4b864398cbcf013fa20a59e597e6e667">molSys::createMolIDAtomIDMultiMap</a>(yCloud);</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;  <span class="comment">// --------------------</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;  <span class="comment">// Set inSlice to false for every atom first</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;  <span class="keywordflow">if</span> (clearPreviousSliceSelection)</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;  {</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iatom = 0; iatom &lt; yCloud-&gt;nop; iatom++) {</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;      yCloud-&gt;pts[iatom].inSlice = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    }</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;  } <span class="comment">// end of init</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;  <span class="comment">// --------------------</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160; </div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;  <span class="comment">// Loop through every iatom and check if the atom is in the slice or not </span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iatom = 0; iatom &lt; yCloud-&gt;nop; iatom++) {</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <span class="comment">// Check if the current atom is in the slice </span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    pointInSlice = <a class="code" href="group__sinp.html#gad5a8c377d8ed78c413c13d80ac8261ac">sinp::atomInSlice</a>(yCloud-&gt;pts[iatom].x, yCloud-&gt;pts[iatom].y, yCloud-&gt;pts[iatom].z,</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;                                               coordLow, coordHigh);</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    <span class="comment">// Set the inSlice bool for the particular Point </span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    <span class="keywordflow">if</span> (pointInSlice)</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    {</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;      yCloud-&gt;pts[iatom].inSlice = <span class="keyword">true</span>; <span class="comment">// iatom is inside the slice</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;      <span class="comment">// Find mol ID and atoms with that particular molecular ID </span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;      iatomMolID = yCloud-&gt;pts[iatom].molID; <span class="comment">// molecule ID </span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;      <span class="comment">// -----------</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;      <span class="comment">// Find all atoms with iatomMolID and set the inSlice bool</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;      <span class="comment">// to true</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;      <span class="keyword">auto</span> range = molIDAtomIDmap.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/unordered_multimap/equal_range.html">equal_range</a>(iatomMolID); </div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;      <span class="comment">// Loop through all atoms with iatomMolID</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span> it = range.first; it != range.second; it++)</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;      {</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;        <span class="comment">// it-&gt;second gives the value (in this case, the atom ID)</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;        jatomID = it-&gt;second; <span class="comment">// Atom ID with molecule ID equal to iatomMolID</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;        <span class="keyword">auto</span> gotJ = yCloud-&gt;idIndexMap.find(jatomID);</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;        jatomIndex = gotJ-&gt;second;</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;        <span class="comment">// Set the jatom inSlice bool to true</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;        yCloud-&gt;pts[jatomIndex].inSlice = <span class="keyword">true</span>; <span class="comment">// jatomIndex is inside the slice </span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;      }</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;      <span class="comment">// -----------</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    } <span class="comment">// the atom is in the slice </span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;      yCloud-&gt;pts[iatom].inSlice = <span class="keyword">false</span>; <span class="comment">// iatom is not in the slice  </span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    } <span class="comment">// atom is not in the slice</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;  }</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160; </div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;  <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;}</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160; </div>
<div class="line"><a name="l00225"></a><span class="lineno"><a class="line" href="group__ring.html#ga81dde14f79d13cb8e2c04a1e78ac11fb">  225</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="group__ring.html#ga81dde14f79d13cb8e2c04a1e78ac11fb">gen::setAtomsWithSameMolID</a>(</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    <a class="code" href="structmolSys_1_1PointCloud.html">molSys::PointCloud</a>&lt;<a class="code" href="structmolSys_1_1Point.html">molSys::Point&lt;double&gt;</a>, <span class="keywordtype">double</span>&gt; *yCloud,</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/unordered_multimap.html">std::unordered_multimap&lt;int,int&gt;</a> molIDAtomIDmap,</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    <span class="keywordtype">int</span> molID, <span class="keywordtype">bool</span> inSliceValue) {</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;  <span class="keywordtype">int</span> jatomID;    <span class="comment">// atom ID of the current jatom</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;  <span class="keywordtype">int</span> jatomIndex; <span class="comment">// index of jatom</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160; </div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;  <span class="comment">// Find all atoms with molID and set the inSlice bool to inSliceValue</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;  <span class="keyword">auto</span> range = molIDAtomIDmap.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/unordered_multimap/equal_range.html">equal_range</a>(molID); </div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160; </div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;  <span class="comment">// Loop through all atoms with molID</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> it = range.first; it != range.second; it++){</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    <span class="comment">// it-&gt;second gives the value (in this case, the atom ID)</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    jatomID = it-&gt;second; <span class="comment">// Atom ID with molecule ID equal to iatomMolID</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    <span class="keyword">auto</span> gotJ = yCloud-&gt;idIndexMap.find(jatomID);</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    jatomIndex = gotJ-&gt;second;</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    <span class="comment">// Set the jatom inSlice bool to true</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    yCloud-&gt;pts[jatomIndex].inSlice = inSliceValue; <span class="comment">// jatomIndex is assigned inSliceValue</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;  } <span class="comment">// end of loop through all atoms with molID</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160; </div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;  <span class="comment">// IC(yCloud-&gt;pts[jatomIndex]);</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160; </div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;  <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;}</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160; </div>
<div class="line"><a name="l00265"></a><span class="lineno"><a class="line" href="group__ring.html#ga9fff26ca8ab43bd8c8c5545f38a83278">  265</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="group__ring.html#ga9fff26ca8ab43bd8c8c5545f38a83278">ring::getEdgeMoleculesInRings</a>(</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt;<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a>&gt; rings, <a class="code" href="structmolSys_1_1PointCloud.html">molSys::PointCloud</a>&lt;<a class="code" href="structmolSys_1_1Point.html">molSys::Point&lt;double&gt;</a>, <span class="keywordtype">double</span>&gt; *oCloud,</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    <a class="code" href="structmolSys_1_1PointCloud.html">molSys::PointCloud</a>&lt;<a class="code" href="structmolSys_1_1Point.html">molSys::Point&lt;double&gt;</a>, <span class="keywordtype">double</span>&gt; *yCloud,</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/array.html">std::array&lt;double, 3&gt;</a> coordLow, <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/array.html">std::array&lt;double, 3&gt;</a> coordHigh, <span class="keywordtype">bool</span> identicalCloud) {</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;  <span class="comment">// A vector of bool values, such that every ring has a value of true (in the slice) or false (not in the slice) </span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;bool&gt;</a> ringInSlice(rings.size(), <span class="keyword">false</span>); <span class="comment">// all set to false initially.</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;  <span class="keywordtype">int</span> jatomIndex, jatomID; <span class="comment">// Index and ID in oCloud </span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;  <span class="keywordtype">int</span> jatomIndex1; <span class="comment">// Index in yCloud  </span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/unordered_multimap.html">std::unordered_multimap&lt;int, int&gt;</a></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;      molIDAtomIDmap; <span class="comment">// Unordered multimap with molecule IDs of the atoms as the keys and the</span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;                  <span class="comment">// atom IDs as the values. More than one atom can have the same molecule ID</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160; </div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;  <span class="comment">// --------------------</span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;  <span class="comment">// Sets all O atoms within the slice to an inSlice bool value of true. If a single atom of a molecule is in the</span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;  <span class="comment">// slice, then all atoms in the molecule will also be inside the slice </span></div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;  <a class="code" href="group__ring.html#ga9decdf9fe1692fc0b03dee64653d9ddf">gen::moleculesInSingleSlice</a>(oCloud, <span class="keyword">true</span>, coordLow, coordHigh);</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;  <span class="comment">// --------------------</span></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;  <span class="comment">// Get the unordered map of the atom IDs (keys) and the molecular IDs</span></div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;  <span class="comment">// (values)</span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;  molIDAtomIDmap = <a class="code" href="group__molSys.html#ga4b864398cbcf013fa20a59e597e6e667">molSys::createMolIDAtomIDMultiMap</a>(yCloud);</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;  <span class="comment">// --------------------</span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160; </div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;  <span class="comment">// Loop through every iatom present in the slice in oCloud</span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;  <span class="comment">// Check to see if iatom is in any ring. If it is present in a ring, set that ring to true </span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;  <span class="comment">// Change the inSlice bool of every iatom in the ring to true if false. Set also the inSlice bool</span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;  <span class="comment">// of the output cloud if it is not identical. </span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160; </div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;  <span class="comment">// Loop through every iatom present in the slice in oCloud to determine which rings are in the slice</span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;  <span class="comment">// The indices of oCloud and rings should match (or this will produce unexpected results)</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iatom = 0; iatom &lt; oCloud-&gt;nop; iatom++) {</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    <span class="comment">// Skip if iatom is not in the slice</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    <span class="keywordflow">if</span> (!oCloud-&gt;pts[iatom].inSlice)</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    {</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    } <span class="comment">// skip for iatom not in slice</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    <span class="comment">// For iatom in the slice, </span></div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    <span class="comment">// loop through all rings to find all the rings it is a part of </span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iring = 0; iring &lt; rings.size(); iring++)</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    {</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;      <span class="comment">// Skip if iring is in the slice already</span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;      <span class="keywordflow">if</span> (ringInSlice[iring])</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;      {</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;      } <span class="comment">// skip for iring in slice </span></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;      <span class="comment">// Check and see if iatom is in iring </span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;      <span class="keywordflow">if</span>(<a class="codeRef" href="http://en.cppreference.com/w/cpp/algorithm/find.html">std::find</a>(rings[iring].begin(), rings[iring].end(), iatom)!=rings[iring].end()){</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;        <span class="comment">// Found iatom; ring is part of the slice </span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;        ringInSlice[iring] = <span class="keyword">true</span>; <span class="comment">// update the vector of bool values</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;        <span class="comment">// --------------------------</span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;        <span class="comment">// Change the inSlice bool of every iatom in oCloud </span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;        <span class="comment">// (and optionally, yCloud) in the ring to true</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;        <span class="comment">// Loop through the elements of the ring </span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; rings[iring].size(); j++)</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;        {</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;          jatomIndex = rings[iring][j]; <span class="comment">// Index of the atom in oCloud </span></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;          <span class="comment">// Set this to true in oCloud </span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;          oCloud-&gt;pts[jatomIndex].inSlice = <span class="keyword">true</span>; <span class="comment">// part of slice </span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;          jatomID = oCloud-&gt;pts[jatomIndex].atomID; <span class="comment">// Atom ID </span></div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;          <span class="comment">// Now if oCloud and yCloud are not the same, use the</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;          <span class="comment">// atom ID to set the inSlice bool value in yCloud </span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;          <span class="keywordflow">if</span> (!identicalCloud)</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;          {</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;            <span class="comment">// Find the index corresponding to the same atom in yCloud </span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;            <span class="keyword">auto</span> gotJ = yCloud-&gt;idIndexMap.find(jatomID);</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;            jatomIndex1 = gotJ-&gt;second;</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;            <span class="comment">// throw if not found ?</span></div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;            <span class="comment">// Set the jatom inSlice bool to true</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;            yCloud-&gt;pts[jatomIndex1].inSlice = <span class="keyword">true</span>; <span class="comment">// jatomIndex is inside the slice </span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;            <span class="comment">// set the inSlice value of all atoms in yCloud with the current molecule ID </span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;            <a class="code" href="group__ring.html#ga81dde14f79d13cb8e2c04a1e78ac11fb">gen::setAtomsWithSameMolID</a>(yCloud, molIDAtomIDmap, </div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;              yCloud-&gt;pts[jatomIndex1].molID, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;          } <span class="comment">// end of setting values in yCloud </span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;        } <span class="comment">// end of loop through the elements of the current ring </span></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;        <span class="comment">// --------------------------</span></div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;      } <span class="comment">// found iatom in the ring</span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;      <span class="comment">//</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    } <span class="comment">// end of loop through all rings searching for iatom </span></div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;  } <span class="comment">// end of loop through atoms in oCloud in the slice </span></div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160; </div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160; </div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;  <span class="comment">// Optionally add support for molecule slice update if yCloud and oCloud are not identical?</span></div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;  <span class="comment">// Some other bool?  </span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;  <span class="comment">// IC(ringInSlice);</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160; </div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;  <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;}</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160; </div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;<span class="comment">// -----------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;<span class="comment">// FUNCTIONS FOR SELECTIONS (RINGS)</span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;<span class="comment">// -----------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160; </div>
<div class="line"><a name="l00375"></a><span class="lineno"><a class="line" href="group__ring.html#gac782697302e8da50e12bec77288a67e0">  375</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="group__ring.html#gac782697302e8da50e12bec77288a67e0">ring::printSliceGetEdgeMoleculesInRings</a>(</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    <a class="codeRef" href="http://en.cppreference.com/w/cpp/string/basic_string.html">std::string</a> path, <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt;<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a>&gt; rings, </div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    <a class="code" href="structmolSys_1_1PointCloud.html">molSys::PointCloud</a>&lt;<a class="code" href="structmolSys_1_1Point.html">molSys::Point&lt;double&gt;</a>, <span class="keywordtype">double</span>&gt; *oCloud,</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    <a class="code" href="structmolSys_1_1PointCloud.html">molSys::PointCloud</a>&lt;<a class="code" href="structmolSys_1_1Point.html">molSys::Point&lt;double&gt;</a>, <span class="keywordtype">double</span>&gt; *yCloud,</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/array.html">std::array&lt;double, 3&gt;</a> coordLow, <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/array.html">std::array&lt;double, 3&gt;</a> coordHigh, <span class="keywordtype">bool</span> identicalCloud) {</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160; </div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;  <span class="comment">//Given the full yCloud PointCloud, set the inSlice bool for every atom,</span></div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;  <span class="comment">// if the molecules are inside the specified (single) region. </span></div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;  <span class="comment">// gen::atomsInSingleSlice(yCloud, true, coordLow, coordHigh);</span></div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;  <a class="code" href="group__ring.html#ga9decdf9fe1692fc0b03dee64653d9ddf">gen::moleculesInSingleSlice</a>(yCloud, <span class="keyword">true</span>, coordLow, coordHigh);</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160; </div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;  <span class="comment">// Make sure that molecules which participate in the rings inside the slice are also </span></div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;  <span class="comment">// in the selection </span></div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;  <a class="code" href="group__ring.html#ga9fff26ca8ab43bd8c8c5545f38a83278">ring::getEdgeMoleculesInRings</a>(rings, oCloud, yCloud, coordLow, coordHigh, identicalCloud);</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160; </div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;  <span class="comment">// Print out the molecule IDs of all the atoms in the slice</span></div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;  <a class="code" href="namespacesout.html#a1cfbcd0f8d90f3033ee5e505c07e0400">sout::writeMoleculeIDsInSlice</a>(path, yCloud);</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;  <span class="comment">// Print out a command that could be used for an expression select command in OVITO</span></div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;  <a class="code" href="namespacesout.html#a96aa8c9d78c09d7cd77c4d46182e7b3b">sout::writeMoleculeIDsExpressionSelectOVITO</a>(path, yCloud);</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160; </div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;  <span class="comment">// Print out the dump of all atoms and molecules, with an inSlice value printed in a separate column</span></div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;  <span class="comment">// H atoms not included in the slice (TODO: fix)</span></div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;  <a class="code" href="namespacesout.html#a31d215aac08b1a890f73e074eae808a1">sout::writeLAMMPSdumpSlice</a>(yCloud, path); </div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;  </div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;  IC(rings[0]);</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160; </div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;  <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;}</div>
<div class="ttc" id="aarray_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/container/array.html">std::array</a></div></div>
<div class="ttc" id="abasic_string_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/string/basic_string.html">std::string</a></div></div>
<div class="ttc" id="aequal_range_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/container/unordered_multimap/equal_range.html">std::unordered_multimap::equal_range</a></div><div class="ttdeci">T equal_range(T... args)</div></div>
<div class="ttc" id="afind_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/algorithm/find.html">std::find</a></div><div class="ttdeci">T find(T... args)</div></div>
<div class="ttc" id="agroup__molSys_html_ga4b864398cbcf013fa20a59e597e6e667"><div class="ttname"><a href="group__molSys.html#ga4b864398cbcf013fa20a59e597e6e667">molSys::createMolIDAtomIDMultiMap</a></div><div class="ttdeci">std::unordered_multimap&lt; int, int &gt; createMolIDAtomIDMultiMap(molSys::PointCloud&lt; molSys::Point&lt; double &gt;, double &gt; *yCloud)</div><div class="ttdef"><b>Definition:</b> <a href="mol__sys_8cpp_source.html#l00067">mol_sys.cpp:67</a></div></div>
<div class="ttc" id="agroup__molSys_html_gad8acfb41ee6bc0258612e9cac24269b2"><div class="ttname"><a href="group__molSys.html#gad8acfb41ee6bc0258612e9cac24269b2">molSys::clearPointCloud</a></div><div class="ttdeci">molSys::PointCloud&lt; molSys::Point&lt; double &gt;, double &gt; clearPointCloud(molSys::PointCloud&lt; molSys::Point&lt; double &gt;, double &gt; *yCloud)</div><div class="ttdoc">//! Function for clearing vectors in PointCloud after multiple usage</div><div class="ttdef"><b>Definition:</b> <a href="mol__sys_8cpp_source.html#l00024">mol_sys.cpp:24</a></div></div>
<div class="ttc" id="agroup__ring_html_ga216eec245aa026b0c9f78f92aa81af34"><div class="ttname"><a href="group__ring.html#ga216eec245aa026b0c9f78f92aa81af34">gen::getPointCloudOneAtomType</a></div><div class="ttdeci">molSys::PointCloud&lt; molSys::Point&lt; double &gt;, double &gt; getPointCloudOneAtomType(molSys::PointCloud&lt; molSys::Point&lt; double &gt;, double &gt; *yCloud, molSys::PointCloud&lt; molSys::Point&lt; double &gt;, double &gt; *outCloud, int atomTypeI, bool isSlice=false, std::array&lt; double, 3 &gt; coordLow=std::array&lt; double, 3 &gt;{0, 0, 0}, std::array&lt; double, 3 &gt; coordHigh=std::array&lt; double, 3 &gt;{0, 0, 0})</div><div class="ttdef"><b>Definition:</b> <a href="selection_8cpp_source.html#l00037">selection.cpp:37</a></div></div>
<div class="ttc" id="agroup__ring_html_ga336353070302bc293ed5261838ee979e"><div class="ttname"><a href="group__ring.html#ga336353070302bc293ed5261838ee979e">gen::atomsInSingleSlice</a></div><div class="ttdeci">void atomsInSingleSlice(molSys::PointCloud&lt; molSys::Point&lt; double &gt;, double &gt; *yCloud, bool clearPreviousSliceSelection=true, std::array&lt; double, 3 &gt; coordLow=std::array&lt; double, 3 &gt;{0, 0, 0}, std::array&lt; double, 3 &gt; coordHigh=std::array&lt; double, 3 &gt;{0, 0, 0})</div><div class="ttdef"><b>Definition:</b> <a href="selection_8cpp_source.html#l00101">selection.cpp:101</a></div></div>
<div class="ttc" id="agroup__ring_html_ga81dde14f79d13cb8e2c04a1e78ac11fb"><div class="ttname"><a href="group__ring.html#ga81dde14f79d13cb8e2c04a1e78ac11fb">gen::setAtomsWithSameMolID</a></div><div class="ttdeci">void setAtomsWithSameMolID(molSys::PointCloud&lt; molSys::Point&lt; double &gt;, double &gt; *yCloud, std::unordered_multimap&lt; int, int &gt; molIDAtomIDmap, int molID, bool inSliceValue=true)</div><div class="ttdef"><b>Definition:</b> <a href="selection_8cpp_source.html#l00225">selection.cpp:225</a></div></div>
<div class="ttc" id="agroup__ring_html_ga9decdf9fe1692fc0b03dee64653d9ddf"><div class="ttname"><a href="group__ring.html#ga9decdf9fe1692fc0b03dee64653d9ddf">gen::moleculesInSingleSlice</a></div><div class="ttdeci">void moleculesInSingleSlice(molSys::PointCloud&lt; molSys::Point&lt; double &gt;, double &gt; *yCloud, bool clearPreviousSliceSelection=true, std::array&lt; double, 3 &gt; coordLow=std::array&lt; double, 3 &gt;{0, 0, 0}, std::array&lt; double, 3 &gt; coordHigh=std::array&lt; double, 3 &gt;{0, 0, 0})</div><div class="ttdef"><b>Definition:</b> <a href="selection_8cpp_source.html#l00147">selection.cpp:147</a></div></div>
<div class="ttc" id="agroup__ring_html_ga9fff26ca8ab43bd8c8c5545f38a83278"><div class="ttname"><a href="group__ring.html#ga9fff26ca8ab43bd8c8c5545f38a83278">ring::getEdgeMoleculesInRings</a></div><div class="ttdeci">void getEdgeMoleculesInRings(std::vector&lt; std::vector&lt; int &gt;&gt; rings, molSys::PointCloud&lt; molSys::Point&lt; double &gt;, double &gt; *oCloud, molSys::PointCloud&lt; molSys::Point&lt; double &gt;, double &gt; *yCloud, std::array&lt; double, 3 &gt; coordLow, std::array&lt; double, 3 &gt; coordHigh, bool identicalCloud=false)</div><div class="ttdef"><b>Definition:</b> <a href="selection_8cpp_source.html#l00265">selection.cpp:265</a></div></div>
<div class="ttc" id="agroup__ring_html_gac782697302e8da50e12bec77288a67e0"><div class="ttname"><a href="group__ring.html#gac782697302e8da50e12bec77288a67e0">ring::printSliceGetEdgeMoleculesInRings</a></div><div class="ttdeci">void printSliceGetEdgeMoleculesInRings(std::string path, std::vector&lt; std::vector&lt; int &gt;&gt; rings, molSys::PointCloud&lt; molSys::Point&lt; double &gt;, double &gt; *oCloud, molSys::PointCloud&lt; molSys::Point&lt; double &gt;, double &gt; *yCloud, std::array&lt; double, 3 &gt; coordLow, std::array&lt; double, 3 &gt; coordHigh, bool identicalCloud=false)</div><div class="ttdef"><b>Definition:</b> <a href="selection_8cpp_source.html#l00375">selection.cpp:375</a></div></div>
<div class="ttc" id="agroup__sinp_html_gad5a8c377d8ed78c413c13d80ac8261ac"><div class="ttname"><a href="group__sinp.html#gad5a8c377d8ed78c413c13d80ac8261ac">sinp::atomInSlice</a></div><div class="ttdeci">bool atomInSlice(double x, double y, double z, std::array&lt; double, 3 &gt; coordLow, std::array&lt; double, 3 &gt; coordHigh)</div><div class="ttdef"><b>Definition:</b> <a href="seams__input_8hpp_source.html#l00089">seams_input.hpp:89</a></div></div>
<div class="ttc" id="anamespacesout_html_a1cfbcd0f8d90f3033ee5e505c07e0400"><div class="ttname"><a href="namespacesout.html#a1cfbcd0f8d90f3033ee5e505c07e0400">sout::writeMoleculeIDsInSlice</a></div><div class="ttdeci">int writeMoleculeIDsInSlice(std::string path, molSys::PointCloud&lt; molSys::Point&lt; double &gt;, double &gt; *yCloud)</div><div class="ttdef"><b>Definition:</b> <a href="seams__output_8cpp_source.html#l00877">seams_output.cpp:877</a></div></div>
<div class="ttc" id="anamespacesout_html_a31d215aac08b1a890f73e074eae808a1"><div class="ttname"><a href="namespacesout.html#a31d215aac08b1a890f73e074eae808a1">sout::writeLAMMPSdumpSlice</a></div><div class="ttdeci">int writeLAMMPSdumpSlice(molSys::PointCloud&lt; molSys::Point&lt; double &gt;, double &gt; *yCloud, std::string path)</div><div class="ttdef"><b>Definition:</b> <a href="seams__output_8cpp_source.html#l01452">seams_output.cpp:1452</a></div></div>
<div class="ttc" id="anamespacesout_html_a96aa8c9d78c09d7cd77c4d46182e7b3b"><div class="ttname"><a href="namespacesout.html#a96aa8c9d78c09d7cd77c4d46182e7b3b">sout::writeMoleculeIDsExpressionSelectOVITO</a></div><div class="ttdeci">int writeMoleculeIDsExpressionSelectOVITO(std::string path, molSys::PointCloud&lt; molSys::Point&lt; double &gt;, double &gt; *yCloud)</div><div class="ttdef"><b>Definition:</b> <a href="seams__output_8cpp_source.html#l00964">seams_output.cpp:964</a></div></div>
<div class="ttc" id="aselection_8hpp_html"><div class="ttname"><a href="selection_8hpp.html">selection.hpp</a></div><div class="ttdoc">File containing functions used to define 'selections' in a given range, using ring information.</div></div>
<div class="ttc" id="astructmolSys_1_1PointCloud_html"><div class="ttname"><a href="structmolSys_1_1PointCloud.html">molSys::PointCloud</a></div><div class="ttdoc">This contains a collection of points; contains information for a particular frame.</div><div class="ttdef"><b>Definition:</b> <a href="mol__sys_8hpp_source.html#l00170">mol_sys.hpp:170</a></div></div>
<div class="ttc" id="astructmolSys_1_1Point_html"><div class="ttname"><a href="structmolSys_1_1Point.html">molSys::Point</a></div><div class="ttdoc">This contains per-particle information.</div><div class="ttdef"><b>Definition:</b> <a href="mol__sys_8hpp_source.html#l00149">mol_sys.hpp:149</a></div></div>
<div class="ttc" id="aunordered_multimap_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/container/unordered_multimap.html">std::unordered_multimap</a></div></div>
<div class="ttc" id="avector_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- Copyright 2020 Rohit Goswami <rog32@hi.is>
     Licensed under the Apache License, Version 2.0 (the "License");
     you may not use this file except in compliance with the License.
     You may obtain a copy of the License at
     http://www.apache.org/licenses/LICENSE-2.0
     Unless required by applicable law or agreed to in writing, software
     distributed under the License is distributed on an "AS IS" BASIS,
     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     See the License for the specific language governing permissions and
     limitations under the License. -->
<!-- HTML footer for doxygen 1.9.1-->
<!-- start footer part -->
<div class="footer">
<hr class="footline"/><address class="footline"><small>
    Generated by&#160;<a href="https://www.doxygen.org/index.html">Doxygen 1.9.1</a> and the <a class="outlink" href="https://github.com/HaoZeke/doxyYoda">doxyYoda theme</a>
</small></address>
</div>
</div>
</body>
</html>
