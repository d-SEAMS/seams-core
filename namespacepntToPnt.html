<!-- Copyright 2020 Rohit Goswami <rog32@hi.is>
     Licensed under the Apache License, Version 2.0 (the "License");
     you may not use this file except in compliance with the License.
     You may obtain a copy of the License at
     http://www.apache.org/licenses/LICENSE-2.0
     Unless required by applicable law or agreed to in writing, software
     distributed under the License is distributed on an "AS IS" BASIS,
     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     See the License for the specific language governing permissions and
     limitations under the License. -->
<!-- HTML header for doxygen 1.9.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>d-SEAMS: pntToPnt Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script>
MathJax = {
  tex: {
    inlineMath: [['$', '$'], ['\\(', '\\)']]
  },
  svg: {
    fontCache: 'global'
  }
  loader: { load: ["[tex]/unicode", "[tex]/ams"] },
  tex: {
    packages: { "[+]": ["unicode", "ams"] },
    tags: "ams",
  },
};
</script>
<script type="text/javascript" id="MathJax-script" async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js">
</script>
<!-- <link href="doxygen.css" rel="stylesheet" type="text/css" /> -->
<link href="doxyYoda.min.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" >
$(document).ready(function() {
     $(".fragment").wrap("<details class='code-details'></details>");
     $(".code-details").append("<summary>Code</summary>");
 }
)
</script>
</head>
<body>
<div class="grid-contents">
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<nav class="title_area">
<a class="project_logo" href="#">
<img src="dSeamsLogo.png" width="30" height="30" alt="Logo">
</a>
<span class="project_info">d-SEAMS v1.0.0</span>
</nav>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">pntToPnt Namespace Reference</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a5b2c3bd3984c707965b6cc5ec03ff1da"><td class="memItemLeft" align="right" valign="top">Eigen::MatrixXd&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepntToPnt.html#a5b2c3bd3984c707965b6cc5ec03ff1da">getPointSetRefRing</a> (int n, int axialDim)</td></tr>
<tr class="separator:a5b2c3bd3984c707965b6cc5ec03ff1da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7e80d4e9ce192f1a20cdea501f4b9f6f"><td class="memItemLeft" align="right" valign="top">Eigen::MatrixXd&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepntToPnt.html#a7e80d4e9ce192f1a20cdea501f4b9f6f">createPrismBlock</a> (<a class="el" href="structmolSys_1_1PointCloud.html">molSys::PointCloud</a>&lt; <a class="el" href="structmolSys_1_1Point.html">molSys::Point</a>&lt; double &gt;, double &gt; *yCloud, const Eigen::MatrixXd &amp;refPoints, int ringSize, <a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt; basal1, <a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt; basal2)</td></tr>
<tr class="separator:a7e80d4e9ce192f1a20cdea501f4b9f6f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a30f913e8e5d720cd00adab9af4276ace"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepntToPnt.html#a30f913e8e5d720cd00adab9af4276ace">getRadiusFromRings</a> (<a class="el" href="structmolSys_1_1PointCloud.html">molSys::PointCloud</a>&lt; <a class="el" href="structmolSys_1_1Point.html">molSys::Point</a>&lt; double &gt;, double &gt; *yCloud, <a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt; basal1, <a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt; basal2)</td></tr>
<tr class="separator:a30f913e8e5d720cd00adab9af4276ace"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac0a7e6a2dd4c1bd115acb3f1226957e7"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepntToPnt.html#ac0a7e6a2dd4c1bd115acb3f1226957e7">getAvgHeightPrismBlock</a> (<a class="el" href="structmolSys_1_1PointCloud.html">molSys::PointCloud</a>&lt; <a class="el" href="structmolSys_1_1Point.html">molSys::Point</a>&lt; double &gt;, double &gt; *yCloud, <a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt; basal1, <a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt; basal2)</td></tr>
<tr class="separator:ac0a7e6a2dd4c1bd115acb3f1226957e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9e26156fea9f39958302a4c95d00797e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepntToPnt.html#a9e26156fea9f39958302a4c95d00797e">relOrderPrismBlock</a> (<a class="el" href="structmolSys_1_1PointCloud.html">molSys::PointCloud</a>&lt; <a class="el" href="structmolSys_1_1Point.html">molSys::Point</a>&lt; double &gt;, double &gt; *yCloud, <a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt; basal1, <a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt; basal2, <a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; <a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt;&gt; nList, <a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt; *outBasal1, <a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt; *outBasal2)</td></tr>
<tr class="separator:a9e26156fea9f39958302a4c95d00797e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a45458315459b7adedcc33c685f58a330"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepntToPnt.html#a45458315459b7adedcc33c685f58a330">relOrderPrismBlock</a> (<a class="el" href="structmolSys_1_1PointCloud.html">molSys::PointCloud</a>&lt; <a class="el" href="structmolSys_1_1Point.html">molSys::Point</a>&lt; double &gt;, double &gt; *yCloud, <a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt; basal1, <a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt; basal2, <a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt; *outBasal1, <a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt; *outBasal2)</td></tr>
<tr class="separator:a45458315459b7adedcc33c685f58a330"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a468a3864d5ebed50594501666028c244"><td class="memItemLeft" align="right" valign="top">Eigen::MatrixXd&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepntToPnt.html#a468a3864d5ebed50594501666028c244">fillPointSetPrismRing</a> (<a class="el" href="structmolSys_1_1PointCloud.html">molSys::PointCloud</a>&lt; <a class="el" href="structmolSys_1_1Point.html">molSys::Point</a>&lt; double &gt;, double &gt; *yCloud, <a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt; basalRing, int startingIndex)</td></tr>
<tr class="separator:a468a3864d5ebed50594501666028c244"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac1fc4d1ca64de4e2ed5e13931cc8a9e3"><td class="memItemLeft" align="right" valign="top">Eigen::MatrixXd&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepntToPnt.html#ac1fc4d1ca64de4e2ed5e13931cc8a9e3">fillPointSetPrismBlock</a> (<a class="el" href="structmolSys_1_1PointCloud.html">molSys::PointCloud</a>&lt; <a class="el" href="structmolSys_1_1Point.html">molSys::Point</a>&lt; double &gt;, double &gt; *yCloud, <a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt; basal1, <a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt; basal2, int startingIndex)</td></tr>
<tr class="separator:ac1fc4d1ca64de4e2ed5e13931cc8a9e3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a332141ec965df89d231a1def4dc3f5d7"><td class="memItemLeft" align="right" valign="top">Eigen::MatrixXd&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepntToPnt.html#a332141ec965df89d231a1def4dc3f5d7">getPointSetCage</a> (<a class="el" href="group__ring.html#ga301cfdc88452cfe51bd4f745d223a7e1">ring::strucType</a> type)</td></tr>
<tr class="separator:a332141ec965df89d231a1def4dc3f5d7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8140eb2ad1dfb9d08e4e917dd14d5424"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepntToPnt.html#a8140eb2ad1dfb9d08e4e917dd14d5424">relOrderHC</a> (<a class="el" href="structmolSys_1_1PointCloud.html">molSys::PointCloud</a>&lt; <a class="el" href="structmolSys_1_1Point.html">molSys::Point</a>&lt; double &gt;, double &gt; *yCloud, <a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt; basal1, <a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt; basal2, <a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; <a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt;&gt; nList, <a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt; *matchedBasal1, <a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt; *matchedBasal2)</td></tr>
<tr class="memdesc:a8140eb2ad1dfb9d08e4e917dd14d5424"><td class="mdescLeft">&#160;</td><td class="mdescRight">Matches the order of the basal rings of an HC or a potential HC.  <a href="namespacepntToPnt.html#a8140eb2ad1dfb9d08e4e917dd14d5424">More...</a><br /></td></tr>
<tr class="separator:a8140eb2ad1dfb9d08e4e917dd14d5424"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a804eb495f58fd5868858cc46480c3425"><td class="memItemLeft" align="right" valign="top"><a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepntToPnt.html#a804eb495f58fd5868858cc46480c3425">relOrderDDC</a> (int index, <a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; <a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt;&gt; rings, <a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; <a class="el" href="structcage_1_1Cage.html">cage::Cage</a> &gt; cageList)</td></tr>
<tr class="memdesc:a804eb495f58fd5868858cc46480c3425"><td class="mdescLeft">&#160;</td><td class="mdescRight">Matches the order of the basal rings of an DDC or a potential HC.  <a href="namespacepntToPnt.html#a804eb495f58fd5868858cc46480c3425">More...</a><br /></td></tr>
<tr class="separator:a804eb495f58fd5868858cc46480c3425"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a896e8ed3ac4436156eac99b12e12c255"><td class="memItemLeft" align="right" valign="top">Eigen::MatrixXd&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepntToPnt.html#a896e8ed3ac4436156eac99b12e12c255">changeHexCageOrder</a> (<a class="el" href="structmolSys_1_1PointCloud.html">molSys::PointCloud</a>&lt; <a class="el" href="structmolSys_1_1Point.html">molSys::Point</a>&lt; double &gt;, double &gt; *yCloud, <a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt; basal1, <a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt; basal2, int startingIndex=0)</td></tr>
<tr class="separator:a896e8ed3ac4436156eac99b12e12c255"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2c4affea21bfc133f8c752d74f3a943a"><td class="memItemLeft" align="right" valign="top">Eigen::MatrixXd&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepntToPnt.html#a2c4affea21bfc133f8c752d74f3a943a">changeDiaCageOrder</a> (<a class="el" href="structmolSys_1_1PointCloud.html">molSys::PointCloud</a>&lt; <a class="el" href="structmolSys_1_1Point.html">molSys::Point</a>&lt; double &gt;, double &gt; *yCloud, <a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt; ddcOrder, int startingIndex=0)</td></tr>
<tr class="separator:a2c4affea21bfc133f8c752d74f3a943a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="a2c4affea21bfc133f8c752d74f3a943a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2c4affea21bfc133f8c752d74f3a943a">&#9670;&nbsp;</a></span>changeDiaCageOrder()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Eigen::MatrixXd pntToPnt::changeDiaCageOrder </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmolSys_1_1PointCloud.html">molSys::PointCloud</a>&lt; <a class="el" href="structmolSys_1_1Point.html">molSys::Point</a>&lt; double &gt;, double &gt; *&#160;</td>
          <td class="paramname"><em>yCloud</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt;&#160;</td>
          <td class="paramname"><em>ddcOrder</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>startingIndex</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Fills up an eigen matrix point set using information of the equatorial ring and peripheral rings, embedded in a vector, already filled in relOrderDDC.</p>
<p>Fills up an eigen matrix point set using information of the equatorial ring and peripheral rings, embedded in a vector, already filled in relOrderDDC. The order is such that the next three atoms in the vector are the first nearest neighbours in the peripheral rings of one triplet (peripheral1), followed by apex1, and three nearest neighbours of the other triplet, followed by apex2. Basically: ((6 equatorial ring atoms), (3 nearest neighbours of [l1,l3,l5] in the peripheral rings), (1 second shell neighbour of [l1,l3,l5]), (first nearest neighbours of [l2,l4,l6]), (second nearest neighbour of [l2,l4,l6]) )</p>
<p>Thus, when you want to change the order of the DDC, this is how the order should be wrapped:</p><ol type="1">
<li>The first 6 atoms should be wrapped around (i.e. the sixth atom should become the first and so on)</li>
<li>The next 3 atoms should be wrapped but only when moved by multiples of 2.</li>
<li>The 9th element should not be changed.</li>
<li>The next three elements should be wrapped around (multiples of 2), since alternate elements of the equatorial ring are bonded. </li>
</ol>

<p class="definition">Definition at line <a class="el" href="pntCorrespondence_8cpp_source.html#l01038">1038</a> of file <a class="el" href="pntCorrespondence_8cpp_source.html">pntCorrespondence.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;                                                {</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;  <span class="keywordtype">int</span> nop = 14;                     <span class="comment">// Number of elements in the DDC</span></div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;  <span class="keywordtype">int</span> ringSize = 6;                 <span class="comment">// Six nodes in the rings</span></div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;  Eigen::MatrixXd pointSet(nop, 3); <span class="comment">// Output point set</span></div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;  <span class="keywordtype">int</span> peripheralStartingIndex; <span class="comment">// Index using which the elements of peripheral1</span></div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;                               <span class="comment">// and peripheral2 will be wrapped</span></div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a> wrappedDDC; <span class="comment">// Changed order of the DDC: should be the same</span></div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;                               <span class="comment">// size as the original ddcOrder vector</span></div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;  <span class="keywordtype">int</span> currentIndex;            <span class="comment">// Current index</span></div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;  <span class="comment">// Variables for filling the point set</span></div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;  <span class="keywordtype">int</span> iatomIndex, jatomIndex;</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/array.html">std::array&lt;double, 3&gt;</a> dr; <span class="comment">// Components of the distance</span></div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160; </div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;  <span class="keywordflow">if</span> (startingIndex == 0) {</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;    wrappedDDC = ddcOrder;</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;  } <span class="comment">// if the order does not have to be changed</span></div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;  <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;    wrappedDDC.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/resize.html">resize</a>(nop); <span class="comment">// Should be the same size as ddcOrder</span></div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;    <span class="comment">// ------------------</span></div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;    <span class="comment">// EQUATORIAL RING</span></div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;    <span class="comment">// Change the order of the equatorial ring</span></div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; ringSize; i++) {</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;      currentIndex = startingIndex + i;</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;      <span class="comment">// Wrap-around</span></div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;      <span class="keywordflow">if</span> (currentIndex &gt;= ringSize) {</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;        currentIndex -= ringSize;</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;      } <span class="comment">// end of wrap-around</span></div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;      <span class="comment">// Update the equatorial ring</span></div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;      wrappedDDC[i] = ddcOrder[currentIndex];</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;    } <span class="comment">// end of wrapping the equatorial ring</span></div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;    <span class="comment">// ------------------</span></div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;    <span class="comment">// PERIPHERAL RINGS</span></div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;    <span class="comment">// The index of the peripheral ring starting indices</span></div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;    <span class="keywordflow">if</span> (startingIndex &lt;= 1) {</div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;      peripheralStartingIndex = 0;</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (startingIndex &gt; 1 &amp;&amp; startingIndex &lt;= 3) {</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;      peripheralStartingIndex = 1;</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;      peripheralStartingIndex = 2;</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;    }</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;    <span class="comment">// Update the portions of the wrappedDDC vector</span></div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 6; i &lt; 9; i++) {</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;      currentIndex = i + peripheralStartingIndex;</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;      <span class="comment">// wrap-around</span></div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;      <span class="keywordflow">if</span> (currentIndex &lt;= 9) {</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;        currentIndex -= 3;</div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;      } <span class="comment">// end of wrap-around</span></div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;      wrappedDDC[i] = ddcOrder[currentIndex];</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;    } <span class="comment">// peripheral1</span></div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;    <span class="comment">// Update the peripheral2 portions of the wrappedDDC vector</span></div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 10; i &lt; 13; i++) {</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;      currentIndex = i + peripheralStartingIndex;</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;      <span class="comment">// wrap-around</span></div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;      <span class="keywordflow">if</span> (currentIndex &lt;= 13) {</div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;        currentIndex -= 3;</div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;      } <span class="comment">// end of wrap-around</span></div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;      wrappedDDC[i] = ddcOrder[currentIndex];</div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;    } <span class="comment">// peripheral2</span></div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;    <span class="comment">// ------------------</span></div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;    <span class="comment">// SECOND-NEAREST NEIGHBOURS</span></div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;    wrappedDDC[9] = ddcOrder[9];   <span class="comment">// apex1</span></div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;    wrappedDDC[13] = ddcOrder[13]; <span class="comment">// apex2</span></div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;    <span class="comment">// ------------------</span></div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;  } <span class="comment">// the order of the DDC has to be changed</span></div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160; </div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;  <span class="comment">// FILL UP THE EIGEN MATRIX</span></div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;  iatomIndex = wrappedDDC[0]; <span class="comment">// first point</span></div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;  pointSet(0, 0) = yCloud-&gt;<a class="code" href="group__molSys.html#ga67ab89369cd26572878a91afd521ef81">pts</a>[iatomIndex].x;</div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;  pointSet(0, 1) = yCloud-&gt;<a class="code" href="group__molSys.html#ga67ab89369cd26572878a91afd521ef81">pts</a>[iatomIndex].y;</div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;  pointSet(0, 2) = yCloud-&gt;<a class="code" href="group__molSys.html#ga67ab89369cd26572878a91afd521ef81">pts</a>[iatomIndex].z;</div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;  <span class="comment">// Loop through the rest of the equatorial ring points</span></div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt; 14; i++) {</div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;    jatomIndex = wrappedDDC[i]; <span class="comment">// Atom index to be filled</span></div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;    <span class="comment">// Get the distance from iatomIndex</span></div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;    dr = <a class="code" href="group__gen.html#ga41d115da13ccda44b9231653321dc465">gen::relDist</a>(yCloud, iatomIndex, jatomIndex);</div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160; </div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;    <span class="comment">// basal2</span></div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;    pointSet(i, 0) = yCloud-&gt;<a class="code" href="group__molSys.html#ga67ab89369cd26572878a91afd521ef81">pts</a>[iatomIndex].x + dr[0];</div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;    pointSet(i, 1) = yCloud-&gt;<a class="code" href="group__molSys.html#ga67ab89369cd26572878a91afd521ef81">pts</a>[iatomIndex].y + dr[1];</div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;    pointSet(i, 2) = yCloud-&gt;<a class="code" href="group__molSys.html#ga67ab89369cd26572878a91afd521ef81">pts</a>[iatomIndex].z + dr[2];</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;  } <span class="comment">// end of loop</span></div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160; </div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;  <span class="keywordflow">return</span> pointSet;</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;}</div>
<div class="ttc" id="aarray_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/container/array.html">std::array</a></div></div>
<div class="ttc" id="agroup__gen_html_ga41d115da13ccda44b9231653321dc465"><div class="ttname"><a href="group__gen.html#ga41d115da13ccda44b9231653321dc465">gen::relDist</a></div><div class="ttdeci">std::array&lt; double, 3 &gt; relDist(molSys::PointCloud&lt; molSys::Point&lt; double &gt;, double &gt; *yCloud, int iatom, int jatom)</div><div class="ttdef"><b>Definition:</b> <a href="generic_8hpp_source.html#l00196">generic.hpp:196</a></div></div>
<div class="ttc" id="agroup__molSys_html_ga67ab89369cd26572878a91afd521ef81"><div class="ttname"><a href="group__molSys.html#ga67ab89369cd26572878a91afd521ef81">molSys::PointCloud::pts</a></div><div class="ttdeci">std::vector&lt; S &gt; pts</div><div class="ttdef"><b>Definition:</b> <a href="mol__sys_8hpp_source.html#l00167">mol_sys.hpp:167</a></div></div>
<div class="ttc" id="aresize_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/container/vector/resize.html">std::vector::resize</a></div><div class="ttdeci">T resize(T... args)</div></div>
<div class="ttc" id="avector_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt; int &gt;</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a896e8ed3ac4436156eac99b12e12c255"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a896e8ed3ac4436156eac99b12e12c255">&#9670;&nbsp;</a></span>changeHexCageOrder()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Eigen::MatrixXd pntToPnt::changeHexCageOrder </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmolSys_1_1PointCloud.html">molSys::PointCloud</a>&lt; <a class="el" href="structmolSys_1_1Point.html">molSys::Point</a>&lt; double &gt;, double &gt; *&#160;</td>
          <td class="paramname"><em>yCloud</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt;&#160;</td>
          <td class="paramname"><em>basal1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt;&#160;</td>
          <td class="paramname"><em>basal2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>startingIndex</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Fills up an eigen matrix point set using the basal rings basal1 and basal2, changing the order of the point set by filling up from the startingIndex (starting from 0 to 5) </p>

<p class="definition">Definition at line <a class="el" href="pntCorrespondence_8cpp_source.html#l00736">736</a> of file <a class="el" href="pntCorrespondence_8cpp_source.html">pntCorrespondence.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;                                                                     {</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;  Eigen::MatrixXd pointSet(12, 3);</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;  <span class="keywordtype">int</span> iatomIndex, jatomIndex; <span class="comment">// Current atom index in yCloud, according to</span></div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;                              <span class="comment">// basal1 and basal2 respectively</span></div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;  <span class="keywordtype">int</span> iPnt;                   <span class="comment">// Current index in the Eigen matrix pointSet</span></div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;  <span class="keywordtype">int</span> cageSize = 12;          <span class="comment">// Number of points in the cage</span></div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a> newBasal1, newBasal2;</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/array.html">std::array&lt;double, 3&gt;</a> dr; <span class="comment">// Components of the distance</span></div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;  <span class="keywordtype">int</span> iatomOne;             <span class="comment">// Index of the first atom</span></div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160; </div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;  <span class="comment">// Checks and balances</span></div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;  <span class="keywordflow">if</span> (startingIndex &gt; 5 || startingIndex &lt; 0) {</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;    startingIndex = 0;</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;  } <span class="comment">// no invalid starting index</span></div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160; </div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;  <span class="comment">// Change the order</span></div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;  <span class="keywordflow">if</span> (startingIndex &gt; 0) {</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; 6; k++) {</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;      iPnt = k + startingIndex;</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;      <span class="keywordflow">if</span> (iPnt &gt;= 6) {</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;        iPnt -= 6;</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;      } <span class="comment">// wrap-around</span></div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;      newBasal1.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/push_back.html">push_back</a>(basal1[iPnt]);</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;      newBasal2.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/push_back.html">push_back</a>(basal2[iPnt]);</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;    } <span class="comment">// change the order</span></div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;  }   <span class="comment">// end of filling for startingIndex&gt;0</span></div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;  <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;    newBasal1 = basal1;</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;    newBasal2 = basal2;</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;  } <span class="comment">// end of filling up the reordered basal rings</span></div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160; </div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;  <span class="comment">// FIRST POINT</span></div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;  <span class="comment">// basal1</span></div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;  iatomOne = newBasal1[0];</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;  pointSet(0, 0) = yCloud-&gt;<a class="code" href="group__molSys.html#ga67ab89369cd26572878a91afd521ef81">pts</a>[iatomOne].x;</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;  pointSet(0, 1) = yCloud-&gt;<a class="code" href="group__molSys.html#ga67ab89369cd26572878a91afd521ef81">pts</a>[iatomOne].y;</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;  pointSet(0, 2) = yCloud-&gt;<a class="code" href="group__molSys.html#ga67ab89369cd26572878a91afd521ef81">pts</a>[iatomOne].z;</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;  <span class="comment">// basal2</span></div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;  jatomIndex = newBasal2[0];</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;  <span class="comment">// Get the distance from basal1</span></div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;  dr = <a class="code" href="group__gen.html#ga41d115da13ccda44b9231653321dc465">gen::relDist</a>(yCloud, iatomOne, jatomIndex);</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160; </div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;  <span class="comment">// basal2</span></div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;  pointSet(6, 0) = yCloud-&gt;<a class="code" href="group__molSys.html#ga67ab89369cd26572878a91afd521ef81">pts</a>[iatomOne].x + dr[0];</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;  pointSet(6, 1) = yCloud-&gt;<a class="code" href="group__molSys.html#ga67ab89369cd26572878a91afd521ef81">pts</a>[iatomOne].y + dr[1];</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;  pointSet(6, 2) = yCloud-&gt;<a class="code" href="group__molSys.html#ga67ab89369cd26572878a91afd521ef81">pts</a>[iatomOne].z + dr[2];</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;  <span class="comment">// Loop through the rest of the points</span></div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt; 6; i++) {</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;    <span class="comment">// basal1</span></div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;    iatomIndex = newBasal1[i]; <span class="comment">// Atom index to be filled for basal1</span></div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;    jatomIndex = newBasal2[i]; <span class="comment">// Atom index to be filled for basal2</span></div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;    <span class="comment">// Get the distance from the first atom</span></div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;    dr = <a class="code" href="group__gen.html#ga41d115da13ccda44b9231653321dc465">gen::relDist</a>(yCloud, iatomOne, iatomIndex);</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;    pointSet(i, 0) = yCloud-&gt;<a class="code" href="group__molSys.html#ga67ab89369cd26572878a91afd521ef81">pts</a>[iatomOne].x + dr[0];</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;    pointSet(i, 1) = yCloud-&gt;<a class="code" href="group__molSys.html#ga67ab89369cd26572878a91afd521ef81">pts</a>[iatomOne].y + dr[1];</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;    pointSet(i, 2) = yCloud-&gt;<a class="code" href="group__molSys.html#ga67ab89369cd26572878a91afd521ef81">pts</a>[iatomOne].z + dr[2];</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;    <span class="comment">// Get the distance from the first atom</span></div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;    dr = <a class="code" href="group__gen.html#ga41d115da13ccda44b9231653321dc465">gen::relDist</a>(yCloud, iatomOne, jatomIndex);</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;    <span class="comment">// basal2</span></div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;    pointSet(i + 6, 0) = yCloud-&gt;<a class="code" href="group__molSys.html#ga67ab89369cd26572878a91afd521ef81">pts</a>[iatomOne].x + dr[0];</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;    pointSet(i + 6, 1) = yCloud-&gt;<a class="code" href="group__molSys.html#ga67ab89369cd26572878a91afd521ef81">pts</a>[iatomOne].y + dr[1];</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;    pointSet(i + 6, 2) = yCloud-&gt;<a class="code" href="group__molSys.html#ga67ab89369cd26572878a91afd521ef81">pts</a>[iatomOne].z + dr[2];</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;  } <span class="comment">// end of loop</span></div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160; </div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;  <span class="keywordflow">return</span> pointSet;</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;}</div>
<div class="ttc" id="apush_back_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/container/vector/push_back.html">std::vector::push_back</a></div><div class="ttdeci">T push_back(T... args)</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a7e80d4e9ce192f1a20cdea501f4b9f6f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7e80d4e9ce192f1a20cdea501f4b9f6f">&#9670;&nbsp;</a></span>createPrismBlock()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Eigen::MatrixXd pntToPnt::createPrismBlock </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmolSys_1_1PointCloud.html">molSys::PointCloud</a>&lt; <a class="el" href="structmolSys_1_1Point.html">molSys::Point</a>&lt; double &gt;, double &gt; *&#160;</td>
          <td class="paramname"><em>yCloud</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Eigen::MatrixXd &amp;&#160;</td>
          <td class="paramname"><em>refPoints</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ringSize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt;&#160;</td>
          <td class="paramname"><em>basal1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt;&#160;</td>
          <td class="paramname"><em>basal2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Creates an eigen matrix for the points of a prism block, constructed from the points of a perfect polygon of radius 1, given the basal rings and axial dimension </p>

<p class="definition">Definition at line <a class="el" href="pntCorrespondence_8cpp_source.html#l00052">52</a> of file <a class="el" href="pntCorrespondence_8cpp_source.html">pntCorrespondence.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;                           {</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;  <span class="keywordtype">int</span> nop = ringSize * 2;           <span class="comment">// Number of particles in the prism block</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  Eigen::MatrixXd pointSet(nop, 3); <span class="comment">// Output point set for a regular prism</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  <span class="keywordtype">int</span> axialDim;                     <span class="comment">// Has a value of 0, 1 or 2 for x, y or z</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  <span class="keywordtype">double</span> avgRadius; <span class="comment">// Average radius within which the basal ring points lie</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;  <span class="keywordtype">double</span> avgHeight; <span class="comment">// Get the average height of the prism</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;  <span class="keywordtype">int</span> iBasalOne,</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;      iBasalTwo; <span class="comment">// Indices for the basal1 and basal2 points in the point set</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  <span class="comment">// --------------------------------------</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;  <span class="comment">// Get the axial dimension</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;  <span class="comment">// The axial dimension will have the largest box length</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;  <span class="comment">// Index -&gt; axial dimension</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  <span class="comment">// 0 -&gt; x dim</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;  <span class="comment">// 1 -&gt; y dim</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;  <span class="comment">// 2 -&gt; z dim</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  axialDim = <a class="codeRef" href="http://en.cppreference.com/w/cpp/algorithm/max_element.html">std::max_element</a>(yCloud-&gt;<a class="code" href="group__molSys.html#gaa7d9b8543780baf4a495c7acdb1f87d8">box</a>.begin(), yCloud-&gt;<a class="code" href="group__molSys.html#gaa7d9b8543780baf4a495c7acdb1f87d8">box</a>.end()) -</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;             yCloud-&gt;<a class="code" href="group__molSys.html#gaa7d9b8543780baf4a495c7acdb1f87d8">box</a>.begin();</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  <span class="comment">// --------------------------------------</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  <span class="comment">// Get the average radius</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  avgRadius = <a class="code" href="namespacepntToPnt.html#a30f913e8e5d720cd00adab9af4276ace">pntToPnt::getRadiusFromRings</a>(yCloud, basal1, basal2);</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  <span class="comment">// --------------------------------------</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  <span class="comment">// Get the average height of the prism</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;  avgHeight = <a class="code" href="namespacepntToPnt.html#ac0a7e6a2dd4c1bd115acb3f1226957e7">pntToPnt::getAvgHeightPrismBlock</a>(yCloud, basal1, basal2);</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;  <span class="comment">// --------------------------------------</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;  <span class="comment">// Fill in the matrix of the point set</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;  <span class="comment">// Fill basal1 first, and then basal2</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; ringSize; i++) {</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    iBasalOne = i;            <span class="comment">// index in point set for basal1 point</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    iBasalTwo = i + ringSize; <span class="comment">// index in point set for basal2 point</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <span class="comment">// Fill up the dimensions</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; 3; k++) {</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;      <span class="comment">// For the axial dimension</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;      <span class="keywordflow">if</span> (k == axialDim) {</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;        pointSet(iBasalOne, k) = 0.0;       <span class="comment">// basal1</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;        pointSet(iBasalTwo, k) = avgHeight; <span class="comment">// basal2</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;      } <span class="comment">// end of filling up the axial dimension</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;      <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;        pointSet(iBasalOne, k) = avgRadius * refPoints(i, k); <span class="comment">// basal1</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;        pointSet(iBasalTwo, k) = avgRadius * refPoints(i, k); <span class="comment">// basal2</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;      } <span class="comment">// fill up the non-axial dimension coordinate dimension</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    }   <span class="comment">// Fill up all the dimensions</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  }     <span class="comment">// end of filling in the point set</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  <span class="comment">// --------------------------------------</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  <span class="keywordflow">return</span> pointSet;</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;} <span class="comment">// end of function</span></div>
<div class="ttc" id="agroup__molSys_html_gaa7d9b8543780baf4a495c7acdb1f87d8"><div class="ttname"><a href="group__molSys.html#gaa7d9b8543780baf4a495c7acdb1f87d8">molSys::PointCloud::box</a></div><div class="ttdeci">std::vector&lt; T &gt; box</div><div class="ttdoc">Number of atoms.</div><div class="ttdef"><b>Definition:</b> <a href="mol__sys_8hpp_source.html#l00170">mol_sys.hpp:170</a></div></div>
<div class="ttc" id="amax_element_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/algorithm/max_element.html">std::max_element</a></div><div class="ttdeci">T max_element(T... args)</div></div>
<div class="ttc" id="anamespacepntToPnt_html_a30f913e8e5d720cd00adab9af4276ace"><div class="ttname"><a href="namespacepntToPnt.html#a30f913e8e5d720cd00adab9af4276ace">pntToPnt::getRadiusFromRings</a></div><div class="ttdeci">double getRadiusFromRings(molSys::PointCloud&lt; molSys::Point&lt; double &gt;, double &gt; *yCloud, std::vector&lt; int &gt; basal1, std::vector&lt; int &gt; basal2)</div><div class="ttdef"><b>Definition:</b> <a href="pntCorrespondence_8cpp_source.html#l00107">pntCorrespondence.cpp:107</a></div></div>
<div class="ttc" id="anamespacepntToPnt_html_ac0a7e6a2dd4c1bd115acb3f1226957e7"><div class="ttname"><a href="namespacepntToPnt.html#ac0a7e6a2dd4c1bd115acb3f1226957e7">pntToPnt::getAvgHeightPrismBlock</a></div><div class="ttdeci">double getAvgHeightPrismBlock(molSys::PointCloud&lt; molSys::Point&lt; double &gt;, double &gt; *yCloud, std::vector&lt; int &gt; basal1, std::vector&lt; int &gt; basal2)</div><div class="ttdef"><b>Definition:</b> <a href="pntCorrespondence_8cpp_source.html#l00167">pntCorrespondence.cpp:167</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac1fc4d1ca64de4e2ed5e13931cc8a9e3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac1fc4d1ca64de4e2ed5e13931cc8a9e3">&#9670;&nbsp;</a></span>fillPointSetPrismBlock()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Eigen::MatrixXd pntToPnt::fillPointSetPrismBlock </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmolSys_1_1PointCloud.html">molSys::PointCloud</a>&lt; <a class="el" href="structmolSys_1_1Point.html">molSys::Point</a>&lt; double &gt;, double &gt; *&#160;</td>
          <td class="paramname"><em>yCloud</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt;&#160;</td>
          <td class="paramname"><em>basal1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt;&#160;</td>
          <td class="paramname"><em>basal2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>startingIndex</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Fill up an Eigen matrix of a prism block (two basal rings) from input vectors for the basal rings</p>
<p>Fill up an Eigen Matrix for a prism block from input vectors of atom indices of the basal rings </p>

<p class="definition">Definition at line <a class="el" href="pntCorrespondence_8cpp_source.html#l00504">504</a> of file <a class="el" href="pntCorrespondence_8cpp_source.html">pntCorrespondence.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;                                                                     {</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;  <span class="keywordtype">int</span> dim = 3;                        <span class="comment">// Number of dimensions (3)</span></div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;  <span class="keywordtype">int</span> ringSize = basal1.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/size.html">size</a>();       <span class="comment">// Number of nodes in the ring</span></div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;  <span class="keywordtype">int</span> nop = ringSize * 2;             <span class="comment">// Number of particles in prism block</span></div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;  Eigen::MatrixXd pointSet(nop, dim); <span class="comment">// Output set of 3D points</span></div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;  <span class="comment">// Indices for the first and second basal rings being filled</span></div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;  <span class="keywordtype">int</span> currentPosition;        <span class="comment">// Current position in the basal ring vectors</span></div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;  <span class="keywordtype">int</span> iatom, jatom;           <span class="comment">// Current index in the point set</span></div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;  <span class="keywordtype">int</span> iatomIndex, jatomIndex; <span class="comment">// Index in yCloud corresponding to the basal1</span></div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;                              <span class="comment">// and basal2 points</span></div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160; </div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;  <span class="comment">// Fill up basal1 points, followed by basal2 points</span></div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160; </div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;  <span class="comment">// Check</span></div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;  <span class="keywordflow">if</span> (startingIndex &gt;= ringSize || startingIndex &lt; 0) {</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;    startingIndex = 0;</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;  } <span class="comment">// end of check</span></div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160; </div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;  <span class="comment">// Beginning from the starting index, get the points in the basal ring</span></div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; ringSize; i++) {</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;    <span class="comment">// Getting currentIndex</span></div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;    currentPosition = startingIndex + i;</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;    <span class="comment">// Wrapping around for the ring</span></div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;    <span class="keywordflow">if</span> (currentPosition &gt;= ringSize) {</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;      currentPosition -= ringSize;</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;    } <span class="comment">// end of wrap-around</span></div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;    <span class="comment">// -------------------</span></div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;    <span class="comment">// Basal1 ring points</span></div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;    iatomIndex =</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;        basal1[currentPosition]; <span class="comment">// Index of the current point in basal1</span></div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;    iatom = i;                   <span class="comment">// index in the point set being filled</span></div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;    pointSet(iatom, 0) = yCloud-&gt;<a class="code" href="group__molSys.html#ga67ab89369cd26572878a91afd521ef81">pts</a>[iatomIndex].x; <span class="comment">// x coord</span></div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;    pointSet(iatom, 1) = yCloud-&gt;<a class="code" href="group__molSys.html#ga67ab89369cd26572878a91afd521ef81">pts</a>[iatomIndex].y; <span class="comment">// y coord</span></div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;    pointSet(iatom, 2) = yCloud-&gt;<a class="code" href="group__molSys.html#ga67ab89369cd26572878a91afd521ef81">pts</a>[iatomIndex].z; <span class="comment">// z coord</span></div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;    <span class="comment">// -------------------</span></div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;    <span class="comment">// Basal2 ring points</span></div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;    jatomIndex =</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;        basal2[currentPosition]; <span class="comment">// Index of the current point in basal2</span></div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;    jatom = i + ringSize;        <span class="comment">// index in the point set being filled</span></div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;    pointSet(jatom, 0) = yCloud-&gt;<a class="code" href="group__molSys.html#ga67ab89369cd26572878a91afd521ef81">pts</a>[jatomIndex].x; <span class="comment">// x coord</span></div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;    pointSet(jatom, 1) = yCloud-&gt;<a class="code" href="group__molSys.html#ga67ab89369cd26572878a91afd521ef81">pts</a>[jatomIndex].y; <span class="comment">// y coord</span></div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;    pointSet(jatom, 2) = yCloud-&gt;<a class="code" href="group__molSys.html#ga67ab89369cd26572878a91afd521ef81">pts</a>[jatomIndex].z; <span class="comment">// z coord</span></div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;  } <span class="comment">// end of point filling from the relative ordering vector of vectors</span></div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160; </div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;  <span class="comment">// Return the set of points</span></div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;  <span class="keywordflow">return</span> pointSet;</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;} <span class="comment">// end of function</span></div>
<div class="ttc" id="asize_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/container/vector/size.html">std::vector::size</a></div><div class="ttdeci">T size(T... args)</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a468a3864d5ebed50594501666028c244"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a468a3864d5ebed50594501666028c244">&#9670;&nbsp;</a></span>fillPointSetPrismRing()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Eigen::MatrixXd pntToPnt::fillPointSetPrismRing </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmolSys_1_1PointCloud.html">molSys::PointCloud</a>&lt; <a class="el" href="structmolSys_1_1Point.html">molSys::Point</a>&lt; double &gt;, double &gt; *&#160;</td>
          <td class="paramname"><em>yCloud</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt;&#160;</td>
          <td class="paramname"><em>basalRing</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>startingIndex</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Fill up an Eigen Matrix of a prism basal ring from an input vector of atom indices</p>
<p>Fill up an Eigen Matrix for a prism basal ring from an input vector of atom indices </p>

<p class="definition">Definition at line <a class="el" href="pntCorrespondence_8cpp_source.html#l00460">460</a> of file <a class="el" href="pntCorrespondence_8cpp_source.html">pntCorrespondence.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;                                                 {</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;  <span class="keywordtype">int</span> dim = 3;                        <span class="comment">// Number of dimensions (3)</span></div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;  <span class="keywordtype">int</span> ringSize = basalRing.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/size.html">size</a>();    <span class="comment">// Number of nodes in the ring</span></div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;  <span class="keywordtype">int</span> nop = basalRing.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/size.html">size</a>();         <span class="comment">// Number of particles in the basal ring</span></div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;  Eigen::MatrixXd pointSet(nop, dim); <span class="comment">// Output set of 3D points</span></div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;  <span class="comment">// Indices for the first and second basal rings being filled</span></div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;  <span class="keywordtype">int</span> currentPosition; <span class="comment">// Current index in basalRing</span></div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;  <span class="keywordtype">int</span> index;           <span class="comment">// Index in yCloud</span></div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160; </div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;  <span class="comment">// Check</span></div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;  <span class="keywordflow">if</span> (startingIndex &gt;= ringSize || startingIndex &lt; 0) {</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;    startingIndex = 0;</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;  } <span class="comment">// end of check</span></div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160; </div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;  <span class="comment">// Beginning from the starting index, get the points in the basal ring</span></div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; nop; i++) {</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    <span class="comment">// Getting currentIndex</span></div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    currentPosition = startingIndex + i;</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    <span class="comment">// Wrapping around for the ring</span></div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;    <span class="keywordflow">if</span> (currentPosition &gt;= ringSize) {</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;      currentPosition -= ringSize;</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    } <span class="comment">// end of wrap-around</span></div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    <span class="comment">// -------------------</span></div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    <span class="comment">// Basal ring points</span></div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    index = basalRing[currentPosition];    <span class="comment">// Index of the current point</span></div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;    pointSet(i, 0) = yCloud-&gt;<a class="code" href="group__molSys.html#ga67ab89369cd26572878a91afd521ef81">pts</a>[index].x; <span class="comment">// x coord</span></div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    pointSet(i, 1) = yCloud-&gt;<a class="code" href="group__molSys.html#ga67ab89369cd26572878a91afd521ef81">pts</a>[index].y; <span class="comment">// y coord</span></div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    pointSet(i, 2) = yCloud-&gt;<a class="code" href="group__molSys.html#ga67ab89369cd26572878a91afd521ef81">pts</a>[index].z; <span class="comment">// z coord</span></div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;  } <span class="comment">// end of point filling from the relative ordering vector of vectors</span></div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160; </div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;  <span class="comment">// Return the set of points</span></div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;  <span class="keywordflow">return</span> pointSet;</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;} <span class="comment">// end of function</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac0a7e6a2dd4c1bd115acb3f1226957e7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac0a7e6a2dd4c1bd115acb3f1226957e7">&#9670;&nbsp;</a></span>getAvgHeightPrismBlock()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double pntToPnt::getAvgHeightPrismBlock </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmolSys_1_1PointCloud.html">molSys::PointCloud</a>&lt; <a class="el" href="structmolSys_1_1Point.html">molSys::Point</a>&lt; double &gt;, double &gt; *&#160;</td>
          <td class="paramname"><em>yCloud</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt;&#160;</td>
          <td class="paramname"><em>basal1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt;&#160;</td>
          <td class="paramname"><em>basal2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Calculate the average height of the prism block, calculated using the basal rings of the prism and the axial dimension </p>

<p class="definition">Definition at line <a class="el" href="pntCorrespondence_8cpp_source.html#l00167">167</a> of file <a class="el" href="pntCorrespondence_8cpp_source.html">pntCorrespondence.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;                                                  {</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;  <span class="keywordtype">double</span> avgHeight = 0.0;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;  <span class="keywordtype">double</span> r_ij;                  <span class="comment">// Distance between a point in basal1 and basal2</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;double&gt;</a> dist;     <span class="comment">// Distances</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  <span class="keywordtype">int</span> ringSize = basal1.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/size.html">size</a>(); <span class="comment">// Number of nodes in the basal rings</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;  <span class="keywordtype">int</span> iatom; <span class="comment">// Atom index in yCloud for the current point in basal1</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;  <span class="keywordtype">int</span> jatom; <span class="comment">// Atom index in yCloud for the current point in basal2</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;  <span class="comment">// -----------------------</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;  <span class="comment">// Calculate the distances of each point from the respective centroid</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; ringSize; i++) {</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <span class="comment">// Get the current point in basal1 and basal2</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    iatom = basal1[i];</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    jatom = basal2[i];</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <span class="comment">// Get the distance between a point in basal1 and the corresponding point in</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <span class="comment">// basal2</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    r_ij = <a class="code" href="group__gen.html#ga881e045598dd517609383d8a3fec5913">gen::periodicDist</a>(yCloud, iatom, jatom);</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    <span class="comment">// Update the distances</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    dist.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/push_back.html">push_back</a>(r_ij);</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;  } <span class="comment">// Loop through every point in basal1 and basal2</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;  <span class="comment">// -----------------------</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;  <span class="comment">// Calculate the average, excluding the outliers</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;  avgHeight = <a class="code" href="group__gen.html#gaf3593d4e71600e8d85fbd873fcd95558">gen::getAverageWithoutOutliers</a>(dist);</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;  <span class="comment">// -----------------------</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;  <span class="keywordflow">return</span> avgHeight;</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;} <span class="comment">// end of function</span></div>
<div class="ttc" id="agroup__gen_html_ga881e045598dd517609383d8a3fec5913"><div class="ttname"><a href="group__gen.html#ga881e045598dd517609383d8a3fec5913">gen::periodicDist</a></div><div class="ttdeci">double periodicDist(molSys::PointCloud&lt; molSys::Point&lt; double &gt;, double &gt; *yCloud, int iatom, int jatom)</div><div class="ttdoc">Inline generic function for obtaining the unwrapped periodic distance between two particles,...</div><div class="ttdef"><b>Definition:</b> <a href="generic_8hpp_source.html#l00104">generic.hpp:104</a></div></div>
<div class="ttc" id="agroup__gen_html_gaf3593d4e71600e8d85fbd873fcd95558"><div class="ttname"><a href="group__gen.html#gaf3593d4e71600e8d85fbd873fcd95558">gen::getAverageWithoutOutliers</a></div><div class="ttdeci">double getAverageWithoutOutliers(std::vector&lt; double &gt; inpVec)</div><div class="ttdoc">Get the average, after excluding the outliers, using quartiles.</div><div class="ttdef"><b>Definition:</b> <a href="generic_8cpp_source.html#l00164">generic.cpp:164</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a332141ec965df89d231a1def4dc3f5d7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a332141ec965df89d231a1def4dc3f5d7">&#9670;&nbsp;</a></span>getPointSetCage()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Eigen::MatrixXd pntToPnt::getPointSetCage </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__ring.html#ga301cfdc88452cfe51bd4f745d223a7e1">ring::strucType</a>&#160;</td>
          <td class="paramname"><em>type</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Fills up an eigen matrix point set a reference ring, which is a regular n-gonal polygon, constructed with radius 1 by default; where n is the number of nodes in the ring</p>
<p>REFERENCE POINT SETS FOR BULK ICES Fills up an eigen matrix point set for a reference cage, saved in the templates folder relative to the top-level directory NOT NEEDED MAYBE </p>

<p class="definition">Definition at line <a class="el" href="pntCorrespondence_8cpp_source.html#l00564">564</a> of file <a class="el" href="pntCorrespondence_8cpp_source.html">pntCorrespondence.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;                                                          {</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;  Eigen::MatrixXd pointSet(12, 3); <span class="comment">// Reference point set (Eigen matrix)</span></div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;  <a class="code" href="structmolSys_1_1PointCloud.html">molSys::PointCloud&lt;molSys::Point&lt;double&gt;</a>, <span class="keywordtype">double</span>&gt;</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;      setCloud; <span class="comment">// PointCloud for holding the reference point values</span></div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160; </div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;  <span class="keywordflow">if</span> (type == <a class="code" href="group__ring.html#gga301cfdc88452cfe51bd4f745d223a7e1a48c3c5c40739122c0bf68fb9faeee9da">ring::HCbasal</a>) {</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;    <span class="comment">// Read in the XYZ file</span></div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;    <a class="codeRef" href="http://en.cppreference.com/w/cpp/string/basic_string.html">std::string</a> fileName = <span class="stringliteral">&quot;templates/hc.xyz&quot;</span>;</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;    <a class="code" href="group__sinp.html#gab2f8bc3f639a2d2618460883116d5b5b">sinp::readXYZ</a>(fileName, &amp;setCloud);</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;    <span class="keywordtype">int</span> n = setCloud.<a class="code" href="group__molSys.html#ga2bdcb9260bd83f313a2d27fcc6437ef1">nop</a>; <span class="comment">// Number of points in the reference point set</span></div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;    Eigen::MatrixXd pointSet(n, 3); <span class="comment">// Output point set for a regular polygon</span></div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160; </div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;    <span class="comment">// Loop through every particle</span></div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; n; i++) {</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;      pointSet(i, 0) = setCloud.<a class="code" href="group__molSys.html#ga67ab89369cd26572878a91afd521ef81">pts</a>[i].x; <span class="comment">// x</span></div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;      pointSet(i, 1) = setCloud.<a class="code" href="group__molSys.html#ga67ab89369cd26572878a91afd521ef81">pts</a>[i].y; <span class="comment">// y</span></div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;      pointSet(i, 2) = setCloud.<a class="code" href="group__molSys.html#ga67ab89369cd26572878a91afd521ef81">pts</a>[i].z; <span class="comment">// z</span></div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;    } <span class="comment">// end of looping through every particle</span></div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160; </div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;    <span class="comment">// Return the filled point set</span></div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;    <span class="keywordflow">return</span> pointSet;</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;  } <span class="comment">// end of reference point set for HCs</span></div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;  <span class="comment">// else {</span></div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;  <span class="comment">//   // ddc</span></div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;  <span class="comment">//   Eigen::MatrixXd pointSet(14, 3);  // Output point set for a regular</span></div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;  <span class="comment">//   polygon return pointSet;</span></div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;  <span class="comment">// }  // DDCs</span></div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160; </div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;  <span class="comment">// Eigen::MatrixXd pointSet(14, 3);  // Output point set for a regular polygon</span></div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;  <span class="comment">// // Never happens</span></div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;  <span class="keywordflow">return</span> pointSet;</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160; </div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;} <span class="comment">// end of function</span></div>
<div class="ttc" id="abasic_string_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/string/basic_string.html">std::string</a></div></div>
<div class="ttc" id="agroup__molSys_html_ga2bdcb9260bd83f313a2d27fcc6437ef1"><div class="ttname"><a href="group__molSys.html#ga2bdcb9260bd83f313a2d27fcc6437ef1">molSys::PointCloud::nop</a></div><div class="ttdeci">int nop</div><div class="ttdoc">Current frame number.</div><div class="ttdef"><b>Definition:</b> <a href="mol__sys_8hpp_source.html#l00169">mol_sys.hpp:169</a></div></div>
<div class="ttc" id="agroup__ring_html_gga301cfdc88452cfe51bd4f745d223a7e1a48c3c5c40739122c0bf68fb9faeee9da"><div class="ttname"><a href="group__ring.html#gga301cfdc88452cfe51bd4f745d223a7e1a48c3c5c40739122c0bf68fb9faeee9da">ring::HCbasal</a></div><div class="ttdeci">@ HCbasal</div><div class="ttdoc">The ring belongs only to a hexagonal cage (HC). Specifically, the ring is purely a basal ring of an H...</div><div class="ttdef"><b>Definition:</b> <a href="ring_8hpp_source.html#l00115">ring.hpp:115</a></div></div>
<div class="ttc" id="agroup__sinp_html_gab2f8bc3f639a2d2618460883116d5b5b"><div class="ttname"><a href="group__sinp.html#gab2f8bc3f639a2d2618460883116d5b5b">sinp::readXYZ</a></div><div class="ttdeci">int readXYZ(std::string filename, molSys::PointCloud&lt; molSys::Point&lt; double &gt;, double &gt; *yCloud)</div><div class="ttdoc">Function for reading in atom coordinates from an XYZ file.</div><div class="ttdef"><b>Definition:</b> <a href="seams__input_8cpp_source.html#l00069">seams_input.cpp:69</a></div></div>
<div class="ttc" id="astructmolSys_1_1PointCloud_html"><div class="ttname"><a href="structmolSys_1_1PointCloud.html">molSys::PointCloud</a></div><div class="ttdoc">This contains a collection of points; contains information for a particular frame.</div><div class="ttdef"><b>Definition:</b> <a href="mol__sys_8hpp_source.html#l00166">mol_sys.hpp:166</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a5b2c3bd3984c707965b6cc5ec03ff1da"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5b2c3bd3984c707965b6cc5ec03ff1da">&#9670;&nbsp;</a></span>getPointSetRefRing()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Eigen::MatrixXd pntToPnt::getPointSetRefRing </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>axialDim</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Fills up an eigen matrix point set a reference ring, which is a regular n-gonal polygon; where n is the number of nodes in the ring</p>
<p>Fills up an eigen matrix point set a reference ring, which is a regular n-gonal polygon, constructed with radius 1 by default; where n is the number of nodes in the ring </p>

<p class="definition">Definition at line <a class="el" href="pntCorrespondence_8cpp_source.html#l00018">18</a> of file <a class="el" href="pntCorrespondence_8cpp_source.html">pntCorrespondence.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;                                                              {</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;  Eigen::MatrixXd pointSet(n, 3); <span class="comment">// Output point set for a regular polygon</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a> dims;          <span class="comment">// Apart from the axial dimension</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160; </div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;  <span class="comment">// Set the axial dimension to 0, and fill up the vector of the other</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;  <span class="comment">// dimensions</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; 3; k++) {</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    <span class="keywordflow">if</span> (k != axialDim) {</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;      dims.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/push_back.html">push_back</a>(k);</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    } <span class="comment">// other dimensions</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;  }   <span class="comment">// end of setting the axial dimension</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160; </div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;  <span class="comment">// To get the vertices of a regular polygon, use the following formula:</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;  <span class="comment">// x[i] = r * cos(2*pi*i/n)</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;  <span class="comment">// y[i] = r * sin(2*pi*i/n)</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;  <span class="comment">// where n is the number of points and the index i is 0&lt;=i&lt;=n</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160; </div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;  <span class="comment">// Loop through every particle</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; n; i++) {</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    pointSet(i, dims[0]) = <a class="codeRef" href="http://en.cppreference.com/w/cpp/numeric/math/cos.html">cos</a>((2.0 * <a class="code" href="group__gen.html#gaa59e2feae36f62dfdb0664bd06de8572">gen::pi</a> * i) / n); <span class="comment">// x</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    pointSet(i, dims[1]) = <a class="codeRef" href="http://en.cppreference.com/w/cpp/numeric/math/sin.html">sin</a>((2.0 * <a class="code" href="group__gen.html#gaa59e2feae36f62dfdb0664bd06de8572">gen::pi</a> * i) / n); <span class="comment">// y</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    <span class="comment">// Set the axial dimension to zero</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    pointSet(i, axialDim) = 0.0;</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;  } <span class="comment">// end of loop through all the points</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160; </div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  <span class="keywordflow">return</span> pointSet;</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;} <span class="comment">// end of function</span></div>
<div class="ttc" id="acos_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/numeric/math/cos.html">std::cos</a></div><div class="ttdeci">T cos(T... args)</div></div>
<div class="ttc" id="agroup__gen_html_gaa59e2feae36f62dfdb0664bd06de8572"><div class="ttname"><a href="group__gen.html#gaa59e2feae36f62dfdb0664bd06de8572">gen::pi</a></div><div class="ttdeci">const double pi</div><div class="ttdef"><b>Definition:</b> <a href="generic_8hpp_source.html#l00050">generic.hpp:50</a></div></div>
<div class="ttc" id="asin_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/numeric/math/sin.html">std::sin</a></div><div class="ttdeci">T sin(T... args)</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a30f913e8e5d720cd00adab9af4276ace"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a30f913e8e5d720cd00adab9af4276ace">&#9670;&nbsp;</a></span>getRadiusFromRings()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double pntToPnt::getRadiusFromRings </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmolSys_1_1PointCloud.html">molSys::PointCloud</a>&lt; <a class="el" href="structmolSys_1_1Point.html">molSys::Point</a>&lt; double &gt;, double &gt; *&#160;</td>
          <td class="paramname"><em>yCloud</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt;&#160;</td>
          <td class="paramname"><em>basal1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt;&#160;</td>
          <td class="paramname"><em>basal2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Calculate the average radial distance for the basal rings, calculated from the centroid of each basal ring </p>

<p class="definition">Definition at line <a class="el" href="pntCorrespondence_8cpp_source.html#l00107">107</a> of file <a class="el" href="pntCorrespondence_8cpp_source.html">pntCorrespondence.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;                                                  {</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  <span class="keywordtype">double</span> avgRadius = 0.0;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;double&gt;</a> centroid1, centroid2;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;double&gt;</a> dist;     <span class="comment">// Distances</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  <span class="keywordtype">int</span> ringSize = basal1.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/size.html">size</a>(); <span class="comment">// Number of nodes in the basal rings</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  <span class="keywordtype">double</span> r1, r2;                <span class="comment">// Distance from the centroid</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  <span class="keywordtype">int</span> iatom; <span class="comment">// Atom index in yCloud for the current point in basal1</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  <span class="keywordtype">int</span> jatom; <span class="comment">// Atom index in yCloud for the current point in basal2</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  <span class="comment">// -----------------------</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;  <span class="comment">// Calculate the centroid for basal1 and basal2</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  centroid1.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/resize.html">resize</a>(3);</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;  centroid2.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/resize.html">resize</a>(3); <span class="comment">// init</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  <span class="comment">// Loop through basal1 and basal2</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; ringSize; i++) {</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <span class="comment">// For basal1</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    centroid1[0] += yCloud-&gt;<a class="code" href="group__molSys.html#ga67ab89369cd26572878a91afd521ef81">pts</a>[basal1[i]].x;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    centroid1[1] += yCloud-&gt;<a class="code" href="group__molSys.html#ga67ab89369cd26572878a91afd521ef81">pts</a>[basal1[i]].y;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    centroid1[2] += yCloud-&gt;<a class="code" href="group__molSys.html#ga67ab89369cd26572878a91afd521ef81">pts</a>[basal1[i]].z;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <span class="comment">// For basal2</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    centroid2[0] += yCloud-&gt;<a class="code" href="group__molSys.html#ga67ab89369cd26572878a91afd521ef81">pts</a>[basal2[i]].x;</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    centroid2[1] += yCloud-&gt;<a class="code" href="group__molSys.html#ga67ab89369cd26572878a91afd521ef81">pts</a>[basal2[i]].y;</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    centroid2[2] += yCloud-&gt;<a class="code" href="group__molSys.html#ga67ab89369cd26572878a91afd521ef81">pts</a>[basal2[i]].z;</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;  } <span class="comment">// end of loop through basal1 and basal2</span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;  <span class="comment">// Normalize by the number of nodes</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; 3; k++) {</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    centroid1[k] /= ringSize;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    centroid2[k] /= ringSize;</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;  } <span class="comment">// end of dividing by the number</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;  <span class="comment">// Calculated the centroid for basal1 and basal2!</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  <span class="comment">// -----------------------</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  <span class="comment">// Calculate the distances of each point from the respective centroid</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; ringSize; i++) {</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    <span class="comment">// Get the current point in basal1 and basal2</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    iatom = basal1[i];</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    jatom = basal2[i];</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    <span class="comment">// Get the distance from the respective centroid</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <span class="comment">// basal1</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    r1 = <a class="code" href="group__gen.html#ga90ce25cc971287af30df06c6f93cbe01">gen::unWrappedDistFromPoint</a>(yCloud, iatom, centroid1);</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    <span class="comment">// basal2</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    r2 = <a class="code" href="group__gen.html#ga90ce25cc971287af30df06c6f93cbe01">gen::unWrappedDistFromPoint</a>(yCloud, jatom, centroid2);</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    <span class="comment">// Update the distances</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    dist.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/push_back.html">push_back</a>(r1);</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    dist.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/push_back.html">push_back</a>(r2);</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;  } <span class="comment">// Loop through every point in basal1 and basal2</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;  <span class="comment">// -----------------------</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  <span class="comment">// Calculate the average, excluding the outliers</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;  avgRadius = <a class="code" href="group__gen.html#gaf3593d4e71600e8d85fbd873fcd95558">gen::getAverageWithoutOutliers</a>(dist);</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;  <span class="comment">// -----------------------</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;  <span class="keywordflow">return</span> avgRadius;</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;} <span class="comment">// end of function</span></div>
<div class="ttc" id="agroup__gen_html_ga90ce25cc971287af30df06c6f93cbe01"><div class="ttname"><a href="group__gen.html#ga90ce25cc971287af30df06c6f93cbe01">gen::unWrappedDistFromPoint</a></div><div class="ttdeci">double unWrappedDistFromPoint(molSys::PointCloud&lt; molSys::Point&lt; double &gt;, double &gt; *yCloud, int iatom, std::vector&lt; double &gt; singlePoint)</div><div class="ttdef"><b>Definition:</b> <a href="generic_8hpp_source.html#l00134">generic.hpp:134</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a804eb495f58fd5868858cc46480c3425"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a804eb495f58fd5868858cc46480c3425">&#9670;&nbsp;</a></span>relOrderDDC()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt; pntToPnt::relOrderDDC </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; <a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt;&gt;&#160;</td>
          <td class="paramname"><em>rings</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; <a class="el" href="structcage_1_1Cage.html">cage::Cage</a> &gt;&#160;</td>
          <td class="paramname"><em>cageList</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Matches the order of the basal rings of an DDC or a potential HC. </p>
<p>Reorders the particles of a DDC into a vector, which contains the atom indices of the DDC particles. Here, index is the index in the cageList vector of structs, referring to a specific DDC. The order created is as follows:</p><ol type="1">
<li>The first 6 atoms are the atoms of the equatorial ring, such that adjacent particles are bonded to each other (l1, l2, l3, l4, l5, l6).</li>
<li>The particles (l1, l3, l5) and (l2, l4, l6) are nearest neighbours of atoms in two different sets of peripheral rings. Each set of three peripheral rings have a second-shell neighbour of the equatorial ring particles (called apex1 and apex2 respectively.)</li>
<li>The order is such that the next three atoms in the vector are the first nearest neighbours in the peripheral rings of one triplet (peripheral1), followed by apex1, and three nearest neighbours of the other triplet, followed by apex2. Basically: ((6 equatorial ring atoms), (3 nearest neighbours of [l1,l3,l5] in the peripheral rings), (1 second shell neighbour of [l1,l3,l5]), (first nearest neighbours of [l2,l4,l6]), (second nearest neighbour of [l2,l4,l6]) )</li>
</ol>
<p>Thus, when you want to change the order of the DDC, this is how the order should be wrapped:</p><ol type="1">
<li>The first 6 atoms should be wrapped around (i.e. the sixth atom should become the first and so on)</li>
<li>The next 3 atoms should be wrapped but only when moved by multiples of 2.</li>
<li>The 9th element should not be changed.</li>
<li>The next three elements should be wrapped around (multiples of 2), since alternate elements of the equatorial ring are bonded. </li>
</ol>

<p class="definition">Definition at line <a class="el" href="pntCorrespondence_8cpp_source.html#l00841">841</a> of file <a class="el" href="pntCorrespondence_8cpp_source.html">pntCorrespondence.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;                                                                     {</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a> ddcOrder; <span class="comment">// Order of the particles in the DDC.</span></div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;  <span class="keywordtype">int</span> nop = 14;              <span class="comment">// Number of elements in the DDC</span></div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;  <span class="keywordtype">int</span> ringSize = 6;          <span class="comment">// Number of nodes in each ring</span></div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;  <span class="keywordtype">int</span> iring, jring;          <span class="comment">// Ring indices of the DDC rings</span></div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;  <span class="keywordtype">int</span> iatom;                 <span class="comment">// Atom index in the equatorial ring</span></div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a> peripheral1, peripheral2; <span class="comment">// Vectors holding the neighbours</span></div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;                                             <span class="comment">// of (l1,l3,l5) and (l2,l4,l6)</span></div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;  <span class="keywordtype">int</span> apex1, apex2;</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;  <span class="keywordtype">bool</span> neighbourFound;            <span class="comment">// Neighbour found</span></div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;  <span class="keywordtype">int</span> nextI, prevI, nextJ, prevJ; <span class="comment">// elements around iatom and jatom</span></div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;  <span class="keywordtype">int</span> jatomIndex, atomIndex;</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160; </div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;  <span class="comment">// Add the equatorial ring particles</span></div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;  iring = cageList[index]</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;              .rings[0]; <span class="comment">// Equatorial ring index in rings vector of vectors</span></div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;  <span class="comment">// Loop through all the atoms of the equatorial ring</span></div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; ringSize; i++) {</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;    ddcOrder.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/push_back.html">push_back</a>(rings[iring][i]);</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;  } <span class="comment">// end of adding equatorial ring particles</span></div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;  <span class="comment">// ------------------------------</span></div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;  <span class="comment">// Find the neighbouring atoms of (l1, l3 and l5) and (l2,l4,l6) by looping</span></div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;  <span class="comment">// through the peripheral rings</span></div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; ringSize; i++) {</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;    <span class="comment">// Init</span></div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;    iatom = ddcOrder[i]; <span class="comment">// element of the equatorial ring</span></div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;    <span class="comment">// Get the next and previous elements of iatom</span></div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;    <span class="comment">// next element</span></div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;    <span class="keywordflow">if</span> (i == ringSize - 1) {</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;      nextI = ddcOrder[0];</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;      prevI = ddcOrder[i - 1];</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;    } <span class="comment">// if last element</span></div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (i == 0) {</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;      nextI = ddcOrder[i + 1];</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;      prevI = ddcOrder[5]; <span class="comment">// wrapped</span></div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;      nextI = ddcOrder[i + 1];</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;      prevI = ddcOrder[i - 1];</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;    }</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;    <span class="comment">// ------------------</span></div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;    <span class="comment">// Search all the peripheral rings for iatom, get the nearest neighbours and</span></div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;    <span class="comment">// apex1 and apex2, which are bonded to the nearest neighbours of the</span></div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;    <span class="comment">// equatorial ring (thus they are second nearest neighbours)</span></div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 1; j &lt;= ringSize; j++) {</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;      <span class="comment">//</span></div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;      jring = cageList[index].rings[j]; <span class="comment">// Peripheral ring</span></div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;      <span class="comment">// Search for iatom</span></div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;      <span class="comment">//</span></div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;      <span class="keyword">auto</span> it = <a class="codeRef" href="http://en.cppreference.com/w/cpp/algorithm/find.html">std::find</a>(rings[jring].<a class="codeRef" href="http://en.cppreference.com/w/cpp/iterator/begin.html">begin</a>(), rings[jring].<a class="codeRef" href="http://en.cppreference.com/w/cpp/iterator/end.html">end</a>(), iatom);</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;      <span class="comment">// If iatom was found in jring peripheral ring</span></div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;      <span class="keywordflow">if</span> (it != rings[jring].<a class="codeRef" href="http://en.cppreference.com/w/cpp/iterator/end.html">end</a>()) {</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;        <span class="comment">// ----------------</span></div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;        <span class="comment">// Atom index for iatom found</span></div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;        jatomIndex = <a class="codeRef" href="http://en.cppreference.com/w/cpp/iterator/distance.html">std::distance</a>(rings[jring].<a class="codeRef" href="http://en.cppreference.com/w/cpp/iterator/begin.html">begin</a>(), it);</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;        <span class="comment">// ----------------</span></div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;        <span class="comment">// Get the next and previous element</span></div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;        <span class="comment">// Next atom</span></div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;        atomIndex = jatomIndex + 1;</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;        <span class="comment">// wrap-around</span></div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;        <span class="keywordflow">if</span> (atomIndex &gt;= ringSize) {</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;          atomIndex -= ringSize;</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;        } <span class="comment">// end of wrap-around</span></div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;        nextJ = rings[jring][atomIndex];</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;        <span class="comment">// Previous atom</span></div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;        atomIndex = jatomIndex - 1;</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;        <span class="keywordflow">if</span> (atomIndex &lt; 0) {</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;          atomIndex += ringSize;</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;        } <span class="comment">// end of wrap-around</span></div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;        prevJ = rings[jring][atomIndex];</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;        <span class="comment">// ----------------</span></div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;        <span class="comment">// Check to see if nextJ or prevJ are different from nextI and prevI</span></div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;        <span class="comment">// Checking prevJ</span></div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;        <span class="keywordflow">if</span> (prevJ != nextI &amp;&amp; prevJ != prevI) {</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;          <span class="comment">// Add to the vector</span></div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;          <span class="comment">// if even peripheral1</span></div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;          <span class="keywordflow">if</span> (i % 2 == 0) {</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;            peripheral1.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/push_back.html">push_back</a>(prevJ);</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;            <span class="comment">// Get apex1 for i=0</span></div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;            <span class="keywordflow">if</span> (i == 0) {</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;              <span class="comment">// Go back two elements from jatomIndex</span></div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;              atomIndex = jatomIndex - 2;</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;              <span class="comment">// wrap-around</span></div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;              <span class="keywordflow">if</span> (atomIndex &lt; 0) {</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;                atomIndex += ringSize;</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;              } <span class="comment">// end of wrap-around</span></div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;              apex1 = rings[jring][atomIndex];</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;            } <span class="comment">// apex1 for i=0</span></div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;          }   <span class="comment">// peripheral1</span></div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;          <span class="comment">// if odd peripheral2</span></div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;          <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;            peripheral2.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/push_back.html">push_back</a>(prevJ);</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;            <span class="comment">// Get apex2 for i=0</span></div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;            <span class="keywordflow">if</span> (i == 1) {</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;              <span class="comment">// Go back two elements from jatomIndex</span></div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;              atomIndex = jatomIndex - 2;</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;              <span class="comment">// wrap-around</span></div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;              <span class="keywordflow">if</span> (atomIndex &lt; 0) {</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;                atomIndex += ringSize;</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;              } <span class="comment">// end of wrap-around</span></div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;              apex2 = rings[jring][atomIndex];</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;            } <span class="comment">// apex2 for i=1</span></div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;          }   <span class="comment">// peripheral 2</span></div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;          <span class="comment">// Get apex1 or apex2 for i=0 or i=1</span></div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;        } <span class="comment">// check if prevJ is the atom to be added, bonded to iatom</span></div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;        <span class="comment">// ----------------------</span></div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;        <span class="comment">// Checking nextJ</span></div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;        <span class="keywordflow">if</span> (nextJ != nextI &amp;&amp; nextJ != prevI) {</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;          <span class="comment">// Add to the vector</span></div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;          <span class="comment">// if even peripheral1</span></div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;          <span class="keywordflow">if</span> (i % 2 == 0) {</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;            peripheral1.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/push_back.html">push_back</a>(nextJ);</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;            <span class="comment">// Get apex1 for i=0</span></div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;            <span class="keywordflow">if</span> (i == 0) {</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;              <span class="comment">// Go foward two elements from jatomIndex</span></div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;              atomIndex = jatomIndex + 2;</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;              <span class="comment">// wrap-around</span></div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;              <span class="keywordflow">if</span> (atomIndex &gt;= ringSize) {</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;                atomIndex -= ringSize;</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;              } <span class="comment">// end of wrap-around</span></div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;              apex1 = rings[jring][atomIndex];</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;            } <span class="comment">// apex1 for i=0</span></div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;          }   <span class="comment">// peripheral1</span></div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;          <span class="comment">// if odd peripheral2</span></div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;          <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;            peripheral2.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/push_back.html">push_back</a>(prevJ);</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;            <span class="comment">// Get apex2 for i=0</span></div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;            <span class="keywordflow">if</span> (i == 1) {</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;              <span class="comment">// Go foward two elements from jatomIndex</span></div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;              atomIndex = jatomIndex + 2;</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;              <span class="comment">// wrap-around</span></div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;              <span class="keywordflow">if</span> (atomIndex &gt;= ringSize) {</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;                atomIndex -= ringSize;</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;              } <span class="comment">// end of wrap-around</span></div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;              apex2 = rings[jring][atomIndex];</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;            } <span class="comment">// apex2 for i=1</span></div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;          }   <span class="comment">// peripheral 2</span></div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;          <span class="comment">// Get apex1 or apex2 for i=0 or i=1</span></div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;        } <span class="comment">// check if prevJ is the atom to be added, bonded to iatom</span></div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;        <span class="comment">// ----------------</span></div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;      } <span class="comment">// end of check for iatom in jring</span></div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;    }   <span class="comment">// end of search for the peripheral rings</span></div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;    <span class="comment">// ------------------</span></div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;  } <span class="comment">// end of looping through the elements of the equatorial ring</span></div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;  <span class="comment">// ------------------------------</span></div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;  <span class="comment">// Update ddcOrder with peripheral1, followed by apex1, peripheral2 and apex2</span></div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;  <span class="comment">// peripheral1</span></div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; peripheral1.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/size.html">size</a>(); i++) {</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;    ddcOrder.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/push_back.html">push_back</a>(peripheral1[i]);</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;  } <span class="comment">// end of adding peripheral1</span></div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;  <span class="comment">// apex1</span></div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;  ddcOrder.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/push_back.html">push_back</a>(apex1);</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;  <span class="comment">// peripheral2</span></div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; peripheral2.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/size.html">size</a>(); i++) {</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;    ddcOrder.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/push_back.html">push_back</a>(peripheral2[i]);</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;  } <span class="comment">// end of adding peripheral2</span></div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;  <span class="comment">// apex2</span></div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;  ddcOrder.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/push_back.html">push_back</a>(apex2);</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;  <span class="keywordflow">return</span> ddcOrder;</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;} <span class="comment">// end of the function</span></div>
<div class="ttc" id="abegin_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/iterator/begin.html">std::begin</a></div><div class="ttdeci">T begin(T... args)</div></div>
<div class="ttc" id="adistance_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/iterator/distance.html">std::distance</a></div><div class="ttdeci">T distance(T... args)</div></div>
<div class="ttc" id="aend_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/iterator/end.html">std::end</a></div><div class="ttdeci">T end(T... args)</div></div>
<div class="ttc" id="afind_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/algorithm/find.html">std::find</a></div><div class="ttdeci">T find(T... args)</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a8140eb2ad1dfb9d08e4e917dd14d5424"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8140eb2ad1dfb9d08e4e917dd14d5424">&#9670;&nbsp;</a></span>relOrderHC()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int pntToPnt::relOrderHC </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmolSys_1_1PointCloud.html">molSys::PointCloud</a>&lt; <a class="el" href="structmolSys_1_1Point.html">molSys::Point</a>&lt; double &gt;, double &gt; *&#160;</td>
          <td class="paramname"><em>yCloud</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt;&#160;</td>
          <td class="paramname"><em>basal1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt;&#160;</td>
          <td class="paramname"><em>basal2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; <a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt;&gt;&#160;</td>
          <td class="paramname"><em>nList</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt; *&#160;</td>
          <td class="paramname"><em>matchedBasal1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt; *&#160;</td>
          <td class="paramname"><em>matchedBasal2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Matches the order of the basal rings of an HC or a potential HC. </p>
<p>Matches the order of the basal rings of an HC or a potential HC. The goal is to find which elements are bonded to which and the relative order </p>

<p class="definition">Definition at line <a class="el" href="pntCorrespondence_8cpp_source.html#l00605">605</a> of file <a class="el" href="pntCorrespondence_8cpp_source.html">pntCorrespondence.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;                                   {</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;  <span class="keywordtype">int</span> l1 = basal1[0];           <span class="comment">// First element of basal1</span></div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;  <span class="keywordtype">int</span> l2 = basal1[1];           <span class="comment">// Second element of basal1</span></div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;  <span class="keywordtype">int</span> ringSize = basal1.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/size.html">size</a>(); <span class="comment">// Number of nodes in the basal rings</span></div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;  <span class="keywordtype">bool</span> neighOne, neighTwo;      <span class="comment">// Basal2 element is the neighbour of l1 or l2</span></div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;  <span class="keywordtype">bool</span> neighbourFound;          <span class="comment">// neighbour found</span></div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;  <span class="keywordtype">int</span> m_k;               <span class="comment">// Element of basal2 which is a neighbour of l1 or l2</span></div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;  <span class="keywordtype">int</span> m_kIndex;          <span class="comment">// Index of basal2 which is a neighbour of l1 or l2</span></div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;  <span class="keywordtype">int</span> iatom;             <span class="comment">// Current element of basal2 being searched for</span></div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;  <span class="keywordtype">int</span> nextBasal1Element; <span class="comment">// Next bonded element of basal1</span></div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;  <span class="keywordtype">int</span> nextBasal2Element; <span class="comment">// Next bonded element of basal2</span></div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;  <span class="keywordtype">bool</span> isReversedOrder;  <span class="comment">// basal2 is reversed wrt basal1</span></div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;  <span class="keywordtype">int</span> index;</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160; </div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;  (*matchedBasal1).resize(ringSize);</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;  (*matchedBasal2).resize(ringSize);</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160; </div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;  <span class="comment">// Search to see if l1 or l2 is a neighbour</span></div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;  <span class="comment">// -------------------</span></div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;  <span class="comment">// Searching for the neighbours of l1 or l2</span></div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; ringSize; i++) {</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;    iatom = basal2[i]; <span class="comment">// Element of basal2</span></div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;    <span class="comment">// Search for the current element in the neighbour list of l1</span></div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;    <span class="keyword">auto</span> it = <a class="codeRef" href="http://en.cppreference.com/w/cpp/algorithm/find.html">std::find</a>(nList[l1].<a class="codeRef" href="http://en.cppreference.com/w/cpp/iterator/begin.html">begin</a>() + 1, nList[l1].<a class="codeRef" href="http://en.cppreference.com/w/cpp/iterator/end.html">end</a>(), iatom);</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;    <span class="comment">// If iatom is the neighbour of l1</span></div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;    <span class="keywordflow">if</span> (it != nList[l1].<a class="codeRef" href="http://en.cppreference.com/w/cpp/iterator/end.html">end</a>()) {</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;      neighbourFound = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;      neighOne = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;      m_k = iatom;  <span class="comment">// Element found</span></div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;      m_kIndex = i; <span class="comment">// Index in basal2</span></div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;      nextBasal1Element = basal1[2];</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;    } <span class="comment">// iatom is the neighbour of l1</span></div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;    <span class="comment">// l2 neighbour check</span></div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;      <span class="keyword">auto</span> it1 = <a class="codeRef" href="http://en.cppreference.com/w/cpp/algorithm/find.html">std::find</a>(nList[l2].<a class="codeRef" href="http://en.cppreference.com/w/cpp/iterator/begin.html">begin</a>() + 1, nList[l2].<a class="codeRef" href="http://en.cppreference.com/w/cpp/iterator/end.html">end</a>(), iatom);</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;      <span class="comment">// If iatom is the neighbour of l2</span></div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;      <span class="keywordflow">if</span> (it1 != nList[l2].<a class="codeRef" href="http://en.cppreference.com/w/cpp/iterator/end.html">end</a>()) {</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;        neighbourFound = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;        neighOne = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;        neighTwo = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;        nextBasal1Element = basal1[3];</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;        m_k = iatom;  <span class="comment">// Element found</span></div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;        m_kIndex = i; <span class="comment">// Index in basal2</span></div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;      } <span class="comment">// iatom is the neighbour of l2</span></div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;    }   <span class="comment">// Check for the neighbour of l2</span></div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;  }     <span class="comment">// end of search through basal2 elements</span></div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;  <span class="comment">// -------------------</span></div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;  <span class="comment">// If a neighbour was not found, then there is some mistake</span></div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;  <span class="keywordflow">if</span> (!neighbourFound) {</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;    <span class="comment">// std::cerr &lt;&lt; &quot;This is not an HC\n&quot;;</span></div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;    <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;  }</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160; </div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;  <span class="comment">// ------------------------------</span></div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;  <span class="comment">// This element should be the nearest neighbour of the corresponding element</span></div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;  <span class="comment">// in basal2</span></div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;  <span class="comment">// Testing the original order</span></div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;  index = m_kIndex + 2;</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;  <span class="comment">// wrap-around</span></div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;  <span class="keywordflow">if</span> (index &gt;= ringSize) {</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;    index -= ringSize;</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;  } <span class="comment">// wrap-around</span></div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;  nextBasal2Element = basal2[index];</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;  <span class="comment">// Search for the next basal element</span></div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;  <span class="keyword">auto</span> it = <a class="codeRef" href="http://en.cppreference.com/w/cpp/algorithm/find.html">std::find</a>(nList[nextBasal1Element].<a class="codeRef" href="http://en.cppreference.com/w/cpp/iterator/begin.html">begin</a>() + 1,</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;                      nList[nextBasal1Element].<a class="codeRef" href="http://en.cppreference.com/w/cpp/iterator/end.html">end</a>(), nextBasal2Element);</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;  <span class="comment">// If this element is found, then the original order is correct</span></div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;  <span class="keywordflow">if</span> (it != nList[nextBasal1Element].<a class="codeRef" href="http://en.cppreference.com/w/cpp/iterator/end.html">end</a>()) {</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;    <span class="comment">// Fill up the temporary vector with basal2 elements</span></div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; ringSize; i++) {</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;      index = m_kIndex + i; <span class="comment">// index in basal2</span></div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;      <span class="comment">// wrap-around</span></div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;      <span class="keywordflow">if</span> (index &gt;= ringSize) {</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;        index -= ringSize;</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;      }                                    <span class="comment">// end of wrap-around</span></div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;      (*matchedBasal2)[i] = basal2[index]; <span class="comment">// fill up values</span></div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;    }                                      <span class="comment">// end of filling up tempBasal2</span></div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;  }                                        <span class="comment">// the original order is correct</span></div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;  <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;    index = m_kIndex - 2;</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;    <span class="comment">// wrap-around</span></div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;    <span class="keywordflow">if</span> (index &lt; 0) {</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;      index += ringSize;</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;    } <span class="comment">// wrap-around</span></div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;    nextBasal2Element = basal2[index];</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;    <span class="comment">// Search for the next basal element</span></div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;    <span class="keyword">auto</span> it = <a class="codeRef" href="http://en.cppreference.com/w/cpp/algorithm/find.html">std::find</a>(nList[nextBasal1Element].<a class="codeRef" href="http://en.cppreference.com/w/cpp/iterator/begin.html">begin</a>() + 1,</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;                        nList[nextBasal1Element].<a class="codeRef" href="http://en.cppreference.com/w/cpp/iterator/end.html">end</a>(), nextBasal2Element);</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;    <span class="comment">// If this element is found, then the original order is correct</span></div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;    <span class="keywordflow">if</span> (it != nList[nextBasal1Element].<a class="codeRef" href="http://en.cppreference.com/w/cpp/iterator/end.html">end</a>()) {</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;      <span class="comment">// Fill up the temporary vector with basal2 elements</span></div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; ringSize; i++) {</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;        index = m_kIndex - i; <span class="comment">// index in basal2</span></div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;        <span class="comment">// wrap-around</span></div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;        <span class="keywordflow">if</span> (index &lt; 0) {</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;          index += ringSize;</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;        }                                    <span class="comment">// end of wrap-around</span></div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;        (*matchedBasal2)[i] = basal2[index]; <span class="comment">// fill up values</span></div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;      }                                      <span class="comment">// end of filling up tempBasal2</span></div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160; </div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;    }</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;      <span class="comment">// std::cerr &lt;&lt; &quot;not an HC\n&quot;;</span></div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;      <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;    }</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;  } <span class="comment">// the reversed order is correct!</span></div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;  <span class="comment">// ------------------------------</span></div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;  <span class="comment">// Fill up basal1</span></div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;  (*matchedBasal1) = basal1;</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;  <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;} <span class="comment">// end of the function</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a45458315459b7adedcc33c685f58a330"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a45458315459b7adedcc33c685f58a330">&#9670;&nbsp;</a></span>relOrderPrismBlock() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int pntToPnt::relOrderPrismBlock </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmolSys_1_1PointCloud.html">molSys::PointCloud</a>&lt; <a class="el" href="structmolSys_1_1Point.html">molSys::Point</a>&lt; double &gt;, double &gt; *&#160;</td>
          <td class="paramname"><em>yCloud</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt;&#160;</td>
          <td class="paramname"><em>basal1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt;&#160;</td>
          <td class="paramname"><em>basal2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt; *&#160;</td>
          <td class="paramname"><em>outBasal1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt; *&#160;</td>
          <td class="paramname"><em>outBasal2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Get the relative ordering of a pair of basal rings for a deformed prism/perfect prism. Outputs a vector of vectors of indices, such that the first vector is for the first basal ring, and the second vector is for the second basal ring.</p>
<p>Get the relative ordering of a pair of basal rings for a deformed prism/perfect prism. Outputs a vector of vectors of indices, such that the first vector is for the first basal ring, and the second vector is for the second basal ring. The input neighbour list is with respect to indices, not IDs </p>

<p class="definition">Definition at line <a class="el" href="pntCorrespondence_8cpp_source.html#l00333">333</a> of file <a class="el" href="pntCorrespondence_8cpp_source.html">pntCorrespondence.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;                                                          {</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;  <span class="keywordtype">int</span> ringSize = basal1.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/size.html">size</a>(); <span class="comment">// Number of nodes in basal1 and basal2</span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;  <span class="keywordtype">int</span> nBonds;       <span class="comment">// Number of bonds between two parallel basal rings</span></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;  <span class="keywordtype">bool</span> isNeighbour; <span class="comment">// Bool for checking if two atoms are neighbours or not</span></div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;  <span class="keywordtype">int</span> l_k, m_k;     <span class="comment">// Elements in basal1 and basal2</span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;  <span class="keywordtype">bool</span> isClock, isAntiClock; <span class="comment">// Clockwise and anti-clockwise ordering of basal1</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;                             <span class="comment">// and basal2</span></div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;  <span class="keywordtype">int</span> iatom, jatom; <span class="comment">// Index in the ring to start from, for basal1 and basal2</span></div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;  <span class="keywordtype">int</span> currentIatom, currentJatom;</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;  <span class="comment">// ---------------</span></div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;  <span class="comment">// Find the nearest neighbours of basal1 elements in basal2</span></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;  nBonds = 0;</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;  <span class="keywordtype">double</span> infHugeNumber = 100000;</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;  <span class="keywordtype">double</span> leastDist = infHugeNumber;</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;  <span class="keywordtype">int</span> index = -1; <span class="comment">// starting index</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;  <span class="comment">// For the first element of basal1:</span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160; </div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;  l_k = basal1[0]; <span class="comment">// This is the atom particle C++ index</span></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160; </div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;  <span class="comment">// Search for the nearest neighbour of l_k in basal2</span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;  <span class="comment">// Loop through basal2 elements</span></div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> m = 0; m &lt; ringSize; m++) {</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    m_k = basal2[m]; <span class="comment">// Atom index to find in the neighbour list of iatom</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160; </div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    <span class="comment">// Calculate the distance</span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    <span class="keywordtype">double</span> dist = <a class="code" href="group__gen.html#ga881e045598dd517609383d8a3fec5913">gen::periodicDist</a>(yCloud, l_k, m_k);</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160; </div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    <span class="comment">// Update the least distance</span></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    <span class="keywordflow">if</span> (leastDist &gt; dist) {</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;      leastDist = dist; <span class="comment">// This is the new least distance</span></div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;      index = m;</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    } <span class="comment">// end of update of the least distance</span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160; </div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;  } <span class="comment">// found element</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160; </div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;  <span class="comment">// If the element has been found, for l1</span></div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;  <span class="keywordflow">if</span> (leastDist &lt; infHugeNumber) {</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    isNeighbour = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    iatom = 0;     <span class="comment">// index of basal1</span></div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    jatom = index; <span class="comment">// index of basal2</span></div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;  }                <span class="comment">// end of check</span></div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;  <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    <a class="codeRef" href="http://en.cppreference.com/w/cpp/io/basic_ostream.html">std::cerr</a> &lt;&lt; <span class="stringliteral">&quot;Something is wrong with your deformed prism.\n&quot;</span>;</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    <span class="comment">// Error handling</span></div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;  }</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;  <span class="comment">// ---------------------------------------------------</span></div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;  <span class="comment">// Find out if the order of basal2 is &#39;clockwise&#39; or &#39;anticlockwise&#39;</span></div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;  isClock = <span class="keyword">false</span>; <span class="comment">// init</span></div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;  isAntiClock = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160; </div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;  <span class="comment">// atom index in the ring</span></div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;  <span class="keywordtype">int</span> tempJfor, tempJback;</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160; </div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;  tempJfor = jatom + 1;</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;  tempJback = jatom - 1;</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160; </div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;  <span class="keywordflow">if</span> (jatom == ringSize - 1) {</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    tempJfor = 0;</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    tempJback = ringSize - 2;</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;  }</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;  <span class="keywordflow">if</span> (jatom == 0) {</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    tempJfor = 1;</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    tempJback = ringSize - 1;</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;  }</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160; </div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;  <span class="keywordtype">int</span> forwardJ = basal2[tempJfor];</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;  <span class="keywordtype">int</span> backwardJ = basal2[tempJback];</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;  <span class="keywordtype">int</span> currentI = basal1[iatom];</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160; </div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;  <span class="comment">// Check clockwise</span></div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;  <span class="keywordtype">double</span> distClock = <a class="code" href="group__gen.html#ga881e045598dd517609383d8a3fec5913">gen::periodicDist</a>(yCloud, currentI, forwardJ);</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;  <span class="keywordtype">double</span> distAntiClock = <a class="code" href="group__gen.html#ga881e045598dd517609383d8a3fec5913">gen::periodicDist</a>(yCloud, currentI, backwardJ);</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160; </div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;  <span class="comment">// Clockwise</span></div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;  <span class="keywordflow">if</span> (distClock &lt; distAntiClock) {</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    isClock = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;  } <span class="comment">// end of clockwise check</span></div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;  <span class="comment">// Anti-clockwise</span></div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;  <span class="keywordflow">if</span> (distAntiClock &lt; distClock) {</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    isAntiClock = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;  } <span class="comment">// end of anti-clockwise check</span></div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;  <span class="comment">// Some error</span></div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;  <span class="keywordflow">if</span> (isClock == <span class="keyword">false</span> &amp;&amp; isAntiClock == <span class="keyword">false</span>) {</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    <span class="comment">// std::cerr &lt;&lt; &quot;The points are equidistant.\n&quot;;</span></div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    <span class="comment">// Error handling</span></div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;  } <span class="comment">// end of error handling</span></div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;  <span class="comment">// ---------------------------------------------------</span></div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;  <span class="comment">// Get the order of basal1 and basal2</span></div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; ringSize; i++) {</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    currentIatom = iatom + i;</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    <span class="keywordflow">if</span> (currentIatom &gt;= ringSize) {</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;      currentIatom -= ringSize;</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    } <span class="comment">// end of basal1 element wrap-around</span></div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160; </div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    <span class="comment">// In clockwise order</span></div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    <span class="keywordflow">if</span> (isClock) {</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;      currentJatom = jatom + i;</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;      <span class="keywordflow">if</span> (currentJatom &gt;= ringSize) {</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;        currentJatom -= ringSize;</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;      } <span class="comment">// wrap around</span></div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    }   <span class="comment">// end of clockwise update</span></div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;      currentJatom = jatom - i;</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;      <span class="keywordflow">if</span> (currentJatom &lt; 0) {</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;        currentJatom += ringSize;</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;      } <span class="comment">// wrap around</span></div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;    }   <span class="comment">// end of anti-clockwise update</span></div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160; </div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    <span class="comment">// Add to outBasal1 and outBasal2 now</span></div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    (*outBasal1).push_back(basal1[currentIatom]);</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;    (*outBasal2).push_back(basal2[currentJatom]);</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;  } <span class="comment">//</span></div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160; </div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;  <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;} <span class="comment">// end of function</span></div>
<div class="ttc" id="abasic_ostream_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/io/basic_ostream.html">std::cerr</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a9e26156fea9f39958302a4c95d00797e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9e26156fea9f39958302a4c95d00797e">&#9670;&nbsp;</a></span>relOrderPrismBlock() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int pntToPnt::relOrderPrismBlock </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmolSys_1_1PointCloud.html">molSys::PointCloud</a>&lt; <a class="el" href="structmolSys_1_1Point.html">molSys::Point</a>&lt; double &gt;, double &gt; *&#160;</td>
          <td class="paramname"><em>yCloud</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt;&#160;</td>
          <td class="paramname"><em>basal1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt;&#160;</td>
          <td class="paramname"><em>basal2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; <a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt;&gt;&#160;</td>
          <td class="paramname"><em>nList</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt; *&#160;</td>
          <td class="paramname"><em>outBasal1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt; *&#160;</td>
          <td class="paramname"><em>outBasal2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Get the relative ordering of a pair of basal rings for a deformed prism/perfect prism. Outputs a vector of vectors of indices, such that the first vector is for the first basal ring, and the second vector is for the second basal ring. The input neighbour list is with respect to indices, not IDs </p>

<p class="definition">Definition at line <a class="el" href="pntCorrespondence_8cpp_source.html#l00203">203</a> of file <a class="el" href="pntCorrespondence_8cpp_source.html">pntCorrespondence.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;                               {</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;  <span class="keywordtype">int</span> ringSize = basal1.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/size.html">size</a>(); <span class="comment">// Number of nodes in basal1 and basal2</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;  <span class="keywordtype">int</span> nBonds;       <span class="comment">// Number of bonds between two parallel basal rings</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;  <span class="keywordtype">bool</span> isNeighbour; <span class="comment">// Bool for checking if two atoms are neighbours or not</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;  <span class="keywordtype">int</span> l_k, m_k;     <span class="comment">// Elements in basal1 and basal2</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;  <span class="keywordtype">bool</span> isClock, isAntiClock; <span class="comment">// Clockwise and anti-clockwise ordering of basal1</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;                             <span class="comment">// and basal2</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;  <span class="keywordtype">int</span> iatom, jatom; <span class="comment">// Index in the ring to start from, for basal1 and basal2</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;  <span class="keywordtype">int</span> currentIatom, currentJatom;</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;  <span class="comment">// ---------------</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;  <span class="comment">// Find the nearest neighbours of basal1 elements in basal2</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;  nBonds = 0;</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;  isNeighbour = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;  <span class="comment">// Loop through every element of basal1</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> l = 0; l &lt; ringSize; l++) {</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    l_k = basal1[l]; <span class="comment">// This is the atom particle C++ index</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160; </div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    <span class="comment">// Search for the nearest neighbour of l_k in basal2</span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    <span class="comment">// Loop through basal2 elements</span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> m = 0; m &lt; ringSize; m++) {</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;      m_k = basal2[m]; <span class="comment">// Atom index to find in the neighbour list of iatom</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160; </div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;      <span class="comment">// Find m_k inside l_k neighbour list</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;      <span class="keyword">auto</span> it = <a class="codeRef" href="http://en.cppreference.com/w/cpp/algorithm/find.html">std::find</a>(nList[l_k].<a class="codeRef" href="http://en.cppreference.com/w/cpp/iterator/begin.html">begin</a>() + 1, nList[l_k].<a class="codeRef" href="http://en.cppreference.com/w/cpp/iterator/end.html">end</a>(), m_k);</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160; </div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;      <span class="comment">// If the element has been found, for l1</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;      <span class="keywordflow">if</span> (it != nList[l_k].<a class="codeRef" href="http://en.cppreference.com/w/cpp/iterator/end.html">end</a>()) {</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;        isNeighbour = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;        iatom = l; <span class="comment">// index of basal1</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;        jatom = m; <span class="comment">// index of basal2</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;      } <span class="comment">// found element</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160; </div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    } <span class="comment">// end of loop through all atomIDs in basal2</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160; </div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    <span class="keywordflow">if</span> (isNeighbour) {</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    } <span class="comment">// nearest neighbour found</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;  }   <span class="comment">// end of loop through all the atomIDs in basal1</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160; </div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;  <span class="keywordflow">if</span> (!isNeighbour) {</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    <a class="codeRef" href="http://en.cppreference.com/w/cpp/io/basic_ostream.html">std::cerr</a> &lt;&lt; <span class="stringliteral">&quot;Something is wrong with your deformed prism.\n&quot;</span>;</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    <span class="comment">// Error handling</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;  }</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;  <span class="comment">// ---------------------------------------------------</span></div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;  <span class="comment">// Find out if the order of basal2 is &#39;clockwise&#39; or &#39;anticlockwise&#39;</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;  isClock = <span class="keyword">false</span>; <span class="comment">// init</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;  isAntiClock = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160; </div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;  <span class="comment">// atom index in the ring</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;  <span class="keywordtype">int</span> tempJfor, tempJback;</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160; </div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;  tempJfor = jatom + 1;</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;  tempJback = jatom - 1;</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160; </div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;  <span class="keywordflow">if</span> (jatom == ringSize - 1) {</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    tempJfor = 0;</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    tempJback = ringSize - 2;</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;  }</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;  <span class="keywordflow">if</span> (jatom == 0) {</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    tempJfor = 1;</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    tempJback = ringSize - 1;</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;  }</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160; </div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;  <span class="keywordtype">int</span> forwardJ = basal2[tempJfor];</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;  <span class="keywordtype">int</span> backwardJ = basal2[tempJback];</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;  <span class="keywordtype">int</span> currentI = basal1[iatom];</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160; </div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;  <span class="comment">// Check clockwise</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;  <span class="keywordtype">double</span> distClock = <a class="code" href="group__gen.html#ga881e045598dd517609383d8a3fec5913">gen::periodicDist</a>(yCloud, currentI, forwardJ);</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;  <span class="keywordtype">double</span> distAntiClock = <a class="code" href="group__gen.html#ga881e045598dd517609383d8a3fec5913">gen::periodicDist</a>(yCloud, currentI, backwardJ);</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160; </div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;  <span class="comment">// Clockwise</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;  <span class="keywordflow">if</span> (distClock &lt; distAntiClock) {</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    isClock = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;  } <span class="comment">// end of clockwise check</span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;  <span class="comment">// Anti-clockwise</span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;  <span class="keywordflow">if</span> (distAntiClock &lt; distClock) {</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    isAntiClock = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;  } <span class="comment">// end of anti-clockwise check</span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;  <span class="comment">// Some error</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;  <span class="keywordflow">if</span> (isClock == <span class="keyword">false</span> &amp;&amp; isAntiClock == <span class="keyword">false</span>) {</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    <span class="comment">// std::cerr &lt;&lt; &quot;The points are equidistant.\n&quot;;</span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    <span class="comment">// Error handling</span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;  } <span class="comment">// end of error handling</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;  <span class="comment">// ---------------------------------------------------</span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;  <span class="comment">// Get the order of basal1 and basal2</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; ringSize; i++) {</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    currentIatom = iatom + i;</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    <span class="keywordflow">if</span> (currentIatom &gt;= ringSize) {</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;      currentIatom -= ringSize;</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    } <span class="comment">// end of basal1 element wrap-around</span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160; </div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    <span class="comment">// In clockwise order</span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    <span class="keywordflow">if</span> (isClock) {</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;      currentJatom = jatom + i;</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;      <span class="keywordflow">if</span> (currentJatom &gt;= ringSize) {</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;        currentJatom -= ringSize;</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;      } <span class="comment">// wrap around</span></div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    }   <span class="comment">// end of clockwise update</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;      currentJatom = jatom - i;</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;      <span class="keywordflow">if</span> (currentJatom &lt; 0) {</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;        currentJatom += ringSize;</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;      } <span class="comment">// wrap around</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    }   <span class="comment">// end of anti-clockwise update</span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160; </div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    <span class="comment">// Add to outBasal1 and outBasal2 now</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    (*outBasal1).push_back(basal1[currentIatom]);</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    (*outBasal2).push_back(basal2[currentJatom]);</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;  } <span class="comment">//</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160; </div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;  <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;} <span class="comment">// end of function</span></div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- Copyright 2020 Rohit Goswami <rog32@hi.is>
     Licensed under the Apache License, Version 2.0 (the "License");
     you may not use this file except in compliance with the License.
     You may obtain a copy of the License at
     http://www.apache.org/licenses/LICENSE-2.0
     Unless required by applicable law or agreed to in writing, software
     distributed under the License is distributed on an "AS IS" BASIS,
     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     See the License for the specific language governing permissions and
     limitations under the License. -->
<!-- HTML footer for doxygen 1.9.1-->
<!-- start footer part -->
<div class="footer">
<hr class="footline"/><address class="footline"><small>
    Generated by&#160;<a href="https://www.doxygen.org/index.html">Doxygen 1.9.1</a> and the <a class="outlink" href="https://github.com/HaoZeke/doxyYoda">doxyYoda theme</a>
</small></address>
</div>
</div>
</body>
</html>
