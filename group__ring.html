<!-- Copyright 2020 Rohit Goswami <rog32@hi.is>
     Licensed under the Apache License, Version 2.0 (the "License");
     you may not use this file except in compliance with the License.
     You may obtain a copy of the License at
     http://www.apache.org/licenses/LICENSE-2.0
     Unless required by applicable law or agreed to in writing, software
     distributed under the License is distributed on an "AS IS" BASIS,
     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     See the License for the specific language governing permissions and
     limitations under the License. -->
<!-- HTML header for doxygen 1.9.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>d-SEAMS: Ring</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script>
MathJax = {
  tex: {
    inlineMath: [['$', '$'], ['\\(', '\\)']]
  },
  svg: {
    fontCache: 'global'
  }
  loader: { load: ["[tex]/unicode", "[tex]/ams"] },
  tex: {
    packages: { "[+]": ["unicode", "ams"] },
    tags: "ams",
  },
};
</script>
<script type="text/javascript" id="MathJax-script" async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js">
</script>
<!-- <link href="doxygen.css" rel="stylesheet" type="text/css" /> -->
<link href="doxyYoda.min.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" >
$(document).ready(function() {
     $(".fragment").wrap("<details class='code-details'></details>");
     $(".code-details").append("<summary>Code</summary>");
 }
)
</script>
</head>
<body>
<div class="grid-contents">
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<nav class="title_area">
<a class="project_logo" href="#">
<img src="dSeamsLogo.png" width="30" height="30" alt="Logo">
</a>
<span class="project_info">d-SEAMS v1.0.0</span>
</nav>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#groups">Modules</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#enumval-members">Enumerator</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">Ring<div class="ingroups"><a class="el" href="group__gen.html">Gen</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Collaboration diagram for Ring:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><img src="group__ring.png" border="0" usemap="#agroup____ring" alt=""/></div>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="groups"></a>
Modules</h2></td></tr>
<tr class="memitem:group__prism3"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__prism3.html">Prism3</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:ga301cfdc88452cfe51bd4f745d223a7e1"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ring.html#ga301cfdc88452cfe51bd4f745d223a7e1">ring::strucType</a> { <br />
&#160;&#160;<a class="el" href="group__ring.html#gga301cfdc88452cfe51bd4f745d223a7e1a60cc60f3804efaf86af8c2c2fbbe7208">ring::unclassified</a>
, <a class="el" href="group__ring.html#gga301cfdc88452cfe51bd4f745d223a7e1a37a9bfe125a811135f6c77d832cef242">ring::DDC</a>
, <a class="el" href="group__ring.html#gga301cfdc88452cfe51bd4f745d223a7e1a48c3c5c40739122c0bf68fb9faeee9da">ring::HCbasal</a>
, <a class="el" href="group__ring.html#gga301cfdc88452cfe51bd4f745d223a7e1a66afb615d90d5df19cce1df68e24d7f2">ring::HCprismatic</a>
, <br />
&#160;&#160;<a class="el" href="group__ring.html#gga301cfdc88452cfe51bd4f745d223a7e1a074049f7a1a6ea8338d256f5b4e586a2">ring::bothBasal</a>
, <a class="el" href="group__ring.html#gga301cfdc88452cfe51bd4f745d223a7e1a6681861f6a3ec92005e0d5a0e4b7dfce">ring::bothPrismatic</a>
, <a class="el" href="group__ring.html#gga301cfdc88452cfe51bd4f745d223a7e1ac4295ff0a8263a65de0694cc0b20e9af">ring::Prism</a>
, <a class="el" href="group__ring.html#gga301cfdc88452cfe51bd4f745d223a7e1a499b694d8386eef89ba2f6e621ed7578">ring::deformedPrism</a>
, <br />
&#160;&#160;<a class="el" href="group__ring.html#gga301cfdc88452cfe51bd4f745d223a7e1aabd9a19704526f9be67c7dcd1c2b4af9">ring::mixedPrismRing</a>
<br />
 }</td></tr>
<tr class="separator:ga301cfdc88452cfe51bd4f745d223a7e1"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga4e4a17533b574451c585e3c839c6622a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ring.html#ga4e4a17533b574451c585e3c839c6622a">tum3::topoUnitMatchingBulk</a> (<a class="elRef" href="http://en.cppreference.com/w/cpp/string/basic_string.html">std::string</a> path, <a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; <a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt;&gt; rings, <a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; <a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt;&gt; nList, <a class="el" href="structmolSys_1_1PointCloud.html">molSys::PointCloud</a>&lt; <a class="el" href="structmolSys_1_1Point.html">molSys::Point</a>&lt; double &gt;, double &gt; *yCloud, int firstFrame, bool printClusters, bool onlyTetrahedral)</td></tr>
<tr class="separator:ga4e4a17533b574451c585e3c839c6622a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga0a321aab8c8956e0885826b65e550a1d"><td class="memItemLeft" align="right" valign="top">Eigen::MatrixXd&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ring.html#ga0a321aab8c8956e0885826b65e550a1d">tum3::buildRefHC</a> (<a class="elRef" href="http://en.cppreference.com/w/cpp/string/basic_string.html">std::string</a> fileName)</td></tr>
<tr class="memdesc:ga0a321aab8c8956e0885826b65e550a1d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Build a reference Hexagonal cage, reading in from a template XYZ file.  <a href="group__ring.html#ga0a321aab8c8956e0885826b65e550a1d">More...</a><br /></td></tr>
<tr class="separator:ga0a321aab8c8956e0885826b65e550a1d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gabf66bd35cdbccfd8fee51564dc889977"><td class="memItemLeft" align="right" valign="top">Eigen::MatrixXd&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ring.html#gabf66bd35cdbccfd8fee51564dc889977">tum3::buildRefDDC</a> (<a class="elRef" href="http://en.cppreference.com/w/cpp/string/basic_string.html">std::string</a> fileName)</td></tr>
<tr class="memdesc:gabf66bd35cdbccfd8fee51564dc889977"><td class="mdescLeft">&#160;</td><td class="mdescRight">Build a reference Double-Diamond cage, reading in from a template XYZ file.  <a href="group__ring.html#gabf66bd35cdbccfd8fee51564dc889977">More...</a><br /></td></tr>
<tr class="separator:gabf66bd35cdbccfd8fee51564dc889977"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga05cfdd8cbd1785d44ee6787cb987cbd7"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ring.html#ga05cfdd8cbd1785d44ee6787cb987cbd7">tum3::shapeMatchHC</a> (<a class="el" href="structmolSys_1_1PointCloud.html">molSys::PointCloud</a>&lt; <a class="el" href="structmolSys_1_1Point.html">molSys::Point</a>&lt; double &gt;, double &gt; *yCloud, const Eigen::MatrixXd &amp;refPoints, <a class="el" href="structcage_1_1Cage.html">cage::Cage</a> cageUnit, <a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; <a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt;&gt; rings, <a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; <a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt;&gt; nList, <a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; double &gt; *quat, double *rmsd)</td></tr>
<tr class="memdesc:ga05cfdd8cbd1785d44ee6787cb987cbd7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Shape-matching for a target HC.  <a href="group__ring.html#ga05cfdd8cbd1785d44ee6787cb987cbd7">More...</a><br /></td></tr>
<tr class="separator:ga05cfdd8cbd1785d44ee6787cb987cbd7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4e415d1a523fd9e0d947ec76306ee5ff"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ring.html#ga4e415d1a523fd9e0d947ec76306ee5ff">tum3::shapeMatchDDC</a> (<a class="el" href="structmolSys_1_1PointCloud.html">molSys::PointCloud</a>&lt; <a class="el" href="structmolSys_1_1Point.html">molSys::Point</a>&lt; double &gt;, double &gt; *yCloud, const Eigen::MatrixXd &amp;refPoints, <a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; <a class="el" href="structcage_1_1Cage.html">cage::Cage</a> &gt; cageList, int cageIndex, <a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; <a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt;&gt; rings, <a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; double &gt; *quat, double *rmsd)</td></tr>
<tr class="memdesc:ga4e415d1a523fd9e0d947ec76306ee5ff"><td class="mdescLeft">&#160;</td><td class="mdescRight">Shape-matching for a target DDC.  <a href="group__ring.html#ga4e415d1a523fd9e0d947ec76306ee5ff">More...</a><br /></td></tr>
<tr class="separator:ga4e415d1a523fd9e0d947ec76306ee5ff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8c3edb4cf0aab398434a883122135c18"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ring.html#ga8c3edb4cf0aab398434a883122135c18">tum3::updateRMSDatom</a> (<a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; <a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt;&gt; rings, <a class="el" href="structcage_1_1Cage.html">cage::Cage</a> cageUnit, double rmsd, <a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; double &gt; *rmsdPerAtom, <a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt; *noOfCommonAtoms, <a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; <a class="el" href="group__cage.html#gaaac41828990e32b9d6e7db4426b61529">cage::iceType</a> &gt; atomTypes)</td></tr>
<tr class="separator:ga8c3edb4cf0aab398434a883122135c18"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga390a8ecb9b86c18c3802fcbdcf37cd83"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ring.html#ga390a8ecb9b86c18c3802fcbdcf37cd83">tum3::averageRMSDatom</a> (<a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; double &gt; *rmsdPerAtom, <a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt; *noOfCommonAtoms)</td></tr>
<tr class="memdesc:ga390a8ecb9b86c18c3802fcbdcf37cd83"><td class="mdescLeft">&#160;</td><td class="mdescRight">Average the RMSD per atom.  <a href="group__ring.html#ga390a8ecb9b86c18c3802fcbdcf37cd83">More...</a><br /></td></tr>
<tr class="separator:ga390a8ecb9b86c18c3802fcbdcf37cd83"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gabad4c396b9a976a7a2199fdfeab143e7"><td class="memItemLeft" align="right" valign="top"><a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; <a class="el" href="structcage_1_1Cage.html">cage::Cage</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ring.html#gabad4c396b9a976a7a2199fdfeab143e7">tum3::topoBulkCriteria</a> (<a class="elRef" href="http://en.cppreference.com/w/cpp/string/basic_string.html">std::string</a> path, <a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; <a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt;&gt; rings, <a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; <a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt;&gt; nList, <a class="el" href="structmolSys_1_1PointCloud.html">molSys::PointCloud</a>&lt; <a class="el" href="structmolSys_1_1Point.html">molSys::Point</a>&lt; double &gt;, double &gt; *yCloud, int firstFrame, int *numHC, int *numDDC, <a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; <a class="el" href="group__ring.html#ga301cfdc88452cfe51bd4f745d223a7e1">ring::strucType</a> &gt; *ringType)</td></tr>
<tr class="separator:gabad4c396b9a976a7a2199fdfeab143e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga34dea1971104b5adb318178730ffc40d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ring.html#ga34dea1971104b5adb318178730ffc40d">tum3::clusterCages</a> (<a class="el" href="structmolSys_1_1PointCloud.html">molSys::PointCloud</a>&lt; <a class="el" href="structmolSys_1_1Point.html">molSys::Point</a>&lt; double &gt;, double &gt; *yCloud, <a class="elRef" href="http://en.cppreference.com/w/cpp/string/basic_string.html">std::string</a> path, <a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; <a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt;&gt; rings, <a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; <a class="el" href="structcage_1_1Cage.html">cage::Cage</a> &gt; cageList, int numHC, int numDDC)</td></tr>
<tr class="separator:ga34dea1971104b5adb318178730ffc40d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga2a339a36e85ff35c64fa3908936faf6c"><td class="memItemLeft" align="right" valign="top"><a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ring.html#ga2a339a36e85ff35c64fa3908936faf6c">tum3::atomsFromCages</a> (<a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; <a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt;&gt; rings, <a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; <a class="el" href="structcage_1_1Cage.html">cage::Cage</a> &gt; cageList, <a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt; <a class="el" href="group__ring.html#ga34dea1971104b5adb318178730ffc40d">clusterCages</a>)</td></tr>
<tr class="memdesc:ga2a339a36e85ff35c64fa3908936faf6c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the atoms in the cages of a given cluster.  <a href="group__ring.html#ga2a339a36e85ff35c64fa3908936faf6c">More...</a><br /></td></tr>
<tr class="separator:ga2a339a36e85ff35c64fa3908936faf6c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae9254c83de03fcf18b4cb5dcb2625011"><td class="memItemLeft" align="right" valign="top"><a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; <a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ring.html#gae9254c83de03fcf18b4cb5dcb2625011">ring::getSingleRingSize</a> (<a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; <a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt;&gt; rings, int ringSize)</td></tr>
<tr class="memdesc:gae9254c83de03fcf18b4cb5dcb2625011"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns a vector of vectors of rings of a single size.  <a href="group__ring.html#gae9254c83de03fcf18b4cb5dcb2625011">More...</a><br /></td></tr>
<tr class="separator:gae9254c83de03fcf18b4cb5dcb2625011"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac30855d0daa2b20c29e4dee39f5cd92f"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ring.html#gac30855d0daa2b20c29e4dee39f5cd92f">ring::hasCommonElements</a> (<a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt; ring1, <a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt; ring2)</td></tr>
<tr class="separator:gac30855d0daa2b20c29e4dee39f5cd92f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf9c0101aa7e09f97cbcf46a4ab83e0c6"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ring.html#gaf9c0101aa7e09f97cbcf46a4ab83e0c6">ring::compareRings</a> (<a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt; ring1, <a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt; ring2)</td></tr>
<tr class="separator:gaf9c0101aa7e09f97cbcf46a4ab83e0c6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga3cca615046ff98165863e95fdadce530"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ring.html#ga3cca615046ff98165863e95fdadce530">ring::findTripletInRing</a> (<a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt; ring, <a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt; triplet)</td></tr>
<tr class="memdesc:ga3cca615046ff98165863e95fdadce530"><td class="mdescLeft">&#160;</td><td class="mdescRight">Searches a particular ring for a triplet.  <a href="group__ring.html#ga3cca615046ff98165863e95fdadce530">More...</a><br /></td></tr>
<tr class="separator:ga3cca615046ff98165863e95fdadce530"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga0d4e6d1dca2b07091dc0d94999c36ed9"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ring.html#ga0d4e6d1dca2b07091dc0d94999c36ed9">ring::commonElementsInThreeRings</a> (<a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt; ring1, <a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt; ring2, <a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt; ring3)</td></tr>
<tr class="memdesc:ga0d4e6d1dca2b07091dc0d94999c36ed9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Common elements in 3 rings.  <a href="group__ring.html#ga0d4e6d1dca2b07091dc0d94999c36ed9">More...</a><br /></td></tr>
<tr class="separator:ga0d4e6d1dca2b07091dc0d94999c36ed9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaed5f39c14a4d76c1746aed53e0d0a2dc"><td class="memItemLeft" align="right" valign="top"><a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ring.html#gaed5f39c14a4d76c1746aed53e0d0a2dc">ring::findsCommonElements</a> (<a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt; ring1, <a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt; ring2)</td></tr>
<tr class="memdesc:gaed5f39c14a4d76c1746aed53e0d0a2dc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the common elements of two rings.  <a href="group__ring.html#gaed5f39c14a4d76c1746aed53e0d0a2dc">More...</a><br /></td></tr>
<tr class="separator:gaed5f39c14a4d76c1746aed53e0d0a2dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga76f3cb7aa8a713aeafecdf3a6fffee31"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ring.html#ga76f3cb7aa8a713aeafecdf3a6fffee31">ring::clearRingList</a> (<a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; <a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt;&gt; &amp;rings)</td></tr>
<tr class="memdesc:ga76f3cb7aa8a713aeafecdf3a6fffee31"><td class="mdescLeft">&#160;</td><td class="mdescRight">Erases memory for a vector of vectors for a list of rings.  <a href="group__ring.html#ga76f3cb7aa8a713aeafecdf3a6fffee31">More...</a><br /></td></tr>
<tr class="separator:ga76f3cb7aa8a713aeafecdf3a6fffee31"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gadab15a0007278962f78f83794549d438"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ring.html#gadab15a0007278962f78f83794549d438">ring::assignPolygonType</a> (<a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; <a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt;&gt; rings, <a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt; *atomTypes, <a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt; nRings)</td></tr>
<tr class="separator:gadab15a0007278962f78f83794549d438"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga216eec245aa026b0c9f78f92aa81af34"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structmolSys_1_1PointCloud.html">molSys::PointCloud</a>&lt; <a class="el" href="structmolSys_1_1Point.html">molSys::Point</a>&lt; double &gt;, double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ring.html#ga216eec245aa026b0c9f78f92aa81af34">gen::getPointCloudOneAtomType</a> (<a class="el" href="structmolSys_1_1PointCloud.html">molSys::PointCloud</a>&lt; <a class="el" href="structmolSys_1_1Point.html">molSys::Point</a>&lt; double &gt;, double &gt; *yCloud, <a class="el" href="structmolSys_1_1PointCloud.html">molSys::PointCloud</a>&lt; <a class="el" href="structmolSys_1_1Point.html">molSys::Point</a>&lt; double &gt;, double &gt; *outCloud, int atomTypeI, bool isSlice=false, <a class="elRef" href="http://en.cppreference.com/w/cpp/container/array.html">std::array</a>&lt; double, 3 &gt; coordLow=<a class="elRef" href="http://en.cppreference.com/w/cpp/container/array.html">std::array</a>&lt; double, 3 &gt;{0, 0, 0}, <a class="elRef" href="http://en.cppreference.com/w/cpp/container/array.html">std::array</a>&lt; double, 3 &gt; coordHigh=<a class="elRef" href="http://en.cppreference.com/w/cpp/container/array.html">std::array</a>&lt; double, 3 &gt;{0, 0, 0})</td></tr>
<tr class="separator:ga216eec245aa026b0c9f78f92aa81af34"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9decdf9fe1692fc0b03dee64653d9ddf"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ring.html#ga9decdf9fe1692fc0b03dee64653d9ddf">gen::moleculesInSingleSlice</a> (<a class="el" href="structmolSys_1_1PointCloud.html">molSys::PointCloud</a>&lt; <a class="el" href="structmolSys_1_1Point.html">molSys::Point</a>&lt; double &gt;, double &gt; *yCloud, bool clearPreviousSliceSelection=true, <a class="elRef" href="http://en.cppreference.com/w/cpp/container/array.html">std::array</a>&lt; double, 3 &gt; coordLow=<a class="elRef" href="http://en.cppreference.com/w/cpp/container/array.html">std::array</a>&lt; double, 3 &gt;{0, 0, 0}, <a class="elRef" href="http://en.cppreference.com/w/cpp/container/array.html">std::array</a>&lt; double, 3 &gt; coordHigh=<a class="elRef" href="http://en.cppreference.com/w/cpp/container/array.html">std::array</a>&lt; double, 3 &gt;{0, 0, 0})</td></tr>
<tr class="separator:ga9decdf9fe1692fc0b03dee64653d9ddf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga336353070302bc293ed5261838ee979e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ring.html#ga336353070302bc293ed5261838ee979e">gen::atomsInSingleSlice</a> (<a class="el" href="structmolSys_1_1PointCloud.html">molSys::PointCloud</a>&lt; <a class="el" href="structmolSys_1_1Point.html">molSys::Point</a>&lt; double &gt;, double &gt; *yCloud, bool clearPreviousSliceSelection=true, <a class="elRef" href="http://en.cppreference.com/w/cpp/container/array.html">std::array</a>&lt; double, 3 &gt; coordLow=<a class="elRef" href="http://en.cppreference.com/w/cpp/container/array.html">std::array</a>&lt; double, 3 &gt;{0, 0, 0}, <a class="elRef" href="http://en.cppreference.com/w/cpp/container/array.html">std::array</a>&lt; double, 3 &gt; coordHigh=<a class="elRef" href="http://en.cppreference.com/w/cpp/container/array.html">std::array</a>&lt; double, 3 &gt;{0, 0, 0})</td></tr>
<tr class="separator:ga336353070302bc293ed5261838ee979e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga81dde14f79d13cb8e2c04a1e78ac11fb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ring.html#ga81dde14f79d13cb8e2c04a1e78ac11fb">gen::setAtomsWithSameMolID</a> (<a class="el" href="structmolSys_1_1PointCloud.html">molSys::PointCloud</a>&lt; <a class="el" href="structmolSys_1_1Point.html">molSys::Point</a>&lt; double &gt;, double &gt; *yCloud, <a class="elRef" href="http://en.cppreference.com/w/cpp/container/unordered_multimap.html">std::unordered_multimap</a>&lt; int, int &gt; molIDAtomIDmap, int molID, bool inSliceValue=true)</td></tr>
<tr class="separator:ga81dde14f79d13cb8e2c04a1e78ac11fb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9fff26ca8ab43bd8c8c5545f38a83278"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ring.html#ga9fff26ca8ab43bd8c8c5545f38a83278">ring::getEdgeMoleculesInRings</a> (<a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; <a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt;&gt; rings, <a class="el" href="structmolSys_1_1PointCloud.html">molSys::PointCloud</a>&lt; <a class="el" href="structmolSys_1_1Point.html">molSys::Point</a>&lt; double &gt;, double &gt; *oCloud, <a class="el" href="structmolSys_1_1PointCloud.html">molSys::PointCloud</a>&lt; <a class="el" href="structmolSys_1_1Point.html">molSys::Point</a>&lt; double &gt;, double &gt; *yCloud, <a class="elRef" href="http://en.cppreference.com/w/cpp/container/array.html">std::array</a>&lt; double, 3 &gt; coordLow, <a class="elRef" href="http://en.cppreference.com/w/cpp/container/array.html">std::array</a>&lt; double, 3 &gt; coordHigh, bool identicalCloud=false)</td></tr>
<tr class="separator:ga9fff26ca8ab43bd8c8c5545f38a83278"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac782697302e8da50e12bec77288a67e0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ring.html#gac782697302e8da50e12bec77288a67e0">ring::printSliceGetEdgeMoleculesInRings</a> (<a class="elRef" href="http://en.cppreference.com/w/cpp/string/basic_string.html">std::string</a> path, <a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; <a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt;&gt; rings, <a class="el" href="structmolSys_1_1PointCloud.html">molSys::PointCloud</a>&lt; <a class="el" href="structmolSys_1_1Point.html">molSys::Point</a>&lt; double &gt;, double &gt; *oCloud, <a class="el" href="structmolSys_1_1PointCloud.html">molSys::PointCloud</a>&lt; <a class="el" href="structmolSys_1_1Point.html">molSys::Point</a>&lt; double &gt;, double &gt; *yCloud, <a class="elRef" href="http://en.cppreference.com/w/cpp/container/array.html">std::array</a>&lt; double, 3 &gt; coordLow, <a class="elRef" href="http://en.cppreference.com/w/cpp/container/array.html">std::array</a>&lt; double, 3 &gt; coordHigh, bool identicalCloud=false)</td></tr>
<tr class="separator:gac782697302e8da50e12bec77288a67e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga0a1fdfaea2b64e45c4e0d7d7f8864507"><td class="memItemLeft" align="right" valign="top"><a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ring.html#ga0a1fdfaea2b64e45c4e0d7d7f8864507">ring::findPrisms</a> (<a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; <a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt;&gt; rings, <a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; <a class="el" href="group__ring.html#ga301cfdc88452cfe51bd4f745d223a7e1">strucType</a> &gt; *ringType, int *nPerfectPrisms, int *nImperfectPrisms, <a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; <a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt;&gt; nList, <a class="el" href="structmolSys_1_1PointCloud.html">molSys::PointCloud</a>&lt; <a class="el" href="structmolSys_1_1Point.html">molSys::Point</a>&lt; double &gt;, double &gt; *yCloud, <a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; double &gt; *rmsdPerAtom, bool doShapeMatching=false)</td></tr>
<tr class="separator:ga0a1fdfaea2b64e45c4e0d7d7f8864507"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gacd2f05f7a6e394f6aae0c0d6e016a383"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ring.html#gacd2f05f7a6e394f6aae0c0d6e016a383">ring::basalPrismConditions</a> (<a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; <a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt;&gt; nList, <a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt; *basal1, <a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt; *basal2)</td></tr>
<tr class="separator:gacd2f05f7a6e394f6aae0c0d6e016a383"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga033c466e933a1a3b532ef4ecdf7626f0"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ring.html#ga033c466e933a1a3b532ef4ecdf7626f0">ring::relaxedPrismConditions</a> (<a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; <a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt;&gt; nList, <a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt; *basal1, <a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt; *basal2)</td></tr>
<tr class="separator:ga033c466e933a1a3b532ef4ecdf7626f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8912c1abc7e5c49831f285e12a48f483"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ring.html#ga8912c1abc7e5c49831f285e12a48f483">ring::discardExtraTetragonBlocks</a> (<a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt; *basal1, <a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt; *basal2, <a class="el" href="structmolSys_1_1PointCloud.html">molSys::PointCloud</a>&lt; <a class="el" href="structmolSys_1_1Point.html">molSys::Point</a>&lt; double &gt;, double &gt; *yCloud)</td></tr>
<tr class="separator:ga8912c1abc7e5c49831f285e12a48f483"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga938e41913c66bc09a3b98a683507da10"><td class="memItemLeft" align="right" valign="top"><a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; <a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ring.html#ga938e41913c66bc09a3b98a683507da10">ring::keepAxialRingsOnly</a> (<a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; <a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt;&gt; rings, <a class="el" href="structmolSys_1_1PointCloud.html">molSys::PointCloud</a>&lt; <a class="el" href="structmolSys_1_1Point.html">molSys::Point</a>&lt; double &gt;, double &gt; *yCloud)</td></tr>
<tr class="memdesc:ga938e41913c66bc09a3b98a683507da10"><td class="mdescLeft">&#160;</td><td class="mdescRight">Saves only axial rings out of all possible rings.  <a href="group__ring.html#ga938e41913c66bc09a3b98a683507da10">More...</a><br /></td></tr>
<tr class="separator:ga938e41913c66bc09a3b98a683507da10"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga083a38f83a1a89eba434d64a33986637"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ring.html#ga083a38f83a1a89eba434d64a33986637">ring::prismAnalysis</a> (<a class="elRef" href="http://en.cppreference.com/w/cpp/string/basic_string.html">std::string</a> path, <a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; <a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt;&gt; rings, <a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; <a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt;&gt; nList, <a class="el" href="structmolSys_1_1PointCloud.html">molSys::PointCloud</a>&lt; <a class="el" href="structmolSys_1_1Point.html">molSys::Point</a>&lt; double &gt;, double &gt; *yCloud, int maxDepth, int *atomID, int firstFrame, int currentFrame, bool doShapeMatching=false)</td></tr>
<tr class="separator:ga083a38f83a1a89eba434d64a33986637"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab1ed37cff6088e349647efff91627f3c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ring.html#gab1ed37cff6088e349647efff91627f3c">ring::assignPrismType</a> (<a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; <a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt;&gt; rings, <a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt; listPrism, int ringSize, <a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; <a class="el" href="group__ring.html#ga301cfdc88452cfe51bd4f745d223a7e1">ring::strucType</a> &gt; ringType, <a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt; *atomTypes, <a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; <a class="el" href="group__ring.html#ga301cfdc88452cfe51bd4f745d223a7e1">ring::strucType</a> &gt; *atomState)</td></tr>
<tr class="separator:gab1ed37cff6088e349647efff91627f3c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga5f7b22fe1354ebe4982b8a9df0067b65"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ring.html#ga5f7b22fe1354ebe4982b8a9df0067b65">ring::deformedPrismTypes</a> (<a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; <a class="el" href="group__ring.html#ga301cfdc88452cfe51bd4f745d223a7e1">ring::strucType</a> &gt; atomState, <a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt; *atomTypes, int maxDepth)</td></tr>
<tr class="memdesc:ga5f7b22fe1354ebe4982b8a9df0067b65"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the atom type values for deformed prisms.  <a href="group__ring.html#ga5f7b22fe1354ebe4982b8a9df0067b65">More...</a><br /></td></tr>
<tr class="separator:ga5f7b22fe1354ebe4982b8a9df0067b65"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9d7e63eb7b6c37024744c4f372796cef"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ring.html#ga9d7e63eb7b6c37024744c4f372796cef">ring::rmAxialTranslations</a> (<a class="el" href="structmolSys_1_1PointCloud.html">molSys::PointCloud</a>&lt; <a class="el" href="structmolSys_1_1Point.html">molSys::Point</a>&lt; double &gt;, double &gt; *yCloud, int *atomID, int firstFrame, int currentFrame)</td></tr>
<tr class="memdesc:ga9d7e63eb7b6c37024744c4f372796cef"><td class="mdescLeft">&#160;</td><td class="mdescRight">Shift the entire ice nanotube and remove axial translations.  <a href="group__ring.html#ga9d7e63eb7b6c37024744c4f372796cef">More...</a><br /></td></tr>
<tr class="separator:ga9d7e63eb7b6c37024744c4f372796cef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga83d8dc9c337e72051e01b234c12cc41c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ring.html#ga83d8dc9c337e72051e01b234c12cc41c">ring::polygonRingAnalysis</a> (<a class="elRef" href="http://en.cppreference.com/w/cpp/string/basic_string.html">std::string</a> path, <a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; <a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt;&gt; rings, <a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; <a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt;&gt; nList, <a class="el" href="structmolSys_1_1PointCloud.html">molSys::PointCloud</a>&lt; <a class="el" href="structmolSys_1_1Point.html">molSys::Point</a>&lt; double &gt;, double &gt; *yCloud, int maxDepth, double sheetArea, int firstFrame)</td></tr>
<tr class="separator:ga83d8dc9c337e72051e01b234c12cc41c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<h2 class="groupheader">Enumeration Type Documentation</h2>
<a id="ga301cfdc88452cfe51bd4f745d223a7e1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga301cfdc88452cfe51bd4f745d223a7e1">&#9670;&nbsp;</a></span>strucType</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="group__ring.html#ga301cfdc88452cfe51bd4f745d223a7e1">ring::strucType</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="gga301cfdc88452cfe51bd4f745d223a7e1a60cc60f3804efaf86af8c2c2fbbe7208"></a>unclassified&#160;</td><td class="fielddoc"><p>The ring is unclassified, which may be either water or a deformed type which cannot be classified by the criteria. </p>
</td></tr>
<tr><td class="fieldname"><a id="gga301cfdc88452cfe51bd4f745d223a7e1a37a9bfe125a811135f6c77d832cef242"></a>DDC&#160;</td><td class="fielddoc"><p>The ring belongs to a double-diamond cage (DDC). </p>
</td></tr>
<tr><td class="fieldname"><a id="gga301cfdc88452cfe51bd4f745d223a7e1a48c3c5c40739122c0bf68fb9faeee9da"></a>HCbasal&#160;</td><td class="fielddoc"><p>The ring belongs only to a hexagonal cage (HC). Specifically, the ring is purely a basal ring of an HC. </p>
</td></tr>
<tr><td class="fieldname"><a id="gga301cfdc88452cfe51bd4f745d223a7e1a66afb615d90d5df19cce1df68e24d7f2"></a>HCprismatic&#160;</td><td class="fielddoc"><p>The ring belongs only to a hexagonal cage (HC); specifically the ring is purely a prismatic ring of an HC. It is not shared by a DDC. </p>
</td></tr>
<tr><td class="fieldname"><a id="gga301cfdc88452cfe51bd4f745d223a7e1a074049f7a1a6ea8338d256f5b4e586a2"></a>bothBasal&#160;</td><td class="fielddoc"><p>The ring belongs to both a DDC and HC. It is a 'mixed' ring. The ring is also one of the basal rings of the HC of which it is part. A mixed ring must be a peripheral ring of the DDC of which it is part by definition. </p>
</td></tr>
<tr><td class="fieldname"><a id="gga301cfdc88452cfe51bd4f745d223a7e1a6681861f6a3ec92005e0d5a0e4b7dfce"></a>bothPrismatic&#160;</td><td class="fielddoc"><p>The ring belongs to both a DDC and HC and is, thus, a 'mixed' ring. The ring is also one of the prismatic rings of the HC of which it is part. A mixed ring must be a peripheral ring of the DDC of which it is part by definition (can never be an equatorial ring of a DDC and also be part of an HC). </p>
</td></tr>
<tr><td class="fieldname"><a id="gga301cfdc88452cfe51bd4f745d223a7e1ac4295ff0a8263a65de0694cc0b20e9af"></a>Prism&#160;</td><td class="fielddoc"><p>The ring belongs to a prism block, classified according to the prism identification scheme. </p>
</td></tr>
<tr><td class="fieldname"><a id="gga301cfdc88452cfe51bd4f745d223a7e1a499b694d8386eef89ba2f6e621ed7578"></a>deformedPrism&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="gga301cfdc88452cfe51bd4f745d223a7e1aabd9a19704526f9be67c7dcd1c2b4af9"></a>mixedPrismRing&#160;</td><td class="fielddoc"></td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="ring_8hpp_source.html#l00116">116</a> of file <a class="el" href="ring_8hpp_source.html">ring.hpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;               {</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  <a class="code" href="group__ring.html#gga301cfdc88452cfe51bd4f745d223a7e1a60cc60f3804efaf86af8c2c2fbbe7208">unclassified</a>,</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  <a class="code" href="group__ring.html#gga301cfdc88452cfe51bd4f745d223a7e1a37a9bfe125a811135f6c77d832cef242">DDC</a>,</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;  <a class="code" href="group__ring.html#gga301cfdc88452cfe51bd4f745d223a7e1a48c3c5c40739122c0bf68fb9faeee9da">HCbasal</a>,</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  <a class="code" href="group__ring.html#gga301cfdc88452cfe51bd4f745d223a7e1a66afb615d90d5df19cce1df68e24d7f2">HCprismatic</a>,</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;  <a class="code" href="group__ring.html#gga301cfdc88452cfe51bd4f745d223a7e1a074049f7a1a6ea8338d256f5b4e586a2">bothBasal</a>,</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  <a class="code" href="group__ring.html#gga301cfdc88452cfe51bd4f745d223a7e1a6681861f6a3ec92005e0d5a0e4b7dfce">bothPrismatic</a>,</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  <a class="code" href="group__ring.html#gga301cfdc88452cfe51bd4f745d223a7e1ac4295ff0a8263a65de0694cc0b20e9af">Prism</a>,</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;  <a class="code" href="group__ring.html#gga301cfdc88452cfe51bd4f745d223a7e1a499b694d8386eef89ba2f6e621ed7578">deformedPrism</a>,</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;  <a class="code" href="group__ring.html#gga301cfdc88452cfe51bd4f745d223a7e1aabd9a19704526f9be67c7dcd1c2b4af9">mixedPrismRing</a></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;};</div>
<div class="ttc" id="agroup__ring_html_gga301cfdc88452cfe51bd4f745d223a7e1a074049f7a1a6ea8338d256f5b4e586a2"><div class="ttname"><a href="group__ring.html#gga301cfdc88452cfe51bd4f745d223a7e1a074049f7a1a6ea8338d256f5b4e586a2">ring::bothBasal</a></div><div class="ttdeci">@ bothBasal</div><div class="ttdoc">The ring belongs to both a DDC and HC. It is a 'mixed' ring. The ring is also one of the basal rings ...</div><div class="ttdef"><b>Definition:</b> <a href="ring_8hpp_source.html#l00121">ring.hpp:121</a></div></div>
<div class="ttc" id="agroup__ring_html_gga301cfdc88452cfe51bd4f745d223a7e1a37a9bfe125a811135f6c77d832cef242"><div class="ttname"><a href="group__ring.html#gga301cfdc88452cfe51bd4f745d223a7e1a37a9bfe125a811135f6c77d832cef242">ring::DDC</a></div><div class="ttdeci">@ DDC</div><div class="ttdoc">The ring belongs to a double-diamond cage (DDC).</div><div class="ttdef"><b>Definition:</b> <a href="ring_8hpp_source.html#l00118">ring.hpp:118</a></div></div>
<div class="ttc" id="agroup__ring_html_gga301cfdc88452cfe51bd4f745d223a7e1a48c3c5c40739122c0bf68fb9faeee9da"><div class="ttname"><a href="group__ring.html#gga301cfdc88452cfe51bd4f745d223a7e1a48c3c5c40739122c0bf68fb9faeee9da">ring::HCbasal</a></div><div class="ttdeci">@ HCbasal</div><div class="ttdoc">The ring belongs only to a hexagonal cage (HC). Specifically, the ring is purely a basal ring of an H...</div><div class="ttdef"><b>Definition:</b> <a href="ring_8hpp_source.html#l00119">ring.hpp:119</a></div></div>
<div class="ttc" id="agroup__ring_html_gga301cfdc88452cfe51bd4f745d223a7e1a499b694d8386eef89ba2f6e621ed7578"><div class="ttname"><a href="group__ring.html#gga301cfdc88452cfe51bd4f745d223a7e1a499b694d8386eef89ba2f6e621ed7578">ring::deformedPrism</a></div><div class="ttdeci">@ deformedPrism</div><div class="ttdef"><b>Definition:</b> <a href="ring_8hpp_source.html#l00124">ring.hpp:124</a></div></div>
<div class="ttc" id="agroup__ring_html_gga301cfdc88452cfe51bd4f745d223a7e1a60cc60f3804efaf86af8c2c2fbbe7208"><div class="ttname"><a href="group__ring.html#gga301cfdc88452cfe51bd4f745d223a7e1a60cc60f3804efaf86af8c2c2fbbe7208">ring::unclassified</a></div><div class="ttdeci">@ unclassified</div><div class="ttdoc">The ring is unclassified, which may be either water or a deformed type which cannot be classified by ...</div><div class="ttdef"><b>Definition:</b> <a href="ring_8hpp_source.html#l00117">ring.hpp:117</a></div></div>
<div class="ttc" id="agroup__ring_html_gga301cfdc88452cfe51bd4f745d223a7e1a6681861f6a3ec92005e0d5a0e4b7dfce"><div class="ttname"><a href="group__ring.html#gga301cfdc88452cfe51bd4f745d223a7e1a6681861f6a3ec92005e0d5a0e4b7dfce">ring::bothPrismatic</a></div><div class="ttdeci">@ bothPrismatic</div><div class="ttdoc">The ring belongs to both a DDC and HC and is, thus, a 'mixed' ring. The ring is also one of the prism...</div><div class="ttdef"><b>Definition:</b> <a href="ring_8hpp_source.html#l00122">ring.hpp:122</a></div></div>
<div class="ttc" id="agroup__ring_html_gga301cfdc88452cfe51bd4f745d223a7e1a66afb615d90d5df19cce1df68e24d7f2"><div class="ttname"><a href="group__ring.html#gga301cfdc88452cfe51bd4f745d223a7e1a66afb615d90d5df19cce1df68e24d7f2">ring::HCprismatic</a></div><div class="ttdeci">@ HCprismatic</div><div class="ttdoc">The ring belongs only to a hexagonal cage (HC); specifically the ring is purely a prismatic ring of a...</div><div class="ttdef"><b>Definition:</b> <a href="ring_8hpp_source.html#l00120">ring.hpp:120</a></div></div>
<div class="ttc" id="agroup__ring_html_gga301cfdc88452cfe51bd4f745d223a7e1aabd9a19704526f9be67c7dcd1c2b4af9"><div class="ttname"><a href="group__ring.html#gga301cfdc88452cfe51bd4f745d223a7e1aabd9a19704526f9be67c7dcd1c2b4af9">ring::mixedPrismRing</a></div><div class="ttdeci">@ mixedPrismRing</div><div class="ttdef"><b>Definition:</b> <a href="ring_8hpp_source.html#l00126">ring.hpp:125</a></div></div>
<div class="ttc" id="agroup__ring_html_gga301cfdc88452cfe51bd4f745d223a7e1ac4295ff0a8263a65de0694cc0b20e9af"><div class="ttname"><a href="group__ring.html#gga301cfdc88452cfe51bd4f745d223a7e1ac4295ff0a8263a65de0694cc0b20e9af">ring::Prism</a></div><div class="ttdeci">@ Prism</div><div class="ttdoc">The ring belongs to a prism block, classified according to the prism identification scheme.</div><div class="ttdef"><b>Definition:</b> <a href="ring_8hpp_source.html#l00123">ring.hpp:123</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="gadab15a0007278962f78f83794549d438"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gadab15a0007278962f78f83794549d438">&#9670;&nbsp;</a></span>assignPolygonType()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ring::assignPolygonType </td>
          <td>(</td>
          <td class="paramtype"><a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; <a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt;&gt;&#160;</td>
          <td class="paramname"><em>rings</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt; *&#160;</td>
          <td class="paramname"><em>atomTypes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt;&#160;</td>
          <td class="paramname"><em>nRings</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Assign an atomType (equal to the number of nodes in the ring) given n-membered rings.</p>
<p>Assign an atomType (equal to the number of nodes in the ring) given the rings vector. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">rings</td><td>The vector of vectors containing the primitive rings, of a particular ring size. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">atomTypes</td><td>A vector which contains a type for each atom, depending on it's type as classified by the prism identification scheme. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nRings</td><td>Number of rings. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="ring_8cpp_source.html#l00040">40</a> of file <a class="el" href="ring_8cpp_source.html">ring.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;                                                   {</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  <span class="comment">// Every value in listPrism corresponds to an index in rings.</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  <span class="comment">// Every ring contains atom indices, corresponding to the indices (not atom</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  <span class="comment">// IDs) in rings</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  <span class="keywordtype">int</span> iring;        <span class="comment">// Index of current ring</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  <span class="keywordtype">int</span> iatom;        <span class="comment">// Index of current atom</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  <span class="keywordtype">int</span> ringSize;     <span class="comment">// Ring size of the current ring</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;  <span class="keywordtype">int</span> prevRingSize; <span class="comment">// Ring size previously assigned to a point</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160; </div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;  <span class="comment">// Dummy value corresponds to a value of 1.</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  <span class="comment">// If an atom is shared by more than one ring type, it is assigned the</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  <span class="comment">// value 2.</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160; </div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;  <span class="comment">// Loop through every ring in rings</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iring = 0; iring &lt; rings.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/size.html">size</a>(); iring++) {</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    ringSize = rings[iring].<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/size.html">size</a>();</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    <span class="comment">// Loop through every element in iring</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; ringSize; j++) {</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;      iatom = rings[iring][j]; <span class="comment">// Atom index</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;      <span class="comment">// Update the atom type</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;      <span class="keywordflow">if</span> ((*atomTypes)[iatom] == 1) {</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;        (*atomTypes)[iatom] = ringSize;</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;      } <span class="comment">// The atom is unclassified</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;      <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;        <span class="comment">// Only update the ring type if the number is higher</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;        prevRingSize = (*atomTypes)[iatom]; <span class="comment">// Previously assigned ring size</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;        <span class="keywordflow">if</span> (ringSize &gt; prevRingSize) {</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;          (*atomTypes)[iatom] = ringSize;</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;        } <span class="comment">// end of assigning the new ring size</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;      }   <span class="comment">// only update if the number is higher</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    }     <span class="comment">// end of loop through every atom in iring</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  }       <span class="comment">// end of loop through every ring</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160; </div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;} <span class="comment">// end of function</span></div>
<div class="ttc" id="asize_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/container/vector/size.html">std::vector::size</a></div><div class="ttdeci">T size(T... args)</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="gab1ed37cff6088e349647efff91627f3c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gab1ed37cff6088e349647efff91627f3c">&#9670;&nbsp;</a></span>assignPrismType()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ring::assignPrismType </td>
          <td>(</td>
          <td class="paramtype"><a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; <a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt;&gt;&#160;</td>
          <td class="paramname"><em>rings</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt;&#160;</td>
          <td class="paramname"><em>listPrism</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ringSize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; <a class="el" href="group__ring.html#ga301cfdc88452cfe51bd4f745d223a7e1">ring::strucType</a> &gt;&#160;</td>
          <td class="paramname"><em>ringType</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt; *&#160;</td>
          <td class="paramname"><em>atomTypes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; <a class="el" href="group__ring.html#ga301cfdc88452cfe51bd4f745d223a7e1">ring::strucType</a> &gt; *&#160;</td>
          <td class="paramname"><em>atomState</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Assign an atomType (equal to the number of nodes in the ring) given a vector with a list of indices of rings comprising the prisms</p>
<p>Assign an atomType (equal to the number of nodes in the ring) given a vector with a list of indices of rings comprising the prisms. Note that the ring indices in the listPrism vector correspond to the indices in the input rings vector of vectors. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">rings</td><td>The vector of vectors containing the primitive rings, of a particular ring size. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">listPrism</td><td>The list of prism blocks found. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ringSize</td><td>The current ring size or number of nodes in each ring. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">atomTypes</td><td>A vector which contains a type for each atom, depending on it's type as classified by the prism identification scheme. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="topo__one__dim_8cpp_source.html#l00696">696</a> of file <a class="el" href="topo__one__dim_8cpp_source.html">topo_one_dim.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;                                                               {</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;  <span class="comment">// Every value in listPrism corresponds to an index in rings.</span></div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;  <span class="comment">// Every ring contains atom indices, corresponding to the indices (not atom</span></div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;  <span class="comment">// IDs) in rings</span></div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;  <span class="keywordtype">int</span> iring;                    <span class="comment">// Index of current ring</span></div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;  <span class="keywordtype">int</span> iatom;                    <span class="comment">// Index of current atom</span></div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;  <a class="code" href="group__ring.html#ga301cfdc88452cfe51bd4f745d223a7e1">ring::strucType</a> currentState; <span class="comment">// Current state of the ring being filled</span></div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160; </div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;  <span class="comment">// Dummy value corresponds to a value of 1.</span></div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;  <span class="comment">// Each value is initialized to the value of 1.</span></div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160; </div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;  <span class="comment">// Loop through every ring in rings</span></div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; listPrism.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/size.html">size</a>(); i++) {</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;    iring = listPrism[i];</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;    <span class="comment">// Get the state of all atoms in the ring</span></div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;    currentState = ringType[iring];</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;    <span class="comment">// Loop through every element in iring</span></div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; ringSize; j++) {</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;      iatom = rings[iring][j]; <span class="comment">// Atom index</span></div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;      <span class="comment">// Update the atom type</span></div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;      (*atomTypes)[iatom] = ringSize;</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;      <span class="comment">//</span></div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;      <span class="comment">// Update the state of the atom</span></div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;      <span class="keywordflow">if</span> ((*atomState)[iatom] == <a class="code" href="group__ring.html#gga301cfdc88452cfe51bd4f745d223a7e1a60cc60f3804efaf86af8c2c2fbbe7208">ring::unclassified</a>) {</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;        (*atomState)[iatom] = currentState;</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;      } <span class="comment">// Update the unclassified atom</span></div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;      <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;        <span class="keywordflow">if</span> ((*atomState)[iatom] != currentState) {</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;          <span class="comment">// For mixed, there is a preference</span></div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;          <span class="keywordflow">if</span> (currentState == <a class="code" href="group__ring.html#gga301cfdc88452cfe51bd4f745d223a7e1aabd9a19704526f9be67c7dcd1c2b4af9">ring::mixedPrismRing</a>) {</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;            (*atomState)[iatom] = currentState;</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;          } <span class="comment">// fill</span></div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;          <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((*atomState)[iatom] == <a class="code" href="group__ring.html#gga301cfdc88452cfe51bd4f745d223a7e1a499b694d8386eef89ba2f6e621ed7578">ring::deformedPrism</a> &amp;&amp;</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;                   currentState == <a class="code" href="group__ring.html#gga301cfdc88452cfe51bd4f745d223a7e1ac4295ff0a8263a65de0694cc0b20e9af">ring::Prism</a>) {</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;            (*atomState)[iatom] = <a class="code" href="group__ring.html#gga301cfdc88452cfe51bd4f745d223a7e1aabd9a19704526f9be67c7dcd1c2b4af9">ring::mixedPrismRing</a>;</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;          } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((*atomState)[iatom] == <a class="code" href="group__ring.html#gga301cfdc88452cfe51bd4f745d223a7e1ac4295ff0a8263a65de0694cc0b20e9af">ring::Prism</a> &amp;&amp;</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;                     currentState == <a class="code" href="group__ring.html#gga301cfdc88452cfe51bd4f745d223a7e1a499b694d8386eef89ba2f6e621ed7578">ring::deformedPrism</a>) {</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;            (*atomState)[iatom] = <a class="code" href="group__ring.html#gga301cfdc88452cfe51bd4f745d223a7e1aabd9a19704526f9be67c7dcd1c2b4af9">ring::mixedPrismRing</a>;</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;          }</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;        } <span class="comment">//</span></div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;      }   <span class="comment">// already filled?</span></div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160; </div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;    } <span class="comment">// end of loop through every atom in iring</span></div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;  }   <span class="comment">// end of loop through every ring</span></div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160; </div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;  <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;} <span class="comment">// end of function</span></div>
<div class="ttc" id="agroup__ring_html_ga301cfdc88452cfe51bd4f745d223a7e1"><div class="ttname"><a href="group__ring.html#ga301cfdc88452cfe51bd4f745d223a7e1">ring::strucType</a></div><div class="ttdeci">strucType</div><div class="ttdef"><b>Definition:</b> <a href="ring_8hpp_source.html#l00116">ring.hpp:116</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ga2a339a36e85ff35c64fa3908936faf6c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga2a339a36e85ff35c64fa3908936faf6c">&#9670;&nbsp;</a></span>atomsFromCages()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt; tum3::atomsFromCages </td>
          <td>(</td>
          <td class="paramtype"><a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; <a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt;&gt;&#160;</td>
          <td class="paramname"><em>rings</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; <a class="el" href="structcage_1_1Cage.html">cage::Cage</a> &gt;&#160;</td>
          <td class="paramname"><em>cageList</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt;&#160;</td>
          <td class="paramname"><em>clusterCages</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gets the atoms in the cages of a given cluster. </p>
<p>Returns a vector containing the atom indices of all the atoms in a cluster of cages, according to the input cageList vector of Cages </p>

<p class="definition">Definition at line <a class="el" href="bulkTUM_8cpp_source.html#l00801">801</a> of file <a class="el" href="bulkTUM_8cpp_source.html">bulkTUM.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;                                                                   {</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a> atoms; <span class="comment">// Contains the atom indices (not IDs) of atoms</span></div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;  <span class="keywordtype">int</span> ringSize = rings[0].<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/size.html">size</a>(); <span class="comment">// Number of nodes in each ring</span></div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;  <span class="keywordtype">int</span> iring;                      <span class="comment">// Index of ring in rings vector of vectors</span></div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;  <span class="keywordtype">int</span> icage;                      <span class="comment">// Index of the current cage in cageList</span></div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;  <span class="keywordtype">int</span> iatom;                      <span class="comment">// Atom index</span></div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="group__ring.html#ga34dea1971104b5adb318178730ffc40d">clusterCages</a>.size(); i++) {</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;    icage = <a class="code" href="group__ring.html#ga34dea1971104b5adb318178730ffc40d">clusterCages</a>[i];</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;    <span class="comment">// Loop through every ring in the cage</span></div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; cageList[icage].rings.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/size.html">size</a>(); j++) {</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;      iring = cageList[icage].rings[j]; <span class="comment">// Current ring index</span></div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;      <span class="comment">// Loop through every atom in iring</span></div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; ringSize; k++) {</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;        iatom = rings[iring][k];</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;        atoms.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/push_back.html">push_back</a>(iatom); <span class="comment">// Add the atom</span></div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;      }                         <span class="comment">// Loop through every atom in iring</span></div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;    }                           <span class="comment">// loop through every ring in the current cage</span></div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;  }                             <span class="comment">// end of loop through all cages</span></div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160; </div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;  <span class="comment">// Remove the duplicates in the atoms vector</span></div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;  <span class="comment">// Duplicate IDs must be removed</span></div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/algorithm/sort.html">sort</a>(atoms.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/begin.html">begin</a>(), atoms.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/end.html">end</a>());</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;  <span class="keyword">auto</span> ip = <a class="codeRef" href="http://en.cppreference.com/w/cpp/algorithm/unique.html">std::unique</a>(atoms.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/begin.html">begin</a>(), atoms.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/end.html">end</a>());</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;  <span class="comment">// Resize peripheral rings to remove undefined terms</span></div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;  atoms.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/resize.html">resize</a>(<a class="codeRef" href="http://en.cppreference.com/w/cpp/iterator/distance.html">std::distance</a>(atoms.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/begin.html">begin</a>(), ip));</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;  <span class="comment">// Return the vector of atoms</span></div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;  <span class="keywordflow">return</span> atoms;</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;}</div>
<div class="ttc" id="abegin_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/container/vector/begin.html">std::vector::begin</a></div><div class="ttdeci">T begin(T... args)</div></div>
<div class="ttc" id="adistance_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/iterator/distance.html">std::distance</a></div><div class="ttdeci">T distance(T... args)</div></div>
<div class="ttc" id="aend_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/container/vector/end.html">std::vector::end</a></div><div class="ttdeci">T end(T... args)</div></div>
<div class="ttc" id="agroup__ring_html_ga34dea1971104b5adb318178730ffc40d"><div class="ttname"><a href="group__ring.html#ga34dea1971104b5adb318178730ffc40d">tum3::clusterCages</a></div><div class="ttdeci">int clusterCages(molSys::PointCloud&lt; molSys::Point&lt; double &gt;, double &gt; *yCloud, std::string path, std::vector&lt; std::vector&lt; int &gt;&gt; rings, std::vector&lt; cage::Cage &gt; cageList, int numHC, int numDDC)</div><div class="ttdef"><b>Definition:</b> <a href="bulkTUM_8cpp_source.html#l00644">bulkTUM.cpp:644</a></div></div>
<div class="ttc" id="apush_back_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/container/vector/push_back.html">std::vector::push_back</a></div><div class="ttdeci">T push_back(T... args)</div></div>
<div class="ttc" id="aresize_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/container/vector/resize.html">std::vector::resize</a></div><div class="ttdeci">T resize(T... args)</div></div>
<div class="ttc" id="asort_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/algorithm/sort.html">std::sort</a></div><div class="ttdeci">T sort(T... args)</div></div>
<div class="ttc" id="aunique_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/algorithm/unique.html">std::unique</a></div><div class="ttdeci">T unique(T... args)</div></div>
<div class="ttc" id="avector_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt; int &gt;</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ga336353070302bc293ed5261838ee979e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga336353070302bc293ed5261838ee979e">&#9670;&nbsp;</a></span>atomsInSingleSlice()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void gen::atomsInSingleSlice </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmolSys_1_1PointCloud.html">molSys::PointCloud</a>&lt; <a class="el" href="structmolSys_1_1Point.html">molSys::Point</a>&lt; double &gt;, double &gt; *&#160;</td>
          <td class="paramname"><em>yCloud</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>clearPreviousSliceSelection</em> = <code>true</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="elRef" href="http://en.cppreference.com/w/cpp/container/array.html">std::array</a>&lt; double, 3 &gt;&#160;</td>
          <td class="paramname"><em>coordLow</em> = <code><a class="elRef" href="http://en.cppreference.com/w/cpp/container/array.html">std::array</a>&lt;double,&#160;3&gt;{0,&#160;0,&#160;0}</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="elRef" href="http://en.cppreference.com/w/cpp/container/array.html">std::array</a>&lt; double, 3 &gt;&#160;</td>
          <td class="paramname"><em>coordHigh</em> = <code><a class="elRef" href="http://en.cppreference.com/w/cpp/container/array.html">std::array</a>&lt;double,&#160;3&gt;{0,&#160;0,&#160;0}</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Given a pointCloud set the inSlice bool for every atom, if the atoms are inside the specified (single) region. Does not handle atoms in molecules straddling the boundary</p>
<p>Function that loops through a given input PointCloud and sets the inSlice bool for every Point according to whether the atom <br  />
 is in the specified (single) slice or not. Not inclusive of atoms in molecules </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">yCloud</td><td>The given input PointCloud </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">clearPreviousSliceSelection</td><td>sets all inSlice bool values to false before adding Points to the slice </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">coordLow</td><td>Contains the lower limits of the slice, if a slice is to be created </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">coordHigh</td><td>Contains the upper limits of the slice, if a slice is to be created </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="selection_8cpp_source.html#l00101">101</a> of file <a class="el" href="selection_8cpp_source.html">selection.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;                                   {</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  <span class="keywordtype">bool</span> pointInSlice = <span class="keyword">true</span>; <span class="comment">// If the current point is in the slice, this is true (otherwise this is false)</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160; </div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  <span class="comment">// --------------------</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  <span class="comment">// Set inSlice to false for every atom first</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  <span class="keywordflow">if</span> (clearPreviousSliceSelection)</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  {</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iatom = 0; iatom &lt; yCloud-&gt;<a class="code" href="group__molSys.html#ga2bdcb9260bd83f313a2d27fcc6437ef1">nop</a>; iatom++) {</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;      yCloud-&gt;<a class="code" href="group__molSys.html#ga67ab89369cd26572878a91afd521ef81">pts</a>[iatom].inSlice = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    }</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  } <span class="comment">// end of init</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  <span class="comment">// --------------------</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160; </div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;  <span class="comment">// Loop through every iatom and check if the atom is in the slice or not </span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iatom = 0; iatom &lt; yCloud-&gt;<a class="code" href="group__molSys.html#ga2bdcb9260bd83f313a2d27fcc6437ef1">nop</a>; iatom++) {</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    <span class="comment">// Check if the current atom is in the slice </span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    pointInSlice = <a class="code" href="group__sinp.html#gad5a8c377d8ed78c413c13d80ac8261ac">sinp::atomInSlice</a>(yCloud-&gt;<a class="code" href="group__molSys.html#ga67ab89369cd26572878a91afd521ef81">pts</a>[iatom].x, yCloud-&gt;<a class="code" href="group__molSys.html#ga67ab89369cd26572878a91afd521ef81">pts</a>[iatom].y, yCloud-&gt;<a class="code" href="group__molSys.html#ga67ab89369cd26572878a91afd521ef81">pts</a>[iatom].z,</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;                                               coordLow, coordHigh);</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160; </div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    yCloud-&gt;<a class="code" href="group__molSys.html#ga67ab89369cd26572878a91afd521ef81">pts</a>[iatom].inSlice = pointInSlice; <span class="comment">// iatom is inside the slice</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  }</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160; </div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;}</div>
<div class="ttc" id="agroup__molSys_html_ga2bdcb9260bd83f313a2d27fcc6437ef1"><div class="ttname"><a href="group__molSys.html#ga2bdcb9260bd83f313a2d27fcc6437ef1">molSys::PointCloud::nop</a></div><div class="ttdeci">int nop</div><div class="ttdoc">Current frame number.</div><div class="ttdef"><b>Definition:</b> <a href="mol__sys_8hpp_source.html#l00173">mol_sys.hpp:173</a></div></div>
<div class="ttc" id="agroup__molSys_html_ga67ab89369cd26572878a91afd521ef81"><div class="ttname"><a href="group__molSys.html#ga67ab89369cd26572878a91afd521ef81">molSys::PointCloud::pts</a></div><div class="ttdeci">std::vector&lt; S &gt; pts</div><div class="ttdef"><b>Definition:</b> <a href="mol__sys_8hpp_source.html#l00171">mol_sys.hpp:171</a></div></div>
<div class="ttc" id="agroup__sinp_html_gad5a8c377d8ed78c413c13d80ac8261ac"><div class="ttname"><a href="group__sinp.html#gad5a8c377d8ed78c413c13d80ac8261ac">sinp::atomInSlice</a></div><div class="ttdeci">bool atomInSlice(double x, double y, double z, std::array&lt; double, 3 &gt; coordLow, std::array&lt; double, 3 &gt; coordHigh)</div><div class="ttdef"><b>Definition:</b> <a href="seams__input_8hpp_source.html#l00089">seams_input.hpp:89</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ga390a8ecb9b86c18c3802fcbdcf37cd83"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga390a8ecb9b86c18c3802fcbdcf37cd83">&#9670;&nbsp;</a></span>averageRMSDatom()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int tum3::averageRMSDatom </td>
          <td>(</td>
          <td class="paramtype"><a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; double &gt; *&#160;</td>
          <td class="paramname"><em>rmsdPerAtom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt; *&#160;</td>
          <td class="paramname"><em>noOfCommonAtoms</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Average the RMSD per atom. </p>
<p>Average the RMSD per atom, by the number of common elements </p>

<p class="definition">Definition at line <a class="el" href="bulkTUM_8cpp_source.html#l00529">529</a> of file <a class="el" href="bulkTUM_8cpp_source.html">bulkTUM.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;                                                           {</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;  <span class="keywordtype">int</span> nop = (*rmsdPerAtom).size(); <span class="comment">// Number of particles</span></div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160; </div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iatom = 0; iatom &lt; nop; iatom++) {</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;    <span class="keywordflow">if</span> ((*noOfCommonAtoms)[iatom] == 0) {</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;      (*rmsdPerAtom)[iatom] = -1; <span class="comment">// Dummy atom</span></div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;      (*rmsdPerAtom)[iatom] /= (*noOfCommonAtoms)[iatom];</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;    }</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;  } <span class="comment">// end of averaging</span></div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160; </div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;  <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;} <span class="comment">// end of function</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="gacd2f05f7a6e394f6aae0c0d6e016a383"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gacd2f05f7a6e394f6aae0c0d6e016a383">&#9670;&nbsp;</a></span>basalPrismConditions()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool ring::basalPrismConditions </td>
          <td>(</td>
          <td class="paramtype"><a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; <a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt;&gt;&#160;</td>
          <td class="paramname"><em>nList</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt; *&#160;</td>
          <td class="paramname"><em>basal1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt; *&#160;</td>
          <td class="paramname"><em>basal2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Tests whether two rings are basal rings (true) or not (false) for a prism (strict criterion)</p>
<p>A function that checks to see if two basal rings are basal rings of a prism block or not, using the neighbour list information. The neighbour list nList is a row-ordered vector of vectors, containing atom indices (not atom IDs!). The first element of each subvector in nList is the atom index of the particle for which the other elements are the nearest neighbours. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">nList</td><td>Row-ordered neighbour list by atom index. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">basal1</td><td>The vector for one of the basal rings. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">basal2</td><td>The vector for the other basal ring. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A value that is true if the basal rings constitute a prism block, and false if they do not make up a prism block. </dd></dl>

<p class="definition">Definition at line <a class="el" href="topo__one__dim_8cpp_source.html#l00351">351</a> of file <a class="el" href="topo__one__dim_8cpp_source.html">topo_one_dim.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;                                                        {</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;  <span class="keywordtype">int</span> l1 = (*basal1)[0]; <span class="comment">// first element of basal1 ring</span></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;  <span class="keywordtype">int</span> ringSize =</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;      (*basal1).size(); <span class="comment">// Size of the ring; each ring contains n elements</span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;  <span class="keywordtype">int</span> m_k;              <span class="comment">// Atom ID of element in basal2</span></div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;  <span class="keywordtype">bool</span> l1_neighbour;    <span class="comment">// m_k is a neighbour of l1(true) or not (false)</span></div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160; </div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;  <span class="comment">// isNeighbour is initialized to false for all basal2 elements; indication if</span></div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;  <span class="comment">// basal2 elements are neighbours of basal1</span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;bool&gt;</a> isNeighbour(ringSize, <span class="keyword">false</span>);</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;  <span class="keywordtype">int</span> kIndex;  <span class="comment">// m_k index</span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;  <span class="keywordtype">int</span> lAtomID; <span class="comment">// atomID of the current element of basal1</span></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;  <span class="keywordtype">int</span> kAtomID; <span class="comment">// atomID of the current element of basal2</span></div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160; </div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;  <span class="comment">// ---------------------------------------------</span></div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;  <span class="comment">// COMPARISON OF basal2 ELEMENTS WITH l1</span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; ringSize; k++) {</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    l1_neighbour = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    m_k = (*basal2)[k];</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    <span class="comment">// =================================</span></div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    <span class="comment">// Checking to seee if m_k is be a neighbour of l1</span></div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    <span class="comment">// Find m_k inside l1 neighbour list</span></div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    <span class="keyword">auto</span> it = <a class="codeRef" href="http://en.cppreference.com/w/cpp/algorithm/find.html">std::find</a>(nList[l1].<a class="codeRef" href="http://en.cppreference.com/w/cpp/iterator/begin.html">begin</a>() + 1, nList[l1].<a class="codeRef" href="http://en.cppreference.com/w/cpp/iterator/end.html">end</a>(), m_k);</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160; </div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    <span class="comment">// If the element has been found, for l1</span></div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    <span class="keywordflow">if</span> (it != nList[l1].<a class="codeRef" href="http://en.cppreference.com/w/cpp/iterator/end.html">end</a>()) {</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;      l1_neighbour = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;      kIndex = k;</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    }</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;  } <span class="comment">// l1 is a neighbour of m_k</span></div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160; </div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;  <span class="comment">// If there is no nearest neighbour, then the two rings are not part of the</span></div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;  <span class="comment">// prism</span></div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;  <span class="keywordflow">if</span> (!l1_neighbour) {</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;  }</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160; </div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;  <span class="comment">// ---------------------------------------------</span></div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;  <span class="comment">// NEIGHBOURS of basal1 in basal2</span></div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;  isNeighbour[kIndex] = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160; </div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;  <span class="comment">// All elements of basal1 must be neighbours of basal2</span></div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt; ringSize; i++) {</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    lAtomID = (*basal1)[i]; <span class="comment">// element of basal1 ring</span></div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; ringSize; k++) {</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;      <span class="comment">// Skip if already a neighbour</span></div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;      <span class="keywordflow">if</span> (isNeighbour[k]) {</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;      }</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;      <span class="comment">// Get the comparison basal2 element</span></div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;      kAtomID = (*basal2)[k]; <span class="comment">// element of basal2 ring;</span></div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160; </div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;      <span class="comment">// Checking to see if kAtomID is a neighbour of lAtomID</span></div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;      <span class="comment">// Find kAtomID inside lAtomID neighbour list</span></div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;      <span class="keyword">auto</span> it1 =</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;          <a class="codeRef" href="http://en.cppreference.com/w/cpp/algorithm/find.html">std::find</a>(nList[lAtomID].<a class="codeRef" href="http://en.cppreference.com/w/cpp/iterator/begin.html">begin</a>() + 1, nList[lAtomID].<a class="codeRef" href="http://en.cppreference.com/w/cpp/iterator/end.html">end</a>(), kAtomID);</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160; </div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;      <span class="comment">// If the element has been found, for l1</span></div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;      <span class="keywordflow">if</span> (it1 != nList[lAtomID].<a class="codeRef" href="http://en.cppreference.com/w/cpp/iterator/end.html">end</a>()) {</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;        isNeighbour[k] = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;      }</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    } <span class="comment">// Loop through basal2</span></div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;  }   <span class="comment">// end of check for neighbours of basal1</span></div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160; </div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;  <span class="comment">// ---------------------------------------------</span></div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160; </div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;  <span class="comment">// They should all be neighbours</span></div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; ringSize; k++) {</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    <span class="comment">// Check to see if any element is false</span></div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    <span class="keywordflow">if</span> (!isNeighbour[k]) {</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    }</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;  }</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160; </div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;  <span class="comment">// Everything works out!</span></div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;}</div>
<div class="ttc" id="afind_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/algorithm/find.html">std::find</a></div><div class="ttdeci">T find(T... args)</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="gabf66bd35cdbccfd8fee51564dc889977"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gabf66bd35cdbccfd8fee51564dc889977">&#9670;&nbsp;</a></span>buildRefDDC()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Eigen::MatrixXd tum3::buildRefDDC </td>
          <td>(</td>
          <td class="paramtype"><a class="elRef" href="http://en.cppreference.com/w/cpp/string/basic_string.html">std::string</a>&#160;</td>
          <td class="paramname"><em>fileName</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Build a reference Double-Diamond cage, reading in from a template XYZ file. </p>
<p>Build a reference Double-Diamond cage, reading it in from a templates directory </p>

<p class="definition">Definition at line <a class="el" href="bulkTUM_8cpp_source.html#l00435">435</a> of file <a class="el" href="bulkTUM_8cpp_source.html">bulkTUM.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;                                                  {</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;  Eigen::MatrixXd refPnts(14, 3); <span class="comment">// Reference point set (Eigen matrix)</span></div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;  <span class="comment">// Get the reference HC point set</span></div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;  <a class="code" href="structmolSys_1_1PointCloud.html">molSys::PointCloud&lt;molSys::Point&lt;double&gt;</a>, <span class="keywordtype">double</span>&gt;</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;      setCloud; <span class="comment">// PointCloud for holding the reference point values</span></div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;  <span class="comment">// Variables for rings</span></div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;std::vector&lt;int&gt;</a>&gt; nList; <span class="comment">// Neighbour list</span></div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;std::vector&lt;int&gt;</a>&gt; rings; <span class="comment">// Rings</span></div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;ring::strucType&gt;</a></div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;      ringType; <span class="comment">// This vector will have a value for each ring inside</span></div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a> listDDC,</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;      listHC; <span class="comment">// Contains atom indices of atoms making up DDCs and HCs</span></div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a> ddcOrder; <span class="comment">// Atom indices of particles in the DDC</span></div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;  <span class="comment">// Make a list of all the DDCs and HCs</span></div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;cage::Cage&gt;</a> cageList;</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;  <span class="keywordtype">int</span> iring, jring;</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;  <span class="comment">// read in the XYZ file into the pointCloud setCloud</span></div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;  <a class="code" href="group__sinp.html#gab2f8bc3f639a2d2618460883116d5b5b">sinp::readXYZ</a>(fileName, &amp;setCloud);</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160; </div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;  <span class="comment">// box lengths</span></div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 3; i++) {</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    setCloud.<a class="code" href="group__molSys.html#gaa7d9b8543780baf4a495c7acdb1f87d8">box</a>[i] = 50;</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;  } <span class="comment">// end of setting box lengths</span></div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160; </div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;  nList = <a class="code" href="group__nneigh.html#gaaaaf74d25014d1c08bb73b8be0a6fe74">nneigh::neighListO</a>(3.5, &amp;setCloud, 1);</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;  <span class="comment">// Neighbour list by index</span></div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;  nList = <a class="code" href="group__nneigh.html#gab2468daaf43c827b54a88af914d0fee8">nneigh::neighbourListByIndex</a>(&amp;setCloud, nList);</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;  <span class="comment">// Find the vector of vector of rings</span></div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;  rings = <a class="code" href="group__primitive.html#ga9872b1fd04c72cc53626b882bec4b99f">primitive::ringNetwork</a>(nList, 6);</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;  <span class="comment">// init the ringType vector</span></div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;  ringType.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/resize.html">resize</a>(rings.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/size.html">size</a>());</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;  <span class="comment">// Find the DDCs</span></div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;  listDDC = <a class="code" href="group__prism3.html#ga35816c398a355ca472fddeb2869fce15">ring::findDDC</a>(rings, &amp;ringType, listHC, &amp;cageList);</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;  <span class="comment">// Save the order of the DDC in a vector</span></div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;  ddcOrder = <a class="code" href="namespacepntToPnt.html#a804eb495f58fd5868858cc46480c3425">pntToPnt::relOrderDDC</a>(0, rings, cageList);</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;  <span class="comment">// Get the reference point set</span></div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;  refPnts = <a class="code" href="namespacepntToPnt.html#a2c4affea21bfc133f8c752d74f3a943a">pntToPnt::changeDiaCageOrder</a>(&amp;setCloud, ddcOrder, 0);</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;  <span class="keywordflow">return</span> refPnts;</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;}</div>
<div class="ttc" id="agroup__molSys_html_gaa7d9b8543780baf4a495c7acdb1f87d8"><div class="ttname"><a href="group__molSys.html#gaa7d9b8543780baf4a495c7acdb1f87d8">molSys::PointCloud::box</a></div><div class="ttdeci">std::vector&lt; T &gt; box</div><div class="ttdoc">Number of atoms.</div><div class="ttdef"><b>Definition:</b> <a href="mol__sys_8hpp_source.html#l00174">mol_sys.hpp:174</a></div></div>
<div class="ttc" id="agroup__nneigh_html_gaaaaf74d25014d1c08bb73b8be0a6fe74"><div class="ttname"><a href="group__nneigh.html#gaaaaf74d25014d1c08bb73b8be0a6fe74">nneigh::neighListO</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; int &gt; &gt; neighListO(double rcutoff, molSys::PointCloud&lt; molSys::Point&lt; double &gt;, double &gt; *yCloud, int typeI)</div><div class="ttdef"><b>Definition:</b> <a href="neighbours_8cpp_source.html#l00118">neighbours.cpp:118</a></div></div>
<div class="ttc" id="agroup__nneigh_html_gab2468daaf43c827b54a88af914d0fee8"><div class="ttname"><a href="group__nneigh.html#gab2468daaf43c827b54a88af914d0fee8">nneigh::neighbourListByIndex</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; int &gt; &gt; neighbourListByIndex(molSys::PointCloud&lt; molSys::Point&lt; double &gt;, double &gt; *yCloud, std::vector&lt; std::vector&lt; int &gt;&gt; nList)</div><div class="ttdef"><b>Definition:</b> <a href="neighbours_8cpp_source.html#l00341">neighbours.cpp:341</a></div></div>
<div class="ttc" id="agroup__primitive_html_ga9872b1fd04c72cc53626b882bec4b99f"><div class="ttname"><a href="group__primitive.html#ga9872b1fd04c72cc53626b882bec4b99f">primitive::ringNetwork</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; int &gt; &gt; ringNetwork(std::vector&lt; std::vector&lt; int &gt;&gt; nList, int maxDepth)</div><div class="ttdef"><b>Definition:</b> <a href="franzblau_8cpp_source.html#l00032">franzblau.cpp:32</a></div></div>
<div class="ttc" id="agroup__prism3_html_ga35816c398a355ca472fddeb2869fce15"><div class="ttname"><a href="group__prism3.html#ga35816c398a355ca472fddeb2869fce15">ring::findDDC</a></div><div class="ttdeci">std::vector&lt; int &gt; findDDC(std::vector&lt; std::vector&lt; int &gt;&gt; rings, std::vector&lt; strucType &gt; *ringType, std::vector&lt; int &gt; listHC, std::vector&lt; cage::Cage &gt; *cageList)</div><div class="ttdef"><b>Definition:</b> <a href="topo__bulk_8cpp_source.html#l00285">topo_bulk.cpp:285</a></div></div>
<div class="ttc" id="agroup__sinp_html_gab2f8bc3f639a2d2618460883116d5b5b"><div class="ttname"><a href="group__sinp.html#gab2f8bc3f639a2d2618460883116d5b5b">sinp::readXYZ</a></div><div class="ttdeci">int readXYZ(std::string filename, molSys::PointCloud&lt; molSys::Point&lt; double &gt;, double &gt; *yCloud)</div><div class="ttdoc">Function for reading in atom coordinates from an XYZ file.</div><div class="ttdef"><b>Definition:</b> <a href="seams__input_8cpp_source.html#l00073">seams_input.cpp:73</a></div></div>
<div class="ttc" id="anamespacepntToPnt_html_a2c4affea21bfc133f8c752d74f3a943a"><div class="ttname"><a href="namespacepntToPnt.html#a2c4affea21bfc133f8c752d74f3a943a">pntToPnt::changeDiaCageOrder</a></div><div class="ttdeci">Eigen::MatrixXd changeDiaCageOrder(molSys::PointCloud&lt; molSys::Point&lt; double &gt;, double &gt; *yCloud, std::vector&lt; int &gt; ddcOrder, int startingIndex=0)</div><div class="ttdef"><b>Definition:</b> <a href="pntCorrespondence_8cpp_source.html#l01042">pntCorrespondence.cpp:1042</a></div></div>
<div class="ttc" id="anamespacepntToPnt_html_a804eb495f58fd5868858cc46480c3425"><div class="ttname"><a href="namespacepntToPnt.html#a804eb495f58fd5868858cc46480c3425">pntToPnt::relOrderDDC</a></div><div class="ttdeci">std::vector&lt; int &gt; relOrderDDC(int index, std::vector&lt; std::vector&lt; int &gt;&gt; rings, std::vector&lt; cage::Cage &gt; cageList)</div><div class="ttdoc">Matches the order of the basal rings of an DDC or a potential HC.</div><div class="ttdef"><b>Definition:</b> <a href="pntCorrespondence_8cpp_source.html#l00845">pntCorrespondence.cpp:845</a></div></div>
<div class="ttc" id="astructmolSys_1_1PointCloud_html"><div class="ttname"><a href="structmolSys_1_1PointCloud.html">molSys::PointCloud</a></div><div class="ttdoc">This contains a collection of points; contains information for a particular frame.</div><div class="ttdef"><b>Definition:</b> <a href="mol__sys_8hpp_source.html#l00170">mol_sys.hpp:170</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ga0a321aab8c8956e0885826b65e550a1d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga0a321aab8c8956e0885826b65e550a1d">&#9670;&nbsp;</a></span>buildRefHC()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Eigen::MatrixXd tum3::buildRefHC </td>
          <td>(</td>
          <td class="paramtype"><a class="elRef" href="http://en.cppreference.com/w/cpp/string/basic_string.html">std::string</a>&#160;</td>
          <td class="paramname"><em>fileName</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Build a reference Hexagonal cage, reading in from a template XYZ file. </p>
<p>Build a reference Hexagonal cage, reading it in from a templates directory </p>

<p class="definition">Definition at line <a class="el" href="bulkTUM_8cpp_source.html#l00377">377</a> of file <a class="el" href="bulkTUM_8cpp_source.html">bulkTUM.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;                                                 {</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;  Eigen::MatrixXd refPnts(12, 3); <span class="comment">// Reference point set (Eigen matrix)</span></div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;  <span class="comment">// Get the reference HC point set</span></div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;  <a class="code" href="structmolSys_1_1PointCloud.html">molSys::PointCloud&lt;molSys::Point&lt;double&gt;</a>, <span class="keywordtype">double</span>&gt;</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;      setCloud; <span class="comment">// PointCloud for holding the reference point values</span></div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;  <span class="comment">// Variables for rings</span></div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;std::vector&lt;int&gt;</a>&gt; nList; <span class="comment">// Neighbour list</span></div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;std::vector&lt;int&gt;</a>&gt; rings; <span class="comment">// Rings</span></div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;ring::strucType&gt;</a></div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;      ringType;            <span class="comment">// This vector will have a value for each ring inside</span></div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a> listHC; <span class="comment">// Contains atom indices of atoms making up HCs</span></div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;  <span class="comment">// Make a list of all the DDCs and HCs</span></div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;cage::Cage&gt;</a> cageList;</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;  <span class="keywordtype">int</span> iring, jring;</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;  <span class="comment">// read in the XYZ file into the pointCloud setCloud</span></div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;  <a class="code" href="group__sinp.html#gab2f8bc3f639a2d2618460883116d5b5b">sinp::readXYZ</a>(fileName, &amp;setCloud);</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;  <span class="comment">// box lengths</span></div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 3; i++) {</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    setCloud.<a class="code" href="group__molSys.html#gaa7d9b8543780baf4a495c7acdb1f87d8">box</a>[i] = 50;</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;  } <span class="comment">// end of setting box lengths</span></div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160; </div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;  nList = <a class="code" href="group__nneigh.html#gaaaaf74d25014d1c08bb73b8be0a6fe74">nneigh::neighListO</a>(3.5, &amp;setCloud, 1);</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;  <span class="comment">// Neighbour list by index</span></div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;  nList = <a class="code" href="group__nneigh.html#gab2468daaf43c827b54a88af914d0fee8">nneigh::neighbourListByIndex</a>(&amp;setCloud, nList);</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;  <span class="comment">// Find the vector of vector of rings</span></div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;  rings = <a class="code" href="group__primitive.html#ga9872b1fd04c72cc53626b882bec4b99f">primitive::ringNetwork</a>(nList, 6);</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;  <span class="comment">// init the ringType vector</span></div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;  ringType.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/resize.html">resize</a>(rings.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/size.html">size</a>());</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;  <span class="comment">// Find the HCs</span></div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;  listHC = <a class="code" href="group__prism3.html#gaf6c8e26a55c976c7ae810914bd1c7362">ring::findHC</a>(rings, &amp;ringType, nList, &amp;cageList);</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;  <span class="comment">// Get the basal rings from cageList</span></div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;  iring = cageList[0].rings[0];</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;  jring = cageList[0].rings[1];</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a> matchedBasal1,</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;      matchedBasal2; <span class="comment">// Re-ordered basal rings 1 and 2</span></div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;  <span class="comment">// Reordered basal rings</span></div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;  <span class="comment">// Getting the target Eigen vectors</span></div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;  <span class="comment">// Get the re-ordered matched basal rings, ordered with respect to each</span></div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;  <span class="comment">// other</span></div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160; </div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;  <a class="code" href="namespacepntToPnt.html#a8140eb2ad1dfb9d08e4e917dd14d5424">pntToPnt::relOrderHC</a>(&amp;setCloud, rings[iring], rings[jring], nList,</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;                       &amp;matchedBasal1, &amp;matchedBasal2);</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;  <span class="comment">// Get the reference point set</span></div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;  refPnts =</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;      <a class="code" href="namespacepntToPnt.html#a896e8ed3ac4436156eac99b12e12c255">pntToPnt::changeHexCageOrder</a>(&amp;setCloud, matchedBasal1, matchedBasal2, 0);</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;  <span class="keywordflow">return</span> refPnts;</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;}</div>
<div class="ttc" id="agroup__prism3_html_gaf6c8e26a55c976c7ae810914bd1c7362"><div class="ttname"><a href="group__prism3.html#gaf6c8e26a55c976c7ae810914bd1c7362">ring::findHC</a></div><div class="ttdeci">std::vector&lt; int &gt; findHC(std::vector&lt; std::vector&lt; int &gt;&gt; rings, std::vector&lt; strucType &gt; *ringType, std::vector&lt; std::vector&lt; int &gt;&gt; nList, std::vector&lt; cage::Cage &gt; *cageList)</div><div class="ttdef"><b>Definition:</b> <a href="topo__bulk_8cpp_source.html#l00651">topo_bulk.cpp:651</a></div></div>
<div class="ttc" id="anamespacepntToPnt_html_a8140eb2ad1dfb9d08e4e917dd14d5424"><div class="ttname"><a href="namespacepntToPnt.html#a8140eb2ad1dfb9d08e4e917dd14d5424">pntToPnt::relOrderHC</a></div><div class="ttdeci">int relOrderHC(molSys::PointCloud&lt; molSys::Point&lt; double &gt;, double &gt; *yCloud, std::vector&lt; int &gt; basal1, std::vector&lt; int &gt; basal2, std::vector&lt; std::vector&lt; int &gt;&gt; nList, std::vector&lt; int &gt; *matchedBasal1, std::vector&lt; int &gt; *matchedBasal2)</div><div class="ttdoc">Matches the order of the basal rings of an HC or a potential HC.</div><div class="ttdef"><b>Definition:</b> <a href="pntCorrespondence_8cpp_source.html#l00609">pntCorrespondence.cpp:609</a></div></div>
<div class="ttc" id="anamespacepntToPnt_html_a896e8ed3ac4436156eac99b12e12c255"><div class="ttname"><a href="namespacepntToPnt.html#a896e8ed3ac4436156eac99b12e12c255">pntToPnt::changeHexCageOrder</a></div><div class="ttdeci">Eigen::MatrixXd changeHexCageOrder(molSys::PointCloud&lt; molSys::Point&lt; double &gt;, double &gt; *yCloud, std::vector&lt; int &gt; basal1, std::vector&lt; int &gt; basal2, int startingIndex=0)</div><div class="ttdef"><b>Definition:</b> <a href="pntCorrespondence_8cpp_source.html#l00740">pntCorrespondence.cpp:740</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ga76f3cb7aa8a713aeafecdf3a6fffee31"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga76f3cb7aa8a713aeafecdf3a6fffee31">&#9670;&nbsp;</a></span>clearRingList()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ring::clearRingList </td>
          <td>(</td>
          <td class="paramtype"><a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; <a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt;&gt; &amp;&#160;</td>
          <td class="paramname"><em>rings</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Erases memory for a vector of vectors for a list of rings. </p>
<p>Deletes the memory of a vector of vectors (specifically for rings). </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">rings</td><td>The vector of vectors to be cleared. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="ring_8cpp_source.html#l00022">22</a> of file <a class="el" href="ring_8cpp_source.html">ring.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;                                                        {</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;std::vector&lt;int&gt;</a>&gt; tempEmpty;</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160; </div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;  rings.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/swap.html">swap</a>(tempEmpty);</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160; </div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;  <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;}</div>
<div class="ttc" id="aswap_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/container/vector/swap.html">std::vector::swap</a></div><div class="ttdeci">T swap(T... args)</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ga34dea1971104b5adb318178730ffc40d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga34dea1971104b5adb318178730ffc40d">&#9670;&nbsp;</a></span>clusterCages()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int tum3::clusterCages </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmolSys_1_1PointCloud.html">molSys::PointCloud</a>&lt; <a class="el" href="structmolSys_1_1Point.html">molSys::Point</a>&lt; double &gt;, double &gt; *&#160;</td>
          <td class="paramname"><em>yCloud</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="elRef" href="http://en.cppreference.com/w/cpp/string/basic_string.html">std::string</a>&#160;</td>
          <td class="paramname"><em>path</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; <a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt;&gt;&#160;</td>
          <td class="paramname"><em>rings</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; <a class="el" href="structcage_1_1Cage.html">cage::Cage</a> &gt;&#160;</td>
          <td class="paramname"><em>cageList</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>numHC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>numDDC</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Clustering Clusters cages using the Stillinger algorithm and prints out individual XYZ files of clusters.</p>
<p>Groups cages into clusters and prints out each cluster into an XYZ file </p>

<p class="definition">Definition at line <a class="el" href="bulkTUM_8cpp_source.html#l00644">644</a> of file <a class="el" href="bulkTUM_8cpp_source.html">bulkTUM.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;                           {</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a> linkedList; <span class="comment">// Linked list for the clustered cages</span></div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;  <span class="keywordtype">int</span> nCages = numHC + numDDC; <span class="comment">// Number of cages in total</span></div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;  <span class="keywordtype">int</span> j, temp;                 <span class="comment">// Variables used inside the loops</span></div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;  <span class="keywordtype">bool</span> isNeighbour; <span class="comment">// true if cages are adjacent to each other, false otherwise</span></div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;bool&gt;</a></div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;      visited; <span class="comment">// To make sure you don&#39;t go through the same cages again.</span></div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;  <span class="keywordtype">int</span> singleDDCs, singleHCs; <span class="comment">// Number of single DDCs and HCs</span></div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;  <span class="comment">// Units are in Angstrom^3</span></div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;  <span class="keywordtype">double</span> volDDC = 72.7;          <span class="comment">// The calculated alpha volume of a single DDC</span></div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;  <span class="keywordtype">double</span> volHC = 40.63;          <span class="comment">// The calculated alpha volume of a single HC</span></div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;  <span class="keywordtype">int</span> nextElement;               <span class="comment">// value in list</span></div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;  <span class="keywordtype">int</span> index;                     <span class="comment">// starting index value</span></div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;  <span class="keywordtype">int</span> currentIndex;              <span class="comment">// Current cage index</span></div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;  <span class="keywordtype">int</span> iClusterNumber;            <span class="comment">// Number in the current cluster</span></div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a> nClusters;    <span class="comment">// Number of cages in each cluster</span></div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a> <a class="code" href="group__ring.html#ga34dea1971104b5adb318178730ffc40d">clusterCages</a>; <span class="comment">// Indices of each cage in the cluster</span></div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a> atoms; <span class="comment">// Vector containing the atom indices of all the</span></div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;                          <span class="comment">// atoms in the cages</span></div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;  <a class="code" href="group__cage.html#ga5787314f51b5927c213db48b81c21d95">cage::cageType</a> type;    <span class="comment">// Type of the cages in the cluster</span></div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;  <span class="comment">// -----------------------------------------------------------</span></div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;  <span class="comment">// INITIALIZATION</span></div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;  linkedList.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/resize.html">resize</a>(nCages); <span class="comment">// init to dummy value</span></div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;  <span class="comment">// Initial values of the list.</span></div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> icage = 0; icage &lt; nCages; icage++) {</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;    <span class="comment">// Assign the index as the ID</span></div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;    linkedList[icage] = icage; <span class="comment">// Index</span></div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;  }                            <span class="comment">// init of cluster IDs</span></div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;  <span class="comment">// -----------------------------------------------------------</span></div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;  <span class="comment">// GETTING THE LINKED LIST</span></div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;  <span class="comment">// HCs first</span></div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; nCages - 1; i++) {</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;    <span class="comment">// If iatom is already in a cluster, skip it</span></div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;    <span class="keywordflow">if</span> (linkedList[i] != i) {</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;    } <span class="comment">// Already part of a cluster</span></div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;    j = i; <span class="comment">// Init of j</span></div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;    <span class="comment">// Execute the next part of the loop while j is not equal to i</span></div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;    <span class="keywordflow">do</span> {</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;      <span class="comment">//</span></div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;      <span class="comment">// Go through the rest of the atoms (KLOOP)</span></div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = i + 1; k &lt; nCages; k++) {</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;        <span class="comment">// Skip if already part of a cluster</span></div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;        <span class="keywordflow">if</span> (linkedList[k] != k) {</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;          <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;        } <span class="comment">// Already part of a cluster</span></div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;        <span class="comment">// k and j must be of the same type</span></div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;        <span class="keywordflow">if</span> (cageList[k].type != cageList[j].type) {</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;          <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;        } <span class="comment">// skip if k and j are not of the same type</span></div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;        <span class="comment">// Check to see if k is a nearest neighbour of j</span></div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;        isNeighbour =</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;            <a class="code" href="group__ring.html#gac30855d0daa2b20c29e4dee39f5cd92f">ring::hasCommonElements</a>(cageList[k].rings, cageList[j].rings);</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;        <span class="keywordflow">if</span> (isNeighbour) {</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;          <span class="comment">// Swap!</span></div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;          temp = linkedList[j];</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;          linkedList[j] = linkedList[k];</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;          linkedList[k] = temp;</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;        } <span class="comment">// j and k are neighbouring cages</span></div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;      }   <span class="comment">// end of loop through k (KLOOP)</span></div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;      <span class="comment">//</span></div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;      j = linkedList[j];</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;    } <span class="keywordflow">while</span> (j != i); <span class="comment">// end of control for j!=i</span></div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;  } <span class="comment">// end of getting the linked list (looping through every i)</span></div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;  <span class="comment">// -----------------------------------------------------------</span></div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;  <span class="comment">// WRITE-OUTS</span></div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;  <span class="comment">// init</span></div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;  visited.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/resize.html">resize</a>(nCages);</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;  singleDDCs = 0;</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;  singleHCs = 0;</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160; </div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; nCages; i++) {</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;    <span class="keywordflow">if</span> (visited[i]) {</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;    } <span class="comment">// Already counted</span></div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;    <span class="comment">// Now that the cage has been visited, set it to true</span></div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;    visited[i] = <span class="keyword">true</span>; <span class="comment">// Visited</span></div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;    <span class="comment">// If only one cage is in the cluster</span></div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;    <span class="keywordflow">if</span> (linkedList[i] == i) {</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;      <span class="comment">// Add to the number of single DDCs</span></div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;      <span class="keywordflow">if</span> (cageList[i].type == <a class="code" href="group__cage.html#gga5787314f51b5927c213db48b81c21d95ac5a9e4f20bab07bef66bb6e15c49682d">cage::DoubleDiaC</a>) {</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;        singleDDCs++;</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;      } <span class="comment">// add to the single DDCs</span></div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;      <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;        singleHCs++;</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;      } <span class="comment">// single HCs</span></div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;    } <span class="comment">// cluster has only one cage</span></div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;    <span class="comment">// init</span></div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;    <a class="code" href="group__ring.html#ga34dea1971104b5adb318178730ffc40d">clusterCages</a>.resize(0);</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;    type = cageList[i].type;</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;    currentIndex = i;</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;    nextElement = linkedList[currentIndex];</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;    index = i;</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;    iClusterNumber = 1;        <span class="comment">// at least one value</span></div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;    <a class="code" href="group__ring.html#ga34dea1971104b5adb318178730ffc40d">clusterCages</a>.push_back(i); <span class="comment">// Add the first cage</span></div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;    <span class="comment">// Get the other cages in the cluster</span></div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;    <span class="keywordflow">while</span> (nextElement != index) {</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;      iClusterNumber++;</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;      currentIndex = nextElement;</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;      visited[currentIndex] = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;      <a class="code" href="group__ring.html#ga34dea1971104b5adb318178730ffc40d">clusterCages</a>.push_back(currentIndex); <span class="comment">// Add the first cage</span></div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;      nextElement = linkedList[currentIndex];</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;    } <span class="comment">// get number</span></div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;    <span class="comment">// Update the number of molecules in the cluster</span></div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;    nClusters.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/push_back.html">push_back</a>(iClusterNumber);</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;    <span class="comment">// --------------</span></div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;    <span class="comment">// PRINT OUT</span></div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;    atoms = <a class="code" href="group__ring.html#ga2a339a36e85ff35c64fa3908936faf6c">tum3::atomsFromCages</a>(rings, cageList, <a class="code" href="group__ring.html#ga34dea1971104b5adb318178730ffc40d">clusterCages</a>);</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;    <span class="keywordtype">int</span> clusterID = nClusters.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/size.html">size</a>();</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;    <span class="comment">// Write out the cluster</span></div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;    <a class="code" href="namespacesout.html#ad80ee9773d7921a87ef5bbbe76541a91">sout::writeXYZcluster</a>(path, yCloud, atoms, clusterID, type);</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;    <span class="comment">// Print out the cages into an XYZ file</span></div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;    <span class="comment">// --------------</span></div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;  } <span class="comment">// end of loop through</span></div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;  <span class="comment">// -----------------------------------------------------------</span></div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;  <span class="comment">// Write out the stuff for single cages</span></div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;  <span class="comment">// ----------------</span></div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/io/basic_ofstream.html">std::ofstream</a> outputFile;</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;  <span class="comment">// Make the output directory if it doesn&#39;t exist</span></div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;  <a class="code" href="namespacesout.html#a3985775f30d7920fbf13f12386abefc1">sout::makePath</a>(path);</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/string/basic_string.html">std::string</a> outputDirName = path + <span class="stringliteral">&quot;bulkTopo&quot;</span>;</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;  <a class="code" href="namespacesout.html#a3985775f30d7920fbf13f12386abefc1">sout::makePath</a>(outputDirName);</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;  outputDirName = path + <span class="stringliteral">&quot;bulkTopo/clusterXYZ/&quot;</span>;</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;  <a class="code" href="namespacesout.html#a3985775f30d7920fbf13f12386abefc1">sout::makePath</a>(outputDirName);</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;  outputDirName = path + <span class="stringliteral">&quot;bulkTopo/clusterXYZ/frame-&quot;</span> +</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;                  <a class="codeRef" href="http://en.cppreference.com/w/cpp/string/basic_string/to_string.html">std::to_string</a>(yCloud-&gt;<a class="code" href="group__molSys.html#gafccb5a0daab40c3ccc83e4494f4176d7">currentFrame</a>);</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;  <a class="code" href="namespacesout.html#a3985775f30d7920fbf13f12386abefc1">sout::makePath</a>(outputDirName);</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;  <span class="comment">// ----------------</span></div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;  <span class="comment">// Write output to file inside the output directory</span></div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;  outputFile.<a class="codeRef" href="http://en.cppreference.com/w/cpp/io/basic_ofstream/open.html">open</a>(path + <span class="stringliteral">&quot;bulkTopo/clusterXYZ/frame-&quot;</span> +</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;                  <a class="codeRef" href="http://en.cppreference.com/w/cpp/string/basic_string/to_string.html">std::to_string</a>(yCloud-&gt;<a class="code" href="group__molSys.html#gafccb5a0daab40c3ccc83e4494f4176d7">currentFrame</a>) + <span class="stringliteral">&quot;/info.dat&quot;</span>);</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;  outputFile &lt;&lt; <span class="stringliteral">&quot;# volDDC volHC in Angstrom^3\n&quot;</span>;</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;  outputFile &lt;&lt; singleDDCs * volDDC &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; singleHCs * volHC &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;  outputFile &lt;&lt; <span class="stringliteral">&quot;There are &quot;</span> &lt;&lt; singleDDCs &lt;&lt; <span class="stringliteral">&quot; single DDCs\n&quot;</span>;</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;  outputFile &lt;&lt; <span class="stringliteral">&quot;There are &quot;</span> &lt;&lt; singleHCs &lt;&lt; <span class="stringliteral">&quot; single HCs\n&quot;</span>;</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;  outputFile.<a class="codeRef" href="http://en.cppreference.com/w/cpp/io/basic_ofstream/close.html">close</a>(); <span class="comment">// Close the file</span></div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;  <span class="comment">// -----------------------------------------------------------</span></div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;  <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;} <span class="comment">// end of the function</span></div>
<div class="ttc" id="abasic_ofstream_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/io/basic_ofstream.html">std::ofstream</a></div></div>
<div class="ttc" id="abasic_string_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/string/basic_string.html">std::string</a></div></div>
<div class="ttc" id="aclose_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/io/basic_ofstream/close.html">std::ofstream::close</a></div><div class="ttdeci">T close(T... args)</div></div>
<div class="ttc" id="agroup__cage_html_ga5787314f51b5927c213db48b81c21d95"><div class="ttname"><a href="group__cage.html#ga5787314f51b5927c213db48b81c21d95">cage::cageType</a></div><div class="ttdeci">cageType</div><div class="ttdef"><b>Definition:</b> <a href="cage_8hpp_source.html#l00054">cage.hpp:54</a></div></div>
<div class="ttc" id="agroup__cage_html_gga5787314f51b5927c213db48b81c21d95ac5a9e4f20bab07bef66bb6e15c49682d"><div class="ttname"><a href="group__cage.html#gga5787314f51b5927c213db48b81c21d95ac5a9e4f20bab07bef66bb6e15c49682d">cage::DoubleDiaC</a></div><div class="ttdeci">@ DoubleDiaC</div><div class="ttdef"><b>Definition:</b> <a href="cage_8hpp_source.html#l00054">cage.hpp:54</a></div></div>
<div class="ttc" id="agroup__molSys_html_gafccb5a0daab40c3ccc83e4494f4176d7"><div class="ttname"><a href="group__molSys.html#gafccb5a0daab40c3ccc83e4494f4176d7">molSys::PointCloud::currentFrame</a></div><div class="ttdeci">int currentFrame</div><div class="ttdoc">Collection of points.</div><div class="ttdef"><b>Definition:</b> <a href="mol__sys_8hpp_source.html#l00172">mol_sys.hpp:172</a></div></div>
<div class="ttc" id="agroup__ring_html_ga2a339a36e85ff35c64fa3908936faf6c"><div class="ttname"><a href="group__ring.html#ga2a339a36e85ff35c64fa3908936faf6c">tum3::atomsFromCages</a></div><div class="ttdeci">std::vector&lt; int &gt; atomsFromCages(std::vector&lt; std::vector&lt; int &gt;&gt; rings, std::vector&lt; cage::Cage &gt; cageList, std::vector&lt; int &gt; clusterCages)</div><div class="ttdoc">Gets the atoms in the cages of a given cluster.</div><div class="ttdef"><b>Definition:</b> <a href="bulkTUM_8cpp_source.html#l00801">bulkTUM.cpp:801</a></div></div>
<div class="ttc" id="agroup__ring_html_gac30855d0daa2b20c29e4dee39f5cd92f"><div class="ttname"><a href="group__ring.html#gac30855d0daa2b20c29e4dee39f5cd92f">ring::hasCommonElements</a></div><div class="ttdeci">bool hasCommonElements(std::vector&lt; int &gt; ring1, std::vector&lt; int &gt; ring2)</div><div class="ttdef"><b>Definition:</b> <a href="ring_8cpp_source.html#l00226">ring.cpp:226</a></div></div>
<div class="ttc" id="anamespacesout_html_a3985775f30d7920fbf13f12386abefc1"><div class="ttname"><a href="namespacesout.html#a3985775f30d7920fbf13f12386abefc1">sout::makePath</a></div><div class="ttdeci">int makePath(const std::string &amp;path)</div><div class="ttdef"><b>Definition:</b> <a href="seams__output_8hpp_source.html#l00064">seams_output.hpp:64</a></div></div>
<div class="ttc" id="anamespacesout_html_ad80ee9773d7921a87ef5bbbe76541a91"><div class="ttname"><a href="namespacesout.html#ad80ee9773d7921a87ef5bbbe76541a91">sout::writeXYZcluster</a></div><div class="ttdeci">int writeXYZcluster(std::string path, molSys::PointCloud&lt; molSys::Point&lt; double &gt;, double &gt; *yCloud, std::vector&lt; int &gt; atoms, int clusterID, cage::cageType type)</div><div class="ttdoc">Function for writing out the XYZ files for each cluster.</div><div class="ttdef"><b>Definition:</b> <a href="seams__output_8cpp_source.html#l02550">seams_output.cpp:2550</a></div></div>
<div class="ttc" id="aopen_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/io/basic_ofstream/open.html">std::ofstream::open</a></div><div class="ttdeci">T open(T... args)</div></div>
<div class="ttc" id="ato_string_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/string/basic_string/to_string.html">std::to_string</a></div><div class="ttdeci">T to_string(T... args)</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ga0d4e6d1dca2b07091dc0d94999c36ed9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga0d4e6d1dca2b07091dc0d94999c36ed9">&#9670;&nbsp;</a></span>commonElementsInThreeRings()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool ring::commonElementsInThreeRings </td>
          <td>(</td>
          <td class="paramtype"><a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt;&#160;</td>
          <td class="paramname"><em>ring1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt;&#160;</td>
          <td class="paramname"><em>ring2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt;&#160;</td>
          <td class="paramname"><em>ring3</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Common elements in 3 rings. </p>
<p>Function that finds the common elements in three input rings </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ring1</td><td>The first ring. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ring2</td><td>The second ring. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ring3</td><td>The third ring. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A value which is true if the three rings have at least one common element, and false if the three rings have no elements in common. </dd></dl>

<p class="definition">Definition at line <a class="el" href="ring_8cpp_source.html#l00114">114</a> of file <a class="el" href="ring_8cpp_source.html">ring.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;                                                            {</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;      common1; <span class="comment">// Vector containing the common elements of the first two rings</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;      common2; <span class="comment">// Vector containing the common elements of the three rings</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160; </div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  <span class="comment">// Common elements among the first two rings</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  common1 = <a class="code" href="group__ring.html#gaed5f39c14a4d76c1746aed53e0d0a2dc">ring::findsCommonElements</a>(ring1, ring2);</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;  <span class="keywordflow">if</span> (common1.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/size.html">size</a>() == 0) {</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;  } <span class="comment">// no common elements in ring1 and ring2</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160; </div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  <span class="comment">// Common elements among all three rings</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  common2 = <a class="code" href="group__ring.html#gaed5f39c14a4d76c1746aed53e0d0a2dc">ring::findsCommonElements</a>(common1, ring3);</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160; </div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;  <span class="comment">// If no common elements were found:</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;  <span class="keywordflow">if</span> (common2.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/size.html">size</a>() == 0) {</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;  } <span class="comment">// no common elements between ring1, ring2, and ring3</span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160; </div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>; <span class="comment">// Common elements found!</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;}</div>
<div class="ttc" id="agroup__ring_html_gaed5f39c14a4d76c1746aed53e0d0a2dc"><div class="ttname"><a href="group__ring.html#gaed5f39c14a4d76c1746aed53e0d0a2dc">ring::findsCommonElements</a></div><div class="ttdeci">std::vector&lt; int &gt; findsCommonElements(std::vector&lt; int &gt; ring1, std::vector&lt; int &gt; ring2)</div><div class="ttdoc">Returns the common elements of two rings.</div><div class="ttdef"><b>Definition:</b> <a href="ring_8cpp_source.html#l00085">ring.cpp:85</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="gaf9c0101aa7e09f97cbcf46a4ab83e0c6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaf9c0101aa7e09f97cbcf46a4ab83e0c6">&#9670;&nbsp;</a></span>compareRings()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool ring::compareRings </td>
          <td>(</td>
          <td class="paramtype"><a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt;&#160;</td>
          <td class="paramname"><em>ring1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt;&#160;</td>
          <td class="paramname"><em>ring2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Compares two disordered vectors and checks to see if they contain the same elements</p>
<p>Checks to see if two vectors (ring1, ring2) have the same elements (which may or may not be disordered). The order or sequence of elements is not important, so the rings are sorted. Returns true if the rings have the same elements </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ring1</td><td>The first ring. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ring2</td><td>The second ring. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A bool; true if the rings contain the same elements (not necessarily in the same sequence) and false if they do not have the same elements. </dd></dl>

<p class="definition">Definition at line <a class="el" href="ring_8cpp_source.html#l00258">258</a> of file <a class="el" href="ring_8cpp_source.html">ring.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;                                                                  {</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;  <span class="comment">// Sort the rings first</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/algorithm/sort.html">sort</a>(ring1.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/begin.html">begin</a>(), ring1.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/end.html">end</a>()); <span class="comment">// Sort ring1 by ID</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/algorithm/sort.html">sort</a>(ring2.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/begin.html">begin</a>(), ring2.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/end.html">end</a>()); <span class="comment">// Sort ring2 by ID</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;  <span class="keywordtype">bool</span> result;</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160; </div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;  (ring1 == ring2) ? result = <span class="keyword">true</span> : result = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160; </div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;  <span class="keywordflow">return</span> result;</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ga5f7b22fe1354ebe4982b8a9df0067b65"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga5f7b22fe1354ebe4982b8a9df0067b65">&#9670;&nbsp;</a></span>deformedPrismTypes()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ring::deformedPrismTypes </td>
          <td>(</td>
          <td class="paramtype"><a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; <a class="el" href="group__ring.html#ga301cfdc88452cfe51bd4f745d223a7e1">ring::strucType</a> &gt;&#160;</td>
          <td class="paramname"><em>atomState</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt; *&#160;</td>
          <td class="paramname"><em>atomTypes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>maxDepth</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the atom type values for deformed prisms. </p>
<p>Assign an atomType value for atoms belonging to deformed prisms. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">rings</td><td>The vector of vectors containing the primitive rings, of a particular ring size. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">listPrism</td><td>The list of prism blocks found. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ringSize</td><td>The current ring size or number of nodes in each ring. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">atomTypes</td><td>A vector which contains a type for each atom, depending on it's type as classified by the prism identification scheme. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="topo__one__dim_8cpp_source.html#l00759">759</a> of file <a class="el" href="topo__one__dim_8cpp_source.html">topo_one_dim.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;                                                                      {</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;  <span class="keywordtype">int</span> nop = atomState.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/size.html">size</a>(); <span class="comment">// Number of particles</span></div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160; </div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;  <span class="comment">// Loop through all particles</span></div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iatom = 0; iatom &lt; nop; iatom++) {</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;    <span class="comment">// Check the atom state</span></div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;    <span class="comment">// Deformed</span></div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;    <span class="keywordflow">if</span> (atomState[iatom] == <a class="code" href="group__ring.html#gga301cfdc88452cfe51bd4f745d223a7e1a499b694d8386eef89ba2f6e621ed7578">ring::deformedPrism</a>) {</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;      (*atomTypes)[iatom] += maxDepth - 2;</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;    } <span class="comment">// type for a deformed prism atom</span></div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (atomState[iatom] == <a class="code" href="group__ring.html#gga301cfdc88452cfe51bd4f745d223a7e1aabd9a19704526f9be67c7dcd1c2b4af9">ring::mixedPrismRing</a>) {</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;      (*atomTypes)[iatom] = 2;</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;    } <span class="comment">// type for a mixed prism ring</span></div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;  }   <span class="comment">// end of reassignation</span></div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160; </div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;  <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ga8912c1abc7e5c49831f285e12a48f483"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga8912c1abc7e5c49831f285e12a48f483">&#9670;&nbsp;</a></span>discardExtraTetragonBlocks()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool ring::discardExtraTetragonBlocks </td>
          <td>(</td>
          <td class="paramtype"><a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt; *&#160;</td>
          <td class="paramname"><em>basal1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt; *&#160;</td>
          <td class="paramname"><em>basal2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmolSys_1_1PointCloud.html">molSys::PointCloud</a>&lt; <a class="el" href="structmolSys_1_1Point.html">molSys::Point</a>&lt; double &gt;, double &gt; *&#160;</td>
          <td class="paramname"><em>yCloud</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Checks whether two 4-membered rings are parallel in one dimension or not to prevent overcounting</p>
<p>A function that discards basal tetragonal rings which are not oriented perpendicular to the axial direction. This is will only work for the XY, YZ or XZ planes. If true is returned, then the rings are axial. This function is only needed for tetragonal prism blocks because in the other cases, the basal rings and lateral planes have a different number of nodes. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">basal1</td><td>The first basal ring. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">basal2</td><td>The other candidate basal ring. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">yCloud</td><td>The input PointCloud. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A bool value which is true if the candidate basal rings are axial, and is false if the planes are lateral planes. </dd></dl>

<p class="definition">Definition at line <a class="el" href="topo__one__dim_8cpp_source.html#l00487">487</a> of file <a class="el" href="topo__one__dim_8cpp_source.html">topo_one_dim.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;                                                           {</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;  <span class="keywordtype">int</span> ringSize =</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;      (*basal1).size(); <span class="comment">// Size of the ring; each ring contains n elements</span></div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;  <span class="keywordtype">int</span> iatomIndex,</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;      jatomIndex;  <span class="comment">// Indices of the elements in basal1 and basal2 respectively</span></div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;  <span class="keywordtype">double</span> r_i, r_j; <span class="comment">// Coordinates in the axial dimension of iatom and jatom of</span></div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;                   <span class="comment">// basal1 and basal2 respectively</span></div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;  <span class="keywordtype">int</span> axialDim;    <span class="comment">// 0 for x, 1 for y and 2 for z dimensions respectively</span></div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;  <span class="comment">// Variables for getting the projected area</span></div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;  <span class="keywordtype">bool</span> axialBasal1, axialBasal2; <span class="comment">// bools for checking if basal1 and basal2 are</span></div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;                                 <span class="comment">// axial (true) respectively</span></div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;  <span class="keywordtype">double</span> areaXY, areaXZ,</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;      areaYZ; <span class="comment">// Projected area on the XY, XZ and YZ planes respectively</span></div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;  <span class="comment">// ----------------------------------------</span></div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;  <span class="comment">// Find the axial dimension for a quasi-one-dimensional ice nanotube</span></div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;  <span class="comment">// The axial dimension will have the largest box length</span></div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;  <span class="comment">// Index -&gt; axial dimension</span></div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;  <span class="comment">// 0 -&gt; x dim</span></div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;  <span class="comment">// 1 -&gt; y dim</span></div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;  <span class="comment">// 2 -&gt; z dim</span></div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;  axialDim = <a class="codeRef" href="http://en.cppreference.com/w/cpp/algorithm/max_element.html">std::max_element</a>(yCloud-&gt;<a class="code" href="group__molSys.html#gaa7d9b8543780baf4a495c7acdb1f87d8">box</a>.begin(), yCloud-&gt;<a class="code" href="group__molSys.html#gaa7d9b8543780baf4a495c7acdb1f87d8">box</a>.end()) -</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;             yCloud-&gt;<a class="code" href="group__molSys.html#gaa7d9b8543780baf4a495c7acdb1f87d8">box</a>.begin();</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;  <span class="comment">// ----------------------------------------</span></div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;  <span class="comment">// Calculate projected area onto the XY, YZ and XZ planes for basal1</span></div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;  axialBasal1 = <span class="keyword">false</span>; <span class="comment">// Init to false</span></div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;  axialBasal2 = <span class="keyword">false</span>; <span class="comment">// Init</span></div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160; </div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;  <span class="comment">// Init the projected area</span></div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;  areaXY = 0.0;</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;  areaXZ = 0.0;</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;  areaYZ = 0.0;</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160; </div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;  jatomIndex = (*basal1)[0];</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160; </div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;  <span class="comment">// All points except the first pair</span></div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 1; k &lt; ringSize; k++) {</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;    iatomIndex = (*basal1)[k]; <span class="comment">// Current vertex</span></div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160; </div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;    <span class="comment">// Add to the polygon area</span></div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;    <span class="comment">// ------</span></div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;    <span class="comment">// XY plane</span></div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;    areaXY += (yCloud-&gt;<a class="code" href="group__molSys.html#ga67ab89369cd26572878a91afd521ef81">pts</a>[jatomIndex].x + yCloud-&gt;<a class="code" href="group__molSys.html#ga67ab89369cd26572878a91afd521ef81">pts</a>[iatomIndex].x) *</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;              (yCloud-&gt;<a class="code" href="group__molSys.html#ga67ab89369cd26572878a91afd521ef81">pts</a>[jatomIndex].y - yCloud-&gt;<a class="code" href="group__molSys.html#ga67ab89369cd26572878a91afd521ef81">pts</a>[iatomIndex].y);</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;    <span class="comment">// ------</span></div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;    <span class="comment">// XZ plane</span></div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;    areaXZ += (yCloud-&gt;<a class="code" href="group__molSys.html#ga67ab89369cd26572878a91afd521ef81">pts</a>[jatomIndex].x + yCloud-&gt;<a class="code" href="group__molSys.html#ga67ab89369cd26572878a91afd521ef81">pts</a>[iatomIndex].x) *</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;              (yCloud-&gt;<a class="code" href="group__molSys.html#ga67ab89369cd26572878a91afd521ef81">pts</a>[jatomIndex].z - yCloud-&gt;<a class="code" href="group__molSys.html#ga67ab89369cd26572878a91afd521ef81">pts</a>[iatomIndex].z);</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;    <span class="comment">// ------</span></div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;    <span class="comment">// YZ plane</span></div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;    areaYZ += (yCloud-&gt;<a class="code" href="group__molSys.html#ga67ab89369cd26572878a91afd521ef81">pts</a>[jatomIndex].y + yCloud-&gt;<a class="code" href="group__molSys.html#ga67ab89369cd26572878a91afd521ef81">pts</a>[iatomIndex].y) *</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;              (yCloud-&gt;<a class="code" href="group__molSys.html#ga67ab89369cd26572878a91afd521ef81">pts</a>[jatomIndex].z - yCloud-&gt;<a class="code" href="group__molSys.html#ga67ab89369cd26572878a91afd521ef81">pts</a>[iatomIndex].z);</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;    <span class="comment">// ------</span></div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;    jatomIndex = iatomIndex;</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;  }</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160; </div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;  <span class="comment">// Closure point</span></div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;  iatomIndex = (*basal1)[0];</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;  <span class="comment">// ------</span></div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;  <span class="comment">// XY plane</span></div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;  areaXY += (yCloud-&gt;<a class="code" href="group__molSys.html#ga67ab89369cd26572878a91afd521ef81">pts</a>[jatomIndex].x + yCloud-&gt;<a class="code" href="group__molSys.html#ga67ab89369cd26572878a91afd521ef81">pts</a>[iatomIndex].x) *</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;            (yCloud-&gt;<a class="code" href="group__molSys.html#ga67ab89369cd26572878a91afd521ef81">pts</a>[jatomIndex].y - yCloud-&gt;<a class="code" href="group__molSys.html#ga67ab89369cd26572878a91afd521ef81">pts</a>[iatomIndex].y);</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;  <span class="comment">// ------</span></div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;  <span class="comment">// XZ plane</span></div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;  areaXZ += (yCloud-&gt;<a class="code" href="group__molSys.html#ga67ab89369cd26572878a91afd521ef81">pts</a>[jatomIndex].x + yCloud-&gt;<a class="code" href="group__molSys.html#ga67ab89369cd26572878a91afd521ef81">pts</a>[iatomIndex].x) *</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;            (yCloud-&gt;<a class="code" href="group__molSys.html#ga67ab89369cd26572878a91afd521ef81">pts</a>[jatomIndex].z - yCloud-&gt;<a class="code" href="group__molSys.html#ga67ab89369cd26572878a91afd521ef81">pts</a>[iatomIndex].z);</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;  <span class="comment">// ------</span></div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;  <span class="comment">// YZ plane</span></div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;  areaYZ += (yCloud-&gt;<a class="code" href="group__molSys.html#ga67ab89369cd26572878a91afd521ef81">pts</a>[jatomIndex].y + yCloud-&gt;<a class="code" href="group__molSys.html#ga67ab89369cd26572878a91afd521ef81">pts</a>[iatomIndex].y) *</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;            (yCloud-&gt;<a class="code" href="group__molSys.html#ga67ab89369cd26572878a91afd521ef81">pts</a>[jatomIndex].z - yCloud-&gt;<a class="code" href="group__molSys.html#ga67ab89369cd26572878a91afd521ef81">pts</a>[iatomIndex].z);</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;  <span class="comment">// ------</span></div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;  <span class="comment">// The actual projected area is half of this</span></div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;  areaXY *= 0.5;</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;  areaXZ *= 0.5;</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;  areaYZ *= 0.5;</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;  <span class="comment">// Get the absolute value</span></div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;  areaXY = <a class="codeRef" href="http://en.cppreference.com/w/cpp/numeric/math/fabs.html">fabs</a>(areaXY);</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;  areaXZ = <a class="codeRef" href="http://en.cppreference.com/w/cpp/numeric/math/fabs.html">fabs</a>(areaXZ);</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;  areaYZ = <a class="codeRef" href="http://en.cppreference.com/w/cpp/numeric/math/fabs.html">fabs</a>(areaYZ);</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160; </div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;  <span class="comment">// If the axial dimension is x, y, or z:</span></div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;  <span class="comment">// then the maximum basal area should be in the YZ, XZ and XY dimensions</span></div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;  <span class="comment">// respectively</span></div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;  <span class="comment">// x dim</span></div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;  <span class="keywordflow">if</span> (axialDim == 0) {</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;    <span class="keywordflow">if</span> (areaYZ &gt; areaXY &amp;&amp; areaYZ &gt; areaXZ) {</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;      axialBasal1 = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;    } <span class="comment">// end of check for axial ring for basal1</span></div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;  }   <span class="comment">// x dim</span></div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;  <span class="comment">// y dim</span></div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (axialDim == 1) {</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;    <span class="keywordflow">if</span> (areaXZ &gt; areaXY &amp;&amp; areaXZ &gt; areaYZ) {</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;      axialBasal1 = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;    } <span class="comment">// end of check for axial ring for basal1</span></div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;  }   <span class="comment">// x dim</span></div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;  <span class="comment">// z dim</span></div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (axialDim == 2) {</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;    <span class="keywordflow">if</span> (areaXY &gt; areaXZ &amp;&amp; areaXY &gt; areaYZ) {</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;      axialBasal1 = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;    } <span class="comment">// end of check for axial ring for basal1</span></div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;  }   <span class="comment">// x dim</span></div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;  <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;    <a class="codeRef" href="http://en.cppreference.com/w/cpp/io/basic_ostream.html">std::cerr</a> &lt;&lt; <span class="stringliteral">&quot;Could not find the axial dimension.\n&quot;</span>;</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;  }</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;  <span class="comment">// ----------------------------------------</span></div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;  <span class="comment">// Calculate projected area onto the XY, YZ and XZ planes for basal2</span></div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160; </div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;  <span class="comment">// Init the projected area</span></div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;  areaXY = 0.0;</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;  areaXZ = 0.0;</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;  areaYZ = 0.0;</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160; </div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;  jatomIndex = (*basal2)[0];</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160; </div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;  <span class="comment">// All points except the first pair</span></div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 1; k &lt; ringSize; k++) {</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;    iatomIndex = (*basal2)[k]; <span class="comment">// Current vertex</span></div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160; </div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;    <span class="comment">// Add to the polygon area</span></div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;    <span class="comment">// ------</span></div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;    <span class="comment">// XY plane</span></div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;    areaXY += (yCloud-&gt;<a class="code" href="group__molSys.html#ga67ab89369cd26572878a91afd521ef81">pts</a>[jatomIndex].x + yCloud-&gt;<a class="code" href="group__molSys.html#ga67ab89369cd26572878a91afd521ef81">pts</a>[iatomIndex].x) *</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;              (yCloud-&gt;<a class="code" href="group__molSys.html#ga67ab89369cd26572878a91afd521ef81">pts</a>[jatomIndex].y - yCloud-&gt;<a class="code" href="group__molSys.html#ga67ab89369cd26572878a91afd521ef81">pts</a>[iatomIndex].y);</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;    <span class="comment">// ------</span></div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;    <span class="comment">// XZ plane</span></div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;    areaXZ += (yCloud-&gt;<a class="code" href="group__molSys.html#ga67ab89369cd26572878a91afd521ef81">pts</a>[jatomIndex].x + yCloud-&gt;<a class="code" href="group__molSys.html#ga67ab89369cd26572878a91afd521ef81">pts</a>[iatomIndex].x) *</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;              (yCloud-&gt;<a class="code" href="group__molSys.html#ga67ab89369cd26572878a91afd521ef81">pts</a>[jatomIndex].z - yCloud-&gt;<a class="code" href="group__molSys.html#ga67ab89369cd26572878a91afd521ef81">pts</a>[iatomIndex].z);</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;    <span class="comment">// ------</span></div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;    <span class="comment">// YZ plane</span></div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;    areaYZ += (yCloud-&gt;<a class="code" href="group__molSys.html#ga67ab89369cd26572878a91afd521ef81">pts</a>[jatomIndex].y + yCloud-&gt;<a class="code" href="group__molSys.html#ga67ab89369cd26572878a91afd521ef81">pts</a>[iatomIndex].y) *</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;              (yCloud-&gt;<a class="code" href="group__molSys.html#ga67ab89369cd26572878a91afd521ef81">pts</a>[jatomIndex].z - yCloud-&gt;<a class="code" href="group__molSys.html#ga67ab89369cd26572878a91afd521ef81">pts</a>[iatomIndex].z);</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;    <span class="comment">// ------</span></div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;    jatomIndex = iatomIndex;</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;  }</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160; </div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;  <span class="comment">// Closure point</span></div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;  iatomIndex = (*basal2)[0];</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;  <span class="comment">// ------</span></div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;  <span class="comment">// XY plane</span></div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;  areaXY += (yCloud-&gt;<a class="code" href="group__molSys.html#ga67ab89369cd26572878a91afd521ef81">pts</a>[jatomIndex].x + yCloud-&gt;<a class="code" href="group__molSys.html#ga67ab89369cd26572878a91afd521ef81">pts</a>[iatomIndex].x) *</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;            (yCloud-&gt;<a class="code" href="group__molSys.html#ga67ab89369cd26572878a91afd521ef81">pts</a>[jatomIndex].y - yCloud-&gt;<a class="code" href="group__molSys.html#ga67ab89369cd26572878a91afd521ef81">pts</a>[iatomIndex].y);</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;  <span class="comment">// ------</span></div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;  <span class="comment">// XZ plane</span></div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;  areaXZ += (yCloud-&gt;<a class="code" href="group__molSys.html#ga67ab89369cd26572878a91afd521ef81">pts</a>[jatomIndex].x + yCloud-&gt;<a class="code" href="group__molSys.html#ga67ab89369cd26572878a91afd521ef81">pts</a>[iatomIndex].x) *</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;            (yCloud-&gt;<a class="code" href="group__molSys.html#ga67ab89369cd26572878a91afd521ef81">pts</a>[jatomIndex].z - yCloud-&gt;<a class="code" href="group__molSys.html#ga67ab89369cd26572878a91afd521ef81">pts</a>[iatomIndex].z);</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;  <span class="comment">// ------</span></div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;  <span class="comment">// YZ plane</span></div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;  areaYZ += (yCloud-&gt;<a class="code" href="group__molSys.html#ga67ab89369cd26572878a91afd521ef81">pts</a>[jatomIndex].y + yCloud-&gt;<a class="code" href="group__molSys.html#ga67ab89369cd26572878a91afd521ef81">pts</a>[iatomIndex].y) *</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;            (yCloud-&gt;<a class="code" href="group__molSys.html#ga67ab89369cd26572878a91afd521ef81">pts</a>[jatomIndex].z - yCloud-&gt;<a class="code" href="group__molSys.html#ga67ab89369cd26572878a91afd521ef81">pts</a>[iatomIndex].z);</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;  <span class="comment">// ------</span></div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;  <span class="comment">// The actual projected area is half of this</span></div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;  areaXY *= 0.5;</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;  areaXZ *= 0.5;</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;  areaYZ *= 0.5;</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;  <span class="comment">// Get the absolute value</span></div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;  areaXY = <a class="codeRef" href="http://en.cppreference.com/w/cpp/numeric/math/fabs.html">fabs</a>(areaXY);</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;  areaXZ = <a class="codeRef" href="http://en.cppreference.com/w/cpp/numeric/math/fabs.html">fabs</a>(areaXZ);</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;  areaYZ = <a class="codeRef" href="http://en.cppreference.com/w/cpp/numeric/math/fabs.html">fabs</a>(areaYZ);</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160; </div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;  <span class="comment">// Check if xy projected area is the greatest</span></div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;  <span class="comment">// If the axial dimension is x, y, or z:</span></div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;  <span class="comment">// then the maximum basal area should be in the YZ, XZ and XY dimensions</span></div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;  <span class="comment">// respectively</span></div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;  <span class="comment">// x dim</span></div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;  <span class="keywordflow">if</span> (axialDim == 0) {</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;    <span class="keywordflow">if</span> (areaYZ &gt; areaXY &amp;&amp; areaYZ &gt; areaXZ) {</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;      axialBasal2 = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;    } <span class="comment">// end of check for axial ring for basal1</span></div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;  }   <span class="comment">// x dim</span></div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;  <span class="comment">// y dim</span></div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (axialDim == 1) {</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;    <span class="keywordflow">if</span> (areaXZ &gt; areaXY &amp;&amp; areaXZ &gt; areaYZ) {</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;      axialBasal2 = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;    } <span class="comment">// end of check for axial ring for basal1</span></div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;  }   <span class="comment">// x dim</span></div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;  <span class="comment">// z dim</span></div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (axialDim == 2) {</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;    <span class="keywordflow">if</span> (areaXY &gt; areaXZ &amp;&amp; areaXY &gt; areaYZ) {</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;      axialBasal2 = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;    } <span class="comment">// end of check for axial ring for basal1</span></div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;  }   <span class="comment">// x dim</span></div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;  <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;    <a class="codeRef" href="http://en.cppreference.com/w/cpp/io/basic_ostream.html">std::cerr</a> &lt;&lt; <span class="stringliteral">&quot;Could not find the axial dimension.\n&quot;</span>;</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;  }</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;  <span class="comment">// ----------------------------------------</span></div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160; </div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;  <span class="comment">// Now check if basal1 and basal2 are axial or not</span></div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;  <span class="keywordflow">if</span> (axialBasal1 == <span class="keyword">true</span> &amp;&amp; axialBasal2 == <span class="keyword">true</span>) {</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;  } <span class="comment">// Check for basal1 and basal2</span></div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;}</div>
<div class="ttc" id="abasic_ostream_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/io/basic_ostream.html">std::cerr</a></div></div>
<div class="ttc" id="afabs_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/numeric/math/fabs.html">std::fabs</a></div><div class="ttdeci">T fabs(T... args)</div></div>
<div class="ttc" id="amax_element_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/algorithm/max_element.html">std::max_element</a></div><div class="ttdeci">T max_element(T... args)</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ga0a1fdfaea2b64e45c4e0d7d7f8864507"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga0a1fdfaea2b64e45c4e0d7d7f8864507">&#9670;&nbsp;</a></span>findPrisms()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt; ring::findPrisms </td>
          <td>(</td>
          <td class="paramtype"><a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; <a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt;&gt;&#160;</td>
          <td class="paramname"><em>rings</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; <a class="el" href="group__ring.html#ga301cfdc88452cfe51bd4f745d223a7e1">strucType</a> &gt; *&#160;</td>
          <td class="paramname"><em>ringType</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>nPerfectPrisms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>nImperfectPrisms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; <a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt;&gt;&#160;</td>
          <td class="paramname"><em>nList</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmolSys_1_1PointCloud.html">molSys::PointCloud</a>&lt; <a class="el" href="structmolSys_1_1Point.html">molSys::Point</a>&lt; double &gt;, double &gt; *&#160;</td>
          <td class="paramname"><em>yCloud</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; double &gt; *&#160;</td>
          <td class="paramname"><em>rmsdPerAtom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>doShapeMatching</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Find out which rings are prisms. Returns a vector containing all the ring IDs which are prisms</p>
<p>Determines which rings are n-sided prisms. This function returns a vector which contains the ring indices of all the rings which are prisms. The ring indices correspond to the index of the rings inside the vector of vector rings, starting from 0. Prism rings can be found using a three-step procedure, in which first two basal rings are found. Prismatic rings are simply rings which share every face made by upper and lower triplets of the basal rings The neighbour list is also required as an input, which is a vector of vectors, containing atom IDs. The first element of the neighbour list is the atom index of the atom for which the other elements are nearest neighbours.\ </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">rings</td><td>The input vector of vectors containing the primitive rings of a single ring size (number of nodes). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ringType</td><td>A vector containing a <a class="el" href="group__ring.html#ga301cfdc88452cfe51bd4f745d223a7e1">ring::strucType</a> value (a classification type) for each ring. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nPrisms</td><td>The number of prism blocks identified for the number of nodes. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nList</td><td>The row-ordered neighbour list (by atom index). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">yCloud</td><td>The input PointCloud. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A vector containing the ring indices of all the rings which have been classified as prisms. The indices are with respect to the input rings vector of vectors. </dd></dl>

<p class="definition">Definition at line <a class="el" href="topo__one__dim_8cpp_source.html#l00193">193</a> of file <a class="el" href="topo__one__dim_8cpp_source.html">topo_one_dim.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;                                                                       {</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a> listPrism;</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;  <span class="keywordtype">int</span> totalRingNum = rings.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/size.html">size</a>(); <span class="comment">// Total number of rings</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a> basal1;         <span class="comment">// First basal ring</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a> basal2;         <span class="comment">// Second basal ring</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;  <span class="keywordtype">bool</span> cond1, cond2; <span class="comment">// Conditions for rings to be basal (true) or not (false)</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;  <span class="keywordtype">bool</span> relaxedCond;  <span class="comment">// Condition so that at least one bond exists between the</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;                     <span class="comment">// two basal rings</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;  <span class="keywordtype">bool</span> isAxialPair;  <span class="comment">// Basal rings should be parallel in one dimension to</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;                     <span class="comment">// prevent overcounting</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;  <span class="keywordtype">int</span> ringSize = rings[0].<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/size.html">size</a>(); <span class="comment">// Number of nodes in each ring</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;  *nImperfectPrisms = 0;          <span class="comment">// Number of undeformed prisms</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;  *nPerfectPrisms = 0;            <span class="comment">// Number of undeformed prisms</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;  <span class="comment">// Matrix for the reference ring for a given ringSize.</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;  Eigen::MatrixXd refPointSet(ringSize, 3);</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160; </div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;  <span class="comment">// Get the reference ring point set for a given ring size.</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;  <span class="comment">// Get the axial dimension</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;  <span class="keywordtype">int</span> axialDim = <a class="codeRef" href="http://en.cppreference.com/w/cpp/algorithm/max_element.html">std::max_element</a>(yCloud-&gt;<a class="code" href="group__molSys.html#gaa7d9b8543780baf4a495c7acdb1f87d8">box</a>.begin(), yCloud-&gt;<a class="code" href="group__molSys.html#gaa7d9b8543780baf4a495c7acdb1f87d8">box</a>.end()) -</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;                 yCloud-&gt;<a class="code" href="group__molSys.html#gaa7d9b8543780baf4a495c7acdb1f87d8">box</a>.begin();</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;  refPointSet = <a class="code" href="namespacepntToPnt.html#a5b2c3bd3984c707965b6cc5ec03ff1da">pntToPnt::getPointSetRefRing</a>(ringSize, axialDim);</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160; </div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;  <span class="comment">// Two loops through all the rings are required to find pairs of basal rings</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iring = 0; iring &lt; totalRingNum - 1; iring++) {</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    cond1 = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    cond2 = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    basal1 = rings[iring]; <span class="comment">// Assign iring to basal1</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    <span class="comment">// Loop through the other rings to get a pair</span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> jring = iring + 1; jring &lt; totalRingNum; jring++) {</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;      basal2 = rings[jring]; <span class="comment">// Assign jring to basal2</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;      <span class="comment">// ------------</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;      <span class="comment">// Put extra check for axial basal rings if shapeMatching is being done</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;      <span class="keywordflow">if</span> (doShapeMatching == <span class="keyword">true</span> || ringSize == 4) {</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;        isAxialPair = <span class="keyword">false</span>; <span class="comment">// init</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;        isAxialPair =</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;            <a class="code" href="group__ring.html#ga8912c1abc7e5c49831f285e12a48f483">ring::discardExtraTetragonBlocks</a>(&amp;basal1, &amp;basal2, yCloud);</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;        <span class="keywordflow">if</span> (isAxialPair == <span class="keyword">false</span>) {</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;          <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;        }</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;      } <span class="comment">// end of check for tetragonal prism blocks</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;      <span class="comment">// ------------</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;      <span class="comment">// Step one: Check to see if basal1 and basal2 have common</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;      <span class="comment">// elements or not. If they don&#39;t, then they cannot be basal rings</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;      cond1 = <a class="code" href="group__ring.html#gac30855d0daa2b20c29e4dee39f5cd92f">ring::hasCommonElements</a>(basal1, basal2);</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;      <span class="keywordflow">if</span> (cond1 == <span class="keyword">true</span>) {</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;      }</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;      <span class="comment">// -----------</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;      <span class="comment">// Step two and three: One of the elements of basal2 must be the nearest</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;      <span class="comment">// neighbour of the first (index0; l1) If m_k is the nearest neighbour of</span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;      <span class="comment">// l1, m_{k+1} ... m_{k+(n-1)} must be neighbours of l_i+1 etc or l_i-1</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;      cond2 = <a class="code" href="group__ring.html#gacd2f05f7a6e394f6aae0c0d6e016a383">ring::basalPrismConditions</a>(nList, &amp;basal1, &amp;basal2);</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;      <span class="comment">// If cond2 is false, the strict criteria for prisms has not been met</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;      <span class="keywordflow">if</span> (cond2 == <span class="keyword">false</span>) {</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;        <span class="comment">// Skip if shape-matching is not desired</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;        <span class="keywordflow">if</span> (!doShapeMatching) {</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;          <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;        } <span class="comment">// shape-matching not desired</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;        <span class="comment">// If shape-matching is to be done:</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;        <span class="comment">// Check for the reduced criteria fulfilment</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;        relaxedCond = <a class="code" href="group__ring.html#ga033c466e933a1a3b532ef4ecdf7626f0">ring::relaxedPrismConditions</a>(nList, &amp;basal1, &amp;basal2);</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;        <span class="comment">// Skip if relaxed criteria are not met</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;        <span class="keywordflow">if</span> (relaxedCond == <span class="keyword">false</span>) {</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;          <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;        } <span class="comment">// end of skipping if the prisms do not fulfil relaxed criteria</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160; </div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;        <span class="comment">// Do shape matching here</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;        <span class="keywordtype">bool</span> isDeformedPrism = <a class="code" href="namespacematch.html#ac4876008ba79e6b30380b4481c188407">match::matchPrism</a>(</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;            yCloud, nList, refPointSet, &amp;basal1, &amp;basal2, rmsdPerAtom, <span class="keyword">false</span>);</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160; </div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;        <span class="comment">// Success! The rings are basal rings of a deformed prism!</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;        <span class="keywordflow">if</span> (isDeformedPrism) {</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;          <span class="comment">//</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;          <span class="comment">// // Update the number of prism blocks</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;          *nImperfectPrisms += 1;</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;          <span class="comment">// Update iring</span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;          <span class="keywordflow">if</span> ((*ringType)[iring] == <a class="code" href="group__ring.html#gga301cfdc88452cfe51bd4f745d223a7e1a60cc60f3804efaf86af8c2c2fbbe7208">ring::unclassified</a>) {</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;            (*ringType)[iring] = <a class="code" href="group__ring.html#gga301cfdc88452cfe51bd4f745d223a7e1a499b694d8386eef89ba2f6e621ed7578">ring::deformedPrism</a>;</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;            listPrism.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/push_back.html">push_back</a>(iring);</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;          } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((*ringType)[iring] == <a class="code" href="group__ring.html#gga301cfdc88452cfe51bd4f745d223a7e1ac4295ff0a8263a65de0694cc0b20e9af">ring::Prism</a>) {</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;            (*ringType)[iring] = <a class="code" href="group__ring.html#gga301cfdc88452cfe51bd4f745d223a7e1aabd9a19704526f9be67c7dcd1c2b4af9">ring::mixedPrismRing</a>;</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;          } <span class="comment">// if it is deformed</span></div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;          <span class="comment">// Update jring</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;          <span class="keywordflow">if</span> ((*ringType)[jring] == <a class="code" href="group__ring.html#gga301cfdc88452cfe51bd4f745d223a7e1a60cc60f3804efaf86af8c2c2fbbe7208">ring::unclassified</a>) {</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;            (*ringType)[jring] = <a class="code" href="group__ring.html#gga301cfdc88452cfe51bd4f745d223a7e1a499b694d8386eef89ba2f6e621ed7578">ring::deformedPrism</a>;</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;            listPrism.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/push_back.html">push_back</a>(jring);</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;          } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((*ringType)[jring] == <a class="code" href="group__ring.html#gga301cfdc88452cfe51bd4f745d223a7e1ac4295ff0a8263a65de0694cc0b20e9af">ring::Prism</a>) {</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;            (*ringType)[jring] = <a class="code" href="group__ring.html#gga301cfdc88452cfe51bd4f745d223a7e1aabd9a19704526f9be67c7dcd1c2b4af9">ring::mixedPrismRing</a>;</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;          } <span class="comment">// if it is deformed</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;        }   <span class="comment">// end of update of ring types</span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160; </div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;        <span class="comment">// // Write outs</span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;        <span class="comment">// // Now write out axial basal rings</span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;        <span class="comment">// sout::writeBasalRingsPrism(&amp;basal1, &amp;basal2, nDeformedPrisms, nList,</span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;        <span class="comment">//                            yCloud, true);</span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;      } <span class="comment">// end of reduced criteria</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;      <span class="comment">// Strict criteria</span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;      <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;        <span class="comment">// Update the number of prism blocks</span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;        *nPerfectPrisms += 1;</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;        <span class="comment">// Update iring</span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;        <span class="keywordflow">if</span> ((*ringType)[iring] == <a class="code" href="group__ring.html#gga301cfdc88452cfe51bd4f745d223a7e1a60cc60f3804efaf86af8c2c2fbbe7208">ring::unclassified</a>) {</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;          (*ringType)[iring] = <a class="code" href="group__ring.html#gga301cfdc88452cfe51bd4f745d223a7e1ac4295ff0a8263a65de0694cc0b20e9af">ring::Prism</a>;</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;          listPrism.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/push_back.html">push_back</a>(iring);</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((*ringType)[iring] == <a class="code" href="group__ring.html#gga301cfdc88452cfe51bd4f745d223a7e1a499b694d8386eef89ba2f6e621ed7578">ring::deformedPrism</a>) {</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;          (*ringType)[iring] = <a class="code" href="group__ring.html#gga301cfdc88452cfe51bd4f745d223a7e1aabd9a19704526f9be67c7dcd1c2b4af9">ring::mixedPrismRing</a>;</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;        } <span class="comment">// if it is deformed</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;        <span class="comment">// Update jring</span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;        <span class="keywordflow">if</span> ((*ringType)[jring] == <a class="code" href="group__ring.html#gga301cfdc88452cfe51bd4f745d223a7e1a60cc60f3804efaf86af8c2c2fbbe7208">ring::unclassified</a>) {</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;          (*ringType)[jring] = <a class="code" href="group__ring.html#gga301cfdc88452cfe51bd4f745d223a7e1ac4295ff0a8263a65de0694cc0b20e9af">ring::Prism</a>;</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;          listPrism.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/push_back.html">push_back</a>(jring);</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((*ringType)[jring] == <a class="code" href="group__ring.html#gga301cfdc88452cfe51bd4f745d223a7e1a499b694d8386eef89ba2f6e621ed7578">ring::deformedPrism</a>) {</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;          (*ringType)[jring] = <a class="code" href="group__ring.html#gga301cfdc88452cfe51bd4f745d223a7e1aabd9a19704526f9be67c7dcd1c2b4af9">ring::mixedPrismRing</a>;</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;        } <span class="comment">// if it is deformed</span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;        <span class="comment">// Shape-matching to get the RMSD (if shape-matching is desired)</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;        <span class="keywordflow">if</span> (doShapeMatching) {</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;          <span class="keywordtype">bool</span> isKnownPrism = <a class="code" href="namespacematch.html#ac4876008ba79e6b30380b4481c188407">match::matchPrism</a>(</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;              yCloud, nList, refPointSet, &amp;basal1, &amp;basal2, rmsdPerAtom, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;        } <span class="comment">// end of shape-matching to get rmsd</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;        <span class="comment">// // Now write out axial basal rings for convex hull calculations</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;        <span class="comment">// sout::writePrisms(&amp;basal1, &amp;basal2, *nPrisms, yCloud);</span></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;        <span class="comment">// // Write out prisms for shape-matching</span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;        <span class="comment">// sout::writeBasalRingsPrism(&amp;basal1, &amp;basal2, *nPrisms, nList, yCloud,</span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;        <span class="comment">//                            false);</span></div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;        <span class="comment">// -----------</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;      } <span class="comment">// end of strict criteria</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160; </div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    } <span class="comment">// end of loop through rest of the rings to get the second basal ring</span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;  }   <span class="comment">// end of loop through all rings for first basal ring</span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160; </div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/algorithm/sort.html">sort</a>(listPrism.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/begin.html">begin</a>(), listPrism.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/end.html">end</a>());</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;  <span class="keyword">auto</span> ip = <a class="codeRef" href="http://en.cppreference.com/w/cpp/algorithm/unique.html">std::unique</a>(listPrism.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/begin.html">begin</a>(), listPrism.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/end.html">end</a>());</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;  <span class="comment">// Resize peripheral rings to remove undefined terms</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;  listPrism.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/resize.html">resize</a>(<a class="codeRef" href="http://en.cppreference.com/w/cpp/iterator/distance.html">std::distance</a>(listPrism.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/begin.html">begin</a>(), ip));</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160; </div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;  <span class="keywordflow">return</span> listPrism;</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;}</div>
<div class="ttc" id="agroup__ring_html_ga033c466e933a1a3b532ef4ecdf7626f0"><div class="ttname"><a href="group__ring.html#ga033c466e933a1a3b532ef4ecdf7626f0">ring::relaxedPrismConditions</a></div><div class="ttdeci">bool relaxedPrismConditions(std::vector&lt; std::vector&lt; int &gt;&gt; nList, std::vector&lt; int &gt; *basal1, std::vector&lt; int &gt; *basal2)</div><div class="ttdef"><b>Definition:</b> <a href="topo__one__dim_8cpp_source.html#l00436">topo_one_dim.cpp:436</a></div></div>
<div class="ttc" id="agroup__ring_html_ga8912c1abc7e5c49831f285e12a48f483"><div class="ttname"><a href="group__ring.html#ga8912c1abc7e5c49831f285e12a48f483">ring::discardExtraTetragonBlocks</a></div><div class="ttdeci">bool discardExtraTetragonBlocks(std::vector&lt; int &gt; *basal1, std::vector&lt; int &gt; *basal2, molSys::PointCloud&lt; molSys::Point&lt; double &gt;, double &gt; *yCloud)</div><div class="ttdef"><b>Definition:</b> <a href="topo__one__dim_8cpp_source.html#l00487">topo_one_dim.cpp:487</a></div></div>
<div class="ttc" id="agroup__ring_html_gacd2f05f7a6e394f6aae0c0d6e016a383"><div class="ttname"><a href="group__ring.html#gacd2f05f7a6e394f6aae0c0d6e016a383">ring::basalPrismConditions</a></div><div class="ttdeci">bool basalPrismConditions(std::vector&lt; std::vector&lt; int &gt;&gt; nList, std::vector&lt; int &gt; *basal1, std::vector&lt; int &gt; *basal2)</div><div class="ttdef"><b>Definition:</b> <a href="topo__one__dim_8cpp_source.html#l00351">topo_one_dim.cpp:351</a></div></div>
<div class="ttc" id="anamespacematch_html_ac4876008ba79e6b30380b4481c188407"><div class="ttname"><a href="namespacematch.html#ac4876008ba79e6b30380b4481c188407">match::matchPrism</a></div><div class="ttdeci">bool matchPrism(molSys::PointCloud&lt; molSys::Point&lt; double &gt;, double &gt; *yCloud, std::vector&lt; std::vector&lt; int &gt;&gt; nList, const Eigen::MatrixXd &amp;refPoints, std::vector&lt; int &gt; *basal1, std::vector&lt; int &gt; *basal2, std::vector&lt; double &gt; *rmsdPerAtom, bool isPerfect=true)</div><div class="ttdef"><b>Definition:</b> <a href="shapeMatch_8cpp_source.html#l00021">shapeMatch.cpp:21</a></div></div>
<div class="ttc" id="anamespacepntToPnt_html_a5b2c3bd3984c707965b6cc5ec03ff1da"><div class="ttname"><a href="namespacepntToPnt.html#a5b2c3bd3984c707965b6cc5ec03ff1da">pntToPnt::getPointSetRefRing</a></div><div class="ttdeci">Eigen::MatrixXd getPointSetRefRing(int n, int axialDim)</div><div class="ttdef"><b>Definition:</b> <a href="pntCorrespondence_8cpp_source.html#l00022">pntCorrespondence.cpp:22</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="gaed5f39c14a4d76c1746aed53e0d0a2dc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaed5f39c14a4d76c1746aed53e0d0a2dc">&#9670;&nbsp;</a></span>findsCommonElements()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt; ring::findsCommonElements </td>
          <td>(</td>
          <td class="paramtype"><a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt;&#160;</td>
          <td class="paramname"><em>ring1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt;&#160;</td>
          <td class="paramname"><em>ring2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns the common elements of two rings. </p>
<p>Function that finds and returns a vector containing the elements shared by two input rings (each ring is a vector). </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ring1</td><td>The first ring. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ring2</td><td>The second ring. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A vector containing the common elements between the input rings. </dd></dl>

<p class="definition">Definition at line <a class="el" href="ring_8cpp_source.html#l00085">85</a> of file <a class="el" href="ring_8cpp_source.html">ring.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;                                                                 {</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a> common;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  <span class="keywordtype">int</span> iatom; <span class="comment">// Index to search for</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160; </div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; ring1.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/size.html">size</a>(); i++) {</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    iatom = ring1[i];</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <span class="comment">// Search for iatom in ring2</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160; </div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    <span class="keyword">auto</span> it = <a class="codeRef" href="http://en.cppreference.com/w/cpp/algorithm/find.html">std::find</a>(ring2.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/begin.html">begin</a>(), ring2.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/end.html">end</a>(), iatom);</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160; </div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <span class="keywordflow">if</span> (it != ring2.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/end.html">end</a>()) {</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;      common.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/push_back.html">push_back</a>(iatom);</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    } <span class="comment">// iatom was found!</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  }   <span class="comment">// end of loop through every element of ring1</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160; </div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  <span class="keywordflow">return</span> common;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ga3cca615046ff98165863e95fdadce530"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga3cca615046ff98165863e95fdadce530">&#9670;&nbsp;</a></span>findTripletInRing()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool ring::findTripletInRing </td>
          <td>(</td>
          <td class="paramtype"><a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt;&#160;</td>
          <td class="paramname"><em>ring</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt;&#160;</td>
          <td class="paramname"><em>triplet</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Searches a particular ring for a triplet. </p>
<p>Function that finds out if a given triplet is is present (in the same order or in reversed order) in a given ring. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ring</td><td>The input ring containing the indices of atoms. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">triplet</td><td>Vector containing the triplet, for whose presence the input ring vector will be checked. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A bool value which is true if the triplet is present in the ring, and is false if the triplet is not in the ring. </dd></dl>

<p class="definition">Definition at line <a class="el" href="ring_8cpp_source.html#l00148">148</a> of file <a class="el" href="ring_8cpp_source.html">ring.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;                                                                        {</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;  <span class="keywordtype">int</span> ringSize = <a class="code" href="namespacering.html">ring</a>.size();   <span class="comment">// should be 6</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a> ringTriplet; <span class="comment">// triplet from the ring to be searched</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;  <span class="keywordtype">int</span> kIndex;                   <span class="comment">// Used for making the triplet</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160; </div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;  <span class="comment">// Loop through every possible triplet in the ring to be searched</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; ringSize; i++) {</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    ringTriplet.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/clear.html">clear</a>(); <span class="comment">// init</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    <span class="comment">// Get the first element of the ring triplet</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    ringTriplet.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/push_back.html">push_back</a>(<a class="code" href="namespacering.html">ring</a>[i]);</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    <span class="comment">// Get the next two elements</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 1; k &lt; 3; k++) {</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;      kIndex = i + k;</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;      <span class="comment">// Wrap-around</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;      <span class="keywordflow">if</span> (kIndex &gt;= ringSize) {</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;        kIndex -= ringSize;</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;      } <span class="comment">// end of wrap-around</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;      ringTriplet.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/push_back.html">push_back</a>(<a class="code" href="namespacering.html">ring</a>[kIndex]);</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    } <span class="comment">// next two elements of ringTriplet</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    <span class="comment">// Obtained ringTriplet!</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    <span class="comment">// Check equality</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    <span class="keywordflow">if</span> (triplet == ringTriplet) {</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    } <span class="comment">// triplet matches!</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    <span class="comment">// Check the reversed triplet too</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <a class="codeRef" href="http://en.cppreference.com/w/cpp/algorithm/reverse.html">std::reverse</a>(ringTriplet.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/begin.html">begin</a>(), ringTriplet.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/end.html">end</a>());</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160; </div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    <span class="comment">// Check for equality</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <span class="keywordflow">if</span> (triplet == ringTriplet) {</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    } <span class="comment">// reversed triplet matches</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;  }   <span class="comment">// first element of ringTriplet</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160; </div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;}</div>
<div class="ttc" id="aclear_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/container/vector/clear.html">std::vector::clear</a></div><div class="ttdeci">T clear(T... args)</div></div>
<div class="ttc" id="anamespacering_html"><div class="ttname"><a href="namespacering.html">ring</a></div><div class="ttdoc">Topological network criteria functions.</div><div class="ttdef"><b>Definition:</b> <a href="ring_8hpp_source.html#l00064">ring.hpp:64</a></div></div>
<div class="ttc" id="areverse_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/algorithm/reverse.html">std::reverse</a></div><div class="ttdeci">T reverse(T... args)</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ga9fff26ca8ab43bd8c8c5545f38a83278"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga9fff26ca8ab43bd8c8c5545f38a83278">&#9670;&nbsp;</a></span>getEdgeMoleculesInRings()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ring::getEdgeMoleculesInRings </td>
          <td>(</td>
          <td class="paramtype"><a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; <a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt;&gt;&#160;</td>
          <td class="paramname"><em>rings</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmolSys_1_1PointCloud.html">molSys::PointCloud</a>&lt; <a class="el" href="structmolSys_1_1Point.html">molSys::Point</a>&lt; double &gt;, double &gt; *&#160;</td>
          <td class="paramname"><em>oCloud</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmolSys_1_1PointCloud.html">molSys::PointCloud</a>&lt; <a class="el" href="structmolSys_1_1Point.html">molSys::Point</a>&lt; double &gt;, double &gt; *&#160;</td>
          <td class="paramname"><em>yCloud</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="elRef" href="http://en.cppreference.com/w/cpp/container/array.html">std::array</a>&lt; double, 3 &gt;&#160;</td>
          <td class="paramname"><em>coordLow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="elRef" href="http://en.cppreference.com/w/cpp/container/array.html">std::array</a>&lt; double, 3 &gt;&#160;</td>
          <td class="paramname"><em>coordHigh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>identicalCloud</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Select edge molecules and atoms which are part of rings, such that rings formed with even one atom in the slice will be included in the selection Modifies the inSlice bool of a given PointCloud (this may be the same) as the given oxygen atom PointCloud which was used to construct the neighbour list used to construct the rings vector of vectors. We assume that the PointCloud structs have the inSlice bool values set according to the presence of the atom in the slice (this can be done using the <a class="el" href="group__ring.html#ga9decdf9fe1692fc0b03dee64653d9ddf">gen::moleculesInSingleSlice</a> function. <br  />
</p>
<p>Function that loops through the PointCloud used to construct the neighbour list (used to generate primitive rings) and sets the inSlice bool values of edge atoms which belong to rings that are formed by atoms in the slice. The output PointCloud may not be the same as the PointCloud used to construct the nList, and the inSlice bool value can be set for both. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">rings</td><td>Vector of vectors of the primitive rings (by index) according to oCloud </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">oCloud</td><td>PointCloud of O atoms, used to construct the rings vector of vectors </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">yCloud</td><td>The output PointCloud (may contain more than just the O atoms) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">identicalCloud</td><td>bool value; if this is true then oCloud and yCloud are the same </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">coordLow</td><td>Contains the lower limits of the slice (needed to find all the molecules of oCloud in the slice) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">coordHigh</td><td>Contains the upper limits of the slice </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="selection_8cpp_source.html#l00265">265</a> of file <a class="el" href="selection_8cpp_source.html">selection.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;                                                                                      {</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;  <span class="comment">// A vector of bool values, such that every ring has a value of true (in the slice) or false (not in the slice) </span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;bool&gt;</a> ringInSlice(rings.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/size.html">size</a>(), <span class="keyword">false</span>); <span class="comment">// all set to false initially.</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;  <span class="keywordtype">int</span> jatomIndex, jatomID; <span class="comment">// Index and ID in oCloud </span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;  <span class="keywordtype">int</span> jatomIndex1; <span class="comment">// Index in yCloud  </span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/unordered_multimap.html">std::unordered_multimap&lt;int, int&gt;</a></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;      molIDAtomIDmap; <span class="comment">// Unordered multimap with molecule IDs of the atoms as the keys and the</span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;                  <span class="comment">// atom IDs as the values. More than one atom can have the same molecule ID</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160; </div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;  <span class="comment">// --------------------</span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;  <span class="comment">// Sets all O atoms within the slice to an inSlice bool value of true. If a single atom of a molecule is in the</span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;  <span class="comment">// slice, then all atoms in the molecule will also be inside the slice </span></div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;  <a class="code" href="group__ring.html#ga9decdf9fe1692fc0b03dee64653d9ddf">gen::moleculesInSingleSlice</a>(oCloud, <span class="keyword">true</span>, coordLow, coordHigh);</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;  <span class="comment">// --------------------</span></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;  <span class="comment">// Get the unordered map of the atom IDs (keys) and the molecular IDs</span></div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;  <span class="comment">// (values)</span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;  molIDAtomIDmap = <a class="code" href="group__molSys.html#ga4b864398cbcf013fa20a59e597e6e667">molSys::createMolIDAtomIDMultiMap</a>(yCloud);</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;  <span class="comment">// --------------------</span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160; </div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;  <span class="comment">// Loop through every iatom present in the slice in oCloud</span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;  <span class="comment">// Check to see if iatom is in any ring. If it is present in a ring, set that ring to true </span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;  <span class="comment">// Change the inSlice bool of every iatom in the ring to true if false. Set also the inSlice bool</span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;  <span class="comment">// of the output cloud if it is not identical. </span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160; </div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;  <span class="comment">// Loop through every iatom present in the slice in oCloud to determine which rings are in the slice</span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;  <span class="comment">// The indices of oCloud and rings should match (or this will produce unexpected results)</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iatom = 0; iatom &lt; oCloud-&gt;<a class="code" href="group__molSys.html#ga2bdcb9260bd83f313a2d27fcc6437ef1">nop</a>; iatom++) {</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    <span class="comment">// Skip if iatom is not in the slice</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    <span class="keywordflow">if</span> (!oCloud-&gt;<a class="code" href="group__molSys.html#ga67ab89369cd26572878a91afd521ef81">pts</a>[iatom].inSlice)</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    {</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    } <span class="comment">// skip for iatom not in slice</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    <span class="comment">// For iatom in the slice, </span></div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    <span class="comment">// loop through all rings to find all the rings it is a part of </span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iring = 0; iring &lt; rings.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/size.html">size</a>(); iring++)</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    {</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;      <span class="comment">// Skip if iring is in the slice already</span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;      <span class="keywordflow">if</span> (ringInSlice[iring])</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;      {</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;      } <span class="comment">// skip for iring in slice </span></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;      <span class="comment">// Check and see if iatom is in iring </span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;      <span class="keywordflow">if</span>(<a class="codeRef" href="http://en.cppreference.com/w/cpp/algorithm/find.html">std::find</a>(rings[iring].<a class="codeRef" href="http://en.cppreference.com/w/cpp/iterator/begin.html">begin</a>(), rings[iring].<a class="codeRef" href="http://en.cppreference.com/w/cpp/iterator/end.html">end</a>(), iatom)!=rings[iring].<a class="codeRef" href="http://en.cppreference.com/w/cpp/iterator/end.html">end</a>()){</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;        <span class="comment">// Found iatom; ring is part of the slice </span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;        ringInSlice[iring] = <span class="keyword">true</span>; <span class="comment">// update the vector of bool values</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;        <span class="comment">// --------------------------</span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;        <span class="comment">// Change the inSlice bool of every iatom in oCloud </span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;        <span class="comment">// (and optionally, yCloud) in the ring to true</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;        <span class="comment">// Loop through the elements of the ring </span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; rings[iring].<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/size.html">size</a>(); j++)</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;        {</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;          jatomIndex = rings[iring][j]; <span class="comment">// Index of the atom in oCloud </span></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;          <span class="comment">// Set this to true in oCloud </span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;          oCloud-&gt;<a class="code" href="group__molSys.html#ga67ab89369cd26572878a91afd521ef81">pts</a>[jatomIndex].inSlice = <span class="keyword">true</span>; <span class="comment">// part of slice </span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;          jatomID = oCloud-&gt;<a class="code" href="group__molSys.html#ga67ab89369cd26572878a91afd521ef81">pts</a>[jatomIndex].atomID; <span class="comment">// Atom ID </span></div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;          <span class="comment">// Now if oCloud and yCloud are not the same, use the</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;          <span class="comment">// atom ID to set the inSlice bool value in yCloud </span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;          <span class="keywordflow">if</span> (!identicalCloud)</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;          {</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;            <span class="comment">// Find the index corresponding to the same atom in yCloud </span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;            <span class="keyword">auto</span> gotJ = yCloud-&gt;<a class="code" href="group__molSys.html#ga8e48a0ae066c2585e7320cdaa0cbc8db">idIndexMap</a>.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/unordered_map/find.html">find</a>(jatomID);</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;            jatomIndex1 = gotJ-&gt;second;</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;            <span class="comment">// throw if not found ?</span></div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;            <span class="comment">// Set the jatom inSlice bool to true</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;            yCloud-&gt;<a class="code" href="group__molSys.html#ga67ab89369cd26572878a91afd521ef81">pts</a>[jatomIndex1].inSlice = <span class="keyword">true</span>; <span class="comment">// jatomIndex is inside the slice </span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;            <span class="comment">// set the inSlice value of all atoms in yCloud with the current molecule ID </span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;            <a class="code" href="group__ring.html#ga81dde14f79d13cb8e2c04a1e78ac11fb">gen::setAtomsWithSameMolID</a>(yCloud, molIDAtomIDmap, </div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;              yCloud-&gt;<a class="code" href="group__molSys.html#ga67ab89369cd26572878a91afd521ef81">pts</a>[jatomIndex1].molID, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;          } <span class="comment">// end of setting values in yCloud </span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;        } <span class="comment">// end of loop through the elements of the current ring </span></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;        <span class="comment">// --------------------------</span></div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;      } <span class="comment">// found iatom in the ring</span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;      <span class="comment">//</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    } <span class="comment">// end of loop through all rings searching for iatom </span></div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;  } <span class="comment">// end of loop through atoms in oCloud in the slice </span></div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160; </div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160; </div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;  <span class="comment">// Optionally add support for molecule slice update if yCloud and oCloud are not identical?</span></div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;  <span class="comment">// Some other bool?  </span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;  <span class="comment">// IC(ringInSlice);</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160; </div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;  <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;}</div>
<div class="ttc" id="agroup__molSys_html_ga4b864398cbcf013fa20a59e597e6e667"><div class="ttname"><a href="group__molSys.html#ga4b864398cbcf013fa20a59e597e6e667">molSys::createMolIDAtomIDMultiMap</a></div><div class="ttdeci">std::unordered_multimap&lt; int, int &gt; createMolIDAtomIDMultiMap(molSys::PointCloud&lt; molSys::Point&lt; double &gt;, double &gt; *yCloud)</div><div class="ttdef"><b>Definition:</b> <a href="mol__sys_8cpp_source.html#l00067">mol_sys.cpp:67</a></div></div>
<div class="ttc" id="agroup__molSys_html_ga8e48a0ae066c2585e7320cdaa0cbc8db"><div class="ttname"><a href="group__molSys.html#ga8e48a0ae066c2585e7320cdaa0cbc8db">molSys::PointCloud::idIndexMap</a></div><div class="ttdeci">std::unordered_map&lt; int, int &gt; idIndexMap</div><div class="ttdoc">xlo, ylo, zlo</div><div class="ttdef"><b>Definition:</b> <a href="mol__sys_8hpp_source.html#l00176">mol_sys.hpp:176</a></div></div>
<div class="ttc" id="agroup__ring_html_ga81dde14f79d13cb8e2c04a1e78ac11fb"><div class="ttname"><a href="group__ring.html#ga81dde14f79d13cb8e2c04a1e78ac11fb">gen::setAtomsWithSameMolID</a></div><div class="ttdeci">void setAtomsWithSameMolID(molSys::PointCloud&lt; molSys::Point&lt; double &gt;, double &gt; *yCloud, std::unordered_multimap&lt; int, int &gt; molIDAtomIDmap, int molID, bool inSliceValue=true)</div><div class="ttdef"><b>Definition:</b> <a href="selection_8cpp_source.html#l00225">selection.cpp:225</a></div></div>
<div class="ttc" id="agroup__ring_html_ga9decdf9fe1692fc0b03dee64653d9ddf"><div class="ttname"><a href="group__ring.html#ga9decdf9fe1692fc0b03dee64653d9ddf">gen::moleculesInSingleSlice</a></div><div class="ttdeci">void moleculesInSingleSlice(molSys::PointCloud&lt; molSys::Point&lt; double &gt;, double &gt; *yCloud, bool clearPreviousSliceSelection=true, std::array&lt; double, 3 &gt; coordLow=std::array&lt; double, 3 &gt;{0, 0, 0}, std::array&lt; double, 3 &gt; coordHigh=std::array&lt; double, 3 &gt;{0, 0, 0})</div><div class="ttdef"><b>Definition:</b> <a href="selection_8cpp_source.html#l00147">selection.cpp:147</a></div></div>
<div class="ttc" id="aunordered_multimap_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/container/unordered_multimap.html">std::unordered_multimap</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ga216eec245aa026b0c9f78f92aa81af34"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga216eec245aa026b0c9f78f92aa81af34">&#9670;&nbsp;</a></span>getPointCloudOneAtomType()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structmolSys_1_1PointCloud.html">molSys::PointCloud</a>&lt; <a class="el" href="structmolSys_1_1Point.html">molSys::Point</a>&lt; double &gt;, double &gt; gen::getPointCloudOneAtomType </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmolSys_1_1PointCloud.html">molSys::PointCloud</a>&lt; <a class="el" href="structmolSys_1_1Point.html">molSys::Point</a>&lt; double &gt;, double &gt; *&#160;</td>
          <td class="paramname"><em>yCloud</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmolSys_1_1PointCloud.html">molSys::PointCloud</a>&lt; <a class="el" href="structmolSys_1_1Point.html">molSys::Point</a>&lt; double &gt;, double &gt; *&#160;</td>
          <td class="paramname"><em>outCloud</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>atomTypeI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>isSlice</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="elRef" href="http://en.cppreference.com/w/cpp/container/array.html">std::array</a>&lt; double, 3 &gt;&#160;</td>
          <td class="paramname"><em>coordLow</em> = <code><a class="elRef" href="http://en.cppreference.com/w/cpp/container/array.html">std::array</a>&lt;double,&#160;3&gt;{0,&#160;0,&#160;0}</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="elRef" href="http://en.cppreference.com/w/cpp/container/array.html">std::array</a>&lt; double, 3 &gt;&#160;</td>
          <td class="paramname"><em>coordHigh</em> = <code><a class="elRef" href="http://en.cppreference.com/w/cpp/container/array.html">std::array</a>&lt;double,&#160;3&gt;{0,&#160;0,&#160;0}</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Given a pointCloud containing certain atom types, this returns a pointCloud containing atoms of only the desired type</p>
<p>Function that loops through a given input pointCloud and returns a new pointCloud only containing atoms of a given atom type ID. <br  />
 This is registered as a Lua function, and is exposed to the user directly. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">yCloud</td><td>The given input PointCloud </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">outCloud</td><td>The output PointCloud </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">atomTypeI</td><td>The type ID of the atoms to save in the output PointCloud </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">isSlice</td><td>This decides whether a slice will be used or not </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">coordLow</td><td>Contains the lower limits of the slice, if a slice is to be created </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">coordHigh</td><td>Contains the upper limits of the slice, if a slice is to be created </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="selection_8cpp_source.html#l00037">37</a> of file <a class="el" href="selection_8cpp_source.html">selection.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;                                   {</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  <span class="keywordtype">int</span> natoms = 0;             <span class="comment">// Number of atoms of the desired type </span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  <span class="keywordtype">bool</span> pointInSlice = <span class="keyword">true</span>; <span class="comment">// If the current point is in the slice, this is true (otherwise this is false)</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160; </div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  <span class="comment">// --------</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  <span class="comment">// Before filling up the PointCloud, if the vectors are filled</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  <span class="comment">// empty them</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;  *outCloud = <a class="code" href="group__molSys.html#gad8acfb41ee6bc0258612e9cac24269b2">molSys::clearPointCloud</a>(outCloud);</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  <span class="comment">// --------</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160; </div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  <span class="comment">// Loop through every iatom and check the type</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iatom = 0; iatom &lt; yCloud-&gt;<a class="code" href="group__molSys.html#ga2bdcb9260bd83f313a2d27fcc6437ef1">nop</a>; iatom++) {</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    <span class="comment">// Skip if the atom is not of the desired type </span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <span class="keywordflow">if</span> (yCloud-&gt;<a class="code" href="group__molSys.html#ga67ab89369cd26572878a91afd521ef81">pts</a>[iatom].type != atomTypeI) {</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    } <span class="comment">// end of checking for the type </span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    <span class="comment">// ----------------</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    <span class="comment">// only if a slice has been requested</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    <span class="keywordflow">if</span> (isSlice) {</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;      pointInSlice = <a class="code" href="group__sinp.html#gad5a8c377d8ed78c413c13d80ac8261ac">sinp::atomInSlice</a>(yCloud-&gt;<a class="code" href="group__molSys.html#ga67ab89369cd26572878a91afd521ef81">pts</a>[iatom].x, yCloud-&gt;<a class="code" href="group__molSys.html#ga67ab89369cd26572878a91afd521ef81">pts</a>[iatom].y, yCloud-&gt;<a class="code" href="group__molSys.html#ga67ab89369cd26572878a91afd521ef81">pts</a>[iatom].z,</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;                                               coordLow, coordHigh);</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;      <span class="comment">// Skip if the atom is not part of the slice</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;      <span class="keywordflow">if</span> (!pointInSlice) {</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;      } <span class="comment">// skipped for atoms not in the slice </span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    } <span class="comment">// end of slice handling </span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <span class="comment">// Actually add the atoms to the outCloud</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    natoms++; <span class="comment">// Update the number of atoms in outCloud</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    outCloud-&gt;<a class="code" href="group__molSys.html#ga67ab89369cd26572878a91afd521ef81">pts</a>.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/push_back.html">push_back</a>(yCloud-&gt;<a class="code" href="group__molSys.html#ga67ab89369cd26572878a91afd521ef81">pts</a>[iatom]); <span class="comment">// Update the pts vector</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    outCloud-&gt;<a class="code" href="group__molSys.html#ga8e48a0ae066c2585e7320cdaa0cbc8db">idIndexMap</a>[yCloud-&gt;<a class="code" href="group__molSys.html#ga67ab89369cd26572878a91afd521ef81">pts</a>[iatom].atomID] =</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;                outCloud-&gt;<a class="code" href="group__molSys.html#ga67ab89369cd26572878a91afd521ef81">pts</a>.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/size.html">size</a>() - 1; <span class="comment">// array index</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  }</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160; </div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  <span class="comment">// Update the number of particles in the PointCloud</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  outCloud-&gt;<a class="code" href="group__molSys.html#ga2bdcb9260bd83f313a2d27fcc6437ef1">nop</a> = outCloud-&gt;<a class="code" href="group__molSys.html#ga67ab89369cd26572878a91afd521ef81">pts</a>.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/size.html">size</a>();</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160; </div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;  <span class="comment">// Box and box lengths </span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;  outCloud-&gt;<a class="code" href="group__molSys.html#gaa7d9b8543780baf4a495c7acdb1f87d8">box</a> = yCloud-&gt;<a class="code" href="group__molSys.html#gaa7d9b8543780baf4a495c7acdb1f87d8">box</a>;</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;  outCloud-&gt;<a class="code" href="group__molSys.html#gac861daaeb2b1e75a6ac9eb3390bc6105">boxLow</a> = yCloud-&gt;<a class="code" href="group__molSys.html#gac861daaeb2b1e75a6ac9eb3390bc6105">boxLow</a>;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160; </div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;  <span class="comment">// Update the frame number</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  outCloud-&gt;<a class="code" href="group__molSys.html#gafccb5a0daab40c3ccc83e4494f4176d7">currentFrame</a> = yCloud-&gt;<a class="code" href="group__molSys.html#gafccb5a0daab40c3ccc83e4494f4176d7">currentFrame</a>; </div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160; </div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;  <span class="keywordflow">return</span> *outCloud;</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;}</div>
<div class="ttc" id="agroup__molSys_html_gac861daaeb2b1e75a6ac9eb3390bc6105"><div class="ttname"><a href="group__molSys.html#gac861daaeb2b1e75a6ac9eb3390bc6105">molSys::PointCloud::boxLow</a></div><div class="ttdeci">std::vector&lt; T &gt; boxLow</div><div class="ttdoc">Periodic box lengths.</div><div class="ttdef"><b>Definition:</b> <a href="mol__sys_8hpp_source.html#l00175">mol_sys.hpp:175</a></div></div>
<div class="ttc" id="agroup__molSys_html_gad8acfb41ee6bc0258612e9cac24269b2"><div class="ttname"><a href="group__molSys.html#gad8acfb41ee6bc0258612e9cac24269b2">molSys::clearPointCloud</a></div><div class="ttdeci">molSys::PointCloud&lt; molSys::Point&lt; double &gt;, double &gt; clearPointCloud(molSys::PointCloud&lt; molSys::Point&lt; double &gt;, double &gt; *yCloud)</div><div class="ttdoc">//! Function for clearing vectors in PointCloud after multiple usage</div><div class="ttdef"><b>Definition:</b> <a href="mol__sys_8cpp_source.html#l00024">mol_sys.cpp:24</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="gae9254c83de03fcf18b4cb5dcb2625011"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gae9254c83de03fcf18b4cb5dcb2625011">&#9670;&nbsp;</a></span>getSingleRingSize()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; <a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt; &gt; ring::getSingleRingSize </td>
          <td>(</td>
          <td class="paramtype"><a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; <a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt;&gt;&#160;</td>
          <td class="paramname"><em>rings</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ringSize</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns a vector of vectors of rings of a single size. </p>
<p>Function that gets rings of a single ring size (i.e. a particular number of nodes) from all primitive rings, and returns a vector of vectors containing the rings of the specified size. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">rings</td><td>The vector of vectors containing the primitive rings of all sizes. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ringSize</td><td>The desired ring size or number of nodes in each ring to be saved. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A vector of vectors containing primitive rings of one ring size or length. </dd></dl>

<p class="definition">Definition at line <a class="el" href="ring_8cpp_source.html#l00200">200</a> of file <a class="el" href="ring_8cpp_source.html">ring.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;                                                                     {</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;std::vector&lt;int&gt;</a>&gt; ringSingleSize; <span class="comment">// rings of one size</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160; </div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;  <span class="comment">// rings contains primitive rings of all sizes</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;  <span class="comment">// Only save rings of a given size (ringSize) to the new</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;  <span class="comment">// vector of vectors, ringSingleSize</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iring = 0; iring &lt; rings.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/size.html">size</a>(); iring++) {</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <span class="comment">// Check the size of the current ring</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    <span class="comment">// If it is the correct size, save it in ringSingleSize</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    <span class="keywordflow">if</span> (rings[iring].size() == ringSize) {</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;      ringSingleSize.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/push_back.html">push_back</a>(rings[iring]);</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    } <span class="comment">// End of check of the size of iring</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;  }   <span class="comment">// end of loop through all rings in rings</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160; </div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;  <span class="keywordflow">return</span> ringSingleSize;</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="gac30855d0daa2b20c29e4dee39f5cd92f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gac30855d0daa2b20c29e4dee39f5cd92f">&#9670;&nbsp;</a></span>hasCommonElements()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool ring::hasCommonElements </td>
          <td>(</td>
          <td class="paramtype"><a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt;&#160;</td>
          <td class="paramname"><em>ring1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt;&#160;</td>
          <td class="paramname"><em>ring2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Check to see if two vectors have common elements or not True, if common elements are present and false if there are no common elements</p>
<p>For two vectors, checks to see if there are common elements (true) or not (false). </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ring1</td><td>The vector of the first ring. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ring2</td><td>The vector of the second ring. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A bool which is true if the input vectors have at least one common element, and false if there are no common elements. </dd></dl>

<p class="definition">Definition at line <a class="el" href="ring_8cpp_source.html#l00226">226</a> of file <a class="el" href="ring_8cpp_source.html">ring.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;                                                                       {</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a> commonElements; <span class="comment">// Vector containing common elements</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160; </div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;  <span class="comment">// Sort the vectors before finding common elements</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/algorithm/sort.html">sort</a>(ring1.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/begin.html">begin</a>(), ring1.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/end.html">end</a>());</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/algorithm/sort.html">sort</a>(ring2.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/begin.html">begin</a>(), ring2.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/end.html">end</a>());</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160; </div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;  <span class="comment">// Find intersection of sorted vectors</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;  <span class="keyword">auto</span> it =</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;      <a class="codeRef" href="http://en.cppreference.com/w/cpp/algorithm/set_intersection.html">std::set_intersection</a>(ring1.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/begin.html">begin</a>(), ring1.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/end.html">end</a>(), ring2.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/begin.html">begin</a>(),</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;                            ring2.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/end.html">end</a>(), <a class="codeRef" href="http://en.cppreference.com/w/cpp/iterator/back_inserter.html">std::back_inserter</a>(commonElements));</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160; </div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;  <span class="comment">// If there are no elements in common, then return false</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;  <span class="keywordflow">if</span> (commonElements.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/size.html">size</a>() == 0) {</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;  }</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;  <span class="comment">// If there are common elements, return true</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;  <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;  }</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;}</div>
<div class="ttc" id="aback_inserter_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/iterator/back_inserter.html">std::back_inserter</a></div><div class="ttdeci">T back_inserter(T... args)</div></div>
<div class="ttc" id="aset_intersection_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/algorithm/set_intersection.html">std::set_intersection</a></div><div class="ttdeci">T set_intersection(T... args)</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ga938e41913c66bc09a3b98a683507da10"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga938e41913c66bc09a3b98a683507da10">&#9670;&nbsp;</a></span>keepAxialRingsOnly()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt;<a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt;int&gt; &gt; ring::keepAxialRingsOnly </td>
          <td>(</td>
          <td class="paramtype"><a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; <a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt;&gt;&#160;</td>
          <td class="paramname"><em>rings</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmolSys_1_1PointCloud.html">molSys::PointCloud</a>&lt; <a class="el" href="structmolSys_1_1Point.html">molSys::Point</a>&lt; double &gt;, double &gt; *&#160;</td>
          <td class="paramname"><em>yCloud</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Saves only axial rings out of all possible rings. </p>

</div>
</div>
<a id="ga9decdf9fe1692fc0b03dee64653d9ddf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga9decdf9fe1692fc0b03dee64653d9ddf">&#9670;&nbsp;</a></span>moleculesInSingleSlice()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void gen::moleculesInSingleSlice </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmolSys_1_1PointCloud.html">molSys::PointCloud</a>&lt; <a class="el" href="structmolSys_1_1Point.html">molSys::Point</a>&lt; double &gt;, double &gt; *&#160;</td>
          <td class="paramname"><em>yCloud</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>clearPreviousSliceSelection</em> = <code>true</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="elRef" href="http://en.cppreference.com/w/cpp/container/array.html">std::array</a>&lt; double, 3 &gt;&#160;</td>
          <td class="paramname"><em>coordLow</em> = <code><a class="elRef" href="http://en.cppreference.com/w/cpp/container/array.html">std::array</a>&lt;double,&#160;3&gt;{0,&#160;0,&#160;0}</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="elRef" href="http://en.cppreference.com/w/cpp/container/array.html">std::array</a>&lt; double, 3 &gt;&#160;</td>
          <td class="paramname"><em>coordHigh</em> = <code><a class="elRef" href="http://en.cppreference.com/w/cpp/container/array.html">std::array</a>&lt;double,&#160;3&gt;{0,&#160;0,&#160;0}</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Given a pointCloud set the inSlice bool for every atom, if the molecules are inside the specified (single) region. If even one atom of a molecule is inside the region, then all atoms of that molecule will be inside the region (irrespective of type)</p>
<p>Function that loops through a given input PointCloud and sets the inSlice bool for every Point according to whether the molecule <br  />
 is in the specified (single) slice or not. If even one atom of a molecule is inside the region, then all atoms belonging to that molecule should be inside the slice as well (therefore, inSlice would be set to true) NOTE: THIS DOES NOT WORK. ERROR </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">yCloud</td><td>The given input PointCloud </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">clearPreviousSliceSelection</td><td>sets all inSlice bool values to false before adding Points to the slice </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">coordLow</td><td>Contains the lower limits of the slice, if a slice is to be created </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">coordHigh</td><td>Contains the upper limits of the slice, if a slice is to be created </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="selection_8cpp_source.html#l00147">147</a> of file <a class="el" href="selection_8cpp_source.html">selection.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;                                   {</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;  <span class="keywordtype">bool</span> pointInSlice = <span class="keyword">true</span>; <span class="comment">// If the current point is in the slice, this is true (otherwise this is false)</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/unordered_multimap.html">std::unordered_multimap&lt;int, int&gt;</a></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;      molIDAtomIDmap; <span class="comment">// Unordered multimap with molecule IDs of the atoms as the keys and the</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;                  <span class="comment">// atom IDs as the values. More than one atom can have the same molecule ID</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  <span class="keywordtype">int</span> iatomMolID; <span class="comment">// molID of the current iatom</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;  <span class="keywordtype">int</span> jatomID;    <span class="comment">// atom ID of the current jatom</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;  <span class="keywordtype">int</span> jatomIndex; <span class="comment">// index of jatom</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160; </div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;  <span class="comment">// --------------------</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;  <span class="comment">// Get the unordered map of the atom IDs (keys) and the molecular IDs</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;  <span class="comment">// (values)</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;  molIDAtomIDmap = <a class="code" href="group__molSys.html#ga4b864398cbcf013fa20a59e597e6e667">molSys::createMolIDAtomIDMultiMap</a>(yCloud);</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;  <span class="comment">// --------------------</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;  <span class="comment">// Set inSlice to false for every atom first</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;  <span class="keywordflow">if</span> (clearPreviousSliceSelection)</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;  {</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iatom = 0; iatom &lt; yCloud-&gt;<a class="code" href="group__molSys.html#ga2bdcb9260bd83f313a2d27fcc6437ef1">nop</a>; iatom++) {</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;      yCloud-&gt;<a class="code" href="group__molSys.html#ga67ab89369cd26572878a91afd521ef81">pts</a>[iatom].inSlice = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    }</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;  } <span class="comment">// end of init</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;  <span class="comment">// --------------------</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160; </div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;  <span class="comment">// Loop through every iatom and check if the atom is in the slice or not </span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iatom = 0; iatom &lt; yCloud-&gt;<a class="code" href="group__molSys.html#ga2bdcb9260bd83f313a2d27fcc6437ef1">nop</a>; iatom++) {</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <span class="comment">// Check if the current atom is in the slice </span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    pointInSlice = <a class="code" href="group__sinp.html#gad5a8c377d8ed78c413c13d80ac8261ac">sinp::atomInSlice</a>(yCloud-&gt;<a class="code" href="group__molSys.html#ga67ab89369cd26572878a91afd521ef81">pts</a>[iatom].x, yCloud-&gt;<a class="code" href="group__molSys.html#ga67ab89369cd26572878a91afd521ef81">pts</a>[iatom].y, yCloud-&gt;<a class="code" href="group__molSys.html#ga67ab89369cd26572878a91afd521ef81">pts</a>[iatom].z,</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;                                               coordLow, coordHigh);</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    <span class="comment">// Set the inSlice bool for the particular Point </span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    <span class="keywordflow">if</span> (pointInSlice)</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    {</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;      yCloud-&gt;<a class="code" href="group__molSys.html#ga67ab89369cd26572878a91afd521ef81">pts</a>[iatom].inSlice = <span class="keyword">true</span>; <span class="comment">// iatom is inside the slice</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;      <span class="comment">// Find mol ID and atoms with that particular molecular ID </span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;      iatomMolID = yCloud-&gt;<a class="code" href="group__molSys.html#ga67ab89369cd26572878a91afd521ef81">pts</a>[iatom].molID; <span class="comment">// molecule ID </span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;      <span class="comment">// -----------</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;      <span class="comment">// Find all atoms with iatomMolID and set the inSlice bool</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;      <span class="comment">// to true</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;      <span class="keyword">auto</span> range = molIDAtomIDmap.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/unordered_multimap/equal_range.html">equal_range</a>(iatomMolID); </div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;      <span class="comment">// Loop through all atoms with iatomMolID</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span> it = range.first; it != range.second; it++)</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;      {</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;        <span class="comment">// it-&gt;second gives the value (in this case, the atom ID)</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;        jatomID = it-&gt;second; <span class="comment">// Atom ID with molecule ID equal to iatomMolID</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;        <span class="keyword">auto</span> gotJ = yCloud-&gt;<a class="code" href="group__molSys.html#ga8e48a0ae066c2585e7320cdaa0cbc8db">idIndexMap</a>.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/unordered_map/find.html">find</a>(jatomID);</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;        jatomIndex = gotJ-&gt;second;</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;        <span class="comment">// Set the jatom inSlice bool to true</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;        yCloud-&gt;<a class="code" href="group__molSys.html#ga67ab89369cd26572878a91afd521ef81">pts</a>[jatomIndex].inSlice = <span class="keyword">true</span>; <span class="comment">// jatomIndex is inside the slice </span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;      }</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;      <span class="comment">// -----------</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    } <span class="comment">// the atom is in the slice </span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;      yCloud-&gt;<a class="code" href="group__molSys.html#ga67ab89369cd26572878a91afd521ef81">pts</a>[iatom].inSlice = <span class="keyword">false</span>; <span class="comment">// iatom is not in the slice  </span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    } <span class="comment">// atom is not in the slice</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;  }</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160; </div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;  <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;}</div>
<div class="ttc" id="aequal_range_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/container/unordered_multimap/equal_range.html">std::unordered_multimap::equal_range</a></div><div class="ttdeci">T equal_range(T... args)</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ga83d8dc9c337e72051e01b234c12cc41c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga83d8dc9c337e72051e01b234c12cc41c">&#9670;&nbsp;</a></span>polygonRingAnalysis()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ring::polygonRingAnalysis </td>
          <td>(</td>
          <td class="paramtype"><a class="elRef" href="http://en.cppreference.com/w/cpp/string/basic_string.html">std::string</a>&#160;</td>
          <td class="paramname"><em>path</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; <a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt;&gt;&#160;</td>
          <td class="paramname"><em>rings</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; <a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt;&gt;&#160;</td>
          <td class="paramname"><em>nList</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmolSys_1_1PointCloud.html">molSys::PointCloud</a>&lt; <a class="el" href="structmolSys_1_1Point.html">molSys::Point</a>&lt; double &gt;, double &gt; *&#160;</td>
          <td class="paramname"><em>yCloud</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>maxDepth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>sheetArea</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>firstFrame</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Find out which rings are prisms, looping through all ring sizes upto the maxDepth The input ringsAllSizes array has rings of every size.</p>
<p>Function that loops through the primitive rings (which is a vector of vectors) of all sizes, upto maxDepth (the largest ring size). The function returns a vector which contains the ring indices of all the rings which constitute prism blocks. The ring IDs correspond to the index of the rings inside the vector of vector rings, starting from 0. This is registered as a Lua function, and is exposed to the user directly. The function calls the following functions internally:</p><ul>
<li><a class="el" href="group__ring.html#ga76f3cb7aa8a713aeafecdf3a6fffee31" title="Erases memory for a vector of vectors for a list of rings.">ring::clearRingList</a> (Clears the vector of vectors for rings of a single type, to prevent excessive memory being blocked).</li>
<li><a class="el" href="group__ring.html#gae9254c83de03fcf18b4cb5dcb2625011" title="Returns a vector of vectors of rings of a single size.">ring::getSingleRingSize</a> (Fill a vector of vectors for rings of a particular ring size).</li>
<li><a class="el" href="group__ring.html#ga0a1fdfaea2b64e45c4e0d7d7f8864507">ring::findPrisms</a> (Now that rings of a particular size have been obtained, prism blocks are found and saved).</li>
<li><a class="el" href="namespacetopoparam.html#ae31b7c89d7555d2cdea139a838b8b40b">topoparam::normHeightPercent</a> (Gets the height% for the prism blocks).</li>
<li><a class="el" href="group__ring.html#gab1ed37cff6088e349647efff91627f3c">ring::assignPrismType</a> (Assigns a prism type to each atom type).</li>
<li><a class="el" href="namespacesout.html#a27b0ed070347ff0351e2d0882d1d6ddd">sout::writePrismNum</a> (Write out the prism information for the current frame).</li>
<li><a class="el" href="namespacesout.html#ae3038ae689d60cc3529b95caa0b75ae1" title="Write a data file for prisms of every type.">sout::writeLAMMPSdataAllPrisms</a> (Writes out a LAMMPS data file for the current frame, which can be visualized in OVITO). <dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">path</td><td>The string to the output directory, in which files will be written out. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rings</td><td>Row-ordered vector of vectors for rings of a single type. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nList</td><td>Row-ordered neighbour list by index. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">yCloud</td><td>The input PointCloud. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">maxDepth</td><td>The maximum possible size of the primitive rings. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">sheetArea</td><td>Area calculated using the two significant dimensions of the quasi-two-dimensional sheet. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">firstFrame</td><td>The first frame to be analyzed </td></tr>
  </table>
  </dd>
</dl>
</li>
</ul>

<p class="definition">Definition at line <a class="el" href="topo__two__dim_8cpp_source.html#l00037">37</a> of file <a class="el" href="topo__two__dim_8cpp_source.html">topo_two_dim.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;                                      {</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;std::vector&lt;int&gt;</a>&gt;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;      ringsOneType;           <span class="comment">// Vector of vectors of rings of a single size</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  <span class="keywordtype">int</span> nRings;                 <span class="comment">// Number of rings of the current type</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a> nRingList; <span class="comment">// Vector of the values of the number of prisms</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;                              <span class="comment">// for a particular frame</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;double&gt;</a> coverageAreaXY; <span class="comment">// Coverage area percent on the XY plane</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;                                      <span class="comment">// for a particular n and frame</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;double&gt;</a> coverageAreaXZ; <span class="comment">// Coverage area percent on the XZ plane</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;                                      <span class="comment">// for a particular n and frame</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;double&gt;</a> coverageAreaYZ; <span class="comment">// Coverage area percent on the YZ plane</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;                                      <span class="comment">// for a particular n and frame</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;double&gt;</a> singleAreas; <span class="comment">// Coverage area on the XY, XZ and YZ planes</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;                                   <span class="comment">// for a single ring</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;      atomTypes; <span class="comment">// contains int values for each prism type considered</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  <span class="comment">// -------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  <span class="comment">// Init</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  nRingList.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/resize.html">resize</a>(</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;      maxDepth -</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;      2); <span class="comment">// Has a value for every value of ringSize from 3, upto maxDepth</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;  coverageAreaXY.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/resize.html">resize</a>(maxDepth - 2);</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  coverageAreaXZ.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/resize.html">resize</a>(maxDepth - 2);</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;  coverageAreaYZ.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/resize.html">resize</a>(maxDepth - 2);</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;  <span class="comment">// The atomTypes vector is the same size as the pointCloud atoms</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;  atomTypes.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/resize.html">resize</a>(yCloud-&gt;<a class="code" href="group__molSys.html#ga2bdcb9260bd83f313a2d27fcc6437ef1">nop</a>, 1); <span class="comment">// The dummy or unclassified value is 1</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  <span class="comment">// -------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;  <span class="comment">// Run this loop for rings of sizes upto maxDepth</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;  <span class="comment">// The smallest possible ring is of size 3</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ringSize = 3; ringSize &lt;= maxDepth; ringSize++) {</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <span class="comment">// Clear ringsOneType</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    <a class="code" href="group__ring.html#ga76f3cb7aa8a713aeafecdf3a6fffee31">ring::clearRingList</a>(ringsOneType);</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    <span class="comment">// Get rings of the current ring size</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    ringsOneType = <a class="code" href="group__ring.html#gae9254c83de03fcf18b4cb5dcb2625011">ring::getSingleRingSize</a>(rings, ringSize);</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    <span class="comment">// Continue if there are zero rings of ringSize</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <span class="keywordflow">if</span> (ringsOneType.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/size.html">size</a>() == 0) {</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;      nRingList[ringSize - 3] = 0; <span class="comment">// Update the number of prisms</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;      <span class="comment">// Update the coverage area%</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;      coverageAreaXY[ringSize - 3] = 0.0;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;      coverageAreaXZ[ringSize - 3] = 0.0;</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;      coverageAreaYZ[ringSize - 3] = 0.0;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    } <span class="comment">// skip if there are no rings</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <span class="comment">// -------------</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <span class="comment">// Number of rings with n nodes</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    nRings = ringsOneType.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/size.html">size</a>();</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <span class="comment">// -------------</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <span class="comment">// Now that you have rings of a certain size:</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    nRingList[ringSize - 3] = nRings; <span class="comment">// Update the number of n-membered rings</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <span class="comment">// Update the coverage area% for the n-membered ring phase.</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    singleAreas = <a class="code" href="namespacetopoparam.html#af43f5a98cbe437620167c8d9ea078b56">topoparam::calcCoverageArea</a>(yCloud, ringsOneType, sheetArea);</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    <span class="comment">// XY plane</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    coverageAreaXY[ringSize - 3] = singleAreas[0];</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <span class="comment">// XZ plane</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    coverageAreaXZ[ringSize - 3] = singleAreas[1];</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <span class="comment">// YZ plane</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    coverageAreaYZ[ringSize - 3] = singleAreas[2];</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    <span class="comment">// -------------</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  } <span class="comment">// end of loop through every possible ringSize</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160; </div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  <span class="comment">// Get the atom types for all the ring types</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  <a class="code" href="group__ring.html#gadab15a0007278962f78f83794549d438">ring::assignPolygonType</a>(rings, &amp;atomTypes, nRingList);</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160; </div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  <span class="comment">// Write out the ring information</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  <a class="code" href="namespacesout.html#a3775e3decf75faac38693c4b13143938">sout::writeRingNum</a>(path, yCloud-&gt;<a class="code" href="group__molSys.html#gafccb5a0daab40c3ccc83e4494f4176d7">currentFrame</a>, nRingList, coverageAreaXY,</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;                     coverageAreaXZ, coverageAreaYZ, maxDepth, firstFrame);</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  <span class="comment">// Write out the lammps data file for the particular frame</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  <a class="code" href="namespacesout.html#a39e0081b79852366fd17b377a9925ae0">sout::writeLAMMPSdataAllRings</a>(yCloud, nList, atomTypes, maxDepth, path);</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160; </div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;}</div>
<div class="ttc" id="agroup__ring_html_ga76f3cb7aa8a713aeafecdf3a6fffee31"><div class="ttname"><a href="group__ring.html#ga76f3cb7aa8a713aeafecdf3a6fffee31">ring::clearRingList</a></div><div class="ttdeci">int clearRingList(std::vector&lt; std::vector&lt; int &gt;&gt; &amp;rings)</div><div class="ttdoc">Erases memory for a vector of vectors for a list of rings.</div><div class="ttdef"><b>Definition:</b> <a href="ring_8cpp_source.html#l00022">ring.cpp:22</a></div></div>
<div class="ttc" id="agroup__ring_html_gadab15a0007278962f78f83794549d438"><div class="ttname"><a href="group__ring.html#gadab15a0007278962f78f83794549d438">ring::assignPolygonType</a></div><div class="ttdeci">int assignPolygonType(std::vector&lt; std::vector&lt; int &gt;&gt; rings, std::vector&lt; int &gt; *atomTypes, std::vector&lt; int &gt; nRings)</div><div class="ttdef"><b>Definition:</b> <a href="ring_8cpp_source.html#l00040">ring.cpp:40</a></div></div>
<div class="ttc" id="agroup__ring_html_gae9254c83de03fcf18b4cb5dcb2625011"><div class="ttname"><a href="group__ring.html#gae9254c83de03fcf18b4cb5dcb2625011">ring::getSingleRingSize</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; int &gt; &gt; getSingleRingSize(std::vector&lt; std::vector&lt; int &gt;&gt; rings, int ringSize)</div><div class="ttdoc">Returns a vector of vectors of rings of a single size.</div><div class="ttdef"><b>Definition:</b> <a href="ring_8cpp_source.html#l00200">ring.cpp:200</a></div></div>
<div class="ttc" id="anamespacesout_html_a3775e3decf75faac38693c4b13143938"><div class="ttname"><a href="namespacesout.html#a3775e3decf75faac38693c4b13143938">sout::writeRingNum</a></div><div class="ttdeci">int writeRingNum(std::string path, int currentFrame, std::vector&lt; int &gt; nRings, std::vector&lt; double &gt; coverageAreaXY, std::vector&lt; double &gt; coverageAreaXZ, std::vector&lt; double &gt; coverageAreaYZ, int maxDepth, int firstFrame)</div><div class="ttdef"><b>Definition:</b> <a href="seams__output_8cpp_source.html#l01077">seams_output.cpp:1077</a></div></div>
<div class="ttc" id="anamespacesout_html_a39e0081b79852366fd17b377a9925ae0"><div class="ttname"><a href="namespacesout.html#a39e0081b79852366fd17b377a9925ae0">sout::writeLAMMPSdataAllRings</a></div><div class="ttdeci">int writeLAMMPSdataAllRings(molSys::PointCloud&lt; molSys::Point&lt; double &gt;, double &gt; *yCloud, std::vector&lt; std::vector&lt; int &gt;&gt; nList, std::vector&lt; int &gt; atomTypes, int maxDepth, std::string path, bool isMonolayer=true)</div><div class="ttdoc">Write a data file for rings of every type for a monolayer.</div><div class="ttdef"><b>Definition:</b> <a href="seams__output_8cpp_source.html#l01661">seams_output.cpp:1661</a></div></div>
<div class="ttc" id="anamespacetopoparam_html_af43f5a98cbe437620167c8d9ea078b56"><div class="ttname"><a href="namespacetopoparam.html#af43f5a98cbe437620167c8d9ea078b56">topoparam::calcCoverageArea</a></div><div class="ttdeci">std::vector&lt; double &gt; calcCoverageArea(molSys::PointCloud&lt; molSys::Point&lt; double &gt;, double &gt; *yCloud, std::vector&lt; std::vector&lt; int &gt;&gt; rings, double sheetArea)</div><div class="ttdef"><b>Definition:</b> <a href="order__parameter_8cpp_source.html#l00070">order_parameter.cpp:70</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="gac782697302e8da50e12bec77288a67e0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gac782697302e8da50e12bec77288a67e0">&#9670;&nbsp;</a></span>printSliceGetEdgeMoleculesInRings()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ring::printSliceGetEdgeMoleculesInRings </td>
          <td>(</td>
          <td class="paramtype"><a class="elRef" href="http://en.cppreference.com/w/cpp/string/basic_string.html">std::string</a>&#160;</td>
          <td class="paramname"><em>path</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; <a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt;&gt;&#160;</td>
          <td class="paramname"><em>rings</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmolSys_1_1PointCloud.html">molSys::PointCloud</a>&lt; <a class="el" href="structmolSys_1_1Point.html">molSys::Point</a>&lt; double &gt;, double &gt; *&#160;</td>
          <td class="paramname"><em>oCloud</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmolSys_1_1PointCloud.html">molSys::PointCloud</a>&lt; <a class="el" href="structmolSys_1_1Point.html">molSys::Point</a>&lt; double &gt;, double &gt; *&#160;</td>
          <td class="paramname"><em>yCloud</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="elRef" href="http://en.cppreference.com/w/cpp/container/array.html">std::array</a>&lt; double, 3 &gt;&#160;</td>
          <td class="paramname"><em>coordLow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="elRef" href="http://en.cppreference.com/w/cpp/container/array.html">std::array</a>&lt; double, 3 &gt;&#160;</td>
          <td class="paramname"><em>coordHigh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>identicalCloud</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Master function for selecting edge molecules and atoms which are part of rings, such that rings formed with even one atom in the slice will be included in the selection Modifies the inSlice bool of a given PointCloud (this may be the same) as the given oxygen atom PointCloud which was used to construct the neighbour list used to construct the rings vector of vectors (calls <a class="el" href="group__ring.html#ga9fff26ca8ab43bd8c8c5545f38a83278">ring::getEdgeMoleculesInRings</a>) Prints out molecule IDs individually of molecules in the slice, and also prints out a LAMMPS data file of just the molecules and atoms in the slice <br  />
</p>
<p>Function that loops through the PointCloud used to construct the neighbour list (used to generate primitive rings) and sets the inSlice bool values of edge atoms which belong to rings that are formed by atoms in the slice. The selected molecule IDs are printed to a separate file, and the molecules and atoms in the slice will be output to a LAMMPS data file (with the original box volume) The output PointCloud may not be the same as the PointCloud used to construct the nList, and the inSlice bool value can be set for both. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">rings</td><td>Vector of vectors of the primitive rings (by index) according to oCloud </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">oCloud</td><td>PointCloud of O atoms, used to construct the rings vector of vectors </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">yCloud</td><td>The output PointCloud (may contain more than just the O atoms) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">identicalCloud</td><td>bool value; if this is true then oCloud and yCloud are the same </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">coordLow</td><td>Contains the lower limits of the slice (needed to find all the molecules of oCloud in the slice) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">coordHigh</td><td>Contains the upper limits of the slice </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="selection_8cpp_source.html#l00375">375</a> of file <a class="el" href="selection_8cpp_source.html">selection.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;                                                                                      {</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160; </div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;  <span class="comment">//Given the full yCloud PointCloud, set the inSlice bool for every atom,</span></div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;  <span class="comment">// if the molecules are inside the specified (single) region. </span></div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;  <span class="comment">// gen::atomsInSingleSlice(yCloud, true, coordLow, coordHigh);</span></div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;  <a class="code" href="group__ring.html#ga9decdf9fe1692fc0b03dee64653d9ddf">gen::moleculesInSingleSlice</a>(yCloud, <span class="keyword">true</span>, coordLow, coordHigh);</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160; </div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;  <span class="comment">// Make sure that molecules which participate in the rings inside the slice are also </span></div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;  <span class="comment">// in the selection </span></div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;  <a class="code" href="group__ring.html#ga9fff26ca8ab43bd8c8c5545f38a83278">ring::getEdgeMoleculesInRings</a>(rings, oCloud, yCloud, coordLow, coordHigh, identicalCloud);</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160; </div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;  <span class="comment">// Print out the molecule IDs of all the atoms in the slice</span></div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;  <a class="code" href="namespacesout.html#a1cfbcd0f8d90f3033ee5e505c07e0400">sout::writeMoleculeIDsInSlice</a>(path, yCloud);</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;  <span class="comment">// Print out a command that could be used for an expression select command in OVITO</span></div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;  <a class="code" href="namespacesout.html#a96aa8c9d78c09d7cd77c4d46182e7b3b">sout::writeMoleculeIDsExpressionSelectOVITO</a>(path, yCloud);</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160; </div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;  <span class="comment">// Print out the dump of all atoms and molecules, with an inSlice value printed in a separate column</span></div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;  <span class="comment">// H atoms not included in the slice (TODO: fix)</span></div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;  <a class="code" href="namespacesout.html#a31d215aac08b1a890f73e074eae808a1">sout::writeLAMMPSdumpSlice</a>(yCloud, path); </div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;  </div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;  IC(rings[0]);</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160; </div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;  <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;}</div>
<div class="ttc" id="agroup__ring_html_ga9fff26ca8ab43bd8c8c5545f38a83278"><div class="ttname"><a href="group__ring.html#ga9fff26ca8ab43bd8c8c5545f38a83278">ring::getEdgeMoleculesInRings</a></div><div class="ttdeci">void getEdgeMoleculesInRings(std::vector&lt; std::vector&lt; int &gt;&gt; rings, molSys::PointCloud&lt; molSys::Point&lt; double &gt;, double &gt; *oCloud, molSys::PointCloud&lt; molSys::Point&lt; double &gt;, double &gt; *yCloud, std::array&lt; double, 3 &gt; coordLow, std::array&lt; double, 3 &gt; coordHigh, bool identicalCloud=false)</div><div class="ttdef"><b>Definition:</b> <a href="selection_8cpp_source.html#l00265">selection.cpp:265</a></div></div>
<div class="ttc" id="anamespacesout_html_a1cfbcd0f8d90f3033ee5e505c07e0400"><div class="ttname"><a href="namespacesout.html#a1cfbcd0f8d90f3033ee5e505c07e0400">sout::writeMoleculeIDsInSlice</a></div><div class="ttdeci">int writeMoleculeIDsInSlice(std::string path, molSys::PointCloud&lt; molSys::Point&lt; double &gt;, double &gt; *yCloud)</div><div class="ttdef"><b>Definition:</b> <a href="seams__output_8cpp_source.html#l00877">seams_output.cpp:877</a></div></div>
<div class="ttc" id="anamespacesout_html_a31d215aac08b1a890f73e074eae808a1"><div class="ttname"><a href="namespacesout.html#a31d215aac08b1a890f73e074eae808a1">sout::writeLAMMPSdumpSlice</a></div><div class="ttdeci">int writeLAMMPSdumpSlice(molSys::PointCloud&lt; molSys::Point&lt; double &gt;, double &gt; *yCloud, std::string path)</div><div class="ttdef"><b>Definition:</b> <a href="seams__output_8cpp_source.html#l01452">seams_output.cpp:1452</a></div></div>
<div class="ttc" id="anamespacesout_html_a96aa8c9d78c09d7cd77c4d46182e7b3b"><div class="ttname"><a href="namespacesout.html#a96aa8c9d78c09d7cd77c4d46182e7b3b">sout::writeMoleculeIDsExpressionSelectOVITO</a></div><div class="ttdeci">int writeMoleculeIDsExpressionSelectOVITO(std::string path, molSys::PointCloud&lt; molSys::Point&lt; double &gt;, double &gt; *yCloud)</div><div class="ttdef"><b>Definition:</b> <a href="seams__output_8cpp_source.html#l00964">seams_output.cpp:964</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ga083a38f83a1a89eba434d64a33986637"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga083a38f83a1a89eba434d64a33986637">&#9670;&nbsp;</a></span>prismAnalysis()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ring::prismAnalysis </td>
          <td>(</td>
          <td class="paramtype"><a class="elRef" href="http://en.cppreference.com/w/cpp/string/basic_string.html">std::string</a>&#160;</td>
          <td class="paramname"><em>path</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; <a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt;&gt;&#160;</td>
          <td class="paramname"><em>rings</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; <a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt;&gt;&#160;</td>
          <td class="paramname"><em>nList</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmolSys_1_1PointCloud.html">molSys::PointCloud</a>&lt; <a class="el" href="structmolSys_1_1Point.html">molSys::Point</a>&lt; double &gt;, double &gt; *&#160;</td>
          <td class="paramname"><em>yCloud</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>maxDepth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>atomID</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>firstFrame</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>currentFrame</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>doShapeMatching</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Find out which rings are prisms, looping through all ring sizes upto the maxDepth The input ringsAllSizes array has rings of every size.</p>
<p>Function that loops through the primitive rings (which is a vector of vectors) of all sizes, upto maxDepth (the largest ring size). The function returns a vector which contains the ring indices of all the rings which constitute prism blocks. The ring IDs correspond to the index of the rings inside the vector of vector rings, starting from 0. This is registered as a Lua function, and is exposed to the user directly. The function calls the following functions internally:</p><ul>
<li><a class="el" href="group__ring.html#ga76f3cb7aa8a713aeafecdf3a6fffee31" title="Erases memory for a vector of vectors for a list of rings.">ring::clearRingList</a> (Clears the vector of vectors for rings of a single type, to prevent excessive memory being blocked).</li>
<li><a class="el" href="group__ring.html#gae9254c83de03fcf18b4cb5dcb2625011" title="Returns a vector of vectors of rings of a single size.">ring::getSingleRingSize</a> (Fill a vector of vectors for rings of a particular ring size).</li>
<li><a class="el" href="group__ring.html#ga0a1fdfaea2b64e45c4e0d7d7f8864507">ring::findPrisms</a> (Now that rings of a particular size have been obtained, prism blocks are found and saved).</li>
<li><a class="el" href="namespacetopoparam.html#ae31b7c89d7555d2cdea139a838b8b40b">topoparam::normHeightPercent</a> (Gets the height% for the prism blocks).</li>
<li><a class="el" href="group__ring.html#gab1ed37cff6088e349647efff91627f3c">ring::assignPrismType</a> (Assigns a prism type to each atom type).</li>
<li><a class="el" href="namespacesout.html#a27b0ed070347ff0351e2d0882d1d6ddd">sout::writePrismNum</a> (Write out the prism information for the current frame).</li>
<li><a class="el" href="namespacesout.html#ae3038ae689d60cc3529b95caa0b75ae1" title="Write a data file for prisms of every type.">sout::writeLAMMPSdataAllPrisms</a> (Writes out a LAMMPS data file for the current frame, which can be visualized in OVITO). <dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">path</td><td>The string to the output directory, in which files will be written out. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rings</td><td>Row-ordered vector of vectors for rings of a single type. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nList</td><td>Row-ordered neighbour list by index. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">yCloud</td><td>The input PointCloud. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">maxDepth</td><td>The maximum possible size of the primitive rings. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">maxDepth</td><td>The first frame. </td></tr>
  </table>
  </dd>
</dl>
</li>
</ul>

<p class="definition">Definition at line <a class="el" href="topo__one__dim_8cpp_source.html#l00049">49</a> of file <a class="el" href="topo__one__dim_8cpp_source.html">topo_one_dim.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;                                                                         {</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;std::vector&lt;int&gt;</a>&gt;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;      ringsOneType;           <span class="comment">// Vector of vectors of rings of a single size</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a> listPrism; <span class="comment">// Vector for ring indices of n-sided prism</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;ring::strucType&gt;</a></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;      ringType; <span class="comment">// This vector will have a value for each ring inside</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;ring::strucType&gt;</a></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;      atomState; <span class="comment">// This vector will have a value for each atom, depending on</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;                 <span class="comment">// the ring type</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;  <span class="keywordtype">int</span> nPerfectPrisms;          <span class="comment">// Number of perfect prisms of each type</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  <span class="keywordtype">int</span> nImperfectPrisms;        <span class="comment">// Number of deformed prisms of each type</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a> nPrismList; <span class="comment">// Vector of the values of the number of perfect</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;                               <span class="comment">// prisms for a particular frame</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a> nDefPrismList; <span class="comment">// Vector of the values of the number of</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;                                  <span class="comment">// deformed prisms for a particular frame</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;double&gt;</a></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;      heightPercent; <span class="comment">// Height percent for a particular n and frame</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;      atomTypes; <span class="comment">// contains int values for each prism type considered</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  <span class="keywordtype">double</span> avgPrismHeight = 2.845; <span class="comment">// A value of 2.7-2.85 Angstrom is reasonable</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  <span class="comment">// Qualifier for the RMSD per atom:</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;double&gt;</a> rmsdPerAtom;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  <span class="comment">// -------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  <span class="comment">// Init</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;  nPrismList.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/resize.html">resize</a>(</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;      maxDepth -</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;      2); <span class="comment">// Has a value for every value of ringSize from 3, upto maxDepth</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;  nDefPrismList.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/resize.html">resize</a>(maxDepth - 2);</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;  heightPercent.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/resize.html">resize</a>(maxDepth - 2);</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;  <span class="comment">// The atomTypes vector is the same size as the pointCloud atoms</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  atomTypes.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/resize.html">resize</a>(yCloud-&gt;<a class="code" href="group__molSys.html#ga2bdcb9260bd83f313a2d27fcc6437ef1">nop</a>, 1); <span class="comment">// The dummy or unclassified value is 1</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  <span class="comment">// The rmsdPerAtom vector is the same size as the pointCloud atoms and has an</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;  <span class="comment">// RMSD value for every atom</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;  rmsdPerAtom.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/resize.html">resize</a>(yCloud-&gt;<a class="code" href="group__molSys.html#ga2bdcb9260bd83f313a2d27fcc6437ef1">nop</a>, -1);</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;  <span class="comment">// Resize the atom state vector</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  atomState.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/resize.html">resize</a>(yCloud-&gt;<a class="code" href="group__molSys.html#ga2bdcb9260bd83f313a2d27fcc6437ef1">nop</a>); <span class="comment">// Dummy or unclassified</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  <span class="comment">// -------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  <span class="comment">// Run this loop for rings of sizes upto maxDepth</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  <span class="comment">// The smallest possible ring is of size 3</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ringSize = 3; ringSize &lt;= maxDepth; ringSize++) {</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <span class="comment">// Clear ringsOneType</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    <a class="code" href="group__ring.html#ga76f3cb7aa8a713aeafecdf3a6fffee31">ring::clearRingList</a>(ringsOneType);</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <span class="comment">// Get rings of the current ring size</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    ringsOneType = <a class="code" href="group__ring.html#gae9254c83de03fcf18b4cb5dcb2625011">ring::getSingleRingSize</a>(rings, ringSize);</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <span class="comment">// Continue if there are zero rings of ringSize</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    <span class="keywordflow">if</span> (ringsOneType.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/size.html">size</a>() == 0) {</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;      nPrismList[ringSize - 3] = 0;      <span class="comment">// Update the number of prisms</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;      nDefPrismList[ringSize - 3] = 0;   <span class="comment">// Update the number of deformed prisms</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;      heightPercent[ringSize - 3] = 0.0; <span class="comment">// Update the height%</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    } <span class="comment">// skip if there are no rings</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    <span class="comment">// -------------</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    <span class="comment">// Init of variables specific to ringSize prisms</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    listPrism.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/resize.html">resize</a>(0);</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    ringType.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/resize.html">resize</a>(0);</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    nPerfectPrisms = 0;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    nImperfectPrisms = 0;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    ringType.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/resize.html">resize</a>(</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        ringsOneType.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/size.html">size</a>()); <span class="comment">// Has a value for each ring. init to zero.</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    <span class="comment">// -------------</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    <span class="comment">// Now that you have rings of a certain size:</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    <span class="comment">// Find prisms, saving the ring indices to listPrism</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    listPrism = <a class="code" href="group__ring.html#ga0a1fdfaea2b64e45c4e0d7d7f8864507">ring::findPrisms</a>(ringsOneType, &amp;ringType, &amp;nPerfectPrisms,</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;                                 &amp;nImperfectPrisms, nList, yCloud, &amp;rmsdPerAtom,</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;                                 doShapeMatching);</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    <span class="comment">// -------------</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    nPrismList[ringSize - 3] =</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;        nPerfectPrisms; <span class="comment">// Update the number of perfect prisms</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    nDefPrismList[ringSize - 3] =</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        nImperfectPrisms; <span class="comment">// Update the number of defromed prisms</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    <span class="keywordtype">int</span> totalPrisms = nPerfectPrisms + nImperfectPrisms;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <span class="comment">// Update the height% for the phase</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    heightPercent[ringSize - 3] =</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;        <a class="code" href="namespacetopoparam.html#ae31b7c89d7555d2cdea139a838b8b40b">topoparam::normHeightPercent</a>(yCloud, totalPrisms, avgPrismHeight);</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <span class="comment">// Continue if there are no prism units</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <span class="keywordflow">if</span> (nPerfectPrisms + nImperfectPrisms == 0) {</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    } <span class="comment">// skip for no prisms</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    <span class="comment">// Do a bunch of write-outs and calculations</span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    <span class="comment">// TODO: Write out each individual prism as data files (maybe with an</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    <span class="comment">// option)</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    <span class="comment">// Get the atom types for a particular prism type</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <a class="code" href="group__ring.html#gab1ed37cff6088e349647efff91627f3c">ring::assignPrismType</a>(ringsOneType, listPrism, ringSize, ringType,</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;                          &amp;atomTypes, &amp;atomState);</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    <span class="comment">// -------------</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  } <span class="comment">// end of loop through every possible ringSize</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160; </div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;  <span class="comment">// Calculate the height%</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160; </div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;  <span class="comment">// Write out the prism information</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;  <a class="code" href="namespacesout.html#a27b0ed070347ff0351e2d0882d1d6ddd">sout::writePrismNum</a>(path, nPrismList, nDefPrismList, heightPercent, maxDepth,</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;                      yCloud-&gt;<a class="code" href="group__molSys.html#gafccb5a0daab40c3ccc83e4494f4176d7">currentFrame</a>, firstFrame);</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;  <span class="comment">// Reassign the prism block types for the deformed prisms</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;  <span class="keywordflow">if</span> (doShapeMatching) {</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    <a class="code" href="group__ring.html#ga5f7b22fe1354ebe4982b8a9df0067b65">ring::deformedPrismTypes</a>(atomState, &amp;atomTypes, maxDepth);</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;  } <span class="comment">// reassign prism block types for deformed prisms</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160; </div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;  <span class="comment">// Get rid of translations along the axial dimension</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;  <a class="code" href="group__ring.html#ga9d7e63eb7b6c37024744c4f372796cef">ring::rmAxialTranslations</a>(yCloud, atomID, firstFrame, currentFrame);</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160; </div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;  <span class="comment">// Write out dump files with the RMSD per atom for the shape-matching</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  <span class="comment">// criterion</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;  <span class="keywordflow">if</span> (doShapeMatching) {</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    <a class="code" href="namespacesout.html#a6ecf4c61a66360ec154723bffe21b2b2">sout::writeLAMMPSdumpINT</a>(yCloud, rmsdPerAtom, atomTypes, maxDepth, path);</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;  } <span class="comment">// reassign prism block types for deformed prisms</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160; </div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;  <span class="comment">// Write out the lammps data file for the particular frame</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;  <a class="code" href="namespacesout.html#ae3038ae689d60cc3529b95caa0b75ae1">sout::writeLAMMPSdataAllPrisms</a>(yCloud, nList, atomTypes, maxDepth, path,</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;                                 doShapeMatching);</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160; </div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;  <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;}</div>
<div class="ttc" id="agroup__ring_html_ga0a1fdfaea2b64e45c4e0d7d7f8864507"><div class="ttname"><a href="group__ring.html#ga0a1fdfaea2b64e45c4e0d7d7f8864507">ring::findPrisms</a></div><div class="ttdeci">std::vector&lt; int &gt; findPrisms(std::vector&lt; std::vector&lt; int &gt;&gt; rings, std::vector&lt; strucType &gt; *ringType, int *nPerfectPrisms, int *nImperfectPrisms, std::vector&lt; std::vector&lt; int &gt;&gt; nList, molSys::PointCloud&lt; molSys::Point&lt; double &gt;, double &gt; *yCloud, std::vector&lt; double &gt; *rmsdPerAtom, bool doShapeMatching=false)</div><div class="ttdef"><b>Definition:</b> <a href="topo__one__dim_8cpp_source.html#l00193">topo_one_dim.cpp:193</a></div></div>
<div class="ttc" id="agroup__ring_html_ga5f7b22fe1354ebe4982b8a9df0067b65"><div class="ttname"><a href="group__ring.html#ga5f7b22fe1354ebe4982b8a9df0067b65">ring::deformedPrismTypes</a></div><div class="ttdeci">int deformedPrismTypes(std::vector&lt; ring::strucType &gt; atomState, std::vector&lt; int &gt; *atomTypes, int maxDepth)</div><div class="ttdoc">Get the atom type values for deformed prisms.</div><div class="ttdef"><b>Definition:</b> <a href="topo__one__dim_8cpp_source.html#l00759">topo_one_dim.cpp:759</a></div></div>
<div class="ttc" id="agroup__ring_html_ga9d7e63eb7b6c37024744c4f372796cef"><div class="ttname"><a href="group__ring.html#ga9d7e63eb7b6c37024744c4f372796cef">ring::rmAxialTranslations</a></div><div class="ttdeci">int rmAxialTranslations(molSys::PointCloud&lt; molSys::Point&lt; double &gt;, double &gt; *yCloud, int *atomID, int firstFrame, int currentFrame)</div><div class="ttdoc">Shift the entire ice nanotube and remove axial translations.</div><div class="ttdef"><b>Definition:</b> <a href="topo__one__dim_8cpp_source.html#l00791">topo_one_dim.cpp:791</a></div></div>
<div class="ttc" id="agroup__ring_html_gab1ed37cff6088e349647efff91627f3c"><div class="ttname"><a href="group__ring.html#gab1ed37cff6088e349647efff91627f3c">ring::assignPrismType</a></div><div class="ttdeci">int assignPrismType(std::vector&lt; std::vector&lt; int &gt;&gt; rings, std::vector&lt; int &gt; listPrism, int ringSize, std::vector&lt; ring::strucType &gt; ringType, std::vector&lt; int &gt; *atomTypes, std::vector&lt; ring::strucType &gt; *atomState)</div><div class="ttdef"><b>Definition:</b> <a href="topo__one__dim_8cpp_source.html#l00696">topo_one_dim.cpp:696</a></div></div>
<div class="ttc" id="anamespacesout_html_a27b0ed070347ff0351e2d0882d1d6ddd"><div class="ttname"><a href="namespacesout.html#a27b0ed070347ff0351e2d0882d1d6ddd">sout::writePrismNum</a></div><div class="ttdeci">int writePrismNum(std::string path, std::vector&lt; int &gt; nPrisms, std::vector&lt; int &gt; nDefPrisms, std::vector&lt; double &gt; heightPercent, int maxDepth, int currentFrame, int firstFrame)</div><div class="ttdef"><b>Definition:</b> <a href="seams__output_8cpp_source.html#l01031">seams_output.cpp:1031</a></div></div>
<div class="ttc" id="anamespacesout_html_a6ecf4c61a66360ec154723bffe21b2b2"><div class="ttname"><a href="namespacesout.html#a6ecf4c61a66360ec154723bffe21b2b2">sout::writeLAMMPSdumpINT</a></div><div class="ttdeci">int writeLAMMPSdumpINT(molSys::PointCloud&lt; molSys::Point&lt; double &gt;, double &gt; *yCloud, std::vector&lt; double &gt; rmsdPerAtom, std::vector&lt; int &gt; atomTypes, int maxDepth, std::string path)</div><div class="ttdoc">Write out a LAMMPS dump file containing the RMSD per atom.</div><div class="ttdef"><b>Definition:</b> <a href="seams__output_8cpp_source.html#l01378">seams_output.cpp:1378</a></div></div>
<div class="ttc" id="anamespacesout_html_ae3038ae689d60cc3529b95caa0b75ae1"><div class="ttname"><a href="namespacesout.html#ae3038ae689d60cc3529b95caa0b75ae1">sout::writeLAMMPSdataAllPrisms</a></div><div class="ttdeci">int writeLAMMPSdataAllPrisms(molSys::PointCloud&lt; molSys::Point&lt; double &gt;, double &gt; *yCloud, std::vector&lt; std::vector&lt; int &gt;&gt; nList, std::vector&lt; int &gt; atomTypes, int maxDepth, std::string path, bool doShapeMatching=false)</div><div class="ttdoc">Write a data file for prisms of every type.</div><div class="ttdef"><b>Definition:</b> <a href="seams__output_8cpp_source.html#l01527">seams_output.cpp:1527</a></div></div>
<div class="ttc" id="anamespacetopoparam_html_ae31b7c89d7555d2cdea139a838b8b40b"><div class="ttname"><a href="namespacetopoparam.html#ae31b7c89d7555d2cdea139a838b8b40b">topoparam::normHeightPercent</a></div><div class="ttdeci">double normHeightPercent(molSys::PointCloud&lt; molSys::Point&lt; double &gt;, double &gt; *yCloud, int nPrisms, double avgPrismHeight)</div><div class="ttdef"><b>Definition:</b> <a href="order__parameter_8cpp_source.html#l00032">order_parameter.cpp:32</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ga033c466e933a1a3b532ef4ecdf7626f0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga033c466e933a1a3b532ef4ecdf7626f0">&#9670;&nbsp;</a></span>relaxedPrismConditions()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool ring::relaxedPrismConditions </td>
          <td>(</td>
          <td class="paramtype"><a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; <a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt;&gt;&#160;</td>
          <td class="paramname"><em>nList</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt; *&#160;</td>
          <td class="paramname"><em>basal1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt; *&#160;</td>
          <td class="paramname"><em>basal2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Reduced criterion: Two candidate basal rings of a prism block should have at least one bond between them</p>
<p>Relaxed criteria for deformed prism blocks: at least one bond should exist between the basal rings. </p>

<p class="definition">Definition at line <a class="el" href="topo__one__dim_8cpp_source.html#l00436">436</a> of file <a class="el" href="topo__one__dim_8cpp_source.html">topo_one_dim.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;                                                          {</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;  <span class="keywordtype">int</span> ringSize =</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;      (*basal1).size();     <span class="comment">// Size of the ring; each ring contains n elements</span></div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;  <span class="keywordtype">int</span> m_k;                  <span class="comment">// Atom ID of element in basal2</span></div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;  <span class="keywordtype">bool</span> isNeighbour = <span class="keyword">false</span>; <span class="comment">// This is true if there is at least one bond</span></div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;                            <span class="comment">// between the basal rings</span></div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;  <span class="keywordtype">int</span> l_k;                  <span class="comment">// Atom ID of element in basal1</span></div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160; </div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;  <span class="comment">// ---------------------------------------------</span></div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;  <span class="comment">// COMPARISON OF basal2 ELEMENTS (m_k) WITH basal1 ELEMENTS (l_k)</span></div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;  <span class="comment">// Loop through all the elements of basal1</span></div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> l = 0; l &lt; ringSize; l++) {</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    l_k = (*basal1)[l];</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;    <span class="comment">// Search for the nearest neighbour of l_k in basal2</span></div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    <span class="comment">// Loop through basal2 elements</span></div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> m = 0; m &lt; ringSize; m++) {</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;      m_k = (*basal2)[m];</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;      <span class="comment">// Find m_k inside l_k neighbour list</span></div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;      <span class="keyword">auto</span> it = <a class="codeRef" href="http://en.cppreference.com/w/cpp/algorithm/find.html">std::find</a>(nList[l_k].<a class="codeRef" href="http://en.cppreference.com/w/cpp/iterator/begin.html">begin</a>() + 1, nList[l_k].<a class="codeRef" href="http://en.cppreference.com/w/cpp/iterator/end.html">end</a>(), m_k);</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160; </div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;      <span class="comment">// If the element has been found, for l1</span></div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;      <span class="keywordflow">if</span> (it != nList[l_k].<a class="codeRef" href="http://en.cppreference.com/w/cpp/iterator/end.html">end</a>()) {</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;        isNeighbour = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;      } <span class="comment">// found element</span></div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    }   <span class="comment">// end of loop through all the elements of basal2</span></div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160; </div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;    <span class="comment">// If a neighbour has been found then</span></div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    <span class="keywordflow">if</span> (isNeighbour) {</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    }</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;  } <span class="comment">// end of loop through all the elements of basal1</span></div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160; </div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;  <span class="comment">// If a neighbour has not been found, return false</span></div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ga9d7e63eb7b6c37024744c4f372796cef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga9d7e63eb7b6c37024744c4f372796cef">&#9670;&nbsp;</a></span>rmAxialTranslations()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ring::rmAxialTranslations </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmolSys_1_1PointCloud.html">molSys::PointCloud</a>&lt; <a class="el" href="structmolSys_1_1Point.html">molSys::Point</a>&lt; double &gt;, double &gt; *&#160;</td>
          <td class="paramname"><em>yCloud</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>atomID</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>firstFrame</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>currentFrame</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Shift the entire ice nanotube and remove axial translations. </p>
<p>Assign an atomType value for atoms belonging to deformed prisms. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">rings</td><td>The vector of vectors containing the primitive rings, of a particular ring size. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">listPrism</td><td>The list of prism blocks found. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ringSize</td><td>The current ring size or number of nodes in each ring. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">atomTypes</td><td>A vector which contains a type for each atom, depending on it's type as classified by the prism identification scheme. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="topo__one__dim_8cpp_source.html#l00791">791</a> of file <a class="el" href="topo__one__dim_8cpp_source.html">topo_one_dim.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;                                      {</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;  <span class="keywordtype">int</span> atomIndex;          <span class="comment">// Index of the atom to be shifted first</span></div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;  <span class="keywordtype">double</span> shiftDistance;   <span class="comment">// Value by which all atoms will be shifted</span></div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;  <span class="keywordtype">double</span> distFrmBoundary; <span class="comment">// Distance from either the upper or lower boundary</span></div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;                          <span class="comment">// along the axial dimension</span></div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;  <span class="comment">// Get the axial dimension</span></div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;  <span class="keywordtype">int</span> axialDim = <a class="codeRef" href="http://en.cppreference.com/w/cpp/algorithm/max_element.html">std::max_element</a>(yCloud-&gt;<a class="code" href="group__molSys.html#gaa7d9b8543780baf4a495c7acdb1f87d8">box</a>.begin(), yCloud-&gt;<a class="code" href="group__molSys.html#gaa7d9b8543780baf4a495c7acdb1f87d8">box</a>.end()) -</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;                 yCloud-&gt;<a class="code" href="group__molSys.html#gaa7d9b8543780baf4a495c7acdb1f87d8">box</a>.begin();</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;  <span class="comment">// Check: (default z)</span></div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;  <span class="keywordflow">if</span> (axialDim &lt; 0 || axialDim &gt; 2) {</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;    axialDim = 2;</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;  } <span class="comment">// end of check to set the axial dimension</span></div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;  <span class="comment">// Lower and higher limits of the box in the axial dimension</span></div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;  <span class="keywordtype">double</span> boxLowAxial = yCloud-&gt;<a class="code" href="group__molSys.html#gac861daaeb2b1e75a6ac9eb3390bc6105">boxLow</a>[axialDim];</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;  <span class="keywordtype">double</span> boxHighAxial = boxLowAxial + yCloud-&gt;<a class="code" href="group__molSys.html#gaa7d9b8543780baf4a495c7acdb1f87d8">box</a>[axialDim];</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;  <span class="comment">// -----------------------------------</span></div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;  <span class="comment">// Update the atomID of the &#39;first&#39; atom in yCloud if the current frame is the</span></div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;  <span class="comment">// first frame.</span></div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;  <span class="comment">// Get the atom index of the first atom to be shifted down or up</span></div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;  <span class="keywordflow">if</span> (currentFrame == firstFrame) {</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;    *atomID = yCloud-&gt;<a class="code" href="group__molSys.html#ga67ab89369cd26572878a91afd521ef81">pts</a>[0].atomID;</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;    atomIndex = 0;</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;  } <span class="comment">// end of update of the atom ID to be shifted for the first frame</span></div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;  <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;    <span class="keywordtype">int</span> iatomID = *atomID; <span class="comment">// Atom ID of the first particle to be moved down</span></div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;    <span class="comment">// Find the index given the atom ID</span></div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;    <span class="keyword">auto</span> it = yCloud-&gt;<a class="code" href="group__molSys.html#ga8e48a0ae066c2585e7320cdaa0cbc8db">idIndexMap</a>.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/unordered_map/find.html">find</a>(iatomID);</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160; </div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;    <span class="keywordflow">if</span> (it != yCloud-&gt;<a class="code" href="group__molSys.html#ga8e48a0ae066c2585e7320cdaa0cbc8db">idIndexMap</a>.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/unordered_map/end.html">end</a>()) {</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;      atomIndex = it-&gt;second;</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;    } <span class="comment">// found jatom</span></div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;      <a class="codeRef" href="http://en.cppreference.com/w/cpp/io/basic_ostream.html">std::cerr</a> &lt;&lt; <span class="stringliteral">&quot;Lost atoms.\n&quot;</span>;</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;      <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;    } <span class="comment">// error handling</span></div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;  } <span class="comment">// Update of atomIndex for all other frames</span></div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;  <span class="comment">// -----------------------------------</span></div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;  <span class="comment">// Calculate the distance by which the atoms must be shifted (negative value)</span></div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;  <span class="keywordflow">if</span> (axialDim == 0) {</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;    shiftDistance = boxLowAxial - yCloud-&gt;<a class="code" href="group__molSys.html#ga67ab89369cd26572878a91afd521ef81">pts</a>[atomIndex].x;</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;  } <span class="comment">// x coordinate</span></div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (axialDim == 1) {</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;    shiftDistance = boxLowAxial - yCloud-&gt;<a class="code" href="group__molSys.html#ga67ab89369cd26572878a91afd521ef81">pts</a>[atomIndex].y;</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;  } <span class="comment">// y coordinate</span></div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;  <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;    shiftDistance = boxLowAxial - yCloud-&gt;<a class="code" href="group__molSys.html#ga67ab89369cd26572878a91afd521ef81">pts</a>[atomIndex].z;</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;  } <span class="comment">// z coordinate</span></div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;  <span class="comment">// -----------------------------------</span></div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;  <span class="comment">// Shift all the particles</span></div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iatom = 0; iatom &lt; yCloud-&gt;<a class="code" href="group__molSys.html#ga2bdcb9260bd83f313a2d27fcc6437ef1">nop</a>; iatom++) {</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;    <span class="comment">// Shift the particles along the axial dimension only</span></div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;    <span class="keywordflow">if</span> (axialDim == 0) {</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;      yCloud-&gt;<a class="code" href="group__molSys.html#ga67ab89369cd26572878a91afd521ef81">pts</a>[iatom].x += shiftDistance;</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;      <span class="comment">// Wrap-around</span></div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;      <span class="keywordflow">if</span> (yCloud-&gt;<a class="code" href="group__molSys.html#ga67ab89369cd26572878a91afd521ef81">pts</a>[iatom].x &lt; boxLowAxial) {</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;        distFrmBoundary = boxLowAxial - yCloud-&gt;<a class="code" href="group__molSys.html#ga67ab89369cd26572878a91afd521ef81">pts</a>[iatom].x; <span class="comment">// positive value</span></div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;        yCloud-&gt;<a class="code" href="group__molSys.html#ga67ab89369cd26572878a91afd521ef81">pts</a>[iatom].x = boxHighAxial - distFrmBoundary;</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;      } <span class="comment">// end of wrap-around</span></div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;    }   <span class="comment">// x coordinate</span></div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (axialDim == 1) {</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;      yCloud-&gt;<a class="code" href="group__molSys.html#ga67ab89369cd26572878a91afd521ef81">pts</a>[iatom].y += shiftDistance;</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;      <span class="comment">// Wrap-around</span></div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;      <span class="keywordflow">if</span> (yCloud-&gt;<a class="code" href="group__molSys.html#ga67ab89369cd26572878a91afd521ef81">pts</a>[iatom].y &lt; boxLowAxial) {</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;        distFrmBoundary = boxLowAxial - yCloud-&gt;<a class="code" href="group__molSys.html#ga67ab89369cd26572878a91afd521ef81">pts</a>[iatom].y; <span class="comment">// positive value</span></div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;        yCloud-&gt;<a class="code" href="group__molSys.html#ga67ab89369cd26572878a91afd521ef81">pts</a>[iatom].y = boxHighAxial - distFrmBoundary;</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;      } <span class="comment">// end of wrap-around</span></div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;    }   <span class="comment">// y coordinate</span></div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;      yCloud-&gt;<a class="code" href="group__molSys.html#ga67ab89369cd26572878a91afd521ef81">pts</a>[iatom].z += shiftDistance;</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;      <span class="comment">// Wrap-around</span></div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;      <span class="keywordflow">if</span> (yCloud-&gt;<a class="code" href="group__molSys.html#ga67ab89369cd26572878a91afd521ef81">pts</a>[iatom].z &lt; boxLowAxial) {</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;        distFrmBoundary = boxLowAxial - yCloud-&gt;<a class="code" href="group__molSys.html#ga67ab89369cd26572878a91afd521ef81">pts</a>[iatom].z; <span class="comment">// positive value</span></div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;        yCloud-&gt;<a class="code" href="group__molSys.html#ga67ab89369cd26572878a91afd521ef81">pts</a>[iatom].z = boxHighAxial - distFrmBoundary;</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;      } <span class="comment">// end of wrap-around</span></div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;    }   <span class="comment">// z coordinate</span></div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;  }     <span class="comment">// end of shifting all paritcles downward</span></div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;  <span class="comment">// -----------------------------------</span></div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;  <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;} <span class="comment">// end of function</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="ga81dde14f79d13cb8e2c04a1e78ac11fb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga81dde14f79d13cb8e2c04a1e78ac11fb">&#9670;&nbsp;</a></span>setAtomsWithSameMolID()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void gen::setAtomsWithSameMolID </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmolSys_1_1PointCloud.html">molSys::PointCloud</a>&lt; <a class="el" href="structmolSys_1_1Point.html">molSys::Point</a>&lt; double &gt;, double &gt; *&#160;</td>
          <td class="paramname"><em>yCloud</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="elRef" href="http://en.cppreference.com/w/cpp/container/unordered_multimap.html">std::unordered_multimap</a>&lt; int, int &gt;&#160;</td>
          <td class="paramname"><em>molIDAtomIDmap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>molID</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>inSliceValue</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Given a particular molecule ID and a pointCloud set the inSlice bool for all atoms, with that molecule ID <br  />
</p>
<p>Function that loops through a given input PointCloud and sets the inSlice bool for every Point according to whether the molecule <br  />
 is in the specified (single) slice or not. If even one atom of a molecule is inside the region, then all atoms belonging to that molecule should be inside the slice as well (therefore, inSlice would be set to true) </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">yCloud</td><td>The given input PointCloud </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">clearPreviousSliceSelection</td><td>sets all inSlice bool values to false before adding Points to the slice </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">coordLow</td><td>Contains the lower limits of the slice, if a slice is to be created </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">coordHigh</td><td>Contains the upper limits of the slice, if a slice is to be created </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="selection_8cpp_source.html#l00225">225</a> of file <a class="el" href="selection_8cpp_source.html">selection.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;                                  {</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;  <span class="keywordtype">int</span> jatomID;    <span class="comment">// atom ID of the current jatom</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;  <span class="keywordtype">int</span> jatomIndex; <span class="comment">// index of jatom</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160; </div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;  <span class="comment">// Find all atoms with molID and set the inSlice bool to inSliceValue</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;  <span class="keyword">auto</span> range = molIDAtomIDmap.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/unordered_multimap/equal_range.html">equal_range</a>(molID); </div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160; </div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;  <span class="comment">// Loop through all atoms with molID</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> it = range.first; it != range.second; it++){</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    <span class="comment">// it-&gt;second gives the value (in this case, the atom ID)</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    jatomID = it-&gt;second; <span class="comment">// Atom ID with molecule ID equal to iatomMolID</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    <span class="keyword">auto</span> gotJ = yCloud-&gt;<a class="code" href="group__molSys.html#ga8e48a0ae066c2585e7320cdaa0cbc8db">idIndexMap</a>.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/unordered_map/find.html">find</a>(jatomID);</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    jatomIndex = gotJ-&gt;second;</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    <span class="comment">// Set the jatom inSlice bool to true</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    yCloud-&gt;<a class="code" href="group__molSys.html#ga67ab89369cd26572878a91afd521ef81">pts</a>[jatomIndex].inSlice = inSliceValue; <span class="comment">// jatomIndex is assigned inSliceValue</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;  } <span class="comment">// end of loop through all atoms with molID</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160; </div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;  <span class="comment">// IC(yCloud-&gt;pts[jatomIndex]);</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160; </div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;  <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ga4e415d1a523fd9e0d947ec76306ee5ff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga4e415d1a523fd9e0d947ec76306ee5ff">&#9670;&nbsp;</a></span>shapeMatchDDC()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int tum3::shapeMatchDDC </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmolSys_1_1PointCloud.html">molSys::PointCloud</a>&lt; <a class="el" href="structmolSys_1_1Point.html">molSys::Point</a>&lt; double &gt;, double &gt; *&#160;</td>
          <td class="paramname"><em>yCloud</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Eigen::MatrixXd &amp;&#160;</td>
          <td class="paramname"><em>refPoints</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; <a class="el" href="structcage_1_1Cage.html">cage::Cage</a> &gt;&#160;</td>
          <td class="paramname"><em>cageList</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>cageIndex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; <a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt;&gt;&#160;</td>
          <td class="paramname"><em>rings</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; double &gt; *&#160;</td>
          <td class="paramname"><em>quat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>rmsd</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Shape-matching for a target DDC. </p>
<p>Match the input cage with a perfect DDC. The quaternion for the rotation and the RMSD is outputted. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">refPoints</td><td>The point set of the reference system (or right system). This is a \( (n \times 3) \) Eigen matrix. Here, \( n \) is the number of particles. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">targetPoints</td><td>\( (n \times 3) \) Eigen matrix of the candidate/test system (or left system). </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">quat</td><td>The quaternion for the optimum rotation of the left system into the right system. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">scale</td><td>The scale factor obtained from Horn's algorithm. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="bulkTUM_8cpp_source.html#l00323">323</a> of file <a class="el" href="bulkTUM_8cpp_source.html">bulkTUM.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;                                           {</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a> ddcOrder;             <span class="comment">// Connectivity of the DDC</span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;  <span class="keywordtype">int</span> ringSize = 6;                      <span class="comment">// Each ring has 6 nodes</span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;  Eigen::MatrixXd targetPointSet(14, 3); <span class="comment">// Target point set (Eigen matrix)</span></div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;double&gt;</a> rmsdList; <span class="comment">// List of RMSD per atom</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;  <span class="comment">// Variables for looping through possible permutations</span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;double&gt;</a> currentQuat; <span class="comment">// quaternion rotation</span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;  <span class="keywordtype">double</span> currentRmsd;              <span class="comment">// least RMSD</span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;  <span class="keywordtype">double</span> currentScale;             <span class="comment">// scale</span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;  <span class="keywordtype">double</span> scale;                    <span class="comment">// Final scale</span></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;  <span class="keywordtype">int</span> index; <span class="comment">// Int for describing which permutation matches the best</span></div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160; </div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;  <span class="comment">// ----------------</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;  <span class="comment">// Save the order of the DDC in a vector</span></div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;  ddcOrder = <a class="code" href="namespacepntToPnt.html#a804eb495f58fd5868858cc46480c3425">pntToPnt::relOrderDDC</a>(cageIndex, rings, cageList);</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;  <span class="comment">// ----------------</span></div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;  <span class="comment">// Loop through all possible permutations</span></div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; ringSize; i++) {</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    <span class="comment">// Change the order of the target points somehow!</span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    targetPointSet = <a class="code" href="namespacepntToPnt.html#a2c4affea21bfc133f8c752d74f3a943a">pntToPnt::changeDiaCageOrder</a>(yCloud, ddcOrder, i);</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    <span class="comment">// Shape-matching</span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    <a class="code" href="namespaceabsor.html#ad4f0741af9784817b44df6883888d9a3">absor::hornAbsOrientation</a>(refPoints, targetPointSet, &amp;currentQuat,</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;                              &amp;currentRmsd, &amp;rmsdList, &amp;currentScale);</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    <span class="keywordflow">if</span> (i == 0) {</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;      *quat = currentQuat;</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;      *rmsd = currentRmsd;</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;      scale = currentScale;</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;      index = 0;</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;      <span class="keywordflow">if</span> (currentRmsd &lt; *rmsd) {</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;        *quat = currentQuat;</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;        *rmsd = currentRmsd;</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;        scale = currentScale;</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;        index = i;</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;      } <span class="comment">// update</span></div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    }   <span class="comment">// Update if this is a better match</span></div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;  }     <span class="comment">// Loop through possible permutations</span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;  <span class="comment">// ----------------</span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;  <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;}</div>
<div class="ttc" id="anamespaceabsor_html_ad4f0741af9784817b44df6883888d9a3"><div class="ttname"><a href="namespaceabsor.html#ad4f0741af9784817b44df6883888d9a3">absor::hornAbsOrientation</a></div><div class="ttdeci">int hornAbsOrientation(const Eigen::MatrixXd &amp;refPoints, const Eigen::MatrixXd &amp;targetPoints, std::vector&lt; double &gt; *quat, double *rmsd, std::vector&lt; double &gt; *rmsdList, double *scale)</div><div class="ttdoc">Get the absolute orientation using Horn's algorithm (with quaternions)</div><div class="ttdef"><b>Definition:</b> <a href="absOrientation_8cpp_source.html#l00030">absOrientation.cpp:30</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ga05cfdd8cbd1785d44ee6787cb987cbd7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga05cfdd8cbd1785d44ee6787cb987cbd7">&#9670;&nbsp;</a></span>shapeMatchHC()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int tum3::shapeMatchHC </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmolSys_1_1PointCloud.html">molSys::PointCloud</a>&lt; <a class="el" href="structmolSys_1_1Point.html">molSys::Point</a>&lt; double &gt;, double &gt; *&#160;</td>
          <td class="paramname"><em>yCloud</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Eigen::MatrixXd &amp;&#160;</td>
          <td class="paramname"><em>refPoints</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structcage_1_1Cage.html">cage::Cage</a>&#160;</td>
          <td class="paramname"><em>cageUnit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; <a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt;&gt;&#160;</td>
          <td class="paramname"><em>rings</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; <a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt;&gt;&#160;</td>
          <td class="paramname"><em>nList</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; double &gt; *&#160;</td>
          <td class="paramname"><em>quat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>rmsd</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Shape-matching for a target HC. </p>
<p>Match the input cage with a perfect HC. The quaternion for the rotation and the RMSD is outputted. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">refPoints</td><td>The point set of the reference system (or right system). This is a \( (n \times 3) \) Eigen matrix. Here, \( n \) is the number of particles. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">targetPoints</td><td>\( (n \times 3) \) Eigen matrix of the candidate/test system (or left system). </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">quat</td><td>The quaternion for the optimum rotation of the left system into the right system. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">scale</td><td>The scale factor obtained from Horn's algorithm. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="bulkTUM_8cpp_source.html#l00251">251</a> of file <a class="el" href="bulkTUM_8cpp_source.html">bulkTUM.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;                                           {</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;  <span class="keywordtype">int</span> iring,</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;      jring; <span class="comment">// Indices in the ring vector of vectors for the basal rings</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a> basal1,</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;      basal2;       <span class="comment">// Re-ordered basal rings matched to each other</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;  <span class="keywordtype">int</span> ringSize = 6; <span class="comment">// Each ring has 6 nodes</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;  Eigen::MatrixXd targetPointSet(12, 3); <span class="comment">// Target point set (Eigen matrix)</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;double&gt;</a> rmsdList; <span class="comment">// List of RMSD per atom</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;  <span class="comment">// Variables for looping through possible permutations</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;double&gt;</a> currentQuat; <span class="comment">// quaternion rotation</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;  <span class="keywordtype">double</span> currentRmsd;              <span class="comment">// least RMSD</span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;  <span class="keywordtype">double</span> currentScale;             <span class="comment">// scale</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;  <span class="keywordtype">double</span> scale;                    <span class="comment">// Final scale</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;  <span class="keywordtype">int</span> index; <span class="comment">// Int for describing which permutation matches the best</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160; </div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;  <span class="comment">// Init</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;  iring = cageUnit.<a class="code" href="group__cage.html#ga5b4c006e8de944ce67f924190123f178">rings</a>[0];    <span class="comment">// Index of basal1</span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;  jring = cageUnit.<a class="code" href="group__cage.html#ga5b4c006e8de944ce67f924190123f178">rings</a>[1];    <span class="comment">// Index of basal2</span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;  rmsdList.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/resize.html">resize</a>(yCloud-&gt;<a class="code" href="group__molSys.html#ga2bdcb9260bd83f313a2d27fcc6437ef1">nop</a>); <span class="comment">// Not actually updated here</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;  <span class="comment">// ----------------</span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;  <span class="comment">// Re-order the basal rings so that they are matched</span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;  <a class="code" href="namespacepntToPnt.html#a8140eb2ad1dfb9d08e4e917dd14d5424">pntToPnt::relOrderHC</a>(yCloud, rings[iring], rings[jring], nList, &amp;basal1,</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;                       &amp;basal2);</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;  <span class="comment">// ----------------</span></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;  <span class="comment">// Loop through all possible permutations</span></div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; ringSize; i++) {</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    <span class="comment">// Change the order of the target points somehow!</span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    targetPointSet = <a class="code" href="namespacepntToPnt.html#a896e8ed3ac4436156eac99b12e12c255">pntToPnt::changeHexCageOrder</a>(yCloud, basal1, basal2, i);</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    <span class="comment">// Shape-matching</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    <a class="code" href="namespaceabsor.html#ad4f0741af9784817b44df6883888d9a3">absor::hornAbsOrientation</a>(refPoints, targetPointSet, &amp;currentQuat,</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;                              &amp;currentRmsd, &amp;rmsdList, &amp;currentScale);</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    <span class="keywordflow">if</span> (i == 0) {</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;      *quat = currentQuat;</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;      *rmsd = currentRmsd;</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;      scale = currentScale;</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;      index = 0;</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;      <span class="keywordflow">if</span> (currentRmsd &lt; *rmsd) {</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;        *quat = currentQuat;</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;        *rmsd = currentRmsd;</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;        scale = currentScale;</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;        index = i;</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;      } <span class="comment">// update</span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    }   <span class="comment">// Update if this is a better match</span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;  }     <span class="comment">// Loop through possible permutations</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;  <span class="comment">// ----------------</span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;  <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;}</div>
<div class="ttc" id="agroup__cage_html_ga5b4c006e8de944ce67f924190123f178"><div class="ttname"><a href="group__cage.html#ga5b4c006e8de944ce67f924190123f178">cage::Cage::rings</a></div><div class="ttdeci">std::vector&lt; int &gt; rings</div><div class="ttdoc">type of the cage : can be DDC or HC</div><div class="ttdef"><b>Definition:</b> <a href="cage_8hpp_source.html#l00088">cage.hpp:88</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="gabad4c396b9a976a7a2199fdfeab143e7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gabad4c396b9a976a7a2199fdfeab143e7">&#9670;&nbsp;</a></span>topoBulkCriteria()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; <a class="el" href="structcage_1_1Cage.html">cage::Cage</a> &gt; tum3::topoBulkCriteria </td>
          <td>(</td>
          <td class="paramtype"><a class="elRef" href="http://en.cppreference.com/w/cpp/string/basic_string.html">std::string</a>&#160;</td>
          <td class="paramname"><em>path</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; <a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt;&gt;&#160;</td>
          <td class="paramname"><em>rings</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; <a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt;&gt;&#160;</td>
          <td class="paramname"><em>nList</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmolSys_1_1PointCloud.html">molSys::PointCloud</a>&lt; <a class="el" href="structmolSys_1_1Point.html">molSys::Point</a>&lt; double &gt;, double &gt; *&#160;</td>
          <td class="paramname"><em>yCloud</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>firstFrame</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>numHC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>numDDC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; <a class="el" href="group__ring.html#ga301cfdc88452cfe51bd4f745d223a7e1">ring::strucType</a> &gt; *&#160;</td>
          <td class="paramname"><em>ringType</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Topological network methods Finds the HCs and DDCs for the system</p>
<p>Finds out if rings constitute double-diamond cages or hexagonal cages. Requires a neighbour list (by index) and a vector of vectors of primitive rings which should also be by index. This is only for rings of size 6! Internally, this function calls the following functions:</p><ul>
<li><a class="el" href="group__ring.html#gae9254c83de03fcf18b4cb5dcb2625011" title="Returns a vector of vectors of rings of a single size.">ring::getSingleRingSize</a> (Saves rings of a single ring size into a new vector of vectors, which is subsequently used for finding DDCs, HCs etc).</li>
<li><a class="el" href="group__prism3.html#ga35816c398a355ca472fddeb2869fce15">ring::findDDC</a> (Finds the DDCs).</li>
<li><a class="el" href="group__prism3.html#gaf6c8e26a55c976c7ae810914bd1c7362">ring::findHC</a> (Finds the HCs).</li>
<li><a class="el" href="group__prism3.html#gadb3c8127d84cb2e90aafff55419f2c85">ring::findMixedRings</a> (Finds the mixed rings, which are shared by DDCs and HCs both).</li>
<li><a class="el" href="group__prism3.html#ga6fcfac293a750bd14cbf1f94ab2a3976" title="Determines the number of HCs, DDCs, Mixed rings, prismatic and basal rings.">ring::getStrucNumbers</a> (Gets the number of structures (DDCs, HCs, mixed rings, basal rings, prismatic rings, to be used for write-outs).</li>
<li><a class="el" href="namespacesout.html#a5ca5eeff9edc702cdcf1b26e8501dc0c">sout::writeTopoBulkData</a> (Writes out the numbers and data obtained for the current frame).</li>
<li><a class="el" href="group__prism3.html#ga584708a1ea3d1503d7f38f0904b7f5f1">ring::getAtomTypesTopoBulk</a> (Gets the atom type for every atom, to be used for printing out the ice types found).</li>
<li><a class="el" href="namespacesout.html#aabeb7b712f568256cf3ed782fa91c518">sout::writeLAMMPSdataTopoBulk</a> (Writes out the atoms, with the classified types, into a LAMMPS data file, which can be visualized in OVITO). <dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">path</td><td>The file path of the output directory to which output files will be written. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rings</td><td>Vector of vectors containing the primitive rings. This should contain rings of only size 6. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nList</td><td>Row-ordered neighbour list, by index. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">yCloud</td><td>The input PointCloud, with respect to which the indices in the rings and nList vector of vectors have been saved. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">firstFrame</td><td>First frame to be analyzed </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">onlyTetrahedral</td><td>Flag for only finding DDCs and HCs (true) or also finding PNCs (false) </td></tr>
  </table>
  </dd>
</dl>
</li>
</ul>

<p class="definition">Definition at line <a class="el" href="bulkTUM_8cpp_source.html#l00581">581</a> of file <a class="el" href="bulkTUM_8cpp_source.html">bulkTUM.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;                                                                 {</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;  <span class="comment">// Ring IDs of each type will be saved in these vectors</span></div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a> listDDC; <span class="comment">// Vector for ring indices of DDC</span></div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a> listHC;  <span class="comment">// Vector for ring indices of HC</span></div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a></div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;      listMixed; <span class="comment">// Vector for ring indices of rings that are both DDC and HC</span></div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;                 <span class="comment">// ringList, of type enum strucType in gen.hpp</span></div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;  <span class="comment">// Make a list of all the DDCs and HCs</span></div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;cage::Cage&gt;</a> cageList;</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;  <span class="comment">// Number of types</span></div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;  <span class="keywordtype">int</span> mixedRings, prismaticRings, basalRings;</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160; </div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;  <span class="comment">// ----------------------------------------------</span></div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;  <span class="comment">// Init</span></div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;  *numHC = 0;  <span class="comment">// Number of hexagonal cages</span></div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;  *numDDC = 0; <span class="comment">// Init the number of DDCs</span></div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;  <span class="comment">// Quit the function for zero rings</span></div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;  <span class="keywordflow">if</span> (rings.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/size.html">size</a>() == 0) {</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;    <span class="keywordflow">return</span> cageList;</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;  } <span class="comment">// skip for no rings of ringSize</span></div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;  <span class="comment">// Init the ringType vector</span></div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;  (*ringType).<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/resize.html">resize</a>(rings.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/size.html">size</a>()); <span class="comment">// Has a value for each ring. init to zero.</span></div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;  <span class="comment">// ----------------------------------------------</span></div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;  <span class="comment">// Get the cages</span></div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160; </div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;  <span class="comment">// Find HC rings, saving the ring IDs (starting from 0) to listHC</span></div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;  listHC = <a class="code" href="group__prism3.html#gaf6c8e26a55c976c7ae810914bd1c7362">ring::findHC</a>(rings, ringType, nList, &amp;cageList);</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160; </div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;  <span class="comment">// Find DDC rings, saving the IDs to listDDC</span></div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;  listDDC = <a class="code" href="group__prism3.html#ga35816c398a355ca472fddeb2869fce15">ring::findDDC</a>(rings, ringType, listHC, &amp;cageList);</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160; </div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;  <span class="comment">// Find rings which are both DDCs and HCs (mixed)</span></div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;  <span class="comment">// A dummy value of -10 in the listDDC and listHC vectors for mixed rings</span></div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;  listMixed = <a class="code" href="group__prism3.html#gadb3c8127d84cb2e90aafff55419f2c85">ring::findMixedRings</a>(rings, ringType, &amp;listDDC, &amp;listHC);</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160; </div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;  <span class="comment">// Get the number of structures (DDCs, HCs, mixed rings, basal rings,</span></div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;  <span class="comment">// prismatic rings)</span></div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;  <a class="code" href="group__prism3.html#ga6fcfac293a750bd14cbf1f94ab2a3976">ring::getStrucNumbers</a>(*ringType, cageList, numHC, numDDC, &amp;mixedRings,</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;                        &amp;prismaticRings, &amp;basalRings);</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160; </div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;  <span class="comment">// Write out to a file</span></div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;  <a class="code" href="namespacesout.html#a5ca5eeff9edc702cdcf1b26e8501dc0c">sout::writeTopoBulkData</a>(path, yCloud-&gt;<a class="code" href="group__molSys.html#gafccb5a0daab40c3ccc83e4494f4176d7">currentFrame</a>, *numHC, *numDDC,</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;                          mixedRings, basalRings, prismaticRings, firstFrame);</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160; </div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;  <span class="keywordflow">return</span> cageList;</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;}</div>
<div class="ttc" id="agroup__prism3_html_ga6fcfac293a750bd14cbf1f94ab2a3976"><div class="ttname"><a href="group__prism3.html#ga6fcfac293a750bd14cbf1f94ab2a3976">ring::getStrucNumbers</a></div><div class="ttdeci">int getStrucNumbers(std::vector&lt; ring::strucType &gt; ringType, std::vector&lt; cage::Cage &gt; cageList, int *numHC, int *numDDC, int *mixedRings, int *prismaticRings, int *basalRings)</div><div class="ttdoc">Determines the number of HCs, DDCs, Mixed rings, prismatic and basal rings.</div><div class="ttdef"><b>Definition:</b> <a href="topo__bulk_8cpp_source.html#l01247">topo_bulk.cpp:1247</a></div></div>
<div class="ttc" id="agroup__prism3_html_gadb3c8127d84cb2e90aafff55419f2c85"><div class="ttname"><a href="group__prism3.html#gadb3c8127d84cb2e90aafff55419f2c85">ring::findMixedRings</a></div><div class="ttdeci">std::vector&lt; int &gt; findMixedRings(std::vector&lt; std::vector&lt; int &gt;&gt; rings, std::vector&lt; strucType &gt; *ringType, std::vector&lt; int &gt; *listDDC, std::vector&lt; int &gt; *listHC)</div><div class="ttdef"><b>Definition:</b> <a href="topo__bulk_8cpp_source.html#l01117">topo_bulk.cpp:1117</a></div></div>
<div class="ttc" id="anamespacesout_html_a5ca5eeff9edc702cdcf1b26e8501dc0c"><div class="ttname"><a href="namespacesout.html#a5ca5eeff9edc702cdcf1b26e8501dc0c">sout::writeTopoBulkData</a></div><div class="ttdeci">int writeTopoBulkData(std::string path, int currentFrame, int numHC, int numDDC, int mixedRings, int basalRings, int prismaticRings, int firstFrame)</div><div class="ttdef"><b>Definition:</b> <a href="seams__output_8cpp_source.html#l01251">seams_output.cpp:1251</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ga4e4a17533b574451c585e3c839c6622a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga4e4a17533b574451c585e3c839c6622a">&#9670;&nbsp;</a></span>topoUnitMatchingBulk()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int tum3::topoUnitMatchingBulk </td>
          <td>(</td>
          <td class="paramtype"><a class="elRef" href="http://en.cppreference.com/w/cpp/string/basic_string.html">std::string</a>&#160;</td>
          <td class="paramname"><em>path</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; <a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt;&gt;&#160;</td>
          <td class="paramname"><em>rings</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; <a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt;&gt;&#160;</td>
          <td class="paramname"><em>nList</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmolSys_1_1PointCloud.html">molSys::PointCloud</a>&lt; <a class="el" href="structmolSys_1_1Point.html">molSys::Point</a>&lt; double &gt;, double &gt; *&#160;</td>
          <td class="paramname"><em>yCloud</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>firstFrame</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>printClusters</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>onlyTetrahedral</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Topological unit matching for bulk water. If printClusters is true, individual clusters of connected cages are printed.</p>
<p>Finds out if rings constitute double-diamond cages or hexagonal cages. Requires a neighbour list (by index) and a vector of vectors of primitive rings which should also be by index. This is registered as a Lua function and is accessible to the user. Internally, this function calls the following functions:</p><ul>
<li><a class="el" href="group__ring.html#gae9254c83de03fcf18b4cb5dcb2625011" title="Returns a vector of vectors of rings of a single size.">ring::getSingleRingSize</a> (Saves rings of a single ring size into a new vector of vectors, which is subsequently used for finding DDCs, HCs etc).</li>
<li><a class="el" href="group__prism3.html#ga35816c398a355ca472fddeb2869fce15">ring::findDDC</a> (Finds the DDCs).</li>
<li><a class="el" href="group__prism3.html#gaf6c8e26a55c976c7ae810914bd1c7362">ring::findHC</a> (Finds the HCs).</li>
<li><a class="el" href="group__prism3.html#gadb3c8127d84cb2e90aafff55419f2c85">ring::findMixedRings</a> (Finds the mixed rings, which are shared by DDCs and HCs both).</li>
<li><a class="el" href="group__prism3.html#ga6fcfac293a750bd14cbf1f94ab2a3976" title="Determines the number of HCs, DDCs, Mixed rings, prismatic and basal rings.">ring::getStrucNumbers</a> (Gets the number of structures (DDCs, HCs, mixed rings, basal rings, prismatic rings, to be used for write-outs).</li>
<li><a class="el" href="namespacesout.html#a5ca5eeff9edc702cdcf1b26e8501dc0c">sout::writeTopoBulkData</a> (Writes out the numbers and data obtained for the current frame).</li>
<li><a class="el" href="group__prism3.html#ga584708a1ea3d1503d7f38f0904b7f5f1">ring::getAtomTypesTopoBulk</a> (Gets the atom type for every atom, to be used for printing out the ice types found).</li>
<li><a class="el" href="namespacesout.html#aabeb7b712f568256cf3ed782fa91c518">sout::writeLAMMPSdataTopoBulk</a> (Writes out the atoms, with the classified types, into a LAMMPS data file, which can be visualized in OVITO). <dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">path</td><td>The file path of the output directory to which output files will be written. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rings</td><td>Vector of vectors containing the primitive rings. This contains rings of all sizes. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nList</td><td>Row-ordered neighbour list, by index. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">yCloud</td><td>The input PointCloud, with respect to which the indices in the rings and nList vector of vectors have been saved. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">firstFrame</td><td>First frame to be analyzed </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">onlyTetrahedral</td><td>Flag for only finding DDCs and HCs (true) or also finding PNCs (false) </td></tr>
  </table>
  </dd>
</dl>
</li>
</ul>

<p class="definition">Definition at line <a class="el" href="bulkTUM_8cpp_source.html#l00052">52</a> of file <a class="el" href="bulkTUM_8cpp_source.html">bulkTUM.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;                                              {</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;  <span class="comment">// The input rings vector has rings of all sizes</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160; </div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  <span class="comment">// ringType has a value for rings of a particular size</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;ring::strucType&gt;</a></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;      ringType; <span class="comment">// This vector will have a value for each ring inside</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;                <span class="comment">// ringList, of type enum strucType in gen.hpp</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;  <span class="comment">// Make a list of all the DDCs and HCs</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;cage::Cage&gt;</a> cageList;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;std::vector&lt;int&gt;</a>&gt;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;      ringsOneType;    <span class="comment">// Vector of vectors of rings of a single size</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;  <span class="keywordtype">int</span> initRingSize;    <span class="comment">// Todo or not: calculate the PNCs or not</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  <span class="keywordtype">int</span> maxRingSize = 6; <span class="comment">// DDCs and HCs are for 6-membered rings</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;cage::iceType&gt;</a></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;      atomTypes; <span class="comment">// This vector will have a value for every atom</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  <span class="comment">// Number of types</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;  <span class="keywordtype">int</span> numHC, numDDC, mixedRings, prismaticRings, basalRings;</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  <span class="comment">// Shape-matching variables ----</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  <span class="keywordtype">double</span> rmsd;              <span class="comment">// RMSD value for a particular cage type</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;double&gt;</a> quat; <span class="comment">// Quaternion obtained from shape-matching</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;std::vector&lt;double&gt;</a>&gt; quatList; <span class="comment">// List of quaternions</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  <span class="comment">// Reference points</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;  Eigen::MatrixXd refPntsDDC(14,</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;                             3); <span class="comment">// Reference point set (Eigen matrix) for a DDC</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;  Eigen::MatrixXd refPntsHC(12,</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;                            3); <span class="comment">// Reference point set (Eigen matrix) for a DDC</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160; </div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;  <span class="comment">// Vector for the RMSD per atom and the RMSD per ring:</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;double&gt;</a> rmsdPerAtom;</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;      noOfCommonElements; <span class="comment">// An atom can belong to more than one ring or shape</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160; </div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  <span class="keywordflow">if</span> (onlyTetrahedral) {</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    initRingSize = 6;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    initRingSize = 5;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  }</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160; </div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  <span class="comment">// Init the atom type vector</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  atomTypes.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/resize.html">resize</a>(yCloud-&gt;<a class="code" href="group__molSys.html#ga2bdcb9260bd83f313a2d27fcc6437ef1">nop</a>); <span class="comment">// Has a value for each atom</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  <span class="comment">// Init the rmsd per atom</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  rmsdPerAtom.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/resize.html">resize</a>(yCloud-&gt;<a class="code" href="group__molSys.html#ga2bdcb9260bd83f313a2d27fcc6437ef1">nop</a>, -1);    <span class="comment">// Has a value for each atom</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  noOfCommonElements.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/resize.html">resize</a>(yCloud-&gt;<a class="code" href="group__molSys.html#ga2bdcb9260bd83f313a2d27fcc6437ef1">nop</a>); <span class="comment">// Has a value for each atom</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160; </div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  <span class="comment">// ----------------------------------------------</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  <span class="comment">// Init</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  <span class="comment">// Get rings of size 5 or 6.</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ringSize = initRingSize; ringSize &lt;= maxRingSize; ringSize++) {</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <span class="comment">// Clear ringsOneType</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <a class="code" href="group__ring.html#ga76f3cb7aa8a713aeafecdf3a6fffee31">ring::clearRingList</a>(ringsOneType);</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    <span class="comment">// Get rings of the current ring size</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    ringsOneType = <a class="code" href="group__ring.html#gae9254c83de03fcf18b4cb5dcb2625011">ring::getSingleRingSize</a>(rings, ringSize);</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    <span class="comment">// Skip for zero rings</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    <span class="keywordflow">if</span> (ringsOneType.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/size.html">size</a>() == 0) {</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    } <span class="comment">// skip for no rings of ringSize</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    <span class="comment">// Init the ringType vector</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    ringType.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/resize.html">resize</a>(</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;        ringsOneType.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/size.html">size</a>()); <span class="comment">// Has a value for each ring. init to zero.</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    <span class="comment">// ----------------------------------------------</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    <span class="keywordflow">if</span> (ringSize == 6) {</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;      <span class="comment">// Get the cages</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160; </div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;      <span class="comment">// Find the DDCs and HCs</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;      cageList = <a class="code" href="group__ring.html#gabad4c396b9a976a7a2199fdfeab143e7">tum3::topoBulkCriteria</a>(path, ringsOneType, nList, yCloud,</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;                                        firstFrame, &amp;numHC, &amp;numDDC, &amp;ringType);</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160; </div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;      <span class="comment">// Gets the atom type for every atom, to be used for printing out the ice</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;      <span class="comment">// types found</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;      <a class="code" href="group__prism3.html#ga584708a1ea3d1503d7f38f0904b7f5f1">ring::getAtomTypesTopoBulk</a>(ringsOneType, ringType, &amp;atomTypes);</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    }</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <span class="comment">// Finding the 5-membered prismatic blocks</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;      <span class="comment">// Get the prism block classifications</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;      <a class="code" href="group__prism3.html#gacb2bc68638bd794af38bcd503e17be0f">prism3::findBulkPrisms</a>(ringsOneType, &amp;ringType, nList, yCloud,</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;                             &amp;rmsdPerAtom);</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;      <span class="comment">// Gets the atom type for every atom, to be used for printing out the ice</span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;      <span class="comment">// types found</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;      <a class="code" href="group__prism3.html#ga584708a1ea3d1503d7f38f0904b7f5f1">ring::getAtomTypesTopoBulk</a>(ringsOneType, ringType, &amp;atomTypes);</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    }</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;  }</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160; </div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;  <span class="comment">// --------------------------------------------------</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  <span class="comment">// SHAPE-MATCHING</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;  <span class="comment">// Get the reference point sets</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/string/basic_string.html">std::string</a> filePathHC = <span class="stringliteral">&quot;templates/hc.xyz&quot;</span>;</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/string/basic_string.html">std::string</a> filePathDDC = <span class="stringliteral">&quot;templates/ddc.xyz&quot;</span>;</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;  refPntsHC = <a class="code" href="group__ring.html#ga0a321aab8c8956e0885826b65e550a1d">tum3::buildRefHC</a>(filePathHC);    <span class="comment">// HC</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;  refPntsDDC = <a class="code" href="group__ring.html#gabf66bd35cdbccfd8fee51564dc889977">tum3::buildRefDDC</a>(filePathDDC); <span class="comment">// DDC</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;  <span class="comment">// Init</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;  <span class="comment">// Loop through all the atoms and set commonElements to 1 for PNC atoms</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; yCloud-&gt;<a class="code" href="group__molSys.html#ga2bdcb9260bd83f313a2d27fcc6437ef1">nop</a>; i++) {</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <span class="keywordflow">if</span> (rmsdPerAtom[i] != -1) {</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;      noOfCommonElements[i] = 1;</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    } <span class="comment">// for atoms which have been updated</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  }   <span class="comment">// end of updating commonElements</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;  <span class="comment">// Loop through the entire cageList vector of cages to match the HCs and DDCs</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;  <span class="comment">// HCs are first, followed by DDCs.</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;  <span class="comment">// Go through all the HCs</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> icage = 0; icage &lt; numHC; icage++) {</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    <span class="comment">// Match against a perfect HC</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    <a class="code" href="group__ring.html#ga05cfdd8cbd1785d44ee6787cb987cbd7">tum3::shapeMatchHC</a>(yCloud, refPntsHC, cageList[icage], ringsOneType, nList,</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;                       &amp;quat, &amp;rmsd);</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <span class="comment">// Update the vector of quaternions</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    quatList.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/push_back.html">push_back</a>(quat);</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    <span class="comment">// Update the RMSD per ring</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    <a class="code" href="group__ring.html#ga8c3edb4cf0aab398434a883122135c18">tum3::updateRMSDatom</a>(ringsOneType, cageList[icage], rmsd, &amp;rmsdPerAtom,</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;                         &amp;noOfCommonElements, atomTypes);</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;  } <span class="comment">// end of looping through all HCs</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  <span class="comment">// --------------------------------------------------</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;  <span class="comment">// Go through all the DDCs</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> icage = numHC; icage &lt; cageList.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/size.html">size</a>(); icage++) {</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <span class="comment">// Match against a perfect DDC</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    <a class="code" href="group__ring.html#ga4e415d1a523fd9e0d947ec76306ee5ff">tum3::shapeMatchDDC</a>(yCloud, refPntsDDC, cageList, icage, ringsOneType,</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;                        &amp;quat, &amp;rmsd);</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <span class="comment">// Update the vector of quaternions</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    quatList.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/push_back.html">push_back</a>(quat);</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    <span class="comment">// Update the RMSD per ring</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <a class="code" href="group__ring.html#ga8c3edb4cf0aab398434a883122135c18">tum3::updateRMSDatom</a>(ringsOneType, cageList[icage], rmsd, &amp;rmsdPerAtom,</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;                         &amp;noOfCommonElements, atomTypes);</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;  } <span class="comment">// end of looping through all HCs</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160; </div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;  <span class="comment">// --------------------------------------------------</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;  <span class="comment">// Getting the RMSD per atom</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;  <span class="comment">// Average the RMSD per atom</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;  <a class="code" href="group__ring.html#ga390a8ecb9b86c18c3802fcbdcf37cd83">tum3::averageRMSDatom</a>(&amp;rmsdPerAtom, &amp;noOfCommonElements);</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;  <span class="comment">// --------------------------------------------------</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160; </div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;  <span class="comment">// Print out the lammps data file with the bonds and types</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;  <a class="code" href="namespacesout.html#aabeb7b712f568256cf3ed782fa91c518">sout::writeLAMMPSdataTopoBulk</a>(yCloud, nList, atomTypes, path);</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;  <span class="comment">// To output the bonds between dummy atoms, uncomment the following line</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;  <span class="comment">// sout::writeLAMMPSdataTopoBulk(yCloud, nList, atomTypes, path, true);</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160; </div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;  <span class="comment">// --------------------------------------------------</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;  <span class="comment">// Writes out the dumpfile</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a> dumpAtomTypes; <span class="comment">// Must be typecast to int</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;  dumpAtomTypes.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/resize.html">resize</a>(atomTypes.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/size.html">size</a>());</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;  <span class="comment">// Change from enum to int</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; atomTypes.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/size.html">size</a>(); i++) {</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    <span class="keywordflow">if</span> (atomTypes[i] == <a class="code" href="group__cage.html#ggaaac41828990e32b9d6e7db4426b61529abf805fba4c226956825175c4514f14ce">cage::hc</a>) {</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;      dumpAtomTypes[i] = 1;</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    } <span class="comment">// HC</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (atomTypes[i] == <a class="code" href="group__cage.html#ggaaac41828990e32b9d6e7db4426b61529a508c36a9ffc7ba85f325a253be11312f">cage::ddc</a>) {</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;      dumpAtomTypes[i] = 2;</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    } <span class="comment">// DDC</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (atomTypes[i] == <a class="code" href="group__cage.html#ggaaac41828990e32b9d6e7db4426b61529a8da31aa983c518632b4a522086415492">cage::mixed</a>) {</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;      dumpAtomTypes[i] = 3;</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    } <span class="comment">// mixed rings</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (atomTypes[i] == <a class="code" href="group__cage.html#ggaaac41828990e32b9d6e7db4426b61529a3eae6b3c7c54d5cecb3d82d838cc6d60">cage::pnc</a>) {</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;      dumpAtomTypes[i] = 4;</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    } <span class="comment">// pnc</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (atomTypes[i] == <a class="code" href="group__cage.html#ggaaac41828990e32b9d6e7db4426b61529acbad0158a8f2811fd4136831fa2b3072">cage::mixed2</a>) {</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;      dumpAtomTypes[i] = 5;</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    } <span class="comment">// shared by pnc and ddc/hc</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;      dumpAtomTypes[i] = 0;</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    } <span class="comment">// dummy atoms</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;  }   <span class="comment">// end of changing the type to int</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;  <a class="code" href="namespacesout.html#ad297dfa82170796cedea7f111e7694df">sout::writeLAMMPSdumpCages</a>(yCloud, rmsdPerAtom, dumpAtomTypes, path,</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;                             firstFrame);</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;  <span class="comment">// --------------------------------------------------</span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;  <span class="comment">// PRINT THE CLUSTERS</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;  <span class="keywordflow">if</span> (printClusters) {</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    <span class="comment">// Print the clusters</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    <a class="code" href="group__ring.html#ga34dea1971104b5adb318178730ffc40d">tum3::clusterCages</a>(yCloud, path, ringsOneType, cageList, numHC, numDDC);</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;  } <span class="comment">// end of printing individual clusters</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;  <span class="comment">// --------------------------------------------------</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;  <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;}</div>
<div class="ttc" id="agroup__cage_html_ggaaac41828990e32b9d6e7db4426b61529a3eae6b3c7c54d5cecb3d82d838cc6d60"><div class="ttname"><a href="group__cage.html#ggaaac41828990e32b9d6e7db4426b61529a3eae6b3c7c54d5cecb3d82d838cc6d60">cage::pnc</a></div><div class="ttdeci">@ pnc</div><div class="ttdef"><b>Definition:</b> <a href="cage_8hpp_source.html#l00075">cage.hpp:75</a></div></div>
<div class="ttc" id="agroup__cage_html_ggaaac41828990e32b9d6e7db4426b61529a508c36a9ffc7ba85f325a253be11312f"><div class="ttname"><a href="group__cage.html#ggaaac41828990e32b9d6e7db4426b61529a508c36a9ffc7ba85f325a253be11312f">cage::ddc</a></div><div class="ttdeci">@ ddc</div><div class="ttdef"><b>Definition:</b> <a href="cage_8hpp_source.html#l00075">cage.hpp:75</a></div></div>
<div class="ttc" id="agroup__cage_html_ggaaac41828990e32b9d6e7db4426b61529a8da31aa983c518632b4a522086415492"><div class="ttname"><a href="group__cage.html#ggaaac41828990e32b9d6e7db4426b61529a8da31aa983c518632b4a522086415492">cage::mixed</a></div><div class="ttdeci">@ mixed</div><div class="ttdef"><b>Definition:</b> <a href="cage_8hpp_source.html#l00075">cage.hpp:75</a></div></div>
<div class="ttc" id="agroup__cage_html_ggaaac41828990e32b9d6e7db4426b61529abf805fba4c226956825175c4514f14ce"><div class="ttname"><a href="group__cage.html#ggaaac41828990e32b9d6e7db4426b61529abf805fba4c226956825175c4514f14ce">cage::hc</a></div><div class="ttdeci">@ hc</div><div class="ttdef"><b>Definition:</b> <a href="cage_8hpp_source.html#l00075">cage.hpp:75</a></div></div>
<div class="ttc" id="agroup__cage_html_ggaaac41828990e32b9d6e7db4426b61529acbad0158a8f2811fd4136831fa2b3072"><div class="ttname"><a href="group__cage.html#ggaaac41828990e32b9d6e7db4426b61529acbad0158a8f2811fd4136831fa2b3072">cage::mixed2</a></div><div class="ttdeci">@ mixed2</div><div class="ttdef"><b>Definition:</b> <a href="cage_8hpp_source.html#l00075">cage.hpp:75</a></div></div>
<div class="ttc" id="agroup__prism3_html_ga584708a1ea3d1503d7f38f0904b7f5f1"><div class="ttname"><a href="group__prism3.html#ga584708a1ea3d1503d7f38f0904b7f5f1">ring::getAtomTypesTopoBulk</a></div><div class="ttdeci">int getAtomTypesTopoBulk(std::vector&lt; std::vector&lt; int &gt;&gt; rings, std::vector&lt; ring::strucType &gt; ringType, std::vector&lt; cage::iceType &gt; *atomTypes)</div><div class="ttdef"><b>Definition:</b> <a href="topo__bulk_8cpp_source.html#l01164">topo_bulk.cpp:1164</a></div></div>
<div class="ttc" id="agroup__prism3_html_gacb2bc68638bd794af38bcd503e17be0f"><div class="ttname"><a href="group__prism3.html#gacb2bc68638bd794af38bcd503e17be0f">prism3::findBulkPrisms</a></div><div class="ttdeci">int findBulkPrisms(std::vector&lt; std::vector&lt; int &gt;&gt; rings, std::vector&lt; ring::strucType &gt; *ringType, std::vector&lt; std::vector&lt; int &gt;&gt; nList, molSys::PointCloud&lt; molSys::Point&lt; double &gt;, double &gt; *yCloud, std::vector&lt; double &gt; *rmsdPerAtom, double heightCutoff=8)</div><div class="ttdoc">Find out which rings are prisms.</div><div class="ttdef"><b>Definition:</b> <a href="topo__bulk_8cpp_source.html#l01328">topo_bulk.cpp:1328</a></div></div>
<div class="ttc" id="agroup__ring_html_ga05cfdd8cbd1785d44ee6787cb987cbd7"><div class="ttname"><a href="group__ring.html#ga05cfdd8cbd1785d44ee6787cb987cbd7">tum3::shapeMatchHC</a></div><div class="ttdeci">int shapeMatchHC(molSys::PointCloud&lt; molSys::Point&lt; double &gt;, double &gt; *yCloud, const Eigen::MatrixXd &amp;refPoints, cage::Cage cageUnit, std::vector&lt; std::vector&lt; int &gt;&gt; rings, std::vector&lt; std::vector&lt; int &gt;&gt; nList, std::vector&lt; double &gt; *quat, double *rmsd)</div><div class="ttdoc">Shape-matching for a target HC.</div><div class="ttdef"><b>Definition:</b> <a href="bulkTUM_8cpp_source.html#l00251">bulkTUM.cpp:251</a></div></div>
<div class="ttc" id="agroup__ring_html_ga0a321aab8c8956e0885826b65e550a1d"><div class="ttname"><a href="group__ring.html#ga0a321aab8c8956e0885826b65e550a1d">tum3::buildRefHC</a></div><div class="ttdeci">Eigen::MatrixXd buildRefHC(std::string fileName)</div><div class="ttdoc">Build a reference Hexagonal cage, reading in from a template XYZ file.</div><div class="ttdef"><b>Definition:</b> <a href="bulkTUM_8cpp_source.html#l00377">bulkTUM.cpp:377</a></div></div>
<div class="ttc" id="agroup__ring_html_ga390a8ecb9b86c18c3802fcbdcf37cd83"><div class="ttname"><a href="group__ring.html#ga390a8ecb9b86c18c3802fcbdcf37cd83">tum3::averageRMSDatom</a></div><div class="ttdeci">int averageRMSDatom(std::vector&lt; double &gt; *rmsdPerAtom, std::vector&lt; int &gt; *noOfCommonAtoms)</div><div class="ttdoc">Average the RMSD per atom.</div><div class="ttdef"><b>Definition:</b> <a href="bulkTUM_8cpp_source.html#l00529">bulkTUM.cpp:529</a></div></div>
<div class="ttc" id="agroup__ring_html_ga4e415d1a523fd9e0d947ec76306ee5ff"><div class="ttname"><a href="group__ring.html#ga4e415d1a523fd9e0d947ec76306ee5ff">tum3::shapeMatchDDC</a></div><div class="ttdeci">int shapeMatchDDC(molSys::PointCloud&lt; molSys::Point&lt; double &gt;, double &gt; *yCloud, const Eigen::MatrixXd &amp;refPoints, std::vector&lt; cage::Cage &gt; cageList, int cageIndex, std::vector&lt; std::vector&lt; int &gt;&gt; rings, std::vector&lt; double &gt; *quat, double *rmsd)</div><div class="ttdoc">Shape-matching for a target DDC.</div><div class="ttdef"><b>Definition:</b> <a href="bulkTUM_8cpp_source.html#l00323">bulkTUM.cpp:323</a></div></div>
<div class="ttc" id="agroup__ring_html_ga8c3edb4cf0aab398434a883122135c18"><div class="ttname"><a href="group__ring.html#ga8c3edb4cf0aab398434a883122135c18">tum3::updateRMSDatom</a></div><div class="ttdeci">int updateRMSDatom(std::vector&lt; std::vector&lt; int &gt;&gt; rings, cage::Cage cageUnit, double rmsd, std::vector&lt; double &gt; *rmsdPerAtom, std::vector&lt; int &gt; *noOfCommonAtoms, std::vector&lt; cage::iceType &gt; atomTypes)</div><div class="ttdef"><b>Definition:</b> <a href="bulkTUM_8cpp_source.html#l00486">bulkTUM.cpp:486</a></div></div>
<div class="ttc" id="agroup__ring_html_gabad4c396b9a976a7a2199fdfeab143e7"><div class="ttname"><a href="group__ring.html#gabad4c396b9a976a7a2199fdfeab143e7">tum3::topoBulkCriteria</a></div><div class="ttdeci">std::vector&lt; cage::Cage &gt; topoBulkCriteria(std::string path, std::vector&lt; std::vector&lt; int &gt;&gt; rings, std::vector&lt; std::vector&lt; int &gt;&gt; nList, molSys::PointCloud&lt; molSys::Point&lt; double &gt;, double &gt; *yCloud, int firstFrame, int *numHC, int *numDDC, std::vector&lt; ring::strucType &gt; *ringType)</div><div class="ttdef"><b>Definition:</b> <a href="bulkTUM_8cpp_source.html#l00581">bulkTUM.cpp:581</a></div></div>
<div class="ttc" id="agroup__ring_html_gabf66bd35cdbccfd8fee51564dc889977"><div class="ttname"><a href="group__ring.html#gabf66bd35cdbccfd8fee51564dc889977">tum3::buildRefDDC</a></div><div class="ttdeci">Eigen::MatrixXd buildRefDDC(std::string fileName)</div><div class="ttdoc">Build a reference Double-Diamond cage, reading in from a template XYZ file.</div><div class="ttdef"><b>Definition:</b> <a href="bulkTUM_8cpp_source.html#l00435">bulkTUM.cpp:435</a></div></div>
<div class="ttc" id="anamespacesout_html_aabeb7b712f568256cf3ed782fa91c518"><div class="ttname"><a href="namespacesout.html#aabeb7b712f568256cf3ed782fa91c518">sout::writeLAMMPSdataTopoBulk</a></div><div class="ttdeci">int writeLAMMPSdataTopoBulk(molSys::PointCloud&lt; molSys::Point&lt; double &gt;, double &gt; *yCloud, std::vector&lt; std::vector&lt; int &gt;&gt; nList, std::vector&lt; cage::iceType &gt; atomTypes, std::string path, bool bondsBetweenDummy=false)</div><div class="ttdef"><b>Definition:</b> <a href="seams__output_8cpp_source.html#l02397">seams_output.cpp:2397</a></div></div>
<div class="ttc" id="anamespacesout_html_ad297dfa82170796cedea7f111e7694df"><div class="ttname"><a href="namespacesout.html#ad297dfa82170796cedea7f111e7694df">sout::writeLAMMPSdumpCages</a></div><div class="ttdeci">int writeLAMMPSdumpCages(molSys::PointCloud&lt; molSys::Point&lt; double &gt;, double &gt; *yCloud, std::vector&lt; double &gt; rmsdPerAtom, std::vector&lt; int &gt; atomTypes, std::string path, int firstFrame)</div><div class="ttdoc">Write out a LAMMPS dump file containing the RMSD per atom for bulk ice.</div><div class="ttdef"><b>Definition:</b> <a href="seams__output_8cpp_source.html#l01288">seams_output.cpp:1288</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ga8c3edb4cf0aab398434a883122135c18"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga8c3edb4cf0aab398434a883122135c18">&#9670;&nbsp;</a></span>updateRMSDatom()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int tum3::updateRMSDatom </td>
          <td>(</td>
          <td class="paramtype"><a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; <a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt;&gt;&#160;</td>
          <td class="paramname"><em>rings</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structcage_1_1Cage.html">cage::Cage</a>&#160;</td>
          <td class="paramname"><em>cageUnit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>rmsd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; double &gt; *&#160;</td>
          <td class="paramname"><em>rmsdPerAtom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; int &gt; *&#160;</td>
          <td class="paramname"><em>noOfCommonAtoms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; <a class="el" href="group__cage.html#gaaac41828990e32b9d6e7db4426b61529">cage::iceType</a> &gt;&#160;</td>
          <td class="paramname"><em>atomTypes</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Calulate the RMSD for each ring, using RMSD values (rmsd) obtained from the shape-matching of each cage</p>
<p>Update the calculated RMSD per ring using the RMSD values of each cage, and also update the values in the noOfCommonRings vector, which will be used for averaging the RMSD per atom depending on the number of cages that share that particular ring. </p>

<p class="definition">Definition at line <a class="el" href="bulkTUM_8cpp_source.html#l00486">486</a> of file <a class="el" href="bulkTUM_8cpp_source.html">bulkTUM.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;                                                           {</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;  <span class="keywordtype">int</span> nRings = cageUnit.<a class="code" href="group__cage.html#ga5b4c006e8de944ce67f924190123f178">rings</a>.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/size.html">size</a>(); <span class="comment">// Number of rings in the current cage</span></div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;  <span class="keywordtype">int</span> iring; <span class="comment">// Index according to the rings vector of vector, for the current</span></div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;             <span class="comment">// ring inside the cage</span></div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;  <span class="keywordtype">int</span> iatom; <span class="comment">// Current atom index</span></div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;  <span class="keywordtype">int</span> ringSize = rings[0].<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/size.html">size</a>(); <span class="comment">// Number of nodes in each ring (6)</span></div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160; </div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;  <span class="comment">// Loop through the rings in each cage</span></div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; nRings; i++) {</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;    iring = cageUnit.<a class="code" href="group__cage.html#ga5b4c006e8de944ce67f924190123f178">rings</a>[i]; <span class="comment">// Current ring</span></div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160; </div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;    <span class="comment">// Loop through all the atoms in the ring</span></div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; ringSize; j++) {</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;      iatom = rings[iring][j]; <span class="comment">// Current atom index</span></div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160; </div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;      <span class="comment">// Skip for PNC atoms</span></div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;      <span class="keywordflow">if</span> (atomTypes[iatom] == <a class="code" href="group__cage.html#ggaaac41828990e32b9d6e7db4426b61529a3eae6b3c7c54d5cecb3d82d838cc6d60">cage::pnc</a> || atomTypes[iatom] == <a class="code" href="group__cage.html#ggaaac41828990e32b9d6e7db4426b61529acbad0158a8f2811fd4136831fa2b3072">cage::mixed2</a>) {</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;      } <span class="comment">// Do not update if the atom is a PNC</span></div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;      <span class="comment">//</span></div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;      <span class="comment">// UPDATE</span></div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;      <span class="keywordflow">if</span> ((*rmsdPerAtom)[iatom] == -1) {</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;        (*rmsdPerAtom)[iatom] = rmsd;</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;        (*noOfCommonAtoms)[iatom] = 1;</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;        (*rmsdPerAtom)[iatom] += rmsd;</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;        (*noOfCommonAtoms)[iatom] += 1;</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;      }</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;    } <span class="comment">// end of looping through all the atoms in the ring</span></div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160; </div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;  } <span class="comment">// end of looping through the rings in the cage</span></div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160; </div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;  <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- Copyright 2020 Rohit Goswami <rog32@hi.is>
     Licensed under the Apache License, Version 2.0 (the "License");
     you may not use this file except in compliance with the License.
     You may obtain a copy of the License at
     http://www.apache.org/licenses/LICENSE-2.0
     Unless required by applicable law or agreed to in writing, software
     distributed under the License is distributed on an "AS IS" BASIS,
     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     See the License for the specific language governing permissions and
     limitations under the License. -->
<!-- HTML footer for doxygen 1.9.1-->
<!-- start footer part -->
<div class="footer">
<hr class="footline"/><address class="footline"><small>
    Generated by&#160;<a href="https://www.doxygen.org/index.html">Doxygen 1.9.1</a> and the <a class="outlink" href="https://github.com/HaoZeke/doxyYoda">doxyYoda theme</a>
</small></address>
</div>
</div>
</body>
</html>
