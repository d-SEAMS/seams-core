<!-- Copyright 2020 Rohit Goswami <rog32@hi.is>
     Licensed under the Apache License, Version 2.0 (the "License");
     you may not use this file except in compliance with the License.
     You may obtain a copy of the License at
     http://www.apache.org/licenses/LICENSE-2.0
     Unless required by applicable law or agreed to in writing, software
     distributed under the License is distributed on an "AS IS" BASIS,
     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     See the License for the specific language governing permissions and
     limitations under the License. -->
<!-- HTML header for doxygen 1.9.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>d-SEAMS: src/bulkTUM.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script>
MathJax = {
  tex: {
    inlineMath: [['$', '$'], ['\\(', '\\)']]
  },
  svg: {
    fontCache: 'global'
  }
  loader: { load: ["[tex]/unicode", "[tex]/ams"] },
  tex: {
    packages: { "[+]": ["unicode", "ams"] },
    tags: "ams",
  },
};
</script>
<script type="text/javascript" id="MathJax-script" async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js">
</script>
<!-- <link href="doxygen.css" rel="stylesheet" type="text/css" /> -->
<link href="doxyYoda.min.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" >
$(document).ready(function() {
     $(".fragment").wrap("<details class='code-details'></details>");
     $(".code-details").append("<summary>Code</summary>");
 }
)
</script>
</head>
<body>
<div class="grid-contents">
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<nav class="title_area">
<a class="project_logo" href="#">
<img src="dSeamsLogo.png" width="30" height="30" alt="Logo">
</a>
<span class="project_info">d-SEAMS v1.0.0</span>
</nav>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">bulkTUM.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="bulkTUM_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">// d-SEAMS - Deferred Structural Elucidation Analysis for Molecular Simulations</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">// Copyright (c) 2018--present d-SEAMS core team</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">// This program is free software: you can redistribute it and/or modify</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">// it under the terms of the MIT License as published by</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">// the Open Source Initiative.</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">// A copy of the MIT License is included in the LICENSE file of this repository.</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">// You should have received a copy of the MIT License along with this program.</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">// If not, see &lt;https://opensource.org/licenses/MIT&gt;.</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160; </div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="bulkTUM_8hpp.html">bulkTUM.hpp</a>&gt;</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160; </div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">// -----------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">// TOPOLOGICAL UNIT MATCHING ALGORITHMS</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">// -----------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160; </div>
<div class="line"><a name="l00052"></a><span class="lineno"><a class="line" href="group__ring.html#ga4e4a17533b574451c585e3c839c6622a">   52</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="group__ring.html#ga4e4a17533b574451c585e3c839c6622a">tum3::topoUnitMatchingBulk</a>(</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    <a class="codeRef" href="http://en.cppreference.com/w/cpp/string/basic_string.html">std::string</a> path, <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt;<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a>&gt; rings,</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt;<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a>&gt; nList,</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <a class="code" href="structmolSys_1_1PointCloud.html">molSys::PointCloud</a>&lt;<a class="code" href="structmolSys_1_1Point.html">molSys::Point&lt;double&gt;</a>, <span class="keywordtype">double</span>&gt; *yCloud, <span class="keywordtype">int</span> firstFrame,</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <span class="keywordtype">bool</span> printClusters, <span class="keywordtype">bool</span> onlyTetrahedral) {</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;  <span class="comment">// The input rings vector has rings of all sizes</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160; </div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  <span class="comment">// ringType has a value for rings of a particular size</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;ring::strucType&gt;</a></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;      ringType; <span class="comment">// This vector will have a value for each ring inside</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;                <span class="comment">// ringList, of type enum strucType in gen.hpp</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;  <span class="comment">// Make a list of all the DDCs and HCs</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;cage::Cage&gt;</a> cageList;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;std::vector&lt;int&gt;</a>&gt;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;      ringsOneType;    <span class="comment">// Vector of vectors of rings of a single size</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;  <span class="keywordtype">int</span> initRingSize;    <span class="comment">// Todo or not: calculate the PNCs or not</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  <span class="keywordtype">int</span> maxRingSize = 6; <span class="comment">// DDCs and HCs are for 6-membered rings</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;cage::iceType&gt;</a></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;      atomTypes; <span class="comment">// This vector will have a value for every atom</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  <span class="comment">// Number of types</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;  <span class="keywordtype">int</span> numHC, numDDC, mixedRings, prismaticRings, basalRings;</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  <span class="comment">// Shape-matching variables ----</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  <span class="keywordtype">double</span> rmsd;              <span class="comment">// RMSD value for a particular cage type</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;double&gt;</a> quat; <span class="comment">// Quaternion obtained from shape-matching</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;std::vector&lt;double&gt;</a>&gt; quatList; <span class="comment">// List of quaternions</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  <span class="comment">// Reference points</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;  Eigen::MatrixXd refPntsDDC(14,</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;                             3); <span class="comment">// Reference point set (Eigen matrix) for a DDC</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;  Eigen::MatrixXd refPntsHC(12,</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;                            3); <span class="comment">// Reference point set (Eigen matrix) for a DDC</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160; </div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;  <span class="comment">// Vector for the RMSD per atom and the RMSD per ring:</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;double&gt;</a> rmsdPerAtom;</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;      noOfCommonElements; <span class="comment">// An atom can belong to more than one ring or shape</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160; </div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  <span class="keywordflow">if</span> (onlyTetrahedral) {</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    initRingSize = 6;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    initRingSize = 5;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  }</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160; </div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  <span class="comment">// Init the atom type vector</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  atomTypes.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/resize.html">resize</a>(yCloud-&gt;nop); <span class="comment">// Has a value for each atom</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  <span class="comment">// Init the rmsd per atom</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  rmsdPerAtom.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/resize.html">resize</a>(yCloud-&gt;nop, -1);    <span class="comment">// Has a value for each atom</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  noOfCommonElements.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/resize.html">resize</a>(yCloud-&gt;nop); <span class="comment">// Has a value for each atom</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160; </div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  <span class="comment">// ----------------------------------------------</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  <span class="comment">// Init</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  <span class="comment">// Get rings of size 5 or 6.</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ringSize = initRingSize; ringSize &lt;= maxRingSize; ringSize++) {</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <span class="comment">// Clear ringsOneType</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <a class="code" href="group__ring.html#ga76f3cb7aa8a713aeafecdf3a6fffee31">ring::clearRingList</a>(ringsOneType);</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    <span class="comment">// Get rings of the current ring size</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    ringsOneType = <a class="code" href="group__ring.html#gae9254c83de03fcf18b4cb5dcb2625011">ring::getSingleRingSize</a>(rings, ringSize);</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    <span class="comment">// Skip for zero rings</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    <span class="keywordflow">if</span> (ringsOneType.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/size.html">size</a>() == 0) {</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    } <span class="comment">// skip for no rings of ringSize</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    <span class="comment">// Init the ringType vector</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    ringType.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/resize.html">resize</a>(</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;        ringsOneType.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/size.html">size</a>()); <span class="comment">// Has a value for each ring. init to zero.</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    <span class="comment">// ----------------------------------------------</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    <span class="keywordflow">if</span> (ringSize == 6) {</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;      <span class="comment">// Get the cages</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160; </div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;      <span class="comment">// Find the DDCs and HCs</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;      cageList = <a class="code" href="group__ring.html#gabad4c396b9a976a7a2199fdfeab143e7">tum3::topoBulkCriteria</a>(path, ringsOneType, nList, yCloud,</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;                                        firstFrame, &amp;numHC, &amp;numDDC, &amp;ringType);</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160; </div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;      <span class="comment">// Gets the atom type for every atom, to be used for printing out the ice</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;      <span class="comment">// types found</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;      <a class="code" href="group__prism3.html#ga584708a1ea3d1503d7f38f0904b7f5f1">ring::getAtomTypesTopoBulk</a>(ringsOneType, ringType, &amp;atomTypes);</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    }</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <span class="comment">// Finding the 5-membered prismatic blocks</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;      <span class="comment">// Get the prism block classifications</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;      <a class="code" href="group__prism3.html#gacb2bc68638bd794af38bcd503e17be0f">prism3::findBulkPrisms</a>(ringsOneType, &amp;ringType, nList, yCloud,</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;                             &amp;rmsdPerAtom);</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;      <span class="comment">// Gets the atom type for every atom, to be used for printing out the ice</span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;      <span class="comment">// types found</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;      <a class="code" href="group__prism3.html#ga584708a1ea3d1503d7f38f0904b7f5f1">ring::getAtomTypesTopoBulk</a>(ringsOneType, ringType, &amp;atomTypes);</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    }</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;  }</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160; </div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;  <span class="comment">// --------------------------------------------------</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  <span class="comment">// SHAPE-MATCHING</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;  <span class="comment">// Get the reference point sets</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/string/basic_string.html">std::string</a> filePathHC = <span class="stringliteral">&quot;templates/hc.xyz&quot;</span>;</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/string/basic_string.html">std::string</a> filePathDDC = <span class="stringliteral">&quot;templates/ddc.xyz&quot;</span>;</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;  refPntsHC = <a class="code" href="group__ring.html#ga0a321aab8c8956e0885826b65e550a1d">tum3::buildRefHC</a>(filePathHC);    <span class="comment">// HC</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;  refPntsDDC = <a class="code" href="group__ring.html#gabf66bd35cdbccfd8fee51564dc889977">tum3::buildRefDDC</a>(filePathDDC); <span class="comment">// DDC</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;  <span class="comment">// Init</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;  <span class="comment">// Loop through all the atoms and set commonElements to 1 for PNC atoms</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; yCloud-&gt;nop; i++) {</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <span class="keywordflow">if</span> (rmsdPerAtom[i] != -1) {</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;      noOfCommonElements[i] = 1;</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    } <span class="comment">// for atoms which have been updated</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  }   <span class="comment">// end of updating commonElements</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;  <span class="comment">// Loop through the entire cageList vector of cages to match the HCs and DDCs</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;  <span class="comment">// HCs are first, followed by DDCs.</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;  <span class="comment">// Go through all the HCs</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> icage = 0; icage &lt; numHC; icage++) {</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    <span class="comment">// Match against a perfect HC</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    <a class="code" href="group__ring.html#ga05cfdd8cbd1785d44ee6787cb987cbd7">tum3::shapeMatchHC</a>(yCloud, refPntsHC, cageList[icage], ringsOneType, nList,</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;                       &amp;quat, &amp;rmsd);</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <span class="comment">// Update the vector of quaternions</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    quatList.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/push_back.html">push_back</a>(quat);</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    <span class="comment">// Update the RMSD per ring</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    <a class="code" href="group__ring.html#ga8c3edb4cf0aab398434a883122135c18">tum3::updateRMSDatom</a>(ringsOneType, cageList[icage], rmsd, &amp;rmsdPerAtom,</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;                         &amp;noOfCommonElements, atomTypes);</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;  } <span class="comment">// end of looping through all HCs</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  <span class="comment">// --------------------------------------------------</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;  <span class="comment">// Go through all the DDCs</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> icage = numHC; icage &lt; cageList.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/size.html">size</a>(); icage++) {</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <span class="comment">// Match against a perfect DDC</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    <a class="code" href="group__ring.html#ga4e415d1a523fd9e0d947ec76306ee5ff">tum3::shapeMatchDDC</a>(yCloud, refPntsDDC, cageList, icage, ringsOneType,</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;                        &amp;quat, &amp;rmsd);</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <span class="comment">// Update the vector of quaternions</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    quatList.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/push_back.html">push_back</a>(quat);</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    <span class="comment">// Update the RMSD per ring</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <a class="code" href="group__ring.html#ga8c3edb4cf0aab398434a883122135c18">tum3::updateRMSDatom</a>(ringsOneType, cageList[icage], rmsd, &amp;rmsdPerAtom,</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;                         &amp;noOfCommonElements, atomTypes);</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;  } <span class="comment">// end of looping through all HCs</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160; </div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;  <span class="comment">// --------------------------------------------------</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;  <span class="comment">// Getting the RMSD per atom</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;  <span class="comment">// Average the RMSD per atom</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;  <a class="code" href="group__ring.html#ga390a8ecb9b86c18c3802fcbdcf37cd83">tum3::averageRMSDatom</a>(&amp;rmsdPerAtom, &amp;noOfCommonElements);</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;  <span class="comment">// --------------------------------------------------</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160; </div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;  <span class="comment">// Print out the lammps data file with the bonds and types</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;  <a class="code" href="namespacesout.html#aabeb7b712f568256cf3ed782fa91c518">sout::writeLAMMPSdataTopoBulk</a>(yCloud, nList, atomTypes, path);</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;  <span class="comment">// To output the bonds between dummy atoms, uncomment the following line</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;  <span class="comment">// sout::writeLAMMPSdataTopoBulk(yCloud, nList, atomTypes, path, true);</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160; </div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;  <span class="comment">// --------------------------------------------------</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;  <span class="comment">// Writes out the dumpfile</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a> dumpAtomTypes; <span class="comment">// Must be typecast to int</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;  dumpAtomTypes.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/resize.html">resize</a>(atomTypes.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/size.html">size</a>());</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;  <span class="comment">// Change from enum to int</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; atomTypes.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/size.html">size</a>(); i++) {</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    <span class="keywordflow">if</span> (atomTypes[i] == <a class="code" href="group__cage.html#ggaaac41828990e32b9d6e7db4426b61529abf805fba4c226956825175c4514f14ce">cage::hc</a>) {</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;      dumpAtomTypes[i] = 1;</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    } <span class="comment">// HC</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (atomTypes[i] == <a class="code" href="group__cage.html#ggaaac41828990e32b9d6e7db4426b61529a508c36a9ffc7ba85f325a253be11312f">cage::ddc</a>) {</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;      dumpAtomTypes[i] = 2;</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    } <span class="comment">// DDC</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (atomTypes[i] == <a class="code" href="group__cage.html#ggaaac41828990e32b9d6e7db4426b61529a8da31aa983c518632b4a522086415492">cage::mixed</a>) {</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;      dumpAtomTypes[i] = 3;</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    } <span class="comment">// mixed rings</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (atomTypes[i] == <a class="code" href="group__cage.html#ggaaac41828990e32b9d6e7db4426b61529a3eae6b3c7c54d5cecb3d82d838cc6d60">cage::pnc</a>) {</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;      dumpAtomTypes[i] = 4;</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    } <span class="comment">// pnc</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (atomTypes[i] == <a class="code" href="group__cage.html#ggaaac41828990e32b9d6e7db4426b61529acbad0158a8f2811fd4136831fa2b3072">cage::mixed2</a>) {</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;      dumpAtomTypes[i] = 5;</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    } <span class="comment">// shared by pnc and ddc/hc</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;      dumpAtomTypes[i] = 0;</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    } <span class="comment">// dummy atoms</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;  }   <span class="comment">// end of changing the type to int</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;  <a class="code" href="namespacesout.html#ad297dfa82170796cedea7f111e7694df">sout::writeLAMMPSdumpCages</a>(yCloud, rmsdPerAtom, dumpAtomTypes, path,</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;                             firstFrame);</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;  <span class="comment">// --------------------------------------------------</span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;  <span class="comment">// PRINT THE CLUSTERS</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;  <span class="keywordflow">if</span> (printClusters) {</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    <span class="comment">// Print the clusters</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    <a class="code" href="group__ring.html#ga34dea1971104b5adb318178730ffc40d">tum3::clusterCages</a>(yCloud, path, ringsOneType, cageList, numHC, numDDC);</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;  } <span class="comment">// end of printing individual clusters</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;  <span class="comment">// --------------------------------------------------</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;  <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;}</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160; </div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;<span class="comment">// Shape-matching for an HC</span></div>
<div class="line"><a name="l00251"></a><span class="lineno"><a class="line" href="group__ring.html#ga05cfdd8cbd1785d44ee6787cb987cbd7">  251</a></span>&#160;<span class="comment"></span><span class="keywordtype">int</span> <a class="code" href="group__ring.html#ga05cfdd8cbd1785d44ee6787cb987cbd7">tum3::shapeMatchHC</a>(</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    <a class="code" href="structmolSys_1_1PointCloud.html">molSys::PointCloud</a>&lt;<a class="code" href="structmolSys_1_1Point.html">molSys::Point&lt;double&gt;</a>, <span class="keywordtype">double</span>&gt; *yCloud,</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    <span class="keyword">const</span> Eigen::MatrixXd &amp;refPoints, <a class="code" href="structcage_1_1Cage.html">cage::Cage</a> cageUnit,</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt;<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a>&gt; rings, <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt;<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a>&gt; nList,</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;double&gt;</a> *quat, <span class="keywordtype">double</span> *rmsd) {</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;  <span class="keywordtype">int</span> iring,</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;      jring; <span class="comment">// Indices in the ring vector of vectors for the basal rings</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a> basal1,</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;      basal2;       <span class="comment">// Re-ordered basal rings matched to each other</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;  <span class="keywordtype">int</span> ringSize = 6; <span class="comment">// Each ring has 6 nodes</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;  Eigen::MatrixXd targetPointSet(12, 3); <span class="comment">// Target point set (Eigen matrix)</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;double&gt;</a> rmsdList; <span class="comment">// List of RMSD per atom</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;  <span class="comment">// Variables for looping through possible permutations</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;double&gt;</a> currentQuat; <span class="comment">// quaternion rotation</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;  <span class="keywordtype">double</span> currentRmsd;              <span class="comment">// least RMSD</span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;  <span class="keywordtype">double</span> currentScale;             <span class="comment">// scale</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;  <span class="keywordtype">double</span> scale;                    <span class="comment">// Final scale</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;  <span class="keywordtype">int</span> index; <span class="comment">// Int for describing which permutation matches the best</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160; </div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;  <span class="comment">// Init</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;  iring = cageUnit.<a class="code" href="group__cage.html#ga5b4c006e8de944ce67f924190123f178">rings</a>[0];    <span class="comment">// Index of basal1</span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;  jring = cageUnit.<a class="code" href="group__cage.html#ga5b4c006e8de944ce67f924190123f178">rings</a>[1];    <span class="comment">// Index of basal2</span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;  rmsdList.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/resize.html">resize</a>(yCloud-&gt;nop); <span class="comment">// Not actually updated here</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;  <span class="comment">// ----------------</span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;  <span class="comment">// Re-order the basal rings so that they are matched</span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;  <a class="code" href="namespacepntToPnt.html#a8140eb2ad1dfb9d08e4e917dd14d5424">pntToPnt::relOrderHC</a>(yCloud, rings[iring], rings[jring], nList, &amp;basal1,</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;                       &amp;basal2);</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;  <span class="comment">// ----------------</span></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;  <span class="comment">// Loop through all possible permutations</span></div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; ringSize; i++) {</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    <span class="comment">// Change the order of the target points somehow!</span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    targetPointSet = <a class="code" href="namespacepntToPnt.html#a896e8ed3ac4436156eac99b12e12c255">pntToPnt::changeHexCageOrder</a>(yCloud, basal1, basal2, i);</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    <span class="comment">// Shape-matching</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    <a class="code" href="namespaceabsor.html#ad4f0741af9784817b44df6883888d9a3">absor::hornAbsOrientation</a>(refPoints, targetPointSet, &amp;currentQuat,</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;                              &amp;currentRmsd, &amp;rmsdList, &amp;currentScale);</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    <span class="keywordflow">if</span> (i == 0) {</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;      *quat = currentQuat;</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;      *rmsd = currentRmsd;</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;      scale = currentScale;</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;      index = 0;</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;      <span class="keywordflow">if</span> (currentRmsd &lt; *rmsd) {</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;        *quat = currentQuat;</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;        *rmsd = currentRmsd;</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;        scale = currentScale;</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;        index = i;</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;      } <span class="comment">// update</span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    }   <span class="comment">// Update if this is a better match</span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;  }     <span class="comment">// Loop through possible permutations</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;  <span class="comment">// ----------------</span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;  <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;}</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160; </div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;<span class="comment">// Shape-matching for a DDC</span></div>
<div class="line"><a name="l00323"></a><span class="lineno"><a class="line" href="group__ring.html#ga4e415d1a523fd9e0d947ec76306ee5ff">  323</a></span>&#160;<span class="comment"></span><span class="keywordtype">int</span> <a class="code" href="group__ring.html#ga4e415d1a523fd9e0d947ec76306ee5ff">tum3::shapeMatchDDC</a>(</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    <a class="code" href="structmolSys_1_1PointCloud.html">molSys::PointCloud</a>&lt;<a class="code" href="structmolSys_1_1Point.html">molSys::Point&lt;double&gt;</a>, <span class="keywordtype">double</span>&gt; *yCloud,</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    <span class="keyword">const</span> Eigen::MatrixXd &amp;refPoints, <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;cage::Cage&gt;</a> cageList,</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    <span class="keywordtype">int</span> cageIndex, <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt;<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a>&gt; rings,</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;double&gt;</a> *quat, <span class="keywordtype">double</span> *rmsd) {</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a> ddcOrder;             <span class="comment">// Connectivity of the DDC</span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;  <span class="keywordtype">int</span> ringSize = 6;                      <span class="comment">// Each ring has 6 nodes</span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;  Eigen::MatrixXd targetPointSet(14, 3); <span class="comment">// Target point set (Eigen matrix)</span></div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;double&gt;</a> rmsdList; <span class="comment">// List of RMSD per atom</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;  <span class="comment">// Variables for looping through possible permutations</span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;double&gt;</a> currentQuat; <span class="comment">// quaternion rotation</span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;  <span class="keywordtype">double</span> currentRmsd;              <span class="comment">// least RMSD</span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;  <span class="keywordtype">double</span> currentScale;             <span class="comment">// scale</span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;  <span class="keywordtype">double</span> scale;                    <span class="comment">// Final scale</span></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;  <span class="keywordtype">int</span> index; <span class="comment">// Int for describing which permutation matches the best</span></div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160; </div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;  <span class="comment">// ----------------</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;  <span class="comment">// Save the order of the DDC in a vector</span></div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;  ddcOrder = <a class="code" href="namespacepntToPnt.html#a804eb495f58fd5868858cc46480c3425">pntToPnt::relOrderDDC</a>(cageIndex, rings, cageList);</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;  <span class="comment">// ----------------</span></div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;  <span class="comment">// Loop through all possible permutations</span></div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; ringSize; i++) {</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    <span class="comment">// Change the order of the target points somehow!</span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    targetPointSet = <a class="code" href="namespacepntToPnt.html#a2c4affea21bfc133f8c752d74f3a943a">pntToPnt::changeDiaCageOrder</a>(yCloud, ddcOrder, i);</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    <span class="comment">// Shape-matching</span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    <a class="code" href="namespaceabsor.html#ad4f0741af9784817b44df6883888d9a3">absor::hornAbsOrientation</a>(refPoints, targetPointSet, &amp;currentQuat,</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;                              &amp;currentRmsd, &amp;rmsdList, &amp;currentScale);</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    <span class="keywordflow">if</span> (i == 0) {</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;      *quat = currentQuat;</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;      *rmsd = currentRmsd;</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;      scale = currentScale;</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;      index = 0;</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;      <span class="keywordflow">if</span> (currentRmsd &lt; *rmsd) {</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;        *quat = currentQuat;</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;        *rmsd = currentRmsd;</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;        scale = currentScale;</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;        index = i;</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;      } <span class="comment">// update</span></div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    }   <span class="comment">// Update if this is a better match</span></div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;  }     <span class="comment">// Loop through possible permutations</span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;  <span class="comment">// ----------------</span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;  <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;}</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160; </div>
<div class="line"><a name="l00377"></a><span class="lineno"><a class="line" href="group__ring.html#ga0a321aab8c8956e0885826b65e550a1d">  377</a></span>&#160;Eigen::MatrixXd <a class="code" href="group__ring.html#ga0a321aab8c8956e0885826b65e550a1d">tum3::buildRefHC</a>(<a class="codeRef" href="http://en.cppreference.com/w/cpp/string/basic_string.html">std::string</a> fileName) {</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;  Eigen::MatrixXd refPnts(12, 3); <span class="comment">// Reference point set (Eigen matrix)</span></div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;  <span class="comment">// Get the reference HC point set</span></div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;  <a class="code" href="structmolSys_1_1PointCloud.html">molSys::PointCloud&lt;molSys::Point&lt;double&gt;</a>, <span class="keywordtype">double</span>&gt;</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;      setCloud; <span class="comment">// PointCloud for holding the reference point values</span></div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;  <span class="comment">// Variables for rings</span></div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;std::vector&lt;int&gt;</a>&gt; nList; <span class="comment">// Neighbour list</span></div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;std::vector&lt;int&gt;</a>&gt; rings; <span class="comment">// Rings</span></div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;ring::strucType&gt;</a></div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;      ringType;            <span class="comment">// This vector will have a value for each ring inside</span></div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a> listHC; <span class="comment">// Contains atom indices of atoms making up HCs</span></div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;  <span class="comment">// Make a list of all the DDCs and HCs</span></div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;cage::Cage&gt;</a> cageList;</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;  <span class="keywordtype">int</span> iring, jring;</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;  <span class="comment">// read in the XYZ file into the pointCloud setCloud</span></div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;  <a class="code" href="group__sinp.html#gab2f8bc3f639a2d2618460883116d5b5b">sinp::readXYZ</a>(fileName, &amp;setCloud);</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;  <span class="comment">// box lengths</span></div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 3; i++) {</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    setCloud.<a class="code" href="group__molSys.html#gaa7d9b8543780baf4a495c7acdb1f87d8">box</a>[i] = 50;</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;  } <span class="comment">// end of setting box lengths</span></div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160; </div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;  nList = <a class="code" href="group__nneigh.html#gaaaaf74d25014d1c08bb73b8be0a6fe74">nneigh::neighListO</a>(3.5, &amp;setCloud, 1);</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;  <span class="comment">// Neighbour list by index</span></div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;  nList = <a class="code" href="group__nneigh.html#gab2468daaf43c827b54a88af914d0fee8">nneigh::neighbourListByIndex</a>(&amp;setCloud, nList);</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;  <span class="comment">// Find the vector of vector of rings</span></div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;  rings = <a class="code" href="group__primitive.html#ga9872b1fd04c72cc53626b882bec4b99f">primitive::ringNetwork</a>(nList, 6);</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;  <span class="comment">// init the ringType vector</span></div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;  ringType.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/resize.html">resize</a>(rings.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/size.html">size</a>());</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;  <span class="comment">// Find the HCs</span></div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;  listHC = <a class="code" href="group__prism3.html#gaf6c8e26a55c976c7ae810914bd1c7362">ring::findHC</a>(rings, &amp;ringType, nList, &amp;cageList);</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;  <span class="comment">// Get the basal rings from cageList</span></div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;  iring = cageList[0].rings[0];</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;  jring = cageList[0].rings[1];</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a> matchedBasal1,</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;      matchedBasal2; <span class="comment">// Re-ordered basal rings 1 and 2</span></div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;  <span class="comment">// Reordered basal rings</span></div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;  <span class="comment">// Getting the target Eigen vectors</span></div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;  <span class="comment">// Get the re-ordered matched basal rings, ordered with respect to each</span></div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;  <span class="comment">// other</span></div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160; </div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;  <a class="code" href="namespacepntToPnt.html#a8140eb2ad1dfb9d08e4e917dd14d5424">pntToPnt::relOrderHC</a>(&amp;setCloud, rings[iring], rings[jring], nList,</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;                       &amp;matchedBasal1, &amp;matchedBasal2);</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;  <span class="comment">// Get the reference point set</span></div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;  refPnts =</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;      <a class="code" href="namespacepntToPnt.html#a896e8ed3ac4436156eac99b12e12c255">pntToPnt::changeHexCageOrder</a>(&amp;setCloud, matchedBasal1, matchedBasal2, 0);</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;  <span class="keywordflow">return</span> refPnts;</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;}</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160; </div>
<div class="line"><a name="l00435"></a><span class="lineno"><a class="line" href="group__ring.html#gabf66bd35cdbccfd8fee51564dc889977">  435</a></span>&#160;Eigen::MatrixXd <a class="code" href="group__ring.html#gabf66bd35cdbccfd8fee51564dc889977">tum3::buildRefDDC</a>(<a class="codeRef" href="http://en.cppreference.com/w/cpp/string/basic_string.html">std::string</a> fileName) {</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;  Eigen::MatrixXd refPnts(14, 3); <span class="comment">// Reference point set (Eigen matrix)</span></div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;  <span class="comment">// Get the reference HC point set</span></div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;  <a class="code" href="structmolSys_1_1PointCloud.html">molSys::PointCloud&lt;molSys::Point&lt;double&gt;</a>, <span class="keywordtype">double</span>&gt;</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;      setCloud; <span class="comment">// PointCloud for holding the reference point values</span></div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;  <span class="comment">// Variables for rings</span></div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;std::vector&lt;int&gt;</a>&gt; nList; <span class="comment">// Neighbour list</span></div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;std::vector&lt;int&gt;</a>&gt; rings; <span class="comment">// Rings</span></div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;ring::strucType&gt;</a></div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;      ringType; <span class="comment">// This vector will have a value for each ring inside</span></div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a> listDDC,</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;      listHC; <span class="comment">// Contains atom indices of atoms making up DDCs and HCs</span></div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a> ddcOrder; <span class="comment">// Atom indices of particles in the DDC</span></div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;  <span class="comment">// Make a list of all the DDCs and HCs</span></div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;cage::Cage&gt;</a> cageList;</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;  <span class="keywordtype">int</span> iring, jring;</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;  <span class="comment">// read in the XYZ file into the pointCloud setCloud</span></div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;  <a class="code" href="group__sinp.html#gab2f8bc3f639a2d2618460883116d5b5b">sinp::readXYZ</a>(fileName, &amp;setCloud);</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160; </div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;  <span class="comment">// box lengths</span></div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 3; i++) {</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    setCloud.<a class="code" href="group__molSys.html#gaa7d9b8543780baf4a495c7acdb1f87d8">box</a>[i] = 50;</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;  } <span class="comment">// end of setting box lengths</span></div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160; </div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;  nList = <a class="code" href="group__nneigh.html#gaaaaf74d25014d1c08bb73b8be0a6fe74">nneigh::neighListO</a>(3.5, &amp;setCloud, 1);</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;  <span class="comment">// Neighbour list by index</span></div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;  nList = <a class="code" href="group__nneigh.html#gab2468daaf43c827b54a88af914d0fee8">nneigh::neighbourListByIndex</a>(&amp;setCloud, nList);</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;  <span class="comment">// Find the vector of vector of rings</span></div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;  rings = <a class="code" href="group__primitive.html#ga9872b1fd04c72cc53626b882bec4b99f">primitive::ringNetwork</a>(nList, 6);</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;  <span class="comment">// init the ringType vector</span></div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;  ringType.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/resize.html">resize</a>(rings.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/size.html">size</a>());</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;  <span class="comment">// Find the DDCs</span></div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;  listDDC = <a class="code" href="group__prism3.html#ga35816c398a355ca472fddeb2869fce15">ring::findDDC</a>(rings, &amp;ringType, listHC, &amp;cageList);</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;  <span class="comment">// Save the order of the DDC in a vector</span></div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;  ddcOrder = <a class="code" href="namespacepntToPnt.html#a804eb495f58fd5868858cc46480c3425">pntToPnt::relOrderDDC</a>(0, rings, cageList);</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;  <span class="comment">// Get the reference point set</span></div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;  refPnts = <a class="code" href="namespacepntToPnt.html#a2c4affea21bfc133f8c752d74f3a943a">pntToPnt::changeDiaCageOrder</a>(&amp;setCloud, ddcOrder, 0);</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;  <span class="keywordflow">return</span> refPnts;</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;}</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160; </div>
<div class="line"><a name="l00486"></a><span class="lineno"><a class="line" href="group__ring.html#ga8c3edb4cf0aab398434a883122135c18">  486</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="group__ring.html#ga8c3edb4cf0aab398434a883122135c18">tum3::updateRMSDatom</a>(<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt;<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a>&gt; rings,</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;                         <a class="code" href="structcage_1_1Cage.html">cage::Cage</a> cageUnit, <span class="keywordtype">double</span> rmsd,</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;                         <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;double&gt;</a> *rmsdPerAtom,</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;                         <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a> *noOfCommonAtoms,</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;                         <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;cage::iceType&gt;</a> atomTypes) {</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;  <span class="keywordtype">int</span> nRings = cageUnit.<a class="code" href="group__cage.html#ga5b4c006e8de944ce67f924190123f178">rings</a>.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/size.html">size</a>(); <span class="comment">// Number of rings in the current cage</span></div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;  <span class="keywordtype">int</span> iring; <span class="comment">// Index according to the rings vector of vector, for the current</span></div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;             <span class="comment">// ring inside the cage</span></div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;  <span class="keywordtype">int</span> iatom; <span class="comment">// Current atom index</span></div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;  <span class="keywordtype">int</span> ringSize = rings[0].size(); <span class="comment">// Number of nodes in each ring (6)</span></div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160; </div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;  <span class="comment">// Loop through the rings in each cage</span></div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; nRings; i++) {</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;    iring = cageUnit.<a class="code" href="group__cage.html#ga5b4c006e8de944ce67f924190123f178">rings</a>[i]; <span class="comment">// Current ring</span></div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160; </div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;    <span class="comment">// Loop through all the atoms in the ring</span></div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; ringSize; j++) {</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;      iatom = rings[iring][j]; <span class="comment">// Current atom index</span></div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160; </div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;      <span class="comment">// Skip for PNC atoms</span></div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;      <span class="keywordflow">if</span> (atomTypes[iatom] == <a class="code" href="group__cage.html#ggaaac41828990e32b9d6e7db4426b61529a3eae6b3c7c54d5cecb3d82d838cc6d60">cage::pnc</a> || atomTypes[iatom] == <a class="code" href="group__cage.html#ggaaac41828990e32b9d6e7db4426b61529acbad0158a8f2811fd4136831fa2b3072">cage::mixed2</a>) {</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;      } <span class="comment">// Do not update if the atom is a PNC</span></div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;      <span class="comment">//</span></div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;      <span class="comment">// UPDATE</span></div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;      <span class="keywordflow">if</span> ((*rmsdPerAtom)[iatom] == -1) {</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;        (*rmsdPerAtom)[iatom] = rmsd;</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;        (*noOfCommonAtoms)[iatom] = 1;</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;        (*rmsdPerAtom)[iatom] += rmsd;</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;        (*noOfCommonAtoms)[iatom] += 1;</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;      }</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;    } <span class="comment">// end of looping through all the atoms in the ring</span></div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160; </div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;  } <span class="comment">// end of looping through the rings in the cage</span></div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160; </div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;  <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;}</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160; </div>
<div class="line"><a name="l00529"></a><span class="lineno"><a class="line" href="group__ring.html#ga390a8ecb9b86c18c3802fcbdcf37cd83">  529</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="group__ring.html#ga390a8ecb9b86c18c3802fcbdcf37cd83">tum3::averageRMSDatom</a>(<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;double&gt;</a> *rmsdPerAtom,</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;                          <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a> *noOfCommonAtoms) {</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;  <span class="keywordtype">int</span> nop = (*rmsdPerAtom).size(); <span class="comment">// Number of particles</span></div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160; </div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iatom = 0; iatom &lt; nop; iatom++) {</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;    <span class="keywordflow">if</span> ((*noOfCommonAtoms)[iatom] == 0) {</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;      (*rmsdPerAtom)[iatom] = -1; <span class="comment">// Dummy atom</span></div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;      (*rmsdPerAtom)[iatom] /= (*noOfCommonAtoms)[iatom];</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;    }</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;  } <span class="comment">// end of averaging</span></div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160; </div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;  <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;} <span class="comment">// end of function</span></div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160; </div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;<span class="comment">// -----------------------------------------------------------------</span></div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;<span class="comment">// TOPOLOGICAL NETWORK ALGORITHMS</span></div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;<span class="comment">// -----------------------------------------------------------------</span></div>
<div class="line"><a name="l00581"></a><span class="lineno"><a class="line" href="group__ring.html#gabad4c396b9a976a7a2199fdfeab143e7">  581</a></span>&#160;<span class="comment"></span><a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;cage::Cage&gt;</a> <a class="code" href="group__ring.html#gabad4c396b9a976a7a2199fdfeab143e7">tum3::topoBulkCriteria</a>(</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;    <a class="codeRef" href="http://en.cppreference.com/w/cpp/string/basic_string.html">std::string</a> path, <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt;<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a>&gt; rings,</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;    <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt;<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a>&gt; nList,</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;    <a class="code" href="structmolSys_1_1PointCloud.html">molSys::PointCloud</a>&lt;<a class="code" href="structmolSys_1_1Point.html">molSys::Point&lt;double&gt;</a>, <span class="keywordtype">double</span>&gt; *yCloud, <span class="keywordtype">int</span> firstFrame,</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;    <span class="keywordtype">int</span> *numHC, <span class="keywordtype">int</span> *numDDC, <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;ring::strucType&gt;</a> *ringType) {</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;  <span class="comment">// Ring IDs of each type will be saved in these vectors</span></div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a> listDDC; <span class="comment">// Vector for ring indices of DDC</span></div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a> listHC;  <span class="comment">// Vector for ring indices of HC</span></div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a></div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;      listMixed; <span class="comment">// Vector for ring indices of rings that are both DDC and HC</span></div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;                 <span class="comment">// ringList, of type enum strucType in gen.hpp</span></div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;  <span class="comment">// Make a list of all the DDCs and HCs</span></div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;cage::Cage&gt;</a> cageList;</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;  <span class="comment">// Number of types</span></div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;  <span class="keywordtype">int</span> mixedRings, prismaticRings, basalRings;</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160; </div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;  <span class="comment">// ----------------------------------------------</span></div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;  <span class="comment">// Init</span></div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;  *numHC = 0;  <span class="comment">// Number of hexagonal cages</span></div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;  *numDDC = 0; <span class="comment">// Init the number of DDCs</span></div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;  <span class="comment">// Quit the function for zero rings</span></div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;  <span class="keywordflow">if</span> (rings.size() == 0) {</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;    <span class="keywordflow">return</span> cageList;</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;  } <span class="comment">// skip for no rings of ringSize</span></div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;  <span class="comment">// Init the ringType vector</span></div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;  (*ringType).<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/resize.html">resize</a>(rings.size()); <span class="comment">// Has a value for each ring. init to zero.</span></div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;  <span class="comment">// ----------------------------------------------</span></div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;  <span class="comment">// Get the cages</span></div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160; </div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;  <span class="comment">// Find HC rings, saving the ring IDs (starting from 0) to listHC</span></div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;  listHC = <a class="code" href="group__prism3.html#gaf6c8e26a55c976c7ae810914bd1c7362">ring::findHC</a>(rings, ringType, nList, &amp;cageList);</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160; </div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;  <span class="comment">// Find DDC rings, saving the IDs to listDDC</span></div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;  listDDC = <a class="code" href="group__prism3.html#ga35816c398a355ca472fddeb2869fce15">ring::findDDC</a>(rings, ringType, listHC, &amp;cageList);</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160; </div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;  <span class="comment">// Find rings which are both DDCs and HCs (mixed)</span></div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;  <span class="comment">// A dummy value of -10 in the listDDC and listHC vectors for mixed rings</span></div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;  listMixed = <a class="code" href="group__prism3.html#gadb3c8127d84cb2e90aafff55419f2c85">ring::findMixedRings</a>(rings, ringType, &amp;listDDC, &amp;listHC);</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160; </div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;  <span class="comment">// Get the number of structures (DDCs, HCs, mixed rings, basal rings,</span></div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;  <span class="comment">// prismatic rings)</span></div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;  <a class="code" href="group__prism3.html#ga6fcfac293a750bd14cbf1f94ab2a3976">ring::getStrucNumbers</a>(*ringType, cageList, numHC, numDDC, &amp;mixedRings,</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;                        &amp;prismaticRings, &amp;basalRings);</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160; </div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;  <span class="comment">// Write out to a file</span></div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;  <a class="code" href="namespacesout.html#a5ca5eeff9edc702cdcf1b26e8501dc0c">sout::writeTopoBulkData</a>(path, yCloud-&gt;currentFrame, *numHC, *numDDC,</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;                          mixedRings, basalRings, prismaticRings, firstFrame);</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160; </div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;  <span class="keywordflow">return</span> cageList;</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;}</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160; </div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;<span class="comment">// -----------------------------------------------------------------</span></div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;<span class="comment">// CLUSTERING ALGORITHMS</span></div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;<span class="comment">// -----------------------------------------------------------------</span></div>
<div class="line"><a name="l00644"></a><span class="lineno"><a class="line" href="group__ring.html#ga34dea1971104b5adb318178730ffc40d">  644</a></span>&#160;<span class="comment"></span><span class="keywordtype">int</span> <a class="code" href="group__ring.html#ga34dea1971104b5adb318178730ffc40d">tum3::clusterCages</a>(</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;    <a class="code" href="structmolSys_1_1PointCloud.html">molSys::PointCloud</a>&lt;<a class="code" href="structmolSys_1_1Point.html">molSys::Point&lt;double&gt;</a>, <span class="keywordtype">double</span>&gt; *yCloud, <a class="codeRef" href="http://en.cppreference.com/w/cpp/string/basic_string.html">std::string</a> path,</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;    <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt;<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a>&gt; rings, <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;cage::Cage&gt;</a> cageList,</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;    <span class="keywordtype">int</span> numHC, <span class="keywordtype">int</span> numDDC) {</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a> linkedList; <span class="comment">// Linked list for the clustered cages</span></div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;  <span class="keywordtype">int</span> nCages = numHC + numDDC; <span class="comment">// Number of cages in total</span></div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;  <span class="keywordtype">int</span> j, temp;                 <span class="comment">// Variables used inside the loops</span></div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;  <span class="keywordtype">bool</span> isNeighbour; <span class="comment">// true if cages are adjacent to each other, false otherwise</span></div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;bool&gt;</a></div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;      visited; <span class="comment">// To make sure you don&#39;t go through the same cages again.</span></div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;  <span class="keywordtype">int</span> singleDDCs, singleHCs; <span class="comment">// Number of single DDCs and HCs</span></div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;  <span class="comment">// Units are in Angstrom^3</span></div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;  <span class="keywordtype">double</span> volDDC = 72.7;          <span class="comment">// The calculated alpha volume of a single DDC</span></div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;  <span class="keywordtype">double</span> volHC = 40.63;          <span class="comment">// The calculated alpha volume of a single HC</span></div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;  <span class="keywordtype">int</span> nextElement;               <span class="comment">// value in list</span></div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;  <span class="keywordtype">int</span> index;                     <span class="comment">// starting index value</span></div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;  <span class="keywordtype">int</span> currentIndex;              <span class="comment">// Current cage index</span></div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;  <span class="keywordtype">int</span> iClusterNumber;            <span class="comment">// Number in the current cluster</span></div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a> nClusters;    <span class="comment">// Number of cages in each cluster</span></div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a> <a class="code" href="group__ring.html#ga34dea1971104b5adb318178730ffc40d">clusterCages</a>; <span class="comment">// Indices of each cage in the cluster</span></div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a> atoms; <span class="comment">// Vector containing the atom indices of all the</span></div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;                          <span class="comment">// atoms in the cages</span></div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;  <a class="code" href="group__cage.html#ga5787314f51b5927c213db48b81c21d95">cage::cageType</a> type;    <span class="comment">// Type of the cages in the cluster</span></div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;  <span class="comment">// -----------------------------------------------------------</span></div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;  <span class="comment">// INITIALIZATION</span></div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;  linkedList.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/resize.html">resize</a>(nCages); <span class="comment">// init to dummy value</span></div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;  <span class="comment">// Initial values of the list.</span></div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> icage = 0; icage &lt; nCages; icage++) {</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;    <span class="comment">// Assign the index as the ID</span></div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;    linkedList[icage] = icage; <span class="comment">// Index</span></div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;  }                            <span class="comment">// init of cluster IDs</span></div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;  <span class="comment">// -----------------------------------------------------------</span></div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;  <span class="comment">// GETTING THE LINKED LIST</span></div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;  <span class="comment">// HCs first</span></div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; nCages - 1; i++) {</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;    <span class="comment">// If iatom is already in a cluster, skip it</span></div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;    <span class="keywordflow">if</span> (linkedList[i] != i) {</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;    } <span class="comment">// Already part of a cluster</span></div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;    j = i; <span class="comment">// Init of j</span></div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;    <span class="comment">// Execute the next part of the loop while j is not equal to i</span></div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;    <span class="keywordflow">do</span> {</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;      <span class="comment">//</span></div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;      <span class="comment">// Go through the rest of the atoms (KLOOP)</span></div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = i + 1; k &lt; nCages; k++) {</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;        <span class="comment">// Skip if already part of a cluster</span></div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;        <span class="keywordflow">if</span> (linkedList[k] != k) {</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;          <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;        } <span class="comment">// Already part of a cluster</span></div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;        <span class="comment">// k and j must be of the same type</span></div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;        <span class="keywordflow">if</span> (cageList[k].type != cageList[j].type) {</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;          <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;        } <span class="comment">// skip if k and j are not of the same type</span></div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;        <span class="comment">// Check to see if k is a nearest neighbour of j</span></div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;        isNeighbour =</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;            <a class="code" href="group__ring.html#gac30855d0daa2b20c29e4dee39f5cd92f">ring::hasCommonElements</a>(cageList[k].rings, cageList[j].rings);</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;        <span class="keywordflow">if</span> (isNeighbour) {</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;          <span class="comment">// Swap!</span></div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;          temp = linkedList[j];</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;          linkedList[j] = linkedList[k];</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;          linkedList[k] = temp;</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;        } <span class="comment">// j and k are neighbouring cages</span></div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;      }   <span class="comment">// end of loop through k (KLOOP)</span></div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;      <span class="comment">//</span></div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;      j = linkedList[j];</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;    } <span class="keywordflow">while</span> (j != i); <span class="comment">// end of control for j!=i</span></div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;  } <span class="comment">// end of getting the linked list (looping through every i)</span></div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;  <span class="comment">// -----------------------------------------------------------</span></div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;  <span class="comment">// WRITE-OUTS</span></div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;  <span class="comment">// init</span></div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;  visited.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/resize.html">resize</a>(nCages);</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;  singleDDCs = 0;</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;  singleHCs = 0;</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160; </div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; nCages; i++) {</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;    <span class="keywordflow">if</span> (visited[i]) {</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;    } <span class="comment">// Already counted</span></div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;    <span class="comment">// Now that the cage has been visited, set it to true</span></div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;    visited[i] = <span class="keyword">true</span>; <span class="comment">// Visited</span></div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;    <span class="comment">// If only one cage is in the cluster</span></div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;    <span class="keywordflow">if</span> (linkedList[i] == i) {</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;      <span class="comment">// Add to the number of single DDCs</span></div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;      <span class="keywordflow">if</span> (cageList[i].type == <a class="code" href="group__cage.html#gga5787314f51b5927c213db48b81c21d95ac5a9e4f20bab07bef66bb6e15c49682d">cage::DoubleDiaC</a>) {</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;        singleDDCs++;</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;      } <span class="comment">// add to the single DDCs</span></div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;      <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;        singleHCs++;</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;      } <span class="comment">// single HCs</span></div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;    } <span class="comment">// cluster has only one cage</span></div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;    <span class="comment">// init</span></div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;    <a class="code" href="group__ring.html#ga34dea1971104b5adb318178730ffc40d">clusterCages</a>.resize(0);</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;    type = cageList[i].type;</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;    currentIndex = i;</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;    nextElement = linkedList[currentIndex];</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;    index = i;</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;    iClusterNumber = 1;        <span class="comment">// at least one value</span></div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;    <a class="code" href="group__ring.html#ga34dea1971104b5adb318178730ffc40d">clusterCages</a>.push_back(i); <span class="comment">// Add the first cage</span></div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;    <span class="comment">// Get the other cages in the cluster</span></div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;    <span class="keywordflow">while</span> (nextElement != index) {</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;      iClusterNumber++;</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;      currentIndex = nextElement;</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;      visited[currentIndex] = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;      <a class="code" href="group__ring.html#ga34dea1971104b5adb318178730ffc40d">clusterCages</a>.push_back(currentIndex); <span class="comment">// Add the first cage</span></div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;      nextElement = linkedList[currentIndex];</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;    } <span class="comment">// get number</span></div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;    <span class="comment">// Update the number of molecules in the cluster</span></div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;    nClusters.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/push_back.html">push_back</a>(iClusterNumber);</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;    <span class="comment">// --------------</span></div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;    <span class="comment">// PRINT OUT</span></div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;    atoms = <a class="code" href="group__ring.html#ga2a339a36e85ff35c64fa3908936faf6c">tum3::atomsFromCages</a>(rings, cageList, <a class="code" href="group__ring.html#ga34dea1971104b5adb318178730ffc40d">clusterCages</a>);</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;    <span class="keywordtype">int</span> clusterID = nClusters.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/size.html">size</a>();</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;    <span class="comment">// Write out the cluster</span></div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;    <a class="code" href="namespacesout.html#ad80ee9773d7921a87ef5bbbe76541a91">sout::writeXYZcluster</a>(path, yCloud, atoms, clusterID, type);</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;    <span class="comment">// Print out the cages into an XYZ file</span></div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;    <span class="comment">// --------------</span></div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;  } <span class="comment">// end of loop through</span></div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;  <span class="comment">// -----------------------------------------------------------</span></div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;  <span class="comment">// Write out the stuff for single cages</span></div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;  <span class="comment">// ----------------</span></div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/io/basic_ofstream.html">std::ofstream</a> outputFile;</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;  <span class="comment">// Make the output directory if it doesn&#39;t exist</span></div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;  <a class="code" href="namespacesout.html#a3985775f30d7920fbf13f12386abefc1">sout::makePath</a>(path);</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/string/basic_string.html">std::string</a> outputDirName = path + <span class="stringliteral">&quot;bulkTopo&quot;</span>;</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;  <a class="code" href="namespacesout.html#a3985775f30d7920fbf13f12386abefc1">sout::makePath</a>(outputDirName);</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;  outputDirName = path + <span class="stringliteral">&quot;bulkTopo/clusterXYZ/&quot;</span>;</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;  <a class="code" href="namespacesout.html#a3985775f30d7920fbf13f12386abefc1">sout::makePath</a>(outputDirName);</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;  outputDirName = path + <span class="stringliteral">&quot;bulkTopo/clusterXYZ/frame-&quot;</span> +</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;                  <a class="codeRef" href="http://en.cppreference.com/w/cpp/string/basic_string/to_string.html">std::to_string</a>(yCloud-&gt;currentFrame);</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;  <a class="code" href="namespacesout.html#a3985775f30d7920fbf13f12386abefc1">sout::makePath</a>(outputDirName);</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;  <span class="comment">// ----------------</span></div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;  <span class="comment">// Write output to file inside the output directory</span></div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;  outputFile.<a class="codeRef" href="http://en.cppreference.com/w/cpp/io/basic_ofstream/open.html">open</a>(path + <span class="stringliteral">&quot;bulkTopo/clusterXYZ/frame-&quot;</span> +</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;                  <a class="codeRef" href="http://en.cppreference.com/w/cpp/string/basic_string/to_string.html">std::to_string</a>(yCloud-&gt;currentFrame) + <span class="stringliteral">&quot;/info.dat&quot;</span>);</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;  outputFile &lt;&lt; <span class="stringliteral">&quot;# volDDC volHC in Angstrom^3\n&quot;</span>;</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;  outputFile &lt;&lt; singleDDCs * volDDC &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; singleHCs * volHC &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;  outputFile &lt;&lt; <span class="stringliteral">&quot;There are &quot;</span> &lt;&lt; singleDDCs &lt;&lt; <span class="stringliteral">&quot; single DDCs\n&quot;</span>;</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;  outputFile &lt;&lt; <span class="stringliteral">&quot;There are &quot;</span> &lt;&lt; singleHCs &lt;&lt; <span class="stringliteral">&quot; single HCs\n&quot;</span>;</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;  outputFile.<a class="codeRef" href="http://en.cppreference.com/w/cpp/io/basic_ofstream/close.html">close</a>(); <span class="comment">// Close the file</span></div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;  <span class="comment">// -----------------------------------------------------------</span></div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;  <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;} <span class="comment">// end of the function</span></div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160; </div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160; </div>
<div class="line"><a name="l00801"></a><span class="lineno"><a class="line" href="group__ring.html#ga2a339a36e85ff35c64fa3908936faf6c">  801</a></span>&#160;<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a> <a class="code" href="group__ring.html#ga2a339a36e85ff35c64fa3908936faf6c">tum3::atomsFromCages</a>(<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt;<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a>&gt; rings,</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;                                      <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;cage::Cage&gt;</a> cageList,</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;                                      <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a> <a class="code" href="group__ring.html#ga34dea1971104b5adb318178730ffc40d">clusterCages</a>) {</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;  <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;int&gt;</a> atoms; <span class="comment">// Contains the atom indices (not IDs) of atoms</span></div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;  <span class="keywordtype">int</span> ringSize = rings[0].<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/size.html">size</a>(); <span class="comment">// Number of nodes in each ring</span></div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;  <span class="keywordtype">int</span> iring;                      <span class="comment">// Index of ring in rings vector of vectors</span></div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;  <span class="keywordtype">int</span> icage;                      <span class="comment">// Index of the current cage in cageList</span></div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;  <span class="keywordtype">int</span> iatom;                      <span class="comment">// Atom index</span></div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="group__ring.html#ga34dea1971104b5adb318178730ffc40d">clusterCages</a>.size(); i++) {</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;    icage = <a class="code" href="group__ring.html#ga34dea1971104b5adb318178730ffc40d">clusterCages</a>[i];</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;    <span class="comment">// Loop through every ring in the cage</span></div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; cageList[icage].rings.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/size.html">size</a>(); j++) {</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;      iring = cageList[icage].rings[j]; <span class="comment">// Current ring index</span></div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;      <span class="comment">// Loop through every atom in iring</span></div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; ringSize; k++) {</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;        iatom = rings[iring][k];</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;        atoms.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/push_back.html">push_back</a>(iatom); <span class="comment">// Add the atom</span></div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;      }                         <span class="comment">// Loop through every atom in iring</span></div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;    }                           <span class="comment">// loop through every ring in the current cage</span></div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;  }                             <span class="comment">// end of loop through all cages</span></div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160; </div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;  <span class="comment">// Remove the duplicates in the atoms vector</span></div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;  <span class="comment">// Duplicate IDs must be removed</span></div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;  sort(atoms.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/begin.html">begin</a>(), atoms.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/end.html">end</a>());</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;  <span class="keyword">auto</span> ip = <a class="codeRef" href="http://en.cppreference.com/w/cpp/algorithm/unique.html">std::unique</a>(atoms.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/begin.html">begin</a>(), atoms.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/end.html">end</a>());</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;  <span class="comment">// Resize peripheral rings to remove undefined terms</span></div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;  atoms.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/resize.html">resize</a>(<a class="codeRef" href="http://en.cppreference.com/w/cpp/iterator/distance.html">std::distance</a>(atoms.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/begin.html">begin</a>(), ip));</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;  <span class="comment">// Return the vector of atoms</span></div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;  <span class="keywordflow">return</span> atoms;</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;}</div>
<div class="ttc" id="abasic_ofstream_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/io/basic_ofstream.html">std::ofstream</a></div></div>
<div class="ttc" id="abasic_string_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/string/basic_string.html">std::string</a></div></div>
<div class="ttc" id="abegin_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/container/vector/begin.html">std::vector::begin</a></div><div class="ttdeci">T begin(T... args)</div></div>
<div class="ttc" id="abulkTUM_8hpp_html"><div class="ttname"><a href="bulkTUM_8hpp.html">bulkTUM.hpp</a></div><div class="ttdoc">File containing functions used specific to bulk topological unit matching (TUM) criterion.</div></div>
<div class="ttc" id="aclose_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/io/basic_ofstream/close.html">std::ofstream::close</a></div><div class="ttdeci">T close(T... args)</div></div>
<div class="ttc" id="adistance_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/iterator/distance.html">std::distance</a></div><div class="ttdeci">T distance(T... args)</div></div>
<div class="ttc" id="aend_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/container/vector/end.html">std::vector::end</a></div><div class="ttdeci">T end(T... args)</div></div>
<div class="ttc" id="agroup__cage_html_ga5787314f51b5927c213db48b81c21d95"><div class="ttname"><a href="group__cage.html#ga5787314f51b5927c213db48b81c21d95">cage::cageType</a></div><div class="ttdeci">cageType</div><div class="ttdef"><b>Definition:</b> <a href="cage_8hpp_source.html#l00054">cage.hpp:54</a></div></div>
<div class="ttc" id="agroup__cage_html_ga5b4c006e8de944ce67f924190123f178"><div class="ttname"><a href="group__cage.html#ga5b4c006e8de944ce67f924190123f178">cage::Cage::rings</a></div><div class="ttdeci">std::vector&lt; int &gt; rings</div><div class="ttdoc">type of the cage : can be DDC or HC</div><div class="ttdef"><b>Definition:</b> <a href="cage_8hpp_source.html#l00088">cage.hpp:88</a></div></div>
<div class="ttc" id="agroup__cage_html_gga5787314f51b5927c213db48b81c21d95ac5a9e4f20bab07bef66bb6e15c49682d"><div class="ttname"><a href="group__cage.html#gga5787314f51b5927c213db48b81c21d95ac5a9e4f20bab07bef66bb6e15c49682d">cage::DoubleDiaC</a></div><div class="ttdeci">@ DoubleDiaC</div><div class="ttdef"><b>Definition:</b> <a href="cage_8hpp_source.html#l00054">cage.hpp:54</a></div></div>
<div class="ttc" id="agroup__cage_html_ggaaac41828990e32b9d6e7db4426b61529a3eae6b3c7c54d5cecb3d82d838cc6d60"><div class="ttname"><a href="group__cage.html#ggaaac41828990e32b9d6e7db4426b61529a3eae6b3c7c54d5cecb3d82d838cc6d60">cage::pnc</a></div><div class="ttdeci">@ pnc</div><div class="ttdef"><b>Definition:</b> <a href="cage_8hpp_source.html#l00075">cage.hpp:75</a></div></div>
<div class="ttc" id="agroup__cage_html_ggaaac41828990e32b9d6e7db4426b61529a508c36a9ffc7ba85f325a253be11312f"><div class="ttname"><a href="group__cage.html#ggaaac41828990e32b9d6e7db4426b61529a508c36a9ffc7ba85f325a253be11312f">cage::ddc</a></div><div class="ttdeci">@ ddc</div><div class="ttdef"><b>Definition:</b> <a href="cage_8hpp_source.html#l00075">cage.hpp:75</a></div></div>
<div class="ttc" id="agroup__cage_html_ggaaac41828990e32b9d6e7db4426b61529a8da31aa983c518632b4a522086415492"><div class="ttname"><a href="group__cage.html#ggaaac41828990e32b9d6e7db4426b61529a8da31aa983c518632b4a522086415492">cage::mixed</a></div><div class="ttdeci">@ mixed</div><div class="ttdef"><b>Definition:</b> <a href="cage_8hpp_source.html#l00075">cage.hpp:75</a></div></div>
<div class="ttc" id="agroup__cage_html_ggaaac41828990e32b9d6e7db4426b61529abf805fba4c226956825175c4514f14ce"><div class="ttname"><a href="group__cage.html#ggaaac41828990e32b9d6e7db4426b61529abf805fba4c226956825175c4514f14ce">cage::hc</a></div><div class="ttdeci">@ hc</div><div class="ttdef"><b>Definition:</b> <a href="cage_8hpp_source.html#l00075">cage.hpp:75</a></div></div>
<div class="ttc" id="agroup__cage_html_ggaaac41828990e32b9d6e7db4426b61529acbad0158a8f2811fd4136831fa2b3072"><div class="ttname"><a href="group__cage.html#ggaaac41828990e32b9d6e7db4426b61529acbad0158a8f2811fd4136831fa2b3072">cage::mixed2</a></div><div class="ttdeci">@ mixed2</div><div class="ttdef"><b>Definition:</b> <a href="cage_8hpp_source.html#l00075">cage.hpp:75</a></div></div>
<div class="ttc" id="agroup__molSys_html_gaa7d9b8543780baf4a495c7acdb1f87d8"><div class="ttname"><a href="group__molSys.html#gaa7d9b8543780baf4a495c7acdb1f87d8">molSys::PointCloud::box</a></div><div class="ttdeci">std::vector&lt; T &gt; box</div><div class="ttdoc">Number of atoms.</div><div class="ttdef"><b>Definition:</b> <a href="mol__sys_8hpp_source.html#l00174">mol_sys.hpp:174</a></div></div>
<div class="ttc" id="agroup__nneigh_html_gaaaaf74d25014d1c08bb73b8be0a6fe74"><div class="ttname"><a href="group__nneigh.html#gaaaaf74d25014d1c08bb73b8be0a6fe74">nneigh::neighListO</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; int &gt; &gt; neighListO(double rcutoff, molSys::PointCloud&lt; molSys::Point&lt; double &gt;, double &gt; *yCloud, int typeI)</div><div class="ttdef"><b>Definition:</b> <a href="neighbours_8cpp_source.html#l00118">neighbours.cpp:118</a></div></div>
<div class="ttc" id="agroup__nneigh_html_gab2468daaf43c827b54a88af914d0fee8"><div class="ttname"><a href="group__nneigh.html#gab2468daaf43c827b54a88af914d0fee8">nneigh::neighbourListByIndex</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; int &gt; &gt; neighbourListByIndex(molSys::PointCloud&lt; molSys::Point&lt; double &gt;, double &gt; *yCloud, std::vector&lt; std::vector&lt; int &gt;&gt; nList)</div><div class="ttdef"><b>Definition:</b> <a href="neighbours_8cpp_source.html#l00341">neighbours.cpp:341</a></div></div>
<div class="ttc" id="agroup__primitive_html_ga9872b1fd04c72cc53626b882bec4b99f"><div class="ttname"><a href="group__primitive.html#ga9872b1fd04c72cc53626b882bec4b99f">primitive::ringNetwork</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; int &gt; &gt; ringNetwork(std::vector&lt; std::vector&lt; int &gt;&gt; nList, int maxDepth)</div><div class="ttdef"><b>Definition:</b> <a href="franzblau_8cpp_source.html#l00032">franzblau.cpp:32</a></div></div>
<div class="ttc" id="agroup__prism3_html_ga35816c398a355ca472fddeb2869fce15"><div class="ttname"><a href="group__prism3.html#ga35816c398a355ca472fddeb2869fce15">ring::findDDC</a></div><div class="ttdeci">std::vector&lt; int &gt; findDDC(std::vector&lt; std::vector&lt; int &gt;&gt; rings, std::vector&lt; strucType &gt; *ringType, std::vector&lt; int &gt; listHC, std::vector&lt; cage::Cage &gt; *cageList)</div><div class="ttdef"><b>Definition:</b> <a href="topo__bulk_8cpp_source.html#l00203">topo_bulk.cpp:203</a></div></div>
<div class="ttc" id="agroup__prism3_html_ga584708a1ea3d1503d7f38f0904b7f5f1"><div class="ttname"><a href="group__prism3.html#ga584708a1ea3d1503d7f38f0904b7f5f1">ring::getAtomTypesTopoBulk</a></div><div class="ttdeci">int getAtomTypesTopoBulk(std::vector&lt; std::vector&lt; int &gt;&gt; rings, std::vector&lt; ring::strucType &gt; ringType, std::vector&lt; cage::iceType &gt; *atomTypes)</div><div class="ttdef"><b>Definition:</b> <a href="topo__bulk_8cpp_source.html#l01082">topo_bulk.cpp:1082</a></div></div>
<div class="ttc" id="agroup__prism3_html_ga6fcfac293a750bd14cbf1f94ab2a3976"><div class="ttname"><a href="group__prism3.html#ga6fcfac293a750bd14cbf1f94ab2a3976">ring::getStrucNumbers</a></div><div class="ttdeci">int getStrucNumbers(std::vector&lt; ring::strucType &gt; ringType, std::vector&lt; cage::Cage &gt; cageList, int *numHC, int *numDDC, int *mixedRings, int *prismaticRings, int *basalRings)</div><div class="ttdoc">Determines the number of HCs, DDCs, Mixed rings, prismatic and basal rings.</div><div class="ttdef"><b>Definition:</b> <a href="topo__bulk_8cpp_source.html#l01165">topo_bulk.cpp:1165</a></div></div>
<div class="ttc" id="agroup__prism3_html_gacb2bc68638bd794af38bcd503e17be0f"><div class="ttname"><a href="group__prism3.html#gacb2bc68638bd794af38bcd503e17be0f">prism3::findBulkPrisms</a></div><div class="ttdeci">int findBulkPrisms(std::vector&lt; std::vector&lt; int &gt;&gt; rings, std::vector&lt; ring::strucType &gt; *ringType, std::vector&lt; std::vector&lt; int &gt;&gt; nList, molSys::PointCloud&lt; molSys::Point&lt; double &gt;, double &gt; *yCloud, std::vector&lt; double &gt; *rmsdPerAtom, double heightCutoff=8)</div><div class="ttdoc">Find out which rings are prisms.</div><div class="ttdef"><b>Definition:</b> <a href="topo__bulk_8cpp_source.html#l01246">topo_bulk.cpp:1246</a></div></div>
<div class="ttc" id="agroup__prism3_html_gadb3c8127d84cb2e90aafff55419f2c85"><div class="ttname"><a href="group__prism3.html#gadb3c8127d84cb2e90aafff55419f2c85">ring::findMixedRings</a></div><div class="ttdeci">std::vector&lt; int &gt; findMixedRings(std::vector&lt; std::vector&lt; int &gt;&gt; rings, std::vector&lt; strucType &gt; *ringType, std::vector&lt; int &gt; *listDDC, std::vector&lt; int &gt; *listHC)</div><div class="ttdef"><b>Definition:</b> <a href="topo__bulk_8cpp_source.html#l01035">topo_bulk.cpp:1035</a></div></div>
<div class="ttc" id="agroup__prism3_html_gaf6c8e26a55c976c7ae810914bd1c7362"><div class="ttname"><a href="group__prism3.html#gaf6c8e26a55c976c7ae810914bd1c7362">ring::findHC</a></div><div class="ttdeci">std::vector&lt; int &gt; findHC(std::vector&lt; std::vector&lt; int &gt;&gt; rings, std::vector&lt; strucType &gt; *ringType, std::vector&lt; std::vector&lt; int &gt;&gt; nList, std::vector&lt; cage::Cage &gt; *cageList)</div><div class="ttdef"><b>Definition:</b> <a href="topo__bulk_8cpp_source.html#l00569">topo_bulk.cpp:569</a></div></div>
<div class="ttc" id="agroup__ring_html_ga05cfdd8cbd1785d44ee6787cb987cbd7"><div class="ttname"><a href="group__ring.html#ga05cfdd8cbd1785d44ee6787cb987cbd7">tum3::shapeMatchHC</a></div><div class="ttdeci">int shapeMatchHC(molSys::PointCloud&lt; molSys::Point&lt; double &gt;, double &gt; *yCloud, const Eigen::MatrixXd &amp;refPoints, cage::Cage cageUnit, std::vector&lt; std::vector&lt; int &gt;&gt; rings, std::vector&lt; std::vector&lt; int &gt;&gt; nList, std::vector&lt; double &gt; *quat, double *rmsd)</div><div class="ttdoc">Shape-matching for a target HC.</div><div class="ttdef"><b>Definition:</b> <a href="bulkTUM_8cpp_source.html#l00251">bulkTUM.cpp:251</a></div></div>
<div class="ttc" id="agroup__ring_html_ga0a321aab8c8956e0885826b65e550a1d"><div class="ttname"><a href="group__ring.html#ga0a321aab8c8956e0885826b65e550a1d">tum3::buildRefHC</a></div><div class="ttdeci">Eigen::MatrixXd buildRefHC(std::string fileName)</div><div class="ttdoc">Build a reference Hexagonal cage, reading in from a template XYZ file.</div><div class="ttdef"><b>Definition:</b> <a href="bulkTUM_8cpp_source.html#l00377">bulkTUM.cpp:377</a></div></div>
<div class="ttc" id="agroup__ring_html_ga2a339a36e85ff35c64fa3908936faf6c"><div class="ttname"><a href="group__ring.html#ga2a339a36e85ff35c64fa3908936faf6c">tum3::atomsFromCages</a></div><div class="ttdeci">std::vector&lt; int &gt; atomsFromCages(std::vector&lt; std::vector&lt; int &gt;&gt; rings, std::vector&lt; cage::Cage &gt; cageList, std::vector&lt; int &gt; clusterCages)</div><div class="ttdoc">Gets the atoms in the cages of a given cluster.</div><div class="ttdef"><b>Definition:</b> <a href="bulkTUM_8cpp_source.html#l00801">bulkTUM.cpp:801</a></div></div>
<div class="ttc" id="agroup__ring_html_ga34dea1971104b5adb318178730ffc40d"><div class="ttname"><a href="group__ring.html#ga34dea1971104b5adb318178730ffc40d">tum3::clusterCages</a></div><div class="ttdeci">int clusterCages(molSys::PointCloud&lt; molSys::Point&lt; double &gt;, double &gt; *yCloud, std::string path, std::vector&lt; std::vector&lt; int &gt;&gt; rings, std::vector&lt; cage::Cage &gt; cageList, int numHC, int numDDC)</div><div class="ttdef"><b>Definition:</b> <a href="bulkTUM_8cpp_source.html#l00644">bulkTUM.cpp:644</a></div></div>
<div class="ttc" id="agroup__ring_html_ga390a8ecb9b86c18c3802fcbdcf37cd83"><div class="ttname"><a href="group__ring.html#ga390a8ecb9b86c18c3802fcbdcf37cd83">tum3::averageRMSDatom</a></div><div class="ttdeci">int averageRMSDatom(std::vector&lt; double &gt; *rmsdPerAtom, std::vector&lt; int &gt; *noOfCommonAtoms)</div><div class="ttdoc">Average the RMSD per atom.</div><div class="ttdef"><b>Definition:</b> <a href="bulkTUM_8cpp_source.html#l00529">bulkTUM.cpp:529</a></div></div>
<div class="ttc" id="agroup__ring_html_ga4e415d1a523fd9e0d947ec76306ee5ff"><div class="ttname"><a href="group__ring.html#ga4e415d1a523fd9e0d947ec76306ee5ff">tum3::shapeMatchDDC</a></div><div class="ttdeci">int shapeMatchDDC(molSys::PointCloud&lt; molSys::Point&lt; double &gt;, double &gt; *yCloud, const Eigen::MatrixXd &amp;refPoints, std::vector&lt; cage::Cage &gt; cageList, int cageIndex, std::vector&lt; std::vector&lt; int &gt;&gt; rings, std::vector&lt; double &gt; *quat, double *rmsd)</div><div class="ttdoc">Shape-matching for a target DDC.</div><div class="ttdef"><b>Definition:</b> <a href="bulkTUM_8cpp_source.html#l00323">bulkTUM.cpp:323</a></div></div>
<div class="ttc" id="agroup__ring_html_ga4e4a17533b574451c585e3c839c6622a"><div class="ttname"><a href="group__ring.html#ga4e4a17533b574451c585e3c839c6622a">tum3::topoUnitMatchingBulk</a></div><div class="ttdeci">int topoUnitMatchingBulk(std::string path, std::vector&lt; std::vector&lt; int &gt;&gt; rings, std::vector&lt; std::vector&lt; int &gt;&gt; nList, molSys::PointCloud&lt; molSys::Point&lt; double &gt;, double &gt; *yCloud, int firstFrame, bool printClusters, bool onlyTetrahedral)</div><div class="ttdef"><b>Definition:</b> <a href="bulkTUM_8cpp_source.html#l00052">bulkTUM.cpp:52</a></div></div>
<div class="ttc" id="agroup__ring_html_ga76f3cb7aa8a713aeafecdf3a6fffee31"><div class="ttname"><a href="group__ring.html#ga76f3cb7aa8a713aeafecdf3a6fffee31">ring::clearRingList</a></div><div class="ttdeci">int clearRingList(std::vector&lt; std::vector&lt; int &gt;&gt; &amp;rings)</div><div class="ttdoc">Erases memory for a vector of vectors for a list of rings.</div><div class="ttdef"><b>Definition:</b> <a href="ring_8cpp_source.html#l00022">ring.cpp:22</a></div></div>
<div class="ttc" id="agroup__ring_html_ga8c3edb4cf0aab398434a883122135c18"><div class="ttname"><a href="group__ring.html#ga8c3edb4cf0aab398434a883122135c18">tum3::updateRMSDatom</a></div><div class="ttdeci">int updateRMSDatom(std::vector&lt; std::vector&lt; int &gt;&gt; rings, cage::Cage cageUnit, double rmsd, std::vector&lt; double &gt; *rmsdPerAtom, std::vector&lt; int &gt; *noOfCommonAtoms, std::vector&lt; cage::iceType &gt; atomTypes)</div><div class="ttdef"><b>Definition:</b> <a href="bulkTUM_8cpp_source.html#l00486">bulkTUM.cpp:486</a></div></div>
<div class="ttc" id="agroup__ring_html_gabad4c396b9a976a7a2199fdfeab143e7"><div class="ttname"><a href="group__ring.html#gabad4c396b9a976a7a2199fdfeab143e7">tum3::topoBulkCriteria</a></div><div class="ttdeci">std::vector&lt; cage::Cage &gt; topoBulkCriteria(std::string path, std::vector&lt; std::vector&lt; int &gt;&gt; rings, std::vector&lt; std::vector&lt; int &gt;&gt; nList, molSys::PointCloud&lt; molSys::Point&lt; double &gt;, double &gt; *yCloud, int firstFrame, int *numHC, int *numDDC, std::vector&lt; ring::strucType &gt; *ringType)</div><div class="ttdef"><b>Definition:</b> <a href="bulkTUM_8cpp_source.html#l00581">bulkTUM.cpp:581</a></div></div>
<div class="ttc" id="agroup__ring_html_gabf66bd35cdbccfd8fee51564dc889977"><div class="ttname"><a href="group__ring.html#gabf66bd35cdbccfd8fee51564dc889977">tum3::buildRefDDC</a></div><div class="ttdeci">Eigen::MatrixXd buildRefDDC(std::string fileName)</div><div class="ttdoc">Build a reference Double-Diamond cage, reading in from a template XYZ file.</div><div class="ttdef"><b>Definition:</b> <a href="bulkTUM_8cpp_source.html#l00435">bulkTUM.cpp:435</a></div></div>
<div class="ttc" id="agroup__ring_html_gac30855d0daa2b20c29e4dee39f5cd92f"><div class="ttname"><a href="group__ring.html#gac30855d0daa2b20c29e4dee39f5cd92f">ring::hasCommonElements</a></div><div class="ttdeci">bool hasCommonElements(std::vector&lt; int &gt; ring1, std::vector&lt; int &gt; ring2)</div><div class="ttdef"><b>Definition:</b> <a href="ring_8cpp_source.html#l00179">ring.cpp:179</a></div></div>
<div class="ttc" id="agroup__ring_html_gae9254c83de03fcf18b4cb5dcb2625011"><div class="ttname"><a href="group__ring.html#gae9254c83de03fcf18b4cb5dcb2625011">ring::getSingleRingSize</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; int &gt; &gt; getSingleRingSize(std::vector&lt; std::vector&lt; int &gt;&gt; rings, int ringSize)</div><div class="ttdoc">Returns a vector of vectors of rings of a single size.</div><div class="ttdef"><b>Definition:</b> <a href="ring_8cpp_source.html#l00153">ring.cpp:153</a></div></div>
<div class="ttc" id="agroup__sinp_html_gab2f8bc3f639a2d2618460883116d5b5b"><div class="ttname"><a href="group__sinp.html#gab2f8bc3f639a2d2618460883116d5b5b">sinp::readXYZ</a></div><div class="ttdeci">int readXYZ(std::string filename, molSys::PointCloud&lt; molSys::Point&lt; double &gt;, double &gt; *yCloud)</div><div class="ttdoc">Function for reading in atom coordinates from an XYZ file.</div><div class="ttdef"><b>Definition:</b> <a href="seams__input_8cpp_source.html#l00073">seams_input.cpp:73</a></div></div>
<div class="ttc" id="anamespaceabsor_html_ad4f0741af9784817b44df6883888d9a3"><div class="ttname"><a href="namespaceabsor.html#ad4f0741af9784817b44df6883888d9a3">absor::hornAbsOrientation</a></div><div class="ttdeci">int hornAbsOrientation(const Eigen::MatrixXd &amp;refPoints, const Eigen::MatrixXd &amp;targetPoints, std::vector&lt; double &gt; *quat, double *rmsd, std::vector&lt; double &gt; *rmsdList, double *scale)</div><div class="ttdoc">Get the absolute orientation using Horn's algorithm (with quaternions)</div><div class="ttdef"><b>Definition:</b> <a href="absOrientation_8cpp_source.html#l00030">absOrientation.cpp:30</a></div></div>
<div class="ttc" id="anamespacepntToPnt_html_a2c4affea21bfc133f8c752d74f3a943a"><div class="ttname"><a href="namespacepntToPnt.html#a2c4affea21bfc133f8c752d74f3a943a">pntToPnt::changeDiaCageOrder</a></div><div class="ttdeci">Eigen::MatrixXd changeDiaCageOrder(molSys::PointCloud&lt; molSys::Point&lt; double &gt;, double &gt; *yCloud, std::vector&lt; int &gt; ddcOrder, int startingIndex=0)</div><div class="ttdef"><b>Definition:</b> <a href="pntCorrespondence_8cpp_source.html#l01042">pntCorrespondence.cpp:1042</a></div></div>
<div class="ttc" id="anamespacepntToPnt_html_a804eb495f58fd5868858cc46480c3425"><div class="ttname"><a href="namespacepntToPnt.html#a804eb495f58fd5868858cc46480c3425">pntToPnt::relOrderDDC</a></div><div class="ttdeci">std::vector&lt; int &gt; relOrderDDC(int index, std::vector&lt; std::vector&lt; int &gt;&gt; rings, std::vector&lt; cage::Cage &gt; cageList)</div><div class="ttdoc">Matches the order of the basal rings of an DDC or a potential HC.</div><div class="ttdef"><b>Definition:</b> <a href="pntCorrespondence_8cpp_source.html#l00845">pntCorrespondence.cpp:845</a></div></div>
<div class="ttc" id="anamespacepntToPnt_html_a8140eb2ad1dfb9d08e4e917dd14d5424"><div class="ttname"><a href="namespacepntToPnt.html#a8140eb2ad1dfb9d08e4e917dd14d5424">pntToPnt::relOrderHC</a></div><div class="ttdeci">int relOrderHC(molSys::PointCloud&lt; molSys::Point&lt; double &gt;, double &gt; *yCloud, std::vector&lt; int &gt; basal1, std::vector&lt; int &gt; basal2, std::vector&lt; std::vector&lt; int &gt;&gt; nList, std::vector&lt; int &gt; *matchedBasal1, std::vector&lt; int &gt; *matchedBasal2)</div><div class="ttdoc">Matches the order of the basal rings of an HC or a potential HC.</div><div class="ttdef"><b>Definition:</b> <a href="pntCorrespondence_8cpp_source.html#l00609">pntCorrespondence.cpp:609</a></div></div>
<div class="ttc" id="anamespacepntToPnt_html_a896e8ed3ac4436156eac99b12e12c255"><div class="ttname"><a href="namespacepntToPnt.html#a896e8ed3ac4436156eac99b12e12c255">pntToPnt::changeHexCageOrder</a></div><div class="ttdeci">Eigen::MatrixXd changeHexCageOrder(molSys::PointCloud&lt; molSys::Point&lt; double &gt;, double &gt; *yCloud, std::vector&lt; int &gt; basal1, std::vector&lt; int &gt; basal2, int startingIndex=0)</div><div class="ttdef"><b>Definition:</b> <a href="pntCorrespondence_8cpp_source.html#l00740">pntCorrespondence.cpp:740</a></div></div>
<div class="ttc" id="anamespacesout_html_a3985775f30d7920fbf13f12386abefc1"><div class="ttname"><a href="namespacesout.html#a3985775f30d7920fbf13f12386abefc1">sout::makePath</a></div><div class="ttdeci">int makePath(const std::string &amp;path)</div><div class="ttdef"><b>Definition:</b> <a href="seams__output_8hpp_source.html#l00064">seams_output.hpp:64</a></div></div>
<div class="ttc" id="anamespacesout_html_a5ca5eeff9edc702cdcf1b26e8501dc0c"><div class="ttname"><a href="namespacesout.html#a5ca5eeff9edc702cdcf1b26e8501dc0c">sout::writeTopoBulkData</a></div><div class="ttdeci">int writeTopoBulkData(std::string path, int currentFrame, int numHC, int numDDC, int mixedRings, int basalRings, int prismaticRings, int firstFrame)</div><div class="ttdef"><b>Definition:</b> <a href="seams__output_8cpp_source.html#l01053">seams_output.cpp:1053</a></div></div>
<div class="ttc" id="anamespacesout_html_aabeb7b712f568256cf3ed782fa91c518"><div class="ttname"><a href="namespacesout.html#aabeb7b712f568256cf3ed782fa91c518">sout::writeLAMMPSdataTopoBulk</a></div><div class="ttdeci">int writeLAMMPSdataTopoBulk(molSys::PointCloud&lt; molSys::Point&lt; double &gt;, double &gt; *yCloud, std::vector&lt; std::vector&lt; int &gt;&gt; nList, std::vector&lt; cage::iceType &gt; atomTypes, std::string path, bool bondsBetweenDummy=false)</div><div class="ttdef"><b>Definition:</b> <a href="seams__output_8cpp_source.html#l02115">seams_output.cpp:2115</a></div></div>
<div class="ttc" id="anamespacesout_html_ad297dfa82170796cedea7f111e7694df"><div class="ttname"><a href="namespacesout.html#ad297dfa82170796cedea7f111e7694df">sout::writeLAMMPSdumpCages</a></div><div class="ttdeci">int writeLAMMPSdumpCages(molSys::PointCloud&lt; molSys::Point&lt; double &gt;, double &gt; *yCloud, std::vector&lt; double &gt; rmsdPerAtom, std::vector&lt; int &gt; atomTypes, std::string path, int firstFrame)</div><div class="ttdoc">Write out a LAMMPS dump file containing the RMSD per atom for bulk ice.</div><div class="ttdef"><b>Definition:</b> <a href="seams__output_8cpp_source.html#l01090">seams_output.cpp:1090</a></div></div>
<div class="ttc" id="anamespacesout_html_ad80ee9773d7921a87ef5bbbe76541a91"><div class="ttname"><a href="namespacesout.html#ad80ee9773d7921a87ef5bbbe76541a91">sout::writeXYZcluster</a></div><div class="ttdeci">int writeXYZcluster(std::string path, molSys::PointCloud&lt; molSys::Point&lt; double &gt;, double &gt; *yCloud, std::vector&lt; int &gt; atoms, int clusterID, cage::cageType type)</div><div class="ttdoc">Function for writing out the XYZ files for each cluster.</div><div class="ttdef"><b>Definition:</b> <a href="seams__output_8cpp_source.html#l02268">seams_output.cpp:2268</a></div></div>
<div class="ttc" id="aopen_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/io/basic_ofstream/open.html">std::ofstream::open</a></div><div class="ttdeci">T open(T... args)</div></div>
<div class="ttc" id="apush_back_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/container/vector/push_back.html">std::vector::push_back</a></div><div class="ttdeci">T push_back(T... args)</div></div>
<div class="ttc" id="aresize_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/container/vector/resize.html">std::vector::resize</a></div><div class="ttdeci">T resize(T... args)</div></div>
<div class="ttc" id="asize_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/container/vector/size.html">std::vector::size</a></div><div class="ttdeci">T size(T... args)</div></div>
<div class="ttc" id="astructcage_1_1Cage_html"><div class="ttname"><a href="structcage_1_1Cage.html">cage::Cage</a></div><div class="ttdoc">This contains a cage, with the constituent rings.</div><div class="ttdef"><b>Definition:</b> <a href="cage_8hpp_source.html#l00086">cage.hpp:86</a></div></div>
<div class="ttc" id="astructmolSys_1_1PointCloud_html"><div class="ttname"><a href="structmolSys_1_1PointCloud.html">molSys::PointCloud</a></div><div class="ttdoc">This contains a collection of points; contains information for a particular frame.</div><div class="ttdef"><b>Definition:</b> <a href="mol__sys_8hpp_source.html#l00170">mol_sys.hpp:170</a></div></div>
<div class="ttc" id="astructmolSys_1_1Point_html"><div class="ttname"><a href="structmolSys_1_1Point.html">molSys::Point</a></div><div class="ttdoc">This contains per-particle information.</div><div class="ttdef"><b>Definition:</b> <a href="mol__sys_8hpp_source.html#l00149">mol_sys.hpp:149</a></div></div>
<div class="ttc" id="ato_string_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/string/basic_string/to_string.html">std::to_string</a></div><div class="ttdeci">T to_string(T... args)</div></div>
<div class="ttc" id="aunique_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/algorithm/unique.html">std::unique</a></div><div class="ttdeci">T unique(T... args)</div></div>
<div class="ttc" id="avector_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- Copyright 2020 Rohit Goswami <rog32@hi.is>
     Licensed under the Apache License, Version 2.0 (the "License");
     you may not use this file except in compliance with the License.
     You may obtain a copy of the License at
     http://www.apache.org/licenses/LICENSE-2.0
     Unless required by applicable law or agreed to in writing, software
     distributed under the License is distributed on an "AS IS" BASIS,
     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     See the License for the specific language governing permissions and
     limitations under the License. -->
<!-- HTML footer for doxygen 1.9.1-->
<!-- start footer part -->
<div class="footer">
<hr class="footline"/><address class="footline"><small>
    Generated by&#160;<a href="https://www.doxygen.org/index.html">Doxygen 1.9.1</a> and the <a class="outlink" href="https://github.com/HaoZeke/doxyYoda">doxyYoda theme</a>
</small></address>
</div>
</div>
</body>
</html>
